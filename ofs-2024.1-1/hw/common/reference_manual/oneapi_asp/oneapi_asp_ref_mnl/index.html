
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../../user_guides/oneapi_asp/ug_oneapi_asp/">
      
      
        <link rel="next" href="../../ofs_sw/mnl_sw_ofs/">
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.9">
    
    
      
        <title>oneAPI Accelerator Support Package(ASP) Reference Manual - OFS</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.85bb2934.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#oneapi-accelerator-support-packageasp-reference-manual-open-fpga-stack" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="OFS" class="md-header__button md-logo" aria-label="OFS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OFS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              oneAPI Accelerator Support Package(ASP) Reference Manual
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ofs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ofs
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../user_guides/ug_fpga_developer/ug_fpga_developer/" class="md-tabs__link">
        Start Here
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../doc_modules/contents_s10_pcie_attach/" class="md-tabs__link">
        Stratix® 10 PCIe Attach OFS
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../doc_modules/contents_agx7_pcie_attach/" class="md-tabs__link">
        Agilex® 7 PCIe Attach OFS
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../doc_modules/contents_agx7_soc_attach/" class="md-tabs__link">
        Agilex SoC Attach OFS
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../user_guides/oneapi_asp/ug_oneapi_asp/" class="md-tabs__link md-tabs__link--active">
        oneAPI
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../ofs_sw/mnl_sw_ofs/" class="md-tabs__link">
        OFS Software
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="OFS" class="md-nav__button md-logo" aria-label="OFS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    OFS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ofs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ofs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Start Here
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Start Here
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_fpga_developer/ug_fpga_developer/" class="md-nav__link">
        FPGA Developer Journey Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../doc_modules/Glossary/" class="md-nav__link">
        Glossary
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Stratix® 10 PCIe Attach OFS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Stratix® 10 PCIe Attach OFS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../doc_modules/contents_s10_pcie_attach/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../board_installation/adp_board_installation/adp_board_installation_guidelines/" class="md-nav__link">
        Board Installation Guide (Intel® FPGA PAC D5005)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sw_installation/pcie_attach/sw_install_pcie_attach/" class="md-nav__link">
        Software Installation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/user_guides/ug_qs_ofs_d5005/ug_qs_ofs_d5005/" class="md-nav__link">
        Getting Started Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/user_guides/ug_eval_ofs_d5005/ug_eval_script_ofs_d5005/" class="md-nav__link">
        Automated Evaluation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/reference_manuals/ofs_fim/mnl_fim_ofs_d5005/" class="md-nav__link">
        Shell Technical Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/dev_guides/fim_dev/ug_dev_fim_ofs_d5005/" class="md-nav__link">
        Shell Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/dev_guides/afu_dev/ug_dev_afu_d5005/" class="md-nav__link">
        Workload Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/afu_dev/ug_dev_pim_based_afu/ug_dev_pim_based_afu/" class="md-nav__link">
        PIM Based AFU Developer User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/afu_dev/ug_dev_afu_sim_env/ug_dev_afu_sim_env/" class="md-nav__link">
        AFU Simulation Environment User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/user_guides/ug_sim_ofs_d5005/ug_sim_ofs_d5005/" class="md-nav__link">
        Simulation User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_12" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_12" id="__nav_3_12_label" tabindex="0">
          Virtualization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_12_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_12">
          <span class="md-nav__icon md-icon"></span>
          Virtualization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_docker/ug_docker/" class="md-nav__link">
        Docker User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_kvm/ug_kvm/" class="md-nav__link">
        KVM User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Agilex® 7 PCIe Attach OFS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Agilex® 7 PCIe Attach OFS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../doc_modules/contents_agx7_pcie_attach/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          Board Installation Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Board Installation Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../board_installation/adp_board_installation/adp_board_installation_guidelines/" class="md-nav__link">
        Intel® FPGA SmartNIC N6000/1-PL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../board_installation/devkit_board_installation/devkit_board_installation_guidelines/" class="md-nav__link">
        Agilex® 7 FPGA I-Series and F-Series Development Kits
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sw_installation/pcie_attach/sw_install_pcie_attach/" class="md-nav__link">
        Software Installation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
          Getting Started Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Getting Started Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../iseries_devkit/user_guides/ug_qs_ofs_iseries/ug_qs_ofs_iseries/" class="md-nav__link">
        OFS for Agilex® 7 FPGA I-Series Development Kit (2xR-Tile,1xF-Tile)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ftile_devkit/user_guides/ug_qs_ofs_ftile/ug_qs_ofs_ftile/" class="md-nav__link">
        OFS for Agilex® 7 FPGA F-Series Development Kit (2xF-Tile)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../n6001/user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/" class="md-nav__link">
        OFS for Intel® FPGA SmartNIC N6001-PL
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_eval_script_ofs_agx7_pcie_attach/ug_eval_script_ofs_agx7_pcie_attach/" class="md-nav__link">
        Automated Evaluation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
          Shell Developer Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          Shell Developer Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../iseries_devkit/dev_guides/fim_dev/ug_ofs_iseries_dk_fim_dev/" class="md-nav__link">
        PCIe Attach I-Series (2xR-Tile, F-Tile)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ftile_devkit/dev_guides/fim_dev/ug_ofs_ftile_dk_fim_dev/" class="md-nav__link">
        PCIe Attach F-Series (2xF-Tile)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/" class="md-nav__link">
        PCIe Attach F-Series (P-Tile/E-Tile)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../n6001/dev_guides/hps_dev/hps_developer_ug/" class="md-nav__link">
        HPS Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_sim_ofs_agx7_pcie_attach/ug_sim_ofs_agx7_pcie_attach/" class="md-nav__link">
        Simulation User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/afu_dev/ug_dev_afu_ofs_agx7_pcie_attach/ug_dev_afu_ofs_agx7_pcie_attach/" class="md-nav__link">
        Workload Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/afu_dev/ug_dev_pim_based_afu/ug_dev_pim_based_afu/" class="md-nav__link">
        PIM Based AFU Developer User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/afu_dev/ug_dev_afu_sim_env/ug_dev_afu_sim_env/" class="md-nav__link">
        AFU Simulation Environment User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
          Virtualization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_12">
          <span class="md-nav__icon md-icon"></span>
          Virtualization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_docker/ug_docker/" class="md-nav__link">
        Docker User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_kvm/ug_kvm/" class="md-nav__link">
        KVM User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Agilex SoC Attach OFS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Agilex SoC Attach OFS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../doc_modules/contents_agx7_soc_attach/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../board_installation/f2000x_board_installation/f2000x_board_installation/" class="md-nav__link">
        Board Installation Guide (Intel® IPU Platform F2000X-PL)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sw_installation/soc_attach/sw_install_soc_attach/" class="md-nav__link">
        Software Installation Guide for SoC Attach
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/user_guides/ug_qs_ofs_f2000x/ug_qs_ofs_f2000x/" class="md-nav__link">
        Getting Started Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/user_guides/ug_eval_ofs/ug_eval_script_ofs_f2000x/" class="md-nav__link">
        Automated Evaluation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/reference_manuals/ofs_fim/mnl_fim_ofs/" class="md-nav__link">
        Shell Technical Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/dev_guides/fim_dev/ug_dev_fim_ofs/" class="md-nav__link">
        Shell Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/dev_guides/afu_dev/ug_dev_afu_ofs_f2000x/" class="md-nav__link">
        Workload Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/afu_dev/ug_dev_pim_based_afu/ug_dev_pim_based_afu/" class="md-nav__link">
        PIM Based AFU Developer User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/afu_dev/ug_dev_afu_sim_env/ug_dev_afu_sim_env/" class="md-nav__link">
        AFU Simulation Environment User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/user_guides/ug_sim_ofs/ug_sim_ofs/" class="md-nav__link">
        Simulation User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_12" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_12" id="__nav_5_12_label" tabindex="0">
          Virtualization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_12_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_12">
          <span class="md-nav__icon md-icon"></span>
          Virtualization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_docker/ug_docker/" class="md-nav__link">
        Docker User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_kvm/ug_kvm/" class="md-nav__link">
        KVM User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          oneAPI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          oneAPI
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/oneapi_asp/ug_oneapi_asp/" class="md-nav__link">
        oneAPI ASP Getting Started User Guide
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          oneAPI Accelerator Support Package(ASP) Reference Manual
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        oneAPI Accelerator Support Package(ASP) Reference Manual
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#10-overview" class="md-nav__link">
    1.0 Overview
  </a>
  
    <nav class="md-nav" aria-label="1.0 Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-about-this-document" class="md-nav__link">
    1.1 About this Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-terminology" class="md-nav__link">
    1.2 Terminology
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-prerequisites" class="md-nav__link">
    1.3 Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-introduction-to-oneapi-on-open-fpga-stackofs" class="md-nav__link">
    1.4 Introduction to oneAPI on Open FPGA Stack(OFS)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-introduction-to-oneapi-accelerator-support-packageasp" class="md-nav__link">
    1.5 Introduction to oneAPI Accelerator Support Package(ASP)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#20-xml-files-in-oneapi-asp" class="md-nav__link">
    2.0 XML Files in oneAPI ASP
  </a>
  
    <nav class="md-nav" aria-label="2.0 XML Files in oneAPI ASP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-board_specxml-file" class="md-nav__link">
    2.1 board_spec.xml File
  </a>
  
    <nav class="md-nav" aria-label="2.1 board_spec.xml File">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211-board-element" class="md-nav__link">
    2.1.1 board Element
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#212-compile-element" class="md-nav__link">
    2.1.2 compile Element
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#213-device-element" class="md-nav__link">
    2.1.3 device Element
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#214-interface-attribute" class="md-nav__link">
    2.1.4 interface Attribute
  </a>
  
    <nav class="md-nav" aria-label="2.1.4 interface Attribute">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2141-port-parameter" class="md-nav__link">
    2.1.4.1 port Parameter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#215-global_mem-element" class="md-nav__link">
    2.1.5 global_mem Element
  </a>
  
    <nav class="md-nav" aria-label="2.1.5 global_mem Element">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2151-global-memory-configurations" class="md-nav__link">
    2.1.5.1 Global Memory Configurations
  </a>
  
    <nav class="md-nav" aria-label="2.1.5.1 Global Memory Configurations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21511-contiguous-global-memory" class="md-nav__link">
    2.1.5.1.1 Contiguous Global Memory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#21512-heterogeneous-memory" class="md-nav__link">
    2.1.5.1.2 Heterogeneous Memory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#216-host-element" class="md-nav__link">
    2.1.6 host Element
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#217-interfaces-element" class="md-nav__link">
    2.1.7 interfaces Element
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#218-channels-element" class="md-nav__link">
    2.1.8 channels Element
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-board_envxml-file" class="md-nav__link">
    2.2 board_env.xml File
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#30-oneapi-asp-hardware" class="md-nav__link">
    3.0 oneAPI ASP Hardware
  </a>
  
    <nav class="md-nav" aria-label="3.0 oneAPI ASP Hardware">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-host-to-external-memory-interfaceemif" class="md-nav__link">
    3.1 Host to External Memory Interface(EMIF)
  </a>
  
    <nav class="md-nav" aria-label="3.1 Host to External Memory Interface(EMIF)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#311-memory-bank-divider" class="md-nav__link">
    3.1.1 Memory Bank Divider
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-host-to-kernel-interface" class="md-nav__link">
    3.2 Host to Kernel Interface
  </a>
  
    <nav class="md-nav" aria-label="3.2 Host to Kernel Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-kernel-interface" class="md-nav__link">
    3.2.1 Kernel Interface
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-kernel-to-external-memory-interface" class="md-nav__link">
    3.3 Kernel to External Memory Interface
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#40-oneapi-asp-software" class="md-nav__link">
    4.0 oneAPI ASP Software
  </a>
  
    <nav class="md-nav" aria-label="4.0 oneAPI ASP Software">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-memory-mapped-devicemmd-layer" class="md-nav__link">
    4.1 Memory Mapped Device(MMD) Layer
  </a>
  
    <nav class="md-nav" aria-label="4.1 Memory Mapped Device(MMD) Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#411-aocl_mmd_get_offline_info" class="md-nav__link">
    4.1.1 aocl_mmd_get_offline_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#412-aocl_mmd_get_info" class="md-nav__link">
    4.1.2 aocl_mmd_get_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#413-aocl_mmd_open" class="md-nav__link">
    4.1.3 aocl_mmd_open
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#414-aocl_mmd_close" class="md-nav__link">
    4.1.4 aocl_mmd_close
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#415-aocl_mmd_set_interrupt_handler" class="md-nav__link">
    4.1.5 aocl_mmd_set_interrupt_handler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#416-aocl_mmd_set_device_interrupt_handler" class="md-nav__link">
    4.1.6 aocl_mmd_set_device_interrupt_handler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#417-aocl_mmd_set_status_handler" class="md-nav__link">
    4.1.7 aocl_mmd_set_status_handler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#418-aocl_mmd_yield" class="md-nav__link">
    4.1.8 aocl_mmd_yield
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#419-aocl_mmd_read" class="md-nav__link">
    4.1.9 aocl_mmd_read
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4110-aocl_mmd_write" class="md-nav__link">
    4.1.10 aocl_mmd_write
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4111-aocl_mmd_copy" class="md-nav__link">
    4.1.11 aocl_mmd_copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4112-aocl_mmd_hostchannel_create" class="md-nav__link">
    4.1.12 aocl_mmd_hostchannel_create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4113-aocl_mmd_hostchannel_destroy" class="md-nav__link">
    4.1.13 aocl_mmd_hostchannel_destroy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4114-aocl_mmd_hostchannel_get_buffer" class="md-nav__link">
    4.1.14 aocl_mmd_hostchannel_get_buffer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4115-aocl_mmd_hostchannel_ack_buffer" class="md-nav__link">
    4.1.15 aocl_mmd_hostchannel_ack_buffer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4116-aocl_mmd_program" class="md-nav__link">
    4.1.16 aocl_mmd_program
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4117-aocl_mmd_host_alloc" class="md-nav__link">
    4.1.17 aocl_mmd_host_alloc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4118-aocl_mmd_free" class="md-nav__link">
    4.1.18 aocl_mmd_free
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4119-aocl_mmd_device_alloc" class="md-nav__link">
    4.1.19 aocl_mmd_device_alloc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4120-aocl_mmd_shared_alloc" class="md-nav__link">
    4.1.20 aocl_mmd_shared_alloc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4121-aocl_mmd_shared_migrate" class="md-nav__link">
    4.1.21 aocl_mmd_shared_migrate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-board-utilities" class="md-nav__link">
    4.2 Board Utilities
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#50-oneapi-asp-implementation-details" class="md-nav__link">
    5.0 oneapi-asp Implementation Details
  </a>
  
    <nav class="md-nav" aria-label="5.0 oneapi-asp Implementation Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-oneapi-asp-directory-structure" class="md-nav__link">
    5.1 oneapi-asp Directory Structure
  </a>
  
    <nav class="md-nav" aria-label="5.1 oneapi-asp Directory Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#511-hardware-folder" class="md-nav__link">
    5.1.1 hardware Folder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#512-commonsource-folder" class="md-nav__link">
    5.1.2 common/source Folder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#513-linux64-folder" class="md-nav__link">
    5.1.3 linux64 Folder
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-oneapi-asp-build-flow" class="md-nav__link">
    5.2 oneapi-asp Build Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-oneapi-asp-hardware-implementation" class="md-nav__link">
    5.3 oneapi-asp Hardware Implementation
  </a>
  
    <nav class="md-nav" aria-label="5.3 oneapi-asp Hardware Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#531-platform-interface-managerpim" class="md-nav__link">
    5.3.1 Platform Interface Manager(PIM)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#532-direct-memory-accessdma-module" class="md-nav__link">
    5.3.2 Direct Memory Access(DMA) Module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#533-board_hwtcl-file" class="md-nav__link">
    5.3.3 board_hw.tcl File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#534-user-datagram-protocoludp-engine" class="md-nav__link">
    5.3.4 User Datagram Protocol(UDP) Engine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#535-hardware-compile-flow" class="md-nav__link">
    5.3.5 Hardware Compile Flow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-oneapi-asp-memory-mapped-devicemmd-layer-implementation" class="md-nav__link">
    5.4 oneapi-asp Memory Mapped Device(MMD) Layer Implementation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55-oneapi-asp-utilities-implementation" class="md-nav__link">
    5.5 oneapi-asp Utilities Implementation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    Appendix
  </a>
  
    <nav class="md-nav" aria-label="Appendix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#appendix-a-memory-mapped-devicemmd-layer-debug-variables" class="md-nav__link">
    Appendix A: Memory Mapped Device(MMD) Layer Debug Variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#document-revision-history" class="md-nav__link">
    Document Revision History
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notices-disclaimers" class="md-nav__link">
    Notices &amp; Disclaimers
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          OFS Software
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          OFS Software
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ofs_sw/mnl_sw_ofs/" class="md-nav__link">
        Software Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sw_installation/pcie_attach/sw_install_pcie_attach/" class="md-nav__link">
        Software Installation Guide OFS for PCIe Attach
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sw_installation/soc_attach/sw_install_soc_attach/" class="md-nav__link">
        Software Installation Guide OFS for SoC Attach
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
          OPAE FPGA Tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_4">
          <span class="md-nav__icon md-icon"></span>
          OPAE FPGA Tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/fpgainfo/fpgainfo/" class="md-nav__link">
        fpgainfo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/fpgasupdate/fpgasupdate/" class="md-nav__link">
        fpgasupdate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/mmlink/mmlink/" class="md-nav__link">
        mmlink
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/packager/packager/" class="md-nav__link">
        packager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/userclk/userclk/" class="md-nav__link">
        userclk
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/hssi/hssi/" class="md-nav__link">
        hssi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/pci_device/pci_device/" class="md-nav__link">
        pci_device
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/opae.io/opae.io/" class="md-nav__link">
        opae.io
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/rsu/rsu/" class="md-nav__link">
        rsu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/host_exerciser/host_exerciser/" class="md-nav__link">
        host_exerciser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/hssi_ethernet/hssistats/" class="md-nav__link">
        HSSI ethernet statistics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/hssi_ethernet/hssimac/" class="md-nav__link">
        HSSI ethernet mac
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/mem_tg/mem_tg/" class="md-nav__link">
        mem_tg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/vabtool/vabtool/" class="md-nav__link">
        vabtool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/opaevfio/opaevfio/" class="md-nav__link">
        opaevfio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/ofs.uio/ofs.uio/" class="md-nav__link">
        ofs.uio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/opaeuio/opaeuio/" class="md-nav__link">
        opaeuio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/fpgad/fpgad/" class="md-nav__link">
        fpgad
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#10-overview" class="md-nav__link">
    1.0 Overview
  </a>
  
    <nav class="md-nav" aria-label="1.0 Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-about-this-document" class="md-nav__link">
    1.1 About this Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-terminology" class="md-nav__link">
    1.2 Terminology
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-prerequisites" class="md-nav__link">
    1.3 Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-introduction-to-oneapi-on-open-fpga-stackofs" class="md-nav__link">
    1.4 Introduction to oneAPI on Open FPGA Stack(OFS)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-introduction-to-oneapi-accelerator-support-packageasp" class="md-nav__link">
    1.5 Introduction to oneAPI Accelerator Support Package(ASP)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#20-xml-files-in-oneapi-asp" class="md-nav__link">
    2.0 XML Files in oneAPI ASP
  </a>
  
    <nav class="md-nav" aria-label="2.0 XML Files in oneAPI ASP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-board_specxml-file" class="md-nav__link">
    2.1 board_spec.xml File
  </a>
  
    <nav class="md-nav" aria-label="2.1 board_spec.xml File">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211-board-element" class="md-nav__link">
    2.1.1 board Element
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#212-compile-element" class="md-nav__link">
    2.1.2 compile Element
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#213-device-element" class="md-nav__link">
    2.1.3 device Element
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#214-interface-attribute" class="md-nav__link">
    2.1.4 interface Attribute
  </a>
  
    <nav class="md-nav" aria-label="2.1.4 interface Attribute">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2141-port-parameter" class="md-nav__link">
    2.1.4.1 port Parameter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#215-global_mem-element" class="md-nav__link">
    2.1.5 global_mem Element
  </a>
  
    <nav class="md-nav" aria-label="2.1.5 global_mem Element">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2151-global-memory-configurations" class="md-nav__link">
    2.1.5.1 Global Memory Configurations
  </a>
  
    <nav class="md-nav" aria-label="2.1.5.1 Global Memory Configurations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21511-contiguous-global-memory" class="md-nav__link">
    2.1.5.1.1 Contiguous Global Memory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#21512-heterogeneous-memory" class="md-nav__link">
    2.1.5.1.2 Heterogeneous Memory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#216-host-element" class="md-nav__link">
    2.1.6 host Element
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#217-interfaces-element" class="md-nav__link">
    2.1.7 interfaces Element
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#218-channels-element" class="md-nav__link">
    2.1.8 channels Element
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-board_envxml-file" class="md-nav__link">
    2.2 board_env.xml File
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#30-oneapi-asp-hardware" class="md-nav__link">
    3.0 oneAPI ASP Hardware
  </a>
  
    <nav class="md-nav" aria-label="3.0 oneAPI ASP Hardware">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-host-to-external-memory-interfaceemif" class="md-nav__link">
    3.1 Host to External Memory Interface(EMIF)
  </a>
  
    <nav class="md-nav" aria-label="3.1 Host to External Memory Interface(EMIF)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#311-memory-bank-divider" class="md-nav__link">
    3.1.1 Memory Bank Divider
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-host-to-kernel-interface" class="md-nav__link">
    3.2 Host to Kernel Interface
  </a>
  
    <nav class="md-nav" aria-label="3.2 Host to Kernel Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-kernel-interface" class="md-nav__link">
    3.2.1 Kernel Interface
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-kernel-to-external-memory-interface" class="md-nav__link">
    3.3 Kernel to External Memory Interface
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#40-oneapi-asp-software" class="md-nav__link">
    4.0 oneAPI ASP Software
  </a>
  
    <nav class="md-nav" aria-label="4.0 oneAPI ASP Software">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-memory-mapped-devicemmd-layer" class="md-nav__link">
    4.1 Memory Mapped Device(MMD) Layer
  </a>
  
    <nav class="md-nav" aria-label="4.1 Memory Mapped Device(MMD) Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#411-aocl_mmd_get_offline_info" class="md-nav__link">
    4.1.1 aocl_mmd_get_offline_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#412-aocl_mmd_get_info" class="md-nav__link">
    4.1.2 aocl_mmd_get_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#413-aocl_mmd_open" class="md-nav__link">
    4.1.3 aocl_mmd_open
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#414-aocl_mmd_close" class="md-nav__link">
    4.1.4 aocl_mmd_close
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#415-aocl_mmd_set_interrupt_handler" class="md-nav__link">
    4.1.5 aocl_mmd_set_interrupt_handler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#416-aocl_mmd_set_device_interrupt_handler" class="md-nav__link">
    4.1.6 aocl_mmd_set_device_interrupt_handler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#417-aocl_mmd_set_status_handler" class="md-nav__link">
    4.1.7 aocl_mmd_set_status_handler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#418-aocl_mmd_yield" class="md-nav__link">
    4.1.8 aocl_mmd_yield
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#419-aocl_mmd_read" class="md-nav__link">
    4.1.9 aocl_mmd_read
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4110-aocl_mmd_write" class="md-nav__link">
    4.1.10 aocl_mmd_write
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4111-aocl_mmd_copy" class="md-nav__link">
    4.1.11 aocl_mmd_copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4112-aocl_mmd_hostchannel_create" class="md-nav__link">
    4.1.12 aocl_mmd_hostchannel_create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4113-aocl_mmd_hostchannel_destroy" class="md-nav__link">
    4.1.13 aocl_mmd_hostchannel_destroy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4114-aocl_mmd_hostchannel_get_buffer" class="md-nav__link">
    4.1.14 aocl_mmd_hostchannel_get_buffer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4115-aocl_mmd_hostchannel_ack_buffer" class="md-nav__link">
    4.1.15 aocl_mmd_hostchannel_ack_buffer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4116-aocl_mmd_program" class="md-nav__link">
    4.1.16 aocl_mmd_program
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4117-aocl_mmd_host_alloc" class="md-nav__link">
    4.1.17 aocl_mmd_host_alloc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4118-aocl_mmd_free" class="md-nav__link">
    4.1.18 aocl_mmd_free
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4119-aocl_mmd_device_alloc" class="md-nav__link">
    4.1.19 aocl_mmd_device_alloc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4120-aocl_mmd_shared_alloc" class="md-nav__link">
    4.1.20 aocl_mmd_shared_alloc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4121-aocl_mmd_shared_migrate" class="md-nav__link">
    4.1.21 aocl_mmd_shared_migrate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-board-utilities" class="md-nav__link">
    4.2 Board Utilities
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#50-oneapi-asp-implementation-details" class="md-nav__link">
    5.0 oneapi-asp Implementation Details
  </a>
  
    <nav class="md-nav" aria-label="5.0 oneapi-asp Implementation Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-oneapi-asp-directory-structure" class="md-nav__link">
    5.1 oneapi-asp Directory Structure
  </a>
  
    <nav class="md-nav" aria-label="5.1 oneapi-asp Directory Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#511-hardware-folder" class="md-nav__link">
    5.1.1 hardware Folder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#512-commonsource-folder" class="md-nav__link">
    5.1.2 common/source Folder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#513-linux64-folder" class="md-nav__link">
    5.1.3 linux64 Folder
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-oneapi-asp-build-flow" class="md-nav__link">
    5.2 oneapi-asp Build Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-oneapi-asp-hardware-implementation" class="md-nav__link">
    5.3 oneapi-asp Hardware Implementation
  </a>
  
    <nav class="md-nav" aria-label="5.3 oneapi-asp Hardware Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#531-platform-interface-managerpim" class="md-nav__link">
    5.3.1 Platform Interface Manager(PIM)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#532-direct-memory-accessdma-module" class="md-nav__link">
    5.3.2 Direct Memory Access(DMA) Module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#533-board_hwtcl-file" class="md-nav__link">
    5.3.3 board_hw.tcl File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#534-user-datagram-protocoludp-engine" class="md-nav__link">
    5.3.4 User Datagram Protocol(UDP) Engine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#535-hardware-compile-flow" class="md-nav__link">
    5.3.5 Hardware Compile Flow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-oneapi-asp-memory-mapped-devicemmd-layer-implementation" class="md-nav__link">
    5.4 oneapi-asp Memory Mapped Device(MMD) Layer Implementation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55-oneapi-asp-utilities-implementation" class="md-nav__link">
    5.5 oneapi-asp Utilities Implementation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    Appendix
  </a>
  
    <nav class="md-nav" aria-label="Appendix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#appendix-a-memory-mapped-devicemmd-layer-debug-variables" class="md-nav__link">
    Appendix A: Memory Mapped Device(MMD) Layer Debug Variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#document-revision-history" class="md-nav__link">
    Document Revision History
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notices-disclaimers" class="md-nav__link">
    Notices &amp; Disclaimers
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="oneapi-accelerator-support-packageasp-reference-manual-open-fpga-stack">oneAPI Accelerator Support Package(ASP) Reference Manual: Open FPGA Stack<a class="headerlink" href="#oneapi-accelerator-support-packageasp-reference-manual-open-fpga-stack" title="Permanent link">&para;</a></h1>
<h2 id="10-overview"><strong>1.0 Overview</strong><a class="headerlink" href="#10-overview" title="Permanent link">&para;</a></h2>
<div id="overview"></div>

<h3 id="11-about-this-document"><strong>1.1 About this Document</strong><a class="headerlink" href="#11-about-this-document" title="Permanent link">&para;</a></h3>
<div id="about_doc"></div>

<p>This document serves as a reference manual for platform designers wanting to enable <a href="https://www.intel.com/content/www/us/en/developer/tools/oneapi/base-toolkit.html#gs.jxodgk">oneAPI</a> support on their Open FPGA Stack(<abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>) platforms. The document describes essential hardware and software components required for enabling this design flow using <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>. Implementation details for <a href="https://github.com/OFS/oneapi-asp"><code>oneapi-asp</code></a> for Open FPGA Stack(<abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>) reference platforms is covered towards the end of the document.</p>
<blockquote>
<p><strong>Note:</strong> Table 1-1 in <a href="https://ofs.github.io/ofs-2024.1-1/hw/common/user_guides/oneapi_asp/ug_oneapi_asp/">oneAPI Accelerator Support Package (ASP): Getting Started User Guide</a> lists <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms.</p>
</blockquote>
<p>For more information about developing application kernels for FPGA using oneAPI Base Toolkit (Base Kit) refer to <a href="https://www.intel.com/content/www/us/en/developer/tools/oneapi/fpga.html#gs.jxoidi">Intel® FPGA Add-on for oneAPI Base Toolkit</a> webpage.</p>
<h3 id="12-terminology"><strong>1.2 Terminology</strong><a class="headerlink" href="#12-terminology" title="Permanent link">&para;</a></h3>
<div id="terminology"></div>

<p>This table defines some of the common terms used when discussing <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>. </p>
<p><strong>Table 1-1: Terminology</strong></p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Abbreviation</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Open FPGA Stack</td>
<td><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr></td>
<td>A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> and software developers to optimize and reuse their designs.</td>
</tr>
<tr>
<td>Accelerator Functional Unit</td>
<td><abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr></td>
<td>Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. <em>Note: An <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> region is the part of the design where an <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> may reside.  This <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> may or may not be a partial reconfiguration region.</em></td>
</tr>
<tr>
<td>FPGA Interface Manager</td>
<td><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></td>
<td>Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs.  The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> resides in the static region of the FPGA and contains the FPGA Management Engine (<abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr>) and I/O ring.</td>
</tr>
<tr>
<td>High Level Design</td>
<td>HLD</td>
<td>For the purpose of this guide, this term refers to designing with High Level Design tools like oneAPI Base Toolkit (Base Kit).</td>
</tr>
<tr>
<td>oneAPI Accelerator Support Package</td>
<td>oneAPI ASP</td>
<td>A collection of hardware and software components that enable oneAPI kernel to communicate with oneAPI runtime and other <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> hardware, software components. oneAPI ASP hardware components and oneAPI kernel form the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> region of a oneAPI system in <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>.</td>
</tr>
<tr>
<td>Intel® FPGA Basic Building Blocks</td>
<td><abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr></td>
<td>Basic Building Blocks (<abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr>) for Altera® FPGAs is a suite of application building blocks and shims like Memory Properties Factory (MPF).</td>
</tr>
<tr>
<td><abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr> Memory Properties Factory</td>
<td><abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr> MPF</td>
<td>Intel® FPGA <abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr> MPF block provides features like virtual to physical address (VTP), ordering read responses, read/write hazard detection, and masked (partial) writes. <code>oneapi-asp</code> uses MPF VTP feature.</td>
</tr>
<tr>
<td>Open Programmable Acceleration Engine Software Development Kit</td>
<td><abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr></td>
<td>A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.</td>
</tr>
<tr>
<td>Platform Interface Manager</td>
<td><abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr></td>
<td>An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> developers can use to handle clock crossing, response sorting, buffering and different protocols.</td>
</tr>
<tr>
<td>Device Feature List</td>
<td><abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr></td>
<td>A concept inherited from <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>. The <abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr> drivers provide support for FPGA devices that are designed to support the Device Feature List. The <abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr>, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the <abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr> driver to automatically load the drivers required for a given FPGA configuration.</td>
</tr>
<tr>
<td>Best Known Configuration</td>
<td><abbr title="Best Known Configuration, The exact hardware configuration Intel has optimized and validated the solution against.">BKC</abbr></td>
<td>The exact hardware configuration that the solution has been optimized and validated against.</td>
</tr>
<tr>
<td>SYCL</td>
<td>-</td>
<td><a href="https://www.khronos.org/sycl/">SYCL</a> (pronounced "sickle") is a royalty-free, cross-platform abstraction layer that enables code for heterogeneous and offload processors to be written using modern ISO C++ (at least C++ 17). It provides several features that make it well-suited for programming heterogeneous systems, allowing the same code to be used for CPUs, GPUs, FPGAs or any other hardware accelerator. SYCL was developed by the Khronos Group, a non-profit organization that develops open standards (including OpenCL™) for graphics, compute, vision, and multimedia. SYCL is being used by a growing number of developers in a variety of industries, including automotive, aerospace, and consumer electronics.</td>
</tr>
<tr>
<td>Data Parallel C++</td>
<td>DPC++</td>
<td><a href="https://www.intel.com/content/www/us/en/developer/tools/oneapi/data-parallel-c-plus-plus.html#gs.5sqn4j">DPC++</a> is Intel’s implementation of the SYCL standard. It supports additional attributes and language extensions which ensure DCP++ (SYCL) is efficiently implanted on Intel hardware.</td>
</tr>
<tr>
<td>Installable Client Driver</td>
<td>ICD</td>
<td><a href="https://github.com/intel/fpga-runtime-for-opencl">Intel® FPGA Runtime for OpenCL™ Software Technology</a> supports the OpenCL ICD extension from the Khronos Group™. The OpenCL ICD extension allows you to have multiple OpenCL implementations on your system. With the OpenCL ICD Loader Library, you may choose from a list of installed platforms and execute OpenCL API calls that are specific to your OpenCL implementation of choice.</td>
</tr>
<tr>
<td>FPGA Client Driver</td>
<td>FCD</td>
<td><a href="https://github.com/intel/fpga-runtime-for-opencl">Intel® FPGA Runtime for OpenCL™ Software Technology</a> supports FPGA Client Driver(FCD) extension. FCD allows the runtime to automatically find and load the oneAPI ASP libraries at host run time</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note:</strong> <code>oneapi-asp</code> was referred to as <code>ofs-hld-shim</code> in <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> (for Agilex® 7 FPGA &amp; Stratix 10® FPGA) and OpenCL <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Shim (<code>ofs-opencl-afu-shim</code>) in <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> early access(EA) release (for Stratix 10® FPGA with Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005 as reference platform).</p>
</blockquote>
<h3 id="13-prerequisites"><strong>1.3 Prerequisites</strong><a class="headerlink" href="#13-prerequisites" title="Permanent link">&para;</a></h3>
<div id="prereq"></div>

<p>The content in this manual requires readers to be familiar with:</p>
<ul>
<li><a href="https://github.com/OFS">Hardware and software components of Open FPGA Stack</a>, especially the following:<ul>
<li>FPGA Interface Manager(<abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>)<ul>
<li>Stratix 10® FPGA:<ul>
<li><a href="https://ofs.github.io/ofs-2024.1-1/hw/d5005/reference_manuals/ofs_fim/mnl_fim_ofs_d5005/">Shell Technical Reference Manual: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Stratix® 10 PCIe Attach FPGAs</a></li>
<li><a href="https://ofs.github.io/ofs-2024.1-1/hw/d5005/dev_guides/fim_dev/ug_dev_fim_ofs_d5005/">Shell Developer Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Stratix® 10 PCIe Attach FPGAs</a></li>
</ul>
</li>
<li>Agilex® 7 FPGA:<ul>
<li><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/reference_manuals/ofs_fim/mnl_fim_ofs_n6001/">Shell Technical Reference Manual: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach FPGAs</a></li>
<li><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/">Shell Developer Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach (P-tile, E-tile) FPGAs</a></li>
<li><a href="https://ofs.github.io/ofs-2024.1-1/hw/ftile_devkit/dev_guides/fim_dev/ug_ofs_ftile_dk_fim_dev/">Shell Developer Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach (2xF-tile) FPGAs</a></li>
<li><a href="https://ofs.github.io/ofs-2024.1-1/hw/iseries_devkit/dev_guides/fim_dev/ug_ofs_iseries_dk_fim_dev/">Shell Developer Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach (2xR-tile, F-tile) FPGAs</a></li>
</ul>
</li>
</ul>
</li>
<li>Accelerator Functional Unit(<abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>)<ul>
<li>Stratix 10® FPGA: <a href="https://ofs.github.io/ofs-2024.1-1/hw/d5005/dev_guides/afu_dev/ug_dev_afu_d5005/">Workload Developer Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Stratix® 10 PCIe Attach FPGAs</a></li>
<li>Agilex® 7 FPGA: <a href="https://ofs.github.io/ofs-2024.1-1/hw/common/user_guides/afu_dev/ug_dev_afu_ofs_agx7_pcie_attach/ug_dev_afu_ofs_agx7_pcie_attach/">Workload Developer Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach FPGAs</a></li>
</ul>
</li>
<li><a href="https://ofs.github.io/ofs-2024.1-1/hw/common/reference_manual/ofs_sw/mnl_sw_ofs/">Software Reference Manual: Open FPGA Stack</a> (<abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> and Linux-<abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr> section)</li>
<li><a href="https://github.com/OFS/ofs-platform-afu-bbb">ofs-platform-afu-bbb</a></li>
</ul>
</li>
</ul>
<p>In addition to above, developers must be familiar with the following tools &amp; concepts:</p>
<ul>
<li><a href="https://www.intel.com/content/www/us/en/support/programmable/support-resources/design-software/user-guides.html">Quartus® Prime Design Software</a> (Quartus® software revisions, Platform Designer, compilation Flows, timing analysis, compilation reports, understanding FPGA resource utilization, programming Altera® FPGAs) </li>
<li><a href="https://www.intel.com/content/www/us/en/software/programmable/quartus-prime/partial-reconfiguration.html">Partial Reconfiguration (<abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr>)</a></li>
<li>FPGA Peripheral IPs (PCIe, External Memory IP, Ethernet IP) </li>
<li><a href="https://www.intel.com/content/www/us/en/docs/programmable/683091/current/introduction-to-the-interface-specifications.html">Avalon® Interface</a></li>
<li>Scripting (TCL, Python, Shell scripts) </li>
<li>Verilog, SystemVerilog </li>
<li>C++ </li>
<li><a href="https://www.intel.com/content/www/us/en/docs/oneapi/programming-guide/current/data-parallelism-in-c-using-sycl.html">Familiarity with SYCL</a> </li>
<li>Familiarity with <a href="https://www.intel.com/content/www/us/en/docs/oneapi/programming-guide/current/fpga-flow.html">oneAPI compilation process for FPGAs</a> &amp; <a href="https://github.com/oneapi-src/oneAPI-samples">oneAPI code samples</a> </li>
<li>Familiarity with <a href="https://ofs.github.io/ofs-2024.1-1/hw/common/user_guides/oneapi_asp/ug_oneapi_asp/">oneAPI Accelerator Support Package (ASP): Getting Started User Guide</a></li>
</ul>
<h3 id="14-introduction-to-oneapi-on-open-fpga-stackofs"><strong>1.4 Introduction to oneAPI on Open FPGA Stack(<abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>)</strong><a class="headerlink" href="#14-introduction-to-oneapi-on-open-fpga-stackofs" title="Permanent link">&para;</a></h3>
<div id="intro_oneapi_ofs"></div>

<p>The <a href="https://www.intel.com/content/www/us/en/developer/tools/oneapi/toolkits.html">Intel® oneAPI Base Toolkit (Base Kit)</a> is a core set of tools and libraries for developing high-performance, data-centric applications across diverse architectures (CPUs, GPUs and FPGAs). It features an industry-leading C++ compiler that implements SYCL, an evolution of C++ for heterogeneous computing.</p>
<p>Figure 1-1 shows the high-level representation of oneAPI application developers using FPGAs for acceleration. The runtime flow consists of a host code running on a processor and an application kernel code running on an FPGA. Open FPGA Stack enables vendors to enable support for this flow on their platforms.</p>
<p><strong>Figure 1-1: oneAPI Application on <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Platforms</strong></p>
<p><a class="glightbox" href="../images/oneAPI_on_OFS_Platform.PNG" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image_oneAPI_on_OFS_Platform" src="../images/oneAPI_on_OFS_Platform.PNG" /></a></p>
<p>oneAPI Base Toolkit (Base Kit) consists of a compiler and runtime environment. The compiler converts a SYCL kernel (FPGA application code) into a hardware circuit. This hardware circuit requires additional logic to communicate with the runtime and FPGA board peripherals. This additional logic is provided by <em>oneAPI Accelerator Support Package(oneAPI ASP)</em>. oneAPI ASP consists of hardware components that enable this generated hardware circuit to communicate with the host processor as well as software components that enable the runtime to identify and communicate with the kernel.</p>
<p>Figure 1-2 shows the workload design steps and steps in which the oneAPI Base Toolkit (Base Kit) requires oneAPI ASP as input. For more information about workload development and how workload developers target a specific platform during compilation, refer to <a href="https://www.intel.com/content/www/us/en/docs/oneapi/programming-guide/current/fpga-flow.html">Intel oneAPI Programming Guide</a> and <a href="https://www.intel.com/content/www/us/en/docs/oneapi-fpga-add-on/developer-guide/current.html">Intel® oneAPI DPC++/C++ Compiler Handbook for Intel® FPGAs</a>. The next section introduces oneAPI ASP.</p>
<p><strong>Figure 1-2: High Level Design Flow for FPGAs with oneAPI Base Toolkit (Base Kit)</strong></p>
<p><a class="glightbox" href="../images/HLD_Design_Flow.PNG" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image_HLD_Design_Flow" src="../images/HLD_Design_Flow.PNG" /></a></p>
<h3 id="15-introduction-to-oneapi-accelerator-support-packageasp"><strong>1.5 Introduction to oneAPI Accelerator Support Package(ASP)</strong><a class="headerlink" href="#15-introduction-to-oneapi-accelerator-support-packageasp" title="Permanent link">&para;</a></h3>
<div id="intro_oneapi_asp"></div>

<p>As mentioned in previous section, oneAPI ASP is a collection of hardware and software components that interface with the hardware circuit generated by the oneAPI compiler. The hardware circuit generated by the oneAPI compiler from a oneAPI kernel is referred to as the <code>kernel system</code>. While the <code>kernel system</code> consists of logic controlled by the workload developer's specifications, the <code>kernel system</code> <em>interfaces</em> are generated by the oneAPI compiler based on specifications provided by the oneAPI ASP designer. These specifications are input to the compiler using <em>XML files</em> (discussed in section 2.0).</p>
<blockquote>
<p><strong>Note:</strong> All the interfaces generated by the oneAPI compiler are <a href="https://www.intel.com/content/www/us/en/docs/programmable/683091/current/introduction-to-the-interface-specifications.html">Avalon® Interfaces</a>.</p>
</blockquote>
<p><strong>Figure 1-3: Kernel System Interfaces</strong></p>
<p><a class="glightbox" href="../images/HW_Design_Overview.PNG" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image_Hardware_Design_Overvew" src="../images/HW_Design_Overview.PNG" /></a></p>
<p>Figure 1-3 shows a high-level representation of an <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> hardware design and interfaces to/from <code>kernel_system</code>. The numbered arrows depict the following:</p>
<ul>
<li>Path 1 represents host-to-External Memory Interface (EMIF)</li>
<li>Path 2 represents the host to kernel interface</li>
<li>Path 3 represents kernel to EMIF</li>
<li>Path 4 represents kernel to Unified Shared Memory (USM) Interface</li>
<li>Path 5 represents kernel to HSSI interface</li>
</ul>
<p>oneAPI ASP hardware components can be divided into 3 categories:</p>
<ol>
<li>RTL components: constituting various interface logic, for example, host to External Memory Interface (EMIF), kernel to EMIF interface, host to kernel interface, kernel to host memory interface as well as additional components to handle kernel control signals and perform Direct Memory Access (DMA)</li>
<li>XML files: for describing hardware interfaces and compilation environment to oneAPI Base Toolkit (Base Kit)</li>
<li>Scripts: to control compile flow</li>
</ol>
<p>In addition to the hardware components, a software layer is required for handling I/O operations between oneAPI runtime and the board. The oneAPI ASP software layer can be divided into 2 categories:</p>
<ol>
<li>Memory Mapped Device (MMD) Layer: required by the host &amp; runtime to communicate with the oneAPI kernel &amp; other oneAPI ASP hardware registers</li>
<li>oneAPI ASP utilities: required to setup and diagnose the board</li>
</ol>
<p>The MMD uses API provided by <a href="https://github.com/OFS/opae-sdk"><abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr></a> to communicate with the device. The FPGA driver is provided by the <a href="https://github.com/OFS/linux-dfl">linux-<abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr></a> kernel driver.</p>
<p>Figure 1-4 shows how the above oneAPI ASP components tie into Open FPGA Stack.</p>
<p><strong>Figure 1-4: Open FPGA Stack (<abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>) components</strong></p>
<p><a class="glightbox" href="../images/Open_FPGA_Stack.PNG" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image_Open_FPGA_Stack" src="../images/Open_FPGA_Stack.PNG" /></a></p>
<h2 id="20-xml-files-in-oneapi-asp"><strong>2.0 XML Files in oneAPI ASP</strong><a class="headerlink" href="#20-xml-files-in-oneapi-asp" title="Permanent link">&para;</a></h2>
<div id="xml_files"></div>

<p>The <code>kernel system</code> <em>interfaces</em> generated by the oneAPI compiler are based on specifications provided by oneAPI ASP developer. An XML file, called <code>board_spec.xml</code> is used to pass the specifications to the oneAPI compiler. oneAPI ASP developers must create this XML file for their boards.</p>
<p>In addition to <code>board_spec.xml</code>, the oneAPI Base Toolkit (Base Kit) relies on another XML file called <code>board_env.xml</code> to get information about the board environment. The <code>board_env.xml</code> file helps the runtime setup board installation.</p>
<p>The next section explains the contents of board_spec.xml. Section 2.2 covers contents of <code>board_env.xml</code> file.</p>
<h3 id="21-board_specxml-file"><strong>2.1 <code>board_spec.xml</code> File</strong><a class="headerlink" href="#21-board_specxml-file" title="Permanent link">&para;</a></h3>
<div id="board_spec"></div>

<p>A typical board_spec.xml structure is shown in Fig 2-1. In addition to kernel system interfaces, the <code>board_spec.xml</code> file is also used to specify other compilation details like Quartus® Prime Pro Edition Software version used in platform design, compilation scripts to help control Quartus® software compile flows, FPGA resource utilization details.</p>
<p>Elements of board_spec.xml file are summarized in table 2-1. Each element has additional attributes and parameters. Details are covered in respective sections for each element.</p>
<p><strong>Figure 2-1: <code>board_spec.xml</code> File Structure</strong></p>
<p><a class="glightbox" href="../images/board_spec.xml.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Board_sepc.xml File Structure" src="../images/board_spec.xml.png" /></a></p>
<p><strong>Table 2-1: Elements of board_spec.xml</strong></p>
<table>
<thead>
<tr>
<th>Element</th>
<th>Use of Element</th>
<th>Attributes</th>
</tr>
</thead>
<tbody>
<tr>
<td>board</td>
<td>Used to specify a name for the board and the version of Quartus® Prime Pro Edition Software used to develop the platform design. This board name is used to identify the board design to be compiled and must match the name of the directory in which board_spec.xml resides.</td>
<td>version, name</td>
</tr>
<tr>
<td>compile</td>
<td>Used to describe different compile flows</td>
<td>project, revision, qsys_file, generic_kernel, generate_cmd, synthesize_cmd, auto_migrate</td>
</tr>
<tr>
<td>device</td>
<td>Used to specify the FPGA device model file for the FPGA part on the board.</td>
<td>device_model, used_resources</td>
</tr>
<tr>
<td>global_mem</td>
<td>Different attributes in this element are used to provide details about the external memory used as the global memory for the FPGA oneAPI kernel/application.</td>
<td>name, max_bandwidth, interleaved_bytes, config_addr, default, interface</td>
</tr>
<tr>
<td>host</td>
<td>Used to specify the offset at which the kernel resides.</td>
<td>kernel_config</td>
</tr>
<tr>
<td>interfaces</td>
<td>Used to specify control signals to oneAPI kernels</td>
<td>interface, kernel_clk_reset</td>
</tr>
<tr>
<td>channels</td>
<td>Used to describe interface to stream data directly between kernels and I/O</td>
<td>interface</td>
</tr>
</tbody>
</table>
<p>The compiler expects a separate <code>board_spec.xml</code> file for every board variant a platform supports. Board variants are different hardware design implementations for the same platform, a oneAPI ASP can have multiple board variants. A oneAPI kernel developer can select the board variant suitable for their application at compile time.</p>
<p>A <code>board_spec.xml</code> file must be located at the top most level of each board variant's hardware directory (the hardware directory is specified by <code>board_env.xml</code>, please refer to section 2.2 for details on <code>hardware</code> element). For example, a separate <code>board_spec.xml</code> file for each board variant for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms is located in <code>oneapi-asp/Platform-Name/hardware/Board-Variant/</code> directory, where <code>Platform-Name</code> is <code>n6001</code>, <code>fseries-dk</code>, <code>iseries-dk</code> for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> targeting Agilex® 7 FPGA and <code>d5005</code> for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> targeting Stratix 10® FPGA.</p>
<h4 id="211-board-element"><strong>2.1.1 board Element</strong><a class="headerlink" href="#211-board-element" title="Permanent link">&para;</a></h4>
<div id="board_element"></div>

<p>The board element of the board_spec.xml file provides the Quartus® Prime Pro Edition Software version and the name of the board.</p>
<p><strong>Table 2-2: Attributes for the <code>board</code> Element</strong></p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>version</td>
<td>The version of the board. The board version should match the version of the Quartus® Prime Pro Edition Software you use to develop the platform design. The oneAPI compiler uses this value to perform environment checks for supported version during application compile</td>
</tr>
<tr>
<td>name</td>
<td>The name of the accelerator board, which must match the name of the directory in which the board_spec.xml file resides. The name must contain a combination of only letters, numbers, underscores (_), hyphens (-), or periods (.) (for example, ofs_n6000).</td>
</tr>
</tbody>
</table>
<p>Example below shows the <code>board</code> element populated for a board designed with Quartus® Prime Pro Edition Software version 22.3 and board variant named "Agilex_brd1".</p>
<blockquote>
<p><strong>Note:</strong> A board variant name is different from a platform directory name. Please see Note in section 2.2 for more information on board variants.</p>
</blockquote>
<p><strong>Figure 2-2: <code>board</code> Element</strong></p>
<p><a class="glightbox" href="../images/board_element.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Board Element Example" src="../images/board_element.png" /></a></p>
<h4 id="212-compile-element"><strong>2.1.2 compile Element</strong><a class="headerlink" href="#212-compile-element" title="Permanent link">&para;</a></h4>
<div id="compile_element"></div>

<p>Depending on the application requirements, the design may have different compilation flows and different design settings for each flow (for example, there can be a flat flow without partial reconfiguration support or a flow with partitions in the design to enable partial reconfiguration). Designers can control the flow and its settings using scripts.
To allow selection of compile flow during application compile &amp; to describe control of Quartus® software compilation as well as registration, automigration, the <code>compile</code> element of the board_spec.xml file and its associated attributes and parameters are used.</p>
<p><strong>Table 2-3: Attributes for <code>compile</code> Element</strong></p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>Name of the compilation flow. This name can be used to differentiate between flows at oneAPI kernel compilation time. oneAPI compiler allows selecting a compile flow using <code>-Xsbsp-flow</code> option.</td>
</tr>
<tr>
<td>project</td>
<td>Name of the Quartus® software project file (.qpf) that the Quartus® Prime Pro Edition Software intends to compile.</td>
</tr>
<tr>
<td>revision</td>
<td>Name of the revision within the Quartus® software project that the Quartus® Prime Pro Edition Software compiles to generate the final bitstream.</td>
</tr>
<tr>
<td>qsys_file</td>
<td>Name of the Platform Designer file into which the oneAPI kernel is embedded. You have the option to assign a value of "none" to qsys_file if you do not require the Quartus® Prime Pro Edition Software to create a top-level .qsys file for your design. In this scenario, oneAPI compiler adds a .qip file into the Quartus® software project. In this case, the custom oneAPI ASP must manually instantiate the generated HDL entity (generated entity is in the kernel_system.v file).</td>
</tr>
<tr>
<td>generic_kernel</td>
<td>Set this value to 1 if you want the offline compiler to generate a common Verilog interface for all compilations. This setting is necessary in situations where you must set up design partitions around the kernel, such as in the Configuration via Protocol (CvP) flow.</td>
</tr>
<tr>
<td>generate_cmd</td>
<td>Command required to prepare for full compilation, such as to generate the Verilog files for the Platform Designer system into which the oneAPI kernel is embedded.</td>
</tr>
<tr>
<td>synthesize_cmd</td>
<td>Command required to generate the fpga.bin file from the Custom Platform. Usually, this command instructs the Quartus® Prime Pro Edition Software to perform a full compilation.</td>
</tr>
<tr>
<td>auto_migrate</td>
<td>*platform_type—Choose this value based on the value referenced in the Reference Platform from which you derive your Custom Platform. Valid values are a10_ref, s10_ref, and none. <br> *include fixes—Comma-separated list of named fixes that you want to apply to the Custom Platform. <br> *exclude fixes—Comma-separated list of named fixes that you do not want to apply to the Custom Platform.</td>
</tr>
</tbody>
</table>
<p>Example below shows a populated <code>compile</code> element for a sample Quartus® software Project called ofs.qpf, the Quartus® software revision to be compiled is called asp (asp.qsf). In this example, the compiler generates the kernel system (entity is called kernel_system) and this entity is instantiated manually in the Quartus® software project (e.g. in a file called kernel_wrapper.v), hence <code>qsys_file</code> is set to "none". The <code>synthesize_cmd</code> points to a script "compile.tcl" located in the same directory as the board_spec.xml, compile script performs all necessary system generation and compile steps for generation of final bitstream. The project directory snippet below is for demonstration only. The compile flow is named "demo_flow".</p>
<p>There can be multiple <code>compile</code> elements for the different compilation flows that a platform designer wishes to enable in their platform (e.g. different revisions with different Quartus® software settings or a <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> revision).</p>
<p><strong>Figure 2-3: <code>compile</code> Element</strong></p>
<p><a class="glightbox" href="../images/compile_element.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Compile Element Example" src="../images/compile_element.png" /></a></p>
<h4 id="213-device-element"><strong>2.1.3 device Element</strong><a class="headerlink" href="#213-device-element" title="Permanent link">&para;</a></h4>
<div id="device_element"></div>

<p>A device model(DM) file is an XML file that has the total resources on the device (i.e. ALMs, FFs, DSPs, RAMs). This is required for any FPGA part used in a oneAPI design. Most device model files are provided as part of the oneAPI Base Toolkit (Base Kit) installation (<code>$INTELFPGAOCLSDKROOT/share/models/dm</code>, where INTELFPGAOCLSDKROOT is set by the <code>setvars.sh</code> environment setup script provided by <a href="https://www.intel.com/content/www/us/en/docs/oneapi/installation-guide-linux/current/prerequisites.html">oneAPI toolkit</a>). If the device model file for your part number is not included in <code>$INTELFPGAOCLSDKROOT/share/models/dm</code>, it must be created and placed in the same folder as <code>board_spec.xml</code>. A new device model file can be created using existing files as reference. </p>
<p>The device model file name must be specified in the <code>device_model</code> attribute of <code>device</code> element. The <code>used_resources</code> attribute is used to specify the resources being utilized by the oneAPI ASP and peripheral IPs. The utilization by non-kernel logic is calculated during platform design. The compiler utilizes the total resources from device model file and utilized resources in <code>used_resources</code> section to estimate the available resources for application kernel.</p>
<p><strong>Table 2-4: Attributes for <code>device</code> Element</strong></p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>device_model</td>
<td>The file name of the device model file that describes the available FPGA resources on the accelerator board.</td>
</tr>
<tr>
<td>used_resources</td>
<td>Reports the number of adaptive logic modules (ALMs), flip-flops, digital signal processor (DSP) blocks and RAM blocks that the board design consumes in the absence of any kernel. If you create a defined partition around all the board logic, you can obtain the used resources data from the Partition Statistics section of the Fitter report. Extract the information from the following parameters: <br>* alms num — The number of logic ALMs used, excluding the number of ALMs with only their registers used. The value should correspond to [a]+[b]+[d] from part [A] of the Fitter Partition Statistics. <br>* ffs num — The number of flip flops. <br>* dsps num — The number of DSP blocks. <br>* rams num — The number of RAM blocks.</td>
</tr>
</tbody>
</table>
<p>Example below shows the <code>device</code> element added for a Agilex® 7 FPGA based platform with device model file named "agfb014r24a2e2vr0_dm.xml". The number of used_resources are for demonstration purposes and are not to be used by oneAPI ASP developers.</p>
<p><strong>Figure 2-4: <code>device</code> Element</strong></p>
<p><a class="glightbox" href="../images/device_element.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Device Element Example" src="../images/device_element.png" /></a></p>
<h4 id="214-interface-attribute"><strong>2.1.4 interface Attribute</strong><a class="headerlink" href="#214-interface-attribute" title="Permanent link">&para;</a></h4>
<div id="interface_attr"></div>

<blockquote>
<p><strong>Note:</strong> This is different from the <code>interfaces</code> element discussed in upcoming sections.
In the board_spec.xml file, each global memory, channel or kernel connection is comprised of individual interfaces. For the <code>global_mem</code>, <code>channels</code>, and <code>interfaces</code> XML elements, an <code>interface</code> attribute must be included to specify the corresponding parameters for each connection.</p>
</blockquote>
<p><strong>Table 2-5: Parameters for <code>interface</code> attribute</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Applicable Interface</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>* For global_mem: instance name of the Platform Designer component.<br>* For channels: instance name of the Platform Designer component that has the channel interface.<br>* For interfaces: name of the entity in which the kernel interface resides (for example, board).</td>
<td>All</td>
</tr>
<tr>
<td>port</td>
<td>port parameter can be defined either inline in <code>interface</code> attribute or as a separate element in <code>interface</code> attribute. See section 2.1.4.1 for more information.</td>
<td>All</td>
</tr>
<tr>
<td>type</td>
<td>* For global_mem: set to agent. <br>* For channels: <br>- Set to streamsource for a stream source that provides data to the kernel.<br>- Set to streamsink for a stream sink interface that consumes data from the kernel.<br>* For interfaces: set to either host, irq, or streamsource.</td>
<td>All</td>
</tr>
<tr>
<td>width</td>
<td>* For global_mem: width of the memory interface in bits.<br>* For channels: number of bits in the channel interface.<br>* For interfaces: width of the kernel interface in bits.</td>
<td>All</td>
</tr>
<tr>
<td>waitrequest_allowance</td>
<td>* For global_mem: [Optional] Amount of Avalon®-MM waitrequest allowance supported on the agent interface (that is, kernel-facing interface) of the clock-crossing bridge that spans between the memory and the kernel clock domains.<br>* For kernel_cra: [Optional] Amount of Avalon®-MM waitrequest allowance that the kernel_cra agent interface must support.<br>This parameter defaults to 0 if you do not specify it in the board_spec.xml file. A value of 0 indicates that this waitrequest allowance feature is disabled.</td>
<td>All</td>
</tr>
<tr>
<td>maxburst</td>
<td>Maximum burst size for the agent interface.<br>Attention: The value of width ÷ 8 x maxburst must be less than the value of interleaved_bytes.</td>
<td>global_mem</td>
</tr>
<tr>
<td>address</td>
<td>Starting address of the memory interface that corresponds to the host interface-side address.<br>For example, address 0 should correspond to the bank1 memory host from the <code>Memory Bank Divider</code>. In addition, any non-zero starting address must abut the end address of the previous memory.</td>
<td>global_mem</td>
</tr>
<tr>
<td>size</td>
<td>Size of the memory interface in bytes.<br>* For global_mem: The sizes of all memory interfaces should be equal.<br>* For interfaces: interface can have variable sizes.</td>
<td>global_mem<br>interfaces<br> &gt; <strong>Note:</strong> Support for size parameter for interface attribute is available in oneAPI Base Toolkit (Base Kit) version 2024.0 and beyond.</td>
</tr>
<tr>
<td>latency_type</td>
<td>If the memory interface has variable latency, set this parameter to average to signify that the specified latency is considered the average case. If the complete kernel-to-memory path has a guaranteed fixed latency, set this parameter to fixed.</td>
<td>global_mem</td>
</tr>
<tr>
<td>chan_id</td>
<td>A string used to identify the channel interface. The string may have up to 128 characters.</td>
<td>channels</td>
</tr>
<tr>
<td>clock</td>
<td>For the streamsource kernel interface type, the parameter specifies the name of the clock that the snoop stream uses. Usually, this clock is the kernel clock.</td>
<td>interfaces</td>
</tr>
</tbody>
</table>
<p>Example for how the <code>interface</code> attribute is used in <code>global_mem</code> and <code>interfaces</code> elements is covered in section for these elements respectively.</p>
<h5 id="2141-port-parameter"><strong>2.1.4.1 port Parameter</strong><a class="headerlink" href="#2141-port-parameter" title="Permanent link">&para;</a></h5>
<div id=port_parameter></div>

<p>As mentioned in Table 2-5, port parameter can be defined either inline in <code>interface</code> attribute or as a separate element in <code>interface</code> attribute. The definition method to use depends on the direction of the port. </p>
<ul>
<li>If the direction of the port is either <code>read</code> or <code>write</code>, it must be a separate element in <code>interface</code> attribute. </li>
<li>If the direction is <code>readwrite</code>, port must be inline with the port name in <code>interface</code> attribute. No direction specification is required. </li>
</ul>
<p>Table below shows the <code>port</code> element attributes.</p>
<p><strong>Table 2-6: <code>port</code> parameter</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>* For global_mem: name of the Avalon®-MM interface in the Platform Designer component that corresponds to the interface attribute.<br>* For channels: name of the streaming interface in the Platform Designer component.<br>* For interfaces: name of the interface to the <code>Kernel Interface</code> Platform Designer component. For example, kernel_cra is the Avalon®-MM interface, and kernel_irq is an interrupt.</td>
</tr>
<tr>
<td>direction</td>
<td>Direction of the port. Valid values are: <br> * "r" : Indicates read <br> * "w" : Indicates <code>write</code></td>
</tr>
</tbody>
</table>
<p>Snippet below shows the inline and separate element definitions of <code>port</code> parameter.</p>
<blockquote>
<p><strong>Note:</strong> Direction specification for port is available in oneAPI Base Toolkit (Base Kit) versions 2024.0 and beyond. For versions prior to oneAPI Base Toolkit (Base Kit) version 2024.0, only the default inline definition of port parameter is supported. </p>
</blockquote>
<p><a class="glightbox" href="../images/port_element.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Port Element Example" src="../images/port_element.png" /></a></p>
<p>Examples for <code>global_mem</code> and <code>interfaces</code> elements in sections below use the inline definition of port.  </p>
<h4 id="215-global_mem-element"><strong>2.1.5 global_mem Element</strong><a class="headerlink" href="#215-global_mem-element" title="Permanent link">&para;</a></h4>
<div id="global_mem_element"></div>

<p>The <code>global_mem</code> element of the board_spec.xml file is used to provide information on the memory interfaces that connect to the kernel.</p>
<blockquote>
<p><strong>Note:</strong> For each global memory that the kernel accesses, you must include one interface element that describes its characteristics.
The different attributes for global_mem element are discussed in table below.</p>
</blockquote>
<p><strong>Table 2-7: Attributes for <code>global_mem</code> Element</strong></p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>The name FPGA application/kernel developer should use to identify the memory type. Each name must be unique and must comprise of less than 32 characters.</td>
</tr>
<tr>
<td>max_bandwidth</td>
<td>The maximum bandwidth, in megabytes per second (MB/s), of all global memory interfaces combined in their current configuration. The oneAPI compiler uses max_bandwidth to choose an architecture suitable for the application and the board. <br> Compute this bandwidth value from datasheets of memories on your board. <br> Example max_bandwidth calculation for a 64-bit DDR4 interface running at 1200 MHz: <br> max_bandwidth = 1200 MHz x 2 x 64 bits ÷ 8-bits = 19200 MB/s <br> The max_bandwidth value will change based on global memory configuration, for example, if the memory configuration comprises of 4 banks of DDR4 configured as a single homogenous memory, the max_bandwidth will be 19200 x 4 (i.e. number of memory interfaces from kernel). Please see section 2.1.5.1 for more information on global memory configurations. <br> Designers have the option to use block RAM instead of or in conjunction with external memory as global memory. The formula for calculating max_bandwidth for block RAM is max_bandwidth = block RAM speed x (block RAM interface size ÷ 8 bits). <br> Example max_bandwidth calculation for a 512-bit block RAM running at 100 MHz: <br> max_bandwidth = 100 MHz x 512 bits ÷ 8 bits = 6400 MB/s</td>
</tr>
<tr>
<td>interleaved_bytes</td>
<td>Include the interleaved_bytes attribute in the board_spec.xml file when you instantiate multiple interfaces(i.e. memory banks) for a given global memory system. This attribute controls the size of data that the offline compiler distributes across the interfaces. <br> The offline compiler currently can interleave data across banks no finer than the size of one full burst. This attribute specifies this size in bytes and following are the recommended values: <br> For two or fewer global memory banks: maxburst x width_bytes <br> For four or more global memory banks: maxburst x width_bytes x 4 <br> The interleaved_bytes value must be the same for the host interface and the kernels. Therefore, the configuration of the <code>Memory Bank Divider</code> must match the exported kernel agent interfaces in this respect (refer to section 3.1.1 for information about <code>Memory Bank Divider</code>) <br> For block RAM, interleaved_bytes equals the width of the interface in bytes.</td>
</tr>
<tr>
<td>config_addr</td>
<td>The address of the ACL Mem Organization Control Platform Designer component (mem_org_mode) that the host software uses to configure memory. You may omit this attribute if your board has homogeneous memory; the software uses the default address (0x18) for this component. If your board has heterogeneous memory, there is a mem_org_mode component in the board system for each memory type. <br> Enter the config_addr attribute and set it to the value of the base address of the mem_org_mode component(s).</td>
</tr>
<tr>
<td>default</td>
<td>Include this optional attribute and assign a value of 1 to set the global memory as the default memory interface. The default memory must start at address 0x0. <br> If you do not implement this attribute, the first memory type defined in the board_spec.xml file becomes the default memory interface.</td>
</tr>
<tr>
<td>interface</td>
<td>See the <code>interface</code> section above for the parameters you must specify for each interface.</td>
</tr>
<tr>
<td>allocation_type</td>
<td>A list that specifies which USM allocator is used to allocate from the global_mem element. Values allowed in this list are <code>host</code>, <code>shared</code>, and <code>device</code>. The following conditions apply: <br> If there are multiple global_mem elements with the same allocation_type attribute, the first allocation_type attribute in the board_spec.xml is assumed to be the one used by the specified allocator. <br> If there is a single global_mem element with multiple allocation_type attributes, this indicates that allocations of the specified types use this global_mem interface. <br> [Legacy support] If you have not specified the allocation_type attribute, it is assumed that all global memory interfaces have the <code>device</code> allocation_type.</td>
</tr>
</tbody>
</table>
<p>Example below shows a <code>global_mem</code> element configuration for a kernel system connected to four 4GB DDR4 memory banks. The DDR4 interface is 64 bit operating at 1200MHz. Note that the name of the platform designer system name is <code>board.qsys</code>. As mentioned in description for <code>interleaved_bytes</code> in table above, the <code>Memory Bank Divider</code> configuration ensures that the host interface matches the interleaved_bytes setting (i.e. 512 bits x 64 burst size = 4096 bytes). For information on <code>waitrequest_allowance</code>, refer to section 2.1.4 on <code>interface</code> attribute.</p>
<blockquote>
<p><strong>Note:</strong> More details on the <code>Memory Bank Divider</code> and the Clock Crossing Bridges is covered in section 3.0</p>
</blockquote>
<p><strong>Figure 2-6: Memory Connection Example Block Diagram and Corresponding <code>global_mem</code> Element in <code>board_spec.xml</code></strong></p>
<p><a class="glightbox" href="../images/Memory_Connection_Example.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Memory Connection Example" src="../images/Memory_Connection_Example.png" /></a></p>
<p><a class="glightbox" href="../images/global_mem_element.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="global_mem Element" src="../images/global_mem_element.png" /></a></p>
<h5 id="2151-global-memory-configurations"><strong>2.1.5.1 Global Memory Configurations</strong><a class="headerlink" href="#2151-global-memory-configurations" title="Permanent link">&para;</a></h5>
<div id="mem_config"></div>

<p>A board can have a single memory bank, multiple memory banks of the same type (e.g. 4 banks of DDR4) or different banks of different types.</p>
<p>The partitioning of memory for oneAPI kernel developers is explained in the <a href="https://www.intel.com/content/www/us/en/docs/oneapi-fpga-add-on/developer-guide/current/global-memory-accesses-optimization.html">Intel® oneAPI DPC++/C++ Compiler Handbook for Intel® FPGAs</a>. The global memory configuration required by an application kernel must match the configuration in board_spec.xml as the compiler uses this information to generate a suitable architecture for the application.
The different memory configurations are</p>
<ul>
<li>A single global memory region (possible with same type of memory banks)</li>
<li>Different global memories (heterogeneous memory)</li>
</ul>
<h6 id="21511-contiguous-global-memory"><strong>2.1.5.1.1 Contiguous Global Memory</strong><a class="headerlink" href="#21511-contiguous-global-memory" title="Permanent link">&para;</a></h6>
<div id="cont_mem"></div>

<p>For boards with multiple memory banks of the same type, designers can configure these as a single contiguous global memory region. This is done by specifying each memory interface within a single global_mem element.
Figure 2-6 showed 4 DDR4 memory banks configured as a single global memory region.</p>
<p>With this configuration, FPGA application developers have the option to use contiguous memory region in an interleaved or a non-interleaved fashion. Even with contiguous memory regions, kernel developers can partition data buffers across the banks/memory channels. Please refer to <a href="https://www.intel.com/content/www/us/en/docs/oneapi-fpga-add-on/developer-guide/current/global-memory-accesses-optimization.html">Global Memory Access Optimization section in Intel® oneAPI DPC++/C++ Compiler Handbook for Intel® FPGAs</a> for more details on these partitioning techniques.</p>
<h6 id="21512-heterogeneous-memory"><strong>2.1.5.1.2 Heterogeneous Memory</strong><a class="headerlink" href="#21512-heterogeneous-memory" title="Permanent link">&para;</a></h6>
<div id="het_mem"></div>

<p>For boards with different memory technologies, designers must specify each type of memory that the kernel needs to access as a separate global memory.</p>
<p>Figure 2-7 shows heterogeneous configurations and the <code>global_mem</code> element structure for two different types of memories (QDR, DDR4). The <code>global_mem</code> element in example below also demonstrates use of the <code>default</code> attribute. It is set to "1" for the DDR4 memory banks, indicating to the oneAPI compiler that the default global memory for the kernel is DDR4.</p>
<p><strong>Figure 2-7: Heterogeneous Memory Example Block Diagram and Corresponding <code>global_mem</code> Element in <code>board_spec.xml</code></strong></p>
<p><a class="glightbox" href="../images/Heterogeneous_memory_block_dia.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Heterogeneous Memory Example Block Diagram" src="../images/Heterogeneous_memory_block_dia.png" /></a></p>
<p><a class="glightbox" href="../images/Heterogeneous_memory_example.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Heterogeneous Memory Example" src="../images/Heterogeneous_memory_example.png" /></a></p>
<p><strong>Unified Shared Memory</strong></p>
<div id="usm"></div>

<p>For applications that require <a href="https://oneapi-src.github.io/DPCPP_Reference/usm.html">USM</a> support, the board_spec.xml must specify host and device memories in a heterogeneous manner.
The <code>allocation_type</code> must be <code>host</code> for global memory region on the host processor. The <code>allocation_type</code> must be set to <code>device</code> for global memory on the FPGA board.
Example below extends the board_spec.xml snippet in figure 2-6 to add a <code>global_mem</code> element for the kernel system to host processor memory interface.</p>
<p><strong>Figure 2-8: <code>global_mem</code> Element Example for Unified Shared Memory(USM)</strong></p>
<p><a class="glightbox" href="../images/USM_global_mem_example.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Unified Shared Memory global_mem element example" src="../images/USM_global_mem_example.png" /></a></p>
<h4 id="216-host-element"><strong>2.1.6 host Element</strong><a class="headerlink" href="#216-host-element" title="Permanent link">&para;</a></h4>
<div id="host_element"></div>

<p>The host element of the board_spec.xml file provides information on the interface from the host to the kernel. Figure below shows an example of host element.</p>
<p><strong>Figure 2-9: <code>host</code> Element Example</strong></p>
<p><a class="glightbox" href="../images/host_element.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="host element example" src="../images/host_element.png" /></a></p>
<p><strong>Table 2-8: Attributes for the <code>host</code> Element</strong></p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>kernel_config</td>
<td>This attribute informs the oneAPI compiler at what offset the kernel resides, from the perspective of the <code>kernel_cra</code> host on the kernel_interface module.<br>* start: the starting address of the kernel. Normally, this attribute has a value of 0 because the kernel_cra host should not host anything except kernels.<br>* size: keep this parameter at the default value of 0x0100000.</td>
</tr>
</tbody>
</table>
<h4 id="217-interfaces-element"><strong>2.1.7 interfaces Element</strong><a class="headerlink" href="#217-interfaces-element" title="Permanent link">&para;</a></h4>
<div id="interfaces_element"></div>

<p>The <code>interfaces</code> element of the board_spec.xml file describes the kernel interfaces that connect to application kernels and control kernel behavior. For this element, include one of each interface of types host, irq and streamsource. Refer to the <code>interface</code> section for the parameters you must specify for each interface.
In addition to the host, irq, and streamsource interfaces, if your design includes a separate Platform Designer subsystem containing the board logic, the kernel clock and reset interfaces exported from it are also part of the interfaces element. Specify these interfaces with the <code>kernel_clk_reset</code> attribute and its corresponding parameters.</p>
<p>Figure below shows example of <code>interfaces</code> element.</p>
<p><strong>Figure 2-10: <code>interfaces</code> Element Example</strong></p>
<p><a class="glightbox" href="../images/interfaces_element.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Interfaces element example" src="../images/interfaces_element.png" /></a></p>
<p><strong>Table 2-9:  Parameters for the <code>kernel_clk_reset</code> Attribute</strong></p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>clk</td>
<td>The Platform Designer name for the kernel clock interface</td>
</tr>
<tr>
<td>clk2x</td>
<td>The Platform Designer name for the 2xkernel clock interface</td>
</tr>
<tr>
<td>reset</td>
<td>The Platform Designer connection for the kernel reset</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note:</strong> Name the kernel clock and reset interfaces in the Platform Designer connection format (that is, <instance_name>.<interface_name>). For example: board.kernel_clk</p>
</blockquote>
<h4 id="218-channels-element"><strong>2.1.8 channels Element</strong><a class="headerlink" href="#218-channels-element" title="Permanent link">&para;</a></h4>
<div id="channels_element"></div>

<p>The <code>channels</code> element provides channels for streaming data directly between kernel and I/O. Each channel (implemented using Avalon-ST specification) must be connected to the kernel via the <code>interface</code> attribute. The channel interface only supports data, and valid and ready Avalon-ST signals. The I/O channel defaults to 8-bit symbols and big-endian ordering at the interface level.</p>
<p>Figure below shows an example of <code>channels</code> element for a single channel with a width of 64 bits. The <code>chan_id</code> attribute identified helps identify the port in the generated <code>kernel_system</code>. Refer to <a href="#214-interface-attribute">section 2.1.4</a> for more information about the <code>interface</code> attribute parameters. Additional interface attributes can be added for additional channels. </p>
<p><strong>Figure 2-11: <code>channels</code> Element Example</strong></p>
<p><a class="glightbox" href="../images/channels_element.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Channels element example" src="../images/channels_element.png" /></a></p>
<p>For more information about kernel development using channels, refer to <em>I/O Pipes</em> section in <a href="https://www.intel.com/content/www/us/en/docs/oneapi-fpga-add-on/developer-guide/current/i-o-pipes.html">Intel® oneAPI DPC++/C++ Compiler Handbook for Intel® FPGAs</a>.</p>
<h3 id="22-board_envxml-file"><strong>2.2 <code>board_env.xml</code> File</strong><a class="headerlink" href="#22-board_envxml-file" title="Permanent link">&para;</a></h3>
<div id="board_env"></div>

<p>The <code>board_env.xml</code> file is used by the oneAPI toolkit to set up the board installation that enables the compiler to target a specific accelerator platform. The board_env.xml file must be located in the top most level of the oneAPI ASP for each platform. For example, the <code>board_env.xml</code> for oneAPI ASP for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms is located in the <code>oneapi-asp/Platform-Name</code> folder, where <code>Platform-Name</code> is <code>n6001</code>, <code>fseries-dk</code>, <code>iseries-dk</code> for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> targeting Agilex® 7 FPGA and <code>d5005</code> for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> targeting Stratix 10® FPGA.</p>
<p>A sample board_env.xml file is shown below. Table 2-10 explains the elements of this file.</p>
<p><strong>Figure 2-12: <code>board_env.xml</code> File Structure</strong></p>
<p><a class="glightbox" href="../images/board_env.xml.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Board_env.xml File Structure" src="../images/board_env.xml.png" /></a></p>
<p><strong>Table 2-10:  Specifications of XML Elements and Attributes in the <code>board_env.xml</code> File</strong></p>
<table>
<thead>
<tr>
<th>Element</th>
<th>Attribute Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>board_env</td>
<td>* version: The oneAPI compiler version used to create oneAPI ASP<br>* name: The runtime uses this as the name of the FPGA Client Driver(FCD) file name</td>
</tr>
<tr>
<td>hardware</td>
<td>* dir: Name of the subdirectory, within the oneAPI ASP directory, that contains the board variant directories for a platform<br> * default: The default board variant that the compiler targets when a platform has multiple board variants and user does not specify an explicit argument using <a href="https://www.intel.com/content/www/us/en/docs/oneapi-fpga-add-on/developer-guide/current/fpga-compilation-flags.html">-Xstarget option</a></td>
</tr>
<tr>
<td>platform</td>
<td>name: Name of the operating system. A separate <code>platform</code> element must be specified for each supported OS for the oneAPI ASP platform</td>
</tr>
<tr>
<td>mmdlib</td>
<td>A string that specifies the path to the MMD library of your oneAPI ASP. To load multiple libraries, specify them in an ordered, comma-separated list. The host application will load the libraries in the order that they appear in the list<br>&gt; <strong>Note:</strong> You can use <code>%b</code> to reference your oneAPI ASP directory and provide path relative to oneAPI ASP directory, for example, if MMD library is located inside <code>linux64/lib</code> folder in oneAPI ASP, the path would be <code>%b/linux64/lib/libintel_opae_mmd.so</code></td>
</tr>
<tr>
<td>linkflags</td>
<td>A string that specifies the linker flags necessary for linking with the MMD layer available with the board<br>&gt; <strong>Note:</strong> You can use %b to reference your oneAPI ASP directory and provide path relative to oneAPI ASP directory, for example, if MMD library is located inside <code>linux64/lib</code> folder in oneAPI ASP, the path would be <code>%b/linux64/lib</code>.</td>
</tr>
<tr>
<td>linklibs</td>
<td>A string that specifies the libraries the oneAPI runtime must link against to use the MMD layer available with the board</td>
</tr>
<tr>
<td>utilbindir</td>
<td>Directory in which the runtime expects to locate board utility executables (i.e. install, uninstall, program, diagnose, flash) <br>&gt; <strong>Note:</strong> You can use %b to reference your oneAPI ASP directory and provide path relative to oneAPI ASP directory, for example, if the utilities are located in <code>linux64/libexec</code> folder in oneAPI ASP, the path would be <code>%b/linux64/libexec</code></td>
</tr>
</tbody>
</table>
<h2 id="30-oneapi-asp-hardware"><strong>3.0 oneAPI ASP Hardware</strong><a class="headerlink" href="#30-oneapi-asp-hardware" title="Permanent link">&para;</a></h2>
<div id="oneAPI_asp_hw"></div>

<p>The oneAPI compiler generates the <code>kernel system</code> interfaces based on specifications provided by the oneAPI ASP developer in the <code>board_spec.xml</code> file. The <code>kernel system</code> interfaces with the rest of the oneAPI ASP RTL as shown in figure 1-3.</p>
<p>Figure 1-3 shows 5 different paths, summarized below:</p>
<ul>
<li>Host to EMIF: Consisting of RTL to handle data transfer between host and on-board memory (e.g. DDR4)</li>
<li>Host to Kernel: Consisting of RTL to handle control signals &amp; interrupts between host and kernel</li>
<li>Kernel to EMIF: Consisting of RTL to handle data transfer between kernel and on-board memory</li>
<li>Kernel to Host memory: Required to support Unified Shared Memory. This requires some additional RTL to handle data transfer between kernel and host memory</li>
<li>Kernel to HSSI: Consisting of RTL to handle data streaming between kernel and I/O</li>
</ul>
<p>Please note that the <code>kernel system</code> generated by oneAPI compiler has Avalon® interfaces. <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> has AXI interfaces. Additional logic blocks from Platform Interface Manager are used to handle protocol conversions. Please refer to section 5.3.1 for more details on <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr>.
The next few sections cover some of the important IP components  required to enable kernel communications with host and board peripherals. More design implementation details are covered in section 5.0.</p>
<h3 id="31-host-to-external-memory-interfaceemif"><strong>3.1 Host to External Memory Interface(EMIF)</strong><a class="headerlink" href="#31-host-to-external-memory-interfaceemif" title="Permanent link">&para;</a></h3>
<div id="host_to_emif"></div>

<p>The host to EMIF datapath consists of a PCIe Subsytem(SS), EMIF Subsystem located in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and a Direct Memory Access(DMA) engine in the oneAPI ASP.</p>
<p>PCIe Subsystem(SS) has the PCIe IP and additional logic to handle PCIe packet format and routing. <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> handles routing signals received from host to the user design located in a region referred to as Accelerator Functional Unit(<abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>) (the <code>Kernel system</code> resides in the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>).</p>
<blockquote>
<p><strong>Note:</strong> For more information about the PCIe SS, please refer to <a href="https://ofs.github.io/ofs-2023.3-2/hw/common/user_guides/ug_qs_pcie_ss.pdf">Intel FPGA IP Subsystem for PCI Express IP User Guide</a></p>
</blockquote>
<p>The External Memory Interface Subsystem (EMIF SS) consists of EMIF IP and additional logic for handling transfers between <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> and on-board memories.</p>
<blockquote>
<p><strong>Note:</strong> For more information about the EMIF SS, please refer to <a href="https://www.intel.com/content/www/us/en/secure/content-details/686148/memory-subsystem-intel-fpga-ip-user-guide-for-intel-agilex-ofs.html?wapkw=686148&amp;DocID=686148">Memory Subsystem Intel FPGA IP User Guide</a></p>
</blockquote>
<p>Large buffers of data are usually transferred between host and on-board memory in oneAPI applications. This necessitates a Direct Memory Access(DMA) Engine between host and on-board memory. In oneAPI ASP designs for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platform, this DMA engine is placed in the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> region. </p>
<p>As described in section 2.1.5.1, there are different configurations for memories on board. In addition to above, figure 1-3 also shows an additional IP in the host to memory datapath, called <em>Memory Bank Divider</em>. This IP is used for handling one of the most commonly used configurations, i.e. configuring multiple memory banks of same type as a contiguous memory region. In this case, the kernel has a contiguous view of the memory and data can be interleaved across the different memory channels. The host must also have the same view of the memory in order to ensure read and write transactions from correct addresses.</p>
<h4 id="311-memory-bank-divider"><strong>3.1.1 Memory Bank Divider</strong><a class="headerlink" href="#311-memory-bank-divider" title="Permanent link">&para;</a></h4>
<div id="ocl_mem_divider"></div>

<p>The Memory Bank Divider is a oneAPI ASP IP component that takes an incoming request from the host interface on the Avalon®-MM agent port and routes it to the appropriate bank host port. This component must reside on the path between the host and the global memory interfaces. In addition, it must reside outside of the path between the kernel and the global memory interfaces.</p>
<p>The following image shows the IP interfaces. Table 3-2 provides more information on the interface signals. </p>
<p><strong>Figure 3-1: Memory Bank Divider IP</strong></p>
<p><a class="glightbox" href="../images/ocl_mem_divider_block_dia.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Memory Bank Divider IP Block Diagram" src="../images/ocl_mem_divider_block_dia.png" /></a></p>
<p>This IP is currently made available as part of the <code>oneapi-asp</code> located in <code>oneapi-asp/common/hardware/common/build/ip</code> folder (<code>memory_bank_divider_hw.tcl</code>). The IP can be instantiated in a top level system by passing values to the parameters as shown in snippet below. Table 3-1 provides more information on the parameters. The oneAPI ASP for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms instantiates this IP in a similar way. Refer to section 5.0 for more information on implementation details for oneAPI ASP for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms.</p>
<pre>
    add_instance memory_bank_divider memory_bank_divider &ltversion&gt
    set_instance_parameter_value memory_bank_divider {NUM_BANKS} {number-of-memory-banks}
    set_instance_parameter_value memory_bank_divider {SEPARATE_RW_PORTS} {true/false-value}
    set_instance_parameter_value memory_bank_divider {PIPELINE_OUTPUTS} {true/false-value}
    set_instance_parameter_value memory_bank_divider {SPLIT_ON_BURSTBOUNDARY} {true/false-value}
    set_instance_parameter_value memory_bank_divider {DATA_WIDTH} {data-width}
    set_instance_parameter_value memory_bank_divider {ADDRESS_WIDTH} {total-addressable-width}
    set_instance_parameter_value memory_bank_divider {BURST_SIZE} {burst-size}
    set_instance_parameter_value memory_bank_divider {MAX_PENDING_READS} {max-pending-reads}
    set_instance_parameter_value memory_bank_divider {ASYNC_RESET} {value}
    set_instance_parameter_value memory_bank_divider {SYNCHRONIZE_RESET} {value}
</pre>

<p><strong>Table 3-1: Parameter Settings for the Memory Bank Divider Component</strong></p>
<table>
<thead>
<tr>
<th>Parameter Name in IP TCL</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>NUM_BANKS</td>
<td>Number of banks</td>
<td>Number of memory banks for each of the global memory types included in your board system. A single memory bank divider has the following allowed values: 1,2,4,8 for this parameter.</td>
</tr>
<tr>
<td>SEPARATE_RW_PORTS</td>
<td>Separate read/write ports</td>
<td>Enable this parameter so that each bank has one port for read operation and one for write operation.</td>
</tr>
<tr>
<td>PIPELINE_OUTPUTS</td>
<td>Add pipeline stage to output</td>
<td>Enable this parameter to allow for potential timing improvements.</td>
</tr>
<tr>
<td>DATA_WIDTH</td>
<td>Data Width</td>
<td>Width of the data bus to the memory in bits.</td>
</tr>
<tr>
<td>ADDRESS_WIDTH</td>
<td>Address Width (total addressable)</td>
<td>Total number of address bits necessary to address all global memory.</td>
</tr>
<tr>
<td>BURST_SIZE</td>
<td>Burst size (maximum)</td>
<td>Set to a value equal to interleaved_bytes/(width/8), where interleaved_bytes and width are defined in the interface attribute of the global_mem element in the <code>board_spec.xml</code> file.</td>
</tr>
<tr>
<td>MAX_PENDING_READS</td>
<td>Maximum Pending Reads</td>
<td>Maximum number of pending read transfers the component can process without asserting a waitrequest signal. Recommended value is 64 if ASP has two global memory banks or fewer and 128 if ASP has four or more global memory banks. <br> CAUTION: A high Maximum Pending Reads value causes Platform Designer to insert a deep response FIFO buffer, between the component's host and agent, that consumes a lot of device resources. It also increases the achievable bandwidth between host and memory interfaces.</td>
</tr>
<tr>
<td>SPLIT_ON_BURSTBOUNDARY</td>
<td>Split read/write bursts on burst word boundary</td>
<td>Enable splitting of read and write bursts on burst word boundary. <br> Enable this parameter if the Number of banks parameter value is greater than 1, and the burst reads and writes that the host controller sends to the agent port crosses burst word boundary.</td>
</tr>
</tbody>
</table>
<p><strong>Table 3-2: Signals and Ports for the Memory Bank Divider Component</strong></p>
<table>
<thead>
<tr>
<th>Signal or Port</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>clk</td>
<td>The bank divider logic uses this clock input. If the IP of your host and memory interfaces have different clocks, ensure that clk clock rate is not slower than the slowest of the two IP clocks.</td>
</tr>
<tr>
<td>reset</td>
<td>The reset input that connects to the board power-on reset.</td>
</tr>
<tr>
<td>s</td>
<td>The agent port that connects to the host interface controller.</td>
</tr>
<tr>
<td>kernel_clk</td>
<td>The kernel_clk drives this clock input</td>
</tr>
<tr>
<td>kernel_reset</td>
<td>The kernel_reset output from the <code>Kernel Interface</code> IP drives this reset input.</td>
</tr>
<tr>
<td>acl_asp_snoop</td>
<td>Export this Avalon® Streaming (Avalon®-ST) source. In the board_spec.xml file, under interfaces, describe only the snoop interface for the default memory (acl_internal_snoop). If you have a heterogeneous memory design, perform these tasks only for the <code>Memory Bank Divider</code> component associated with the  default memory.<br> <strong>Important:</strong> The memory system you build in HW tcl (e.g. <code>ddr_board_hw.tcl</code> in oneapi-asp for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms. Refer to section 5 for more details on <code>ddr_board_hw.tcl</code>) alters the width of acl_asp_snoop. You must update the width of the streamsource interface within the channels element in the <code>board_spec.xml</code> file to match the width of acl_asp_snoop.<br> In the <code>board_spec.xml</code> file, update the width of the snoop interface (acl_internal_snoop) specified with the streamsource kernel interface within the interfaces element. Updating the width ensures that the global_mem interface entries in <code>board_spec.xml</code> match the characteristics of the bank<code>N</code> Avalon®-MM hosts from corresponding <code>Memory Bank Divider</code> component for the default memory.</td>
</tr>
<tr>
<td>acl_asp_memorg_host</td>
<td>This conduit connects to the acl_asp_memorg_host interface of the <code>Kernel Interface</code> IP.<br>&gt; <strong>Note:</strong> Signal present if Number of banks &gt; 1.</td>
</tr>
<tr>
<td>bank1, bank2, ..., bank8</td>
<td>The number of memory hosts available in the <code>Memory Bank Divider</code> depends on the number of memory banks that were included when the unit was instantiated. Connect each bank with each memory interface in the same order as the starting address for the corresponding kernel memory interface specified in the board_spec.xml file. <br> For example, global_mem interface that begins at address 0 must correspond to the memory host in bank1 from the <code>Memory Bank Divider</code>.</td>
</tr>
</tbody>
</table>
<h3 id="32-host-to-kernel-interface"><strong>3.2 Host to Kernel Interface</strong><a class="headerlink" href="#32-host-to-kernel-interface" title="Permanent link">&para;</a></h3>
<div id="host_to_kern"></div>

<p>The host exchanges control signals with kernel with the help of an additional oneAPI ASP IP . The control signals coming from the host are on a different clock domain (PCIe clock) while the kernel runs on different clock frequency . The <em>Kernel Interface</em> IP handles the clock domain crossing for these control signals as well as handles communication with kernel CSR, interrupts and generates the reset for oneAPI kernel.
All oneAPI ASP designs must instantiate <em>Kernel Interface</em> IPs to ensure the kernel functions correctly.</p>
<h4 id="321-kernel-interface"><strong>3.2.1 Kernel Interface</strong><a class="headerlink" href="#321-kernel-interface" title="Permanent link">&para;</a></h4>
<div id="ocl_kern_intf"></div>

<p>The Kernel Interface is an oneAPI ASP component that allows the host interface to access and control the oneAPI kernel. </p>
<p>The following image shows the IP interfaces. Table 3-4 provides more information on the interface signals.</p>
<p><strong>Figure 3-2: Kernel Interface IP</strong></p>
<p><a class="glightbox" href="../images/ocl_kern_intf_block_dia.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Kernel Interface IP Block Diagram" src="../images/ocl_kern_intf_block_dia.png" /></a></p>
<p>This IP is currently made available as part of the <code>oneapi-asp</code> located in <code>oneapi-asp/common/hardware/common/build/ip</code> folder (<code>kernel_interface_hw.tcl</code>). The IP can be instantiated in a top level system by passing values to the parameters as shown in snippet below. Table 3-3 provides more information on the parameter. The oneAPI ASP for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms instantiates this IP in a similar way. Refer to section 5.0 for more information on implementation details for oneAPI ASP for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms.</p>
<pre>
    add_instance kernel_interface kernel_interface &ltversion&gt
    set_instance_parameter_value kernel_interface {NUM_GLOBAL_MEMS} {value}
</pre>

<p><strong>Table 3-3: Parameter Settings for the Kernel Interface Component</strong></p>
<table>
<thead>
<tr>
<th>Parameter Name in IP TCL</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>NUM_GLOBAL_MEMS</td>
<td>Number of global memory systems</td>
<td>Number of global memory types in your board design.</td>
</tr>
</tbody>
</table>
<p><strong>Table 3-4: Signals and Ports for the Kernel Interface Component</strong></p>
<table>
<thead>
<tr>
<th>Signal or Port</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>clk</td>
<td>The clock input used for the host control interface. The clock rate of clk can be slow.</td>
</tr>
<tr>
<td>reset</td>
<td>This reset input resets the control interface. It also triggers the kernel_reset signal, which resets all kernel logic.</td>
</tr>
<tr>
<td>ctrl</td>
<td>Use this agent port to connect to the host interface. This interface is a low-speed interface with which you set kernel arguments and start the kernel's execution.</td>
</tr>
<tr>
<td>kernel_clk</td>
<td>kernel clock drives this clock input.</td>
</tr>
<tr>
<td>kernel_cra</td>
<td>This Avalon®-MM host interface communicates directly with the kernels generated by the oneAPI compiler. Export the Avalon®-MM interface to the Kernel Interface and name it in the board_spec.xml file.</td>
</tr>
<tr>
<td>sw_reset_in</td>
<td>When necessary, the host interface resets the kernel via the ctrl interface. If the board design requires a kernel reset, it can do so via this reset input. Otherwise, connect the interface to a global power-on reset.</td>
</tr>
<tr>
<td>kernel_reset</td>
<td>Use this reset output to reset the kernel and any other hardware that communicates with the kernel. <br> Warning: This reset occurs between the MMD open and close calls. Therefore, it must not reset anything necessary for the operation of your MMD.</td>
</tr>
<tr>
<td>sw_reset_export</td>
<td>This reset output is the same as kernel_reset, but it is synchronized to the clk interface. Use this output to reset logic that is not in the kernel_clk clock domain but should be reset whenever the kernel resets.</td>
</tr>
<tr>
<td>acl_asp_memorg_host</td>
<td>The memory interfaces use these signals. <br> Based on the number of global memory systems you specify in the <code>Kernel Interface</code> component parameter editor, the Quartus® Prime Pro Edition Software creates the corresponding number of copies of this signal, each with a different hexadecimal suffix. Connect each signal to the <code>Memory Bank Divider</code> component associated with each global memory system (for example, DDR). Then, list the hexadecimal suffix in the config_addr attribute of the global_mem element in the board_spec.xml file.</td>
</tr>
<tr>
<td>kernel_irq_from_kernel</td>
<td>An interrupt input from the kernel. This signal is exported and named in the board_spec.xml file.</td>
</tr>
<tr>
<td>kernel_irq_to_host</td>
<td>An interrupt output from the kernel. This signal connects to the host interface.</td>
</tr>
</tbody>
</table>
<h3 id="33-kernel-to-external-memory-interface"><strong>3.3 Kernel to External Memory Interface</strong><a class="headerlink" href="#33-kernel-to-external-memory-interface" title="Permanent link">&para;</a></h3>
<div id="kern_to_emif"></div>

<p>The kernel system masters the interface from kernel to external memory. oneAPI compiler generates kernel system memory interface logic (e.g. Load-Store Unit) according to the global memory configuration and <code>interface</code> specifications in <code>board_spec.xml</code> file.
The kernel system operates at kernel clock, hence, oneAPI ASP developers must handle clock domain crossing from kernel to EMIF clock domain.</p>
<p>For implementation details for all datapaths discussed above, please refer to section 5.3.</p>
<h2 id="40-oneapi-asp-software"><strong>4.0 oneAPI ASP Software</strong><a class="headerlink" href="#40-oneapi-asp-software" title="Permanent link">&para;</a></h2>
<div id="oneAPI_asp_sw"></div>

<p>The software components of oneAPI ASP consist of the Memory Mapped Device(MMD) layer and the board utility routine required by runtime.</p>
<p>Section 4.1 introduces MMD layer and section 4.2 explains board utilities.</p>
<h3 id="41-memory-mapped-devicemmd-layer"><strong>4.1 Memory Mapped Device(MMD) Layer</strong><a class="headerlink" href="#41-memory-mapped-devicemmd-layer" title="Permanent link">&para;</a></h3>
<div id="mmd"></div>

<p>The oneAPI ASP Memory Mapped Device (MMD) layer sits in between the oneAPI runtime and <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> and provides a set of API for device communication and control. The runtime calls into the MMD API for various operations like opening a handle to the device, allocating memory etc.</p>
<blockquote>
<p><strong>Note:</strong> For more information about the FPGA runtime, please refer to FPGA Runtime documentation <a href="https://github.com/intel/fpga-runtime-for-opencl/tree/main/docs">here</a>.</p>
</blockquote>
<p>A header file, called <code>aocl_mmd.h</code>, has the list of MMD API calls that must be implemented by oneAPI ASPs. From the perspective of the caller, below is typical MMD API lifecycle:</p>
<ol>
<li>Open device to provide handle for further operations</li>
<li>Set interrupt and status handlers</li>
<li>Program device with kernel bitstream</li>
<li>Allocate memory if required</li>
<li>Perform Read, Write operations (DMA or <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr>)</li>
<li>Free memory if allocation done in step 4</li>
<li>Close device. No further operations permitted until subsequent open device call</li>
</ol>
<p>Table below summarizes all APIs listed in <code>aocl_mmd.h</code>.  </p>
<p><strong>Table 4-1: Summary of MMD API from <code>aocl_mmd.h</code></strong></p>
<table>
<thead>
<tr>
<th>API</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>aocl_mmd_get_offline_info</td>
<td>Obtain offline information about the board. This function is offline because it is device-independent and does not require a handle from the <code>aocl_mmd_open()</code> call</td>
</tr>
<tr>
<td>aocl_mmd_get_info</td>
<td>Obtain information about the board specified in the <code>requested_info_id</code> argument (refer to section 4.1.2 for more information)</td>
</tr>
<tr>
<td>aocl_mmd_open</td>
<td>Open and initialize the specified device</td>
</tr>
<tr>
<td>aocl_mmd_close</td>
<td>Close an opened device via its handle</td>
</tr>
<tr>
<td>aocl_mmd_set_interrupt_handler</td>
<td>Set the interrupt handler for the opened device</td>
</tr>
<tr>
<td>aocl_mmd_set_device_interrupt_handler</td>
<td>Sets the device interrupt handler for opened device, interrupt handler is called to notify runtime of any exceptions</td>
</tr>
<tr>
<td>aocl_mmd_set_status_handler</td>
<td>Set the operation status handler for the opened device</td>
</tr>
<tr>
<td>aocl_mmd_yield</td>
<td>The <code>aocl_mmd_yield</code> function is called when the host interface is idle. The host interface might be idle because it is waiting for the device to process certain events</td>
</tr>
<tr>
<td>aocl_mmd_read</td>
<td>Read operation on a single interface</td>
</tr>
<tr>
<td>aocl_mmd_write</td>
<td>Write operation on a single interface</td>
</tr>
<tr>
<td>aocl_mmd_copy</td>
<td>Copy operation on a single interface</td>
</tr>
<tr>
<td>aocl_mmd_hostchannel_create</td>
<td>Creates a channel interface</td>
</tr>
<tr>
<td>aocl_mmd_hostchannel_destroy</td>
<td>Destroys channel interface</td>
</tr>
<tr>
<td>aocl_mmd_hostchannel_get_buffer</td>
<td>Provides host with pointer used to read/write from channel interface</td>
</tr>
<tr>
<td>aocl_mmd_hostchannel_ack_buffer</td>
<td>Acknowledges read/write from channel</td>
</tr>
<tr>
<td>aocl_mmd_program</td>
<td>Reprogram operation for the specified device</td>
</tr>
<tr>
<td>aocl_mmd_host_alloc</td>
<td>Provide memory that is allocated on the host. Host allocations are accessible by the host and one or more devices</td>
</tr>
<tr>
<td>aocl_mmd_free</td>
<td>Free memory that has been allocated by MMD</td>
</tr>
<tr>
<td>aocl_mmd_device_alloc</td>
<td>Allocate memory that is owned by the device</td>
</tr>
<tr>
<td>aocl_mmd_shared_alloc</td>
<td>Allocate shared memory between the host and the FPGA</td>
</tr>
<tr>
<td>aocl_mmd_shared_migrate</td>
<td>Handle migration of non-concurrent shared allocations any time the accessor of the allocation changes</td>
</tr>
</tbody>
</table>
<p>Sections below cover more details for each API (expected arguments, return values). Section 5.4 discusses more about the implementation of the MMD layer APIs in oneAPI ASPs for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms.</p>
<h4 id="411-aocl_mmd_get_offline_info"><strong>4.1.1 <code>aocl_mmd_get_offline_info</code></strong><a class="headerlink" href="#411-aocl_mmd_get_offline_info" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_get_offline_info"></div>

<p>The <code>aocl_mmd_get_offline_info</code> function obtains offline information about the board specified in the <code>requested_info_id</code> argument. This function is offline because it is device-independent and does not require a handle from the <code>aocl_mmd_open()</code> call.</p>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_get_offline_info (
        aocl_mmd_offline_info_t requested_info_id,
        size_t param_value_size,
        void* param_value,
        size_t* param_size_ret )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li><code>requested_info_id</code>: An enum value of type <code>aocl_mmd_offline_info_t</code> that indicates the offline device information returning to the caller.</li>
</ol>
<p><strong>Table 4-2: Possible Enum Values for the <code>requested_info_id</code> Argument</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>AOCL_MMD_VERSION</td>
<td>Version of MMD layer</td>
<td>char*</td>
</tr>
<tr>
<td>AOCL_MMD_NUM_BOARDS</td>
<td>Number of candidate boards</td>
<td>int</td>
</tr>
<tr>
<td>AOCL_MMD_BOARD_NAMES</td>
<td>Names of available boards<br> &gt; <strong>Note</strong>: Separate each board name by a semicolon (;) delimiter.</td>
<td>char*</td>
</tr>
<tr>
<td>AOCL_MMD_VENDOR_NAME</td>
<td>Name of board vendor</td>
<td>char*</td>
</tr>
<tr>
<td>AOCL_MMD_VENDOR_ID</td>
<td>An integer board vendor ID</td>
<td>int</td>
</tr>
<tr>
<td>AOCL_MMD_USES_YIELD</td>
<td>A value of 0 instructs the runtime to suspend user's processes. The runtime resumes these processes after it receives an event update (for example, an interrupt) from the MMD layer.<br>A value of 1 instructs the runtime to continuously call the <code>aocl_mmd_yield</code> function while it waits for events to complete.<br><strong>CAUTION</strong>: Setting <code>AOCL_MMD_USES_YIELD</code> to 1 might cause high CPU utilization if the <code>aocl_mmd_yield</code> function does not suspend the current thread.</td>
<td>int</td>
</tr>
</tbody>
</table>
<ol>
<li>
<p><code>param_value_size</code>: Size of the <code>param_value</code> field in bytes. This size_t value should match the size of the expected return type that the enum definition indicates.
For example, if <code>AOCL_MMD_NUM_BOARDS</code> returns a value of type int, set the <code>param_value_size</code> to sizeof (int). You should see the same number of bytes returned in the <code>param_size_ret</code> argument.</p>
</li>
<li>
<p><code>param_value</code>: A void* pointer to the variable that receives the returned information.</p>
</li>
<li>
<p><code>param_size_ret</code>: A pointer argument of type size_t* that receives the number of bytes of returned data.</p>
</li>
</ol>
<p><strong>Return Value</strong></p>
<p>A negative return value indicates an error.</p>
<h4 id="412-aocl_mmd_get_info"><strong>4.1.2 <code>aocl_mmd_get_info</code></strong><a class="headerlink" href="#412-aocl_mmd_get_info" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_get_info"></div>

<p>The <code>aocl_mmd_get_info</code> function obtains information about the board specified in the <code>requested_info_id</code> argument.</p>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_get_info (
        int handle,
        aocl_mmd_info_t requested_info_id,
        size_t param_value_size,
        void* param_value,
        size_t* param_size_ret )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: A positive int value representing the handle to the board obtained from the <code>aocl_mmd_open()</code> call.</p>
</li>
<li>
<p><code>requested_info_id</code>: An enum value of type <code>aocl_mmd_info_t</code> that indicates the device information returning to the caller.</p>
</li>
</ol>
<p><strong>Table 4-3: Possible Enum Values for the <code>requested_info_id</code> Argument</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>AOCL_MMD_NUM_KERNEL_INTERFACES</td>
<td>Number of kernel interfaces</td>
<td>int</td>
</tr>
<tr>
<td>AOCL_MMD_KERNEL_INTERFACES</td>
<td>Kernel interfaces</td>
<td>int*</td>
</tr>
<tr>
<td>AOCL_MMD_PLL_INTERFACES</td>
<td>Kernel clock handles</td>
<td>int*</td>
</tr>
<tr>
<td>AOCL_MMD_MEMORY_INTERFACE</td>
<td>Global memory handle</td>
<td>int</td>
</tr>
<tr>
<td>AOCL_MMD_TERMPERATURE</td>
<td>Temperature measurement</td>
<td>float</td>
</tr>
<tr>
<td>AOCL_MMD_PCIE_INFO</td>
<td>PCIe® information</td>
<td>char*</td>
</tr>
<tr>
<td>AOCL_MMD_BOARD_NAME</td>
<td>Board name</td>
<td>char*</td>
</tr>
<tr>
<td>AOCL_MMD_BOARD_UNIQUE_ID</td>
<td>Unique board ID</td>
<td>char*</td>
</tr>
<tr>
<td>AOCL_MMD_CONCURRENT_READS</td>
<td>Number of parallel reads<br>A value of 1 indicates serial reads.</td>
<td>int</td>
</tr>
<tr>
<td>AOCL_MMD_CONCURRENT_WRITES</td>
<td>Number of parallel writes<br>A value of 1 indicates serial writes.</td>
<td>int</td>
</tr>
<tr>
<td>AOCL_MMD_CONCURRENT_READS_OR_WRITES</td>
<td>Total number of concurrent read and write operations</td>
<td>int</td>
</tr>
<tr>
<td>AOCL_MMD_MIN_HOST_MEMORY_ALIGNMENT</td>
<td>Minimum alignment that the oneAPI ASP supports for host allocations</td>
<td>size_t</td>
</tr>
<tr>
<td>AOCL_MMD_HOST_MEM_CAPABILITIES</td>
<td>Capabilities of <code>aocl_mmd_host_alloc()</code> function</td>
<td>unsigned int</td>
</tr>
<tr>
<td>AOCL_MMD_SHARED_MEM_CAPABILITIES</td>
<td>Capabilities of <code>aocl_mmd_shared_alloc()</code> function</td>
<td>unsigned int</td>
</tr>
<tr>
<td>AOCL_MMD_DEVICE_MEM_CAPABILITIES</td>
<td>Capabilities of <code>aocl_mmd_device_alloc()</code> function</td>
<td>unsigned int</td>
</tr>
<tr>
<td>AOCL_MMD_HOST_MEM_CONCURRENT_GRANULARITY</td>
<td>Granularity of concurrent host accesses</td>
<td>size_t</td>
</tr>
<tr>
<td>AOCL_MMD_SHARED_MEM_CONCURRENT_GRANULARITY</td>
<td>Granularity of concurrent shared accesses</td>
<td>size_t</td>
</tr>
<tr>
<td>AOCL_MMD_DEVICE_MEM_CONCURRENT_GRANULARITY</td>
<td>Granularity of concurrent device accesses</td>
<td>size_t</td>
</tr>
</tbody>
</table>
<ol>
<li>
<p><code>param_value_size</code>: Size of the <code>param_value</code> field in bytes. This size_t value should match the size of the expected return type that the enum definition indicates.
For example, if AOCL_MMD_TEMPERATURE returns a value of type float, set the <code>param_value_size</code> to sizeof (float). You should see the same number of bytes returned in the <code>param_size_ret</code> argument.</p>
</li>
<li>
<p><code>param_value</code>: A void* pointer to the variable that receives the returned information.</p>
</li>
<li>
<p><code>param_size_ret</code>: A pointer argument of type size_t* that receives the number of bytes of returned data.</p>
</li>
</ol>
<p><strong>Capability Values</strong> </p>
<p><strong>Table 4-4: Capability Values for <code>aocl_mmd_get_info</code> Function</strong></p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AOCL_MMD_MEM_CAPABILITY_SUPPORTED</td>
<td>If you do not set this value, allocation function is not supported even if other capabilities are set.</td>
</tr>
<tr>
<td>AOCL_MMD_MEM_CAPABILITY_ATOMIC</td>
<td>Supports atomic access to the memory by either the host or the device.</td>
</tr>
<tr>
<td>AOCL_MMD_MEM_CAPABILITY_CONCURRENT</td>
<td>Supports concurrent access to the memory either by the host or the device if the accesses are not on the same block. Block granularity is defined by AOCL_MMD_*_MEM_CONCURRENT_GRANULARITY. Blocks are aligned to this granularity.</td>
</tr>
<tr>
<td>AOCL_MMD_MEM_CAPABILITY_P2P</td>
<td>Memory can be accessed by multiple devices at the same time.</td>
</tr>
</tbody>
</table>
<p><strong>Return Value</strong></p>
<p>A negative return value indicates an error.</p>
<h4 id="413-aocl_mmd_open"><strong>4.1.3 <code>aocl_mmd_open</code></strong><a class="headerlink" href="#413-aocl_mmd_open" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_open"></div>

<p>The <code>aocl_mmd_open</code> function opens and initializes the specified device.</p>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_open (const char *name)

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li><code>name</code>: The function opens the board with a name that matches this const char* string. The name typically matches the one specified by the AOCL_MMD_BOARD_NAMES offline information.</li>
</ol>
<p>The runtime first queries the AOCL_MMD_BOARD_NAMES offline information to identify the boards that it might be able to open. Then it attempts to open all possible devices by calling <code>aocl_mmd_open</code> and using each of the board names as argument.</p>
<blockquote>
<p><strong>Note</strong>: The name must be a C-style NULL-terminated ASCII string.</p>
</blockquote>
<p><strong>Return Value</strong></p>
<p>If <code>aocl_mmd_open()</code> executes successfully, the return value is a positive integer that acts as a handle to the board.</p>
<p>If <code>aocl_mmd_open()</code> fails to execute, a negative return value indicates an error. In the event of an error, the runtime proceeds to open other known devices. Therefore, it is imperative that the MMD layer does not exit the application if an open call fails.</p>
<h4 id="414-aocl_mmd_close"><strong>4.1.4 <code>aocl_mmd_close</code></strong><a class="headerlink" href="#414-aocl_mmd_close" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_close"></div>

<p>The <code>aocl_mmd_close</code> function closes an opened device via its handle.</p>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_close (int handle)

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li><code>handle</code>: A positive int value representing the handle to the board obtained from the <code>aocl_mmd_open()</code> call.</li>
</ol>
<p><strong>Return Value</strong></p>
<p>If the <code>aocl_mmd_close()</code> executes successfully, the return value is 0.</p>
<p>If <code>aocl_mmd_close()</code> fails to execute, a negative return value indicates an error.</p>
<h4 id="415-aocl_mmd_set_interrupt_handler"><strong>4.1.5 <code>aocl_mmd_set_interrupt_handler</code></strong><a class="headerlink" href="#415-aocl_mmd_set_interrupt_handler" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_set_interrupt_handler"></div>

<p>The <code>aocl_mmd_set_interrupt_handler</code> function sets the interrupt handler for the opened device.
When the device internals identify an asynchronous kernel event (for example, a kernel completion), the interrupt handler is called to notify the runtime of the event.</p>
<blockquote>
<p><strong>Note:</strong> Ignore the interrupts from the kernel until this handler is set.</p>
</blockquote>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_set_interrupt_handler (
        int handle, 
        aocl_mmd_interrupt_handler_fn fn,
        void* user_data )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: A positive int value representing the handle to the board obtained from the <code>aocl_mmd_open()</code> call.</p>
</li>
<li>
<p><code>fn</code>: The callback function to invoke when a kernel interrupt occurs. The <code>fn</code> argument is of type <code>aocl_mmd_interrupt_handler_fn</code>, which is defined as follows:</p>
</li>
</ol>
<pre>
    typedef void (*aocl_mmd_interrupt_handler_fn)( int handle, void* user_data );
</pre>

<ol>
<li><code>user_data</code>: The void* type user-provided data that passes to <code>fn</code> when it is called.</li>
</ol>
<p><strong>Return Value</strong></p>
<p>If the function executes successfully, the return value is 0.</p>
<p>If the function fails to execute, a negative return value indicates an error.</p>
<h4 id="416-aocl_mmd_set_device_interrupt_handler"><strong>4.1.6 <code>aocl_mmd_set_device_interrupt_handler</code></strong><a class="headerlink" href="#416-aocl_mmd_set_device_interrupt_handler" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_set_device_interrupt_handler"></div>

<p>The <code>aocl_mmd_set_device_interrupt_handler</code> function sets the device interrupt handler for the opened device. When the device internals identify an asynchronous exception event (for example, a bit correction event), the device interrupt handler is called to notify the runtime of the event.</p>
<blockquote>
<p><strong>Note:</strong> Ignore the interrupts from the device until this handler is set.</p>
</blockquote>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_set_device_interrupt_handler (
        int handle, 
        aocl_mmd_device_interrupt_handler_fn fn,
        void* user_data )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: A positive int value representing the handle to the board obtained from the <code>aocl_mmd_open()</code> call.</p>
</li>
<li>
<p><code>fn</code>: The callback function to invoke when a kernel interrupt occurs. The <code>fn</code> argument is of type <code>aocl_mmd_device_interrupt_handler_fn</code>, which is defined as follows:</p>
</li>
</ol>
<pre> 
    typedef void (*aocl_mmd_device_interrupt_handler_fn)( int handle, aocl_mmd_interrupt_info* data_in, void* user_data );
</pre>

<p><code>aocl_mmd_interrupt_info</code> is defined as:</p>
<pre>

    typedef struct {
        unsigned long long int exception_type;
        void *user_private_info;
        size_t user_cb;
    } aocl_mmd_interrupt_info;

</pre>

<p>Where:</p>
<ul>
<li><code>exception_type</code> acts as a bitfield that contains exactly one bit, corresponding to an exception number.</li>
<li><code>user_private_info</code> and <code>user_cb</code> represent pointers to binary data that the OpenCL implementation return. These pointers log additional information that is helpful for debugging the error.</li>
</ul>
<ol>
<li><code>user_data</code>: The void* type user-provided data that passes to <code>fn</code> when it is called.</li>
</ol>
<p><strong>Return Value</strong></p>
<p>If the function executes successfully, the return value is 0.</p>
<p>If the function fails to execute, a negative return value indicates an error.</p>
<h4 id="417-aocl_mmd_set_status_handler"><strong>4.1.7 <code>aocl_mmd_set_status_handler</code></strong><a class="headerlink" href="#417-aocl_mmd_set_status_handler" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_set_status_handler"></div>

<p>The <code>aocl_mmd_set_status_handler</code> function sets the operation status handler for the opened device. The operation status handler is called under the following circumstances:</p>
<ul>
<li>When the operation completes successfully and status is 0.</li>
<li>When the operation completes with errors and status is a negative value.</li>
</ul>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_set_status_handler (
        int handle,
        aocl_mmd_status_handler_fn fn,
        void* user_data )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: A positive int value representing the handle to the board obtained from the <code>aocl_mmd_open()</code> call.</p>
</li>
<li>
<p><code>fn</code>: The callback function to invoke when a status update occurs. The <code>fn</code> argument is of type <code>aocl_mmd_status_handler_fn</code>, which is defined as follows:</p>
</li>
</ol>
<pre>
    typedef void (*aocl_mmd_status_handler_fn)( int handle, void* user_data, aocl_mmd_op_t op, int status );
</pre>

<ol>
<li><code>user_data</code>: The void* type user-provided data that passes to <code>fn</code> when it is called.</li>
</ol>
<p><strong>Return Value</strong></p>
<p>If the function executes successfully, the return value is 0.</p>
<p>If the function fails to execute, a negative return value indicates an error.</p>
<h4 id="418-aocl_mmd_yield"><strong>4.1.8 <code>aocl_mmd_yield</code></strong><a class="headerlink" href="#418-aocl_mmd_yield" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_yield"></div>

<p>The <code>aocl_mmd_yield</code> function is called when the host interface is idle. The host interface might be idle because it is waiting for the device to process certain events.</p>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_yield (int handle)

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li><code>handle</code>: A positive int value representing the handle to the board obtained from the <code>aocl_mmd_open()</code> call.</li>
</ol>
<p><strong>Return Value</strong></p>
<p>A nonzero return value indicates that the yield function performed work necessary for proper device functioning such as processing direct memory access (DMA) transactions.</p>
<p>A return value of 0 indicates that the yield function did not perform work necessary for proper device functioning.</p>
<blockquote>
<p><strong>Note:</strong> The yield function might be called continuously if it reports that it has necessary work to perform.</p>
</blockquote>
<h4 id="419-aocl_mmd_read"><strong>4.1.9 <code>aocl_mmd_read</code></strong><a class="headerlink" href="#419-aocl_mmd_read" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_read"></div>

<p>The <code>aocl_mmd_read</code> function is the read operation on a single interface.</p>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_read (
        int handle,
        aocl_mmd_op_t op,
        size_t len,
        void* dst,
        int mmd_interface, size_t offset )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: A positive int value representing the handle to the board obtained from the <code>aocl_mmd_open()</code> call.</p>
</li>
<li>
<p><code>op</code>: The operation object of type <code>aocl_mmd_op_t</code> used to track the progress of the operation. If <code>op</code> is NULL, the call must block, and return only after the operation completes.</p>
</li>
</ol>
<blockquote>
<p><strong>Note:</strong> <code>aocl_mmd_op_t</code> is defined as follows:</p>
</blockquote>
<pre>
    typedef void* aocl_mmd_op_t;
</pre>

<ol>
<li>
<p><code>len</code>: The size of the data, in bytes, that the function transfers. Declare <code>len</code> with type size_t.</p>
</li>
<li>
<p><code>dst</code>: The host buffer, of type void*, to which data is written.</p>
</li>
<li>
<p><code>mmd_interface</code>: the handle to the interface being accessed. For example, to access global memory this handle will be value obtained from <code>aocl_mmd_get_info</code> call with AOCL_MMD_MEMORY_INTERFACE as <code>requested_info_id</code> argument.</p>
</li>
<li>
<p><code>offset</code>: The size_t byte offset within the interface at which the data transfer begins.</p>
</li>
</ol>
<p><strong>Return Value</strong></p>
<p>If the read operation is successful, the return value is 0.</p>
<p>If the read operation fails, a negative return value indicates an error.</p>
<h4 id="4110-aocl_mmd_write"><strong>4.1.10 <code>aocl_mmd_write</code></strong><a class="headerlink" href="#4110-aocl_mmd_write" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_write"></div>

<p>The aocl_mmd_write function is the write operation on a single interface.</p>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_write (
        int handle,
        aocl_mmd_op_t op,
        size_t len,
        const void* src,
        int mmd_interface, size_t offset )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: A positive int value representing the handle to the board obtained from the <code>aocl_mmd_open()</code> call.</p>
</li>
<li>
<p><code>op</code>: The operation object of type <code>aocl_mmd_op_t</code> used to track the progress of the operation. If <code>op</code> is NULL, the call must block, and return only after the operation completes.</p>
</li>
</ol>
<blockquote>
<p><strong>Note:</strong> <code>aocl_mmd_op_t</code> is defined as follows:</p>
</blockquote>
<pre>
    typedef void* aocl_mmd_op_t;
</pre>

<ol>
<li>
<p><code>len</code>: The size of the data, in bytes, that the function transfers. Declare <code>len</code> with type size_t.</p>
</li>
<li>
<p><code>src</code>: The host buffer, of type const void*, from which data is read.</p>
</li>
<li>
<p><code>mmd_interface</code>: the handle to the interface being accessed. For example, to access global memory this handle will be value obtained from <code>aocl_mmd_get_info</code> call with AOCL_MMD_MEMORY_INTERFACE as <code>requested_info_id</code> argument.</p>
</li>
<li>
<p><code>offset</code>: The size_t byte offset within the interface at which the data transfer begins.</p>
</li>
</ol>
<p><strong>Return Value</strong></p>
<p>If the write operation is successful, the return value is 0.</p>
<p>If the write operation fails, a negative return value indicates an error.</p>
<h4 id="4111-aocl_mmd_copy"><strong>4.1.11 <code>aocl_mmd_copy</code></strong><a class="headerlink" href="#4111-aocl_mmd_copy" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_copy"></div>

<p>The <code>aocl_mmd_copy</code> function is the copy operation on a single interface.</p>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_copy (
        int handle,
        aocl_mmd_op_t op,
        size_t len,
        int mmd_interface, size_t src_offset, size_t dst_offset )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: A positive int value representing the handle to the board obtained from the <code>aocl_mmd_open()</code> call.</p>
</li>
<li>
<p><code>op</code>: The operation object of type <code>aocl_mmd_op_t</code> used to track the progress of the operation. If <code>op</code> is NULL, the call must block, and return only after the operation completes.</p>
</li>
</ol>
<blockquote>
<p><strong>Note:</strong> <code>aocl_mmd_op_t</code> is defined as follows:</p>
</blockquote>
<pre>
    typedef void* aocl_mmd_op_t;
</pre>

<ol>
<li>
<p><code>len</code>: The size of the data, in bytes, that the function transfers. Declare <code>len</code> with type size_t.</p>
</li>
<li>
<p><code>mmd_interface</code>: the handle to the interface being accessed. For example, to access global memory this handle will be value obtained from <code>aocl_mmd_get_info</code> call with AOCL_MMD_MEMORY_INTERFACE as <code>requested_info_id</code> argument.</p>
</li>
<li>
<p><code>src_offset</code>: The size_t byte offset within the source interface at which the data transfer begins.</p>
</li>
<li>
<p><code>dst_offset</code>: The size_t byte offset within the destination interface at which the data transfer begins</p>
</li>
</ol>
<p><strong>Return Value</strong></p>
<p>If the copy operation is successful, the return value is 0.</p>
<p>If the copy operation fails, a negative return value indicates an error.</p>
<h4 id="4112-aocl_mmd_hostchannel_create"><strong>4.1.12 <code>aocl_mmd_hostchannel_create</code></strong><a class="headerlink" href="#4112-aocl_mmd_hostchannel_create" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_hostchannel_create"></div>

<p>The <code>aocl_mmd_hostchannel_create</code> function creates a channel interface.</p>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_hostchannel_create (
        int handle,
        char *channel_name,
        size_t queue_depth,
        int direction )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: A positive int value representing the handle to the board obtained from the <code>aocl_mmd_open()</code> call.</p>
</li>
<li>
<p><code>channel_name</code>: Name of the channel to be initialized. The channel name is same as that used in the <code>board_spec.xml</code> file.</p>
</li>
<li>
<p><code>queue_depth</code>: The size of pinned internal buffer in bytes. Pointer to the internal buffer is provided when the user calls the <code>aocl_mmd_hostchannel_get_buffer()</code> function.</p>
</li>
<li>
<p><code>direction</code>: The direction of the channel.</p>
</li>
</ol>
<p><strong>Return Value</strong></p>
<p>If the function executes successfully, the return value is positive and is handle to the channel.</p>
<p>If the function fails to execute, a negative return value indicates an error.</p>
<h4 id="4113-aocl_mmd_hostchannel_destroy"><strong>4.1.13 <code>aocl_mmd_hostchannel_destroy</code></strong><a class="headerlink" href="#4113-aocl_mmd_hostchannel_destroy" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_hostchannel_destroy"></div>

<p>The <code>aocl_mmd_hostchannel_destroy</code> function destroys the channel interface.</p>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_hostchannel_destroy (
        int handle,
        int channel )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: A positive int value representing the handle to the board obtained from the <code>aocl_mmd_open()</code> call.</p>
</li>
<li>
<p><code>channel</code>: A positive int value representing handle to the channel to close obtained from the <code>aocl_mmd_hostchannel_create()</code> call.</p>
</li>
</ol>
<p><strong>Return Value</strong></p>
<p>If the function executes successfully, the return value is 0.</p>
<p>If the function fails to execute, a negative return value indicates an error.</p>
<h4 id="4114-aocl_mmd_hostchannel_get_buffer"><strong>4.1.14 <code>aocl_mmd_hostchannel_get_buffer</code></strong><a class="headerlink" href="#4114-aocl_mmd_hostchannel_get_buffer" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_hostchannel_get_buffer"></div>

<p>The <code>aocl_mmd_hostchannel_get_buffer</code> function provides a host with a pointer to the buffer they can access to write or read from the channel interface, along with the space or data available in the buffer, in bytes.</p>
<p><strong>Syntax</strong></p>
<pre>

    void *aocl_mmd_hostchannel_get_buffer (
        int handle,
        int channel,
        size_t *buffer_size,
        int *status )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: A positive int value representing the handle to the board obtained from the <code>aocl_mmd_open()</code> call.</p>
</li>
<li>
<p><code>channel</code>: A positive int value representing handle to the channel to close obtained from the <code>aocl_mmd_hostchannel_create()</code> call.</p>
</li>
<li>
<p><code>buffer_size</code>: A pointer to size_t that the function writes available buffer space or size to.</p>
</li>
<li>
<p><code>status</code>: A pointer to int that the function writes result of the call to.</p>
</li>
</ol>
<p><strong>Return Value</strong></p>
<p>If the function executes successfully, int pointed to by the status pointer is 0. Returned void* may still be NULL, in which case size_t pointed by the buffer_size is 0.</p>
<p>If the function fails to execute, int pointed by the status pointer is a negative value.</p>
<h4 id="4115-aocl_mmd_hostchannel_ack_buffer"><strong>4.1.15 <code>aocl_mmd_hostchannel_ack_buffer</code></strong><a class="headerlink" href="#4115-aocl_mmd_hostchannel_ack_buffer" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_hostchannel_ack_buffer"></div>

<p>You can acknowledge write or read from the channel by calling <code>aocl_mmd_hostchannel_ack_buffer</code>.</p>
<p><strong>Syntax</strong></p>
<pre>

    size_t aocl_mmd_hostchannel_ack_buffer (
        int handle,
        int channel,
        size_t send_size,
        int *status )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: A positive int value representing the handle to the board obtained from the <code>aocl_mmd_open()</code> call.</p>
</li>
<li>
<p><code>channel</code>: A positive int value representing handle to the channel to close obtained from the <code>aocl_mmd_hostchannel_create()</code> call.</p>
</li>
<li>
<p><code>send_size</code>: The size in bytes that the user is acknowledging.</p>
</li>
<li>
<p><code>status</code>: A pointer to int that the function writes result of the call to.</p>
</li>
</ol>
<p><strong>Return Value</strong></p>
<p>If the function executes successfully, int pointed to by status pointer is 0. Also, there is no guarantee that the user's <code>send_size</code> is the actual size that gets acknowledged. The returned size_t is the amount of bytes that was actually acknowledged.</p>
<p>If the function fails to execute, int pointed by status pointer is a negative value.</p>
<h4 id="4116-aocl_mmd_program"><strong>4.1.16 <code>aocl_mmd_program</code></strong><a class="headerlink" href="#4116-aocl_mmd_program" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_program"></div>

<p>The <code>aocl_mmd_program</code> function is the program operation for the specified device. The host must guarantee that no other operations are executing on the device during the program operation. </p>
<p>During <code>aocl_mmd_program</code> execution, the kernels are idle and no read, write, or copy operation can occur.</p>
<p>Disable interrupts and program the FPGA with the data from <code>user_data</code>, which has a size specified by the size argument. The host then calls <code>aocl_mmd_set_status_handler</code> and <code>aocl_mmd_set_interrupt_handler</code> again, which enable the interrupts. If events such as interrupts occur during <code>aocl_mmd_program</code> execution, race conditions or data corruption might occur.</p>
<p><strong>Syntax</strong></p>
<pre>

 int aocl_mmd_program (
    int handle,
    void * user_data,
    size_t size,
    aocl_mmd_program_mode_t program_mode )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: A positive int value representing the handle to the board obtained from the <code>aocl_mmd_open()</code> call.</p>
</li>
<li>
<p><code>user_data</code>: The void* type binary contents of the <em>fpga.bin</em> file that is created during kernel compilation.</p>
</li>
<li>
<p><code>size</code>: The size of <code>user_data</code> in bytes. The size argument is of size_t.</p>
</li>
<li>
<p><code>program_mode</code>: The bit-field that specifies the mode of device programming.</p>
</li>
</ol>
<p><strong>Table 4-5: Possible Values for the <code>program_mode</code> Argument</strong></p>
<table>
<thead>
<tr>
<th><code>program_mode</code> Argument Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AOCL_MMD_PROGRAM_PRESERVE_GLOBAL_MEMORY</td>
<td>This flag specifies that during programming the global memory on the devices are preserved.</td>
</tr>
</tbody>
</table>
<p><strong>Return Value</strong></p>
<p>If <code>aocl_mmd_program</code> executes successfully, the return value is the pointer value that the host uses to access shared memory.</p>
<h4 id="4117-aocl_mmd_host_alloc"><strong>4.1.17 <code>aocl_mmd_host_alloc</code></strong><a class="headerlink" href="#4117-aocl_mmd_host_alloc" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_host_alloc"></div>

<p>Host allocations provide memory that is allocated on the host. This memory must be deallocated with the <code>aocl_mmd_free</code> function. Host allocations are accessible by the host and one or more devices. The same pointer to a host allocation may be used on the host and all supported devices. They have address equivalence.</p>
<p><strong>Syntax</strong></p>
<p>Once the device has signaled completion through the <code>aocl_mmd_interrupt_handler_fn</code> function, the host can assume it has access to the latest contents of the memory, allocated by the <code>aocl_mmd_host_alloc</code> function call.</p>
<pre>

    void* aocl_mmd_host_alloc (
        int* handles,
        size_t num_devices,
        size_t size,
        size_t alignment,
        aocl_mmd_mem_properties_t *properties,
        int* error )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handles</code>: Handles for devices that needs access to this memory.</p>
</li>
<li>
<p><code>num_devices</code>: Number of devices in the handles.</p>
</li>
<li>
<p><code>size</code>: The size of the memory region.</p>
</li>
<li>
<p><code>alignment</code>: The alignment (in bytes) of the allocation.</p>
</li>
<li>
<p><code>properties</code>: Specifies additional information about the allocated memory, described by a property type name and its corresponding value. Each property type name is immediately followed by the corresponding desired value. The list is terminated with a zero.  For example, [<property1>, <value1>, <property2>, <value2>, 0]</p>
</li>
<li>
<p><code>error</code>: The error code defined by AOCL_MMD_ERROR*:</p>
</li>
</ol>
<ul>
<li>AOCL_MMD_ERROR_SUCCESS: No error occurred.</li>
<li>AOCL_MMD_ERROR_INVALID_HANDLE: The device handle provided is invalid.</li>
<li>AOCL_MMD_ERROR_OUT_OF_MEMORY: Ran out of memory.</li>
<li>AOCL_MMD_ERROR_UNSUPPORTED_ALIGNMENT: The device does not support the provided alignment.</li>
<li>AOCL_MMD_ERROR_UNSUPPORTED_PROPERTY: The device does not support the provided property.</li>
</ul>
<p><strong>Return Value</strong></p>
<p>If the <code>aocl_mmd_host_alloc</code> function executes successfully, the return value is a valid pointer value. Otherwise, the return value is NULL.</p>
<h4 id="4118-aocl_mmd_free"><strong>4.1.18 <code>aocl_mmd_free</code></strong><a class="headerlink" href="#4118-aocl_mmd_free" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_free"></div>

<p>Releases memory that was allocated by MMD.</p>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_free (void* mem)

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li><code>mem</code>: The pointer to the memory region. Must be a pointer that is allocated by the MMD.</li>
</ol>
<p><strong>Return Value</strong></p>
<p>Returns one of the following error code:</p>
<ul>
<li>AOCL_MMD_ERROR_SUCCESS: No error occurred</li>
<li>AOCL_MMD_ERROR_INVALID_POINTER: Invalid pointer provided</li>
</ul>
<h4 id="4119-aocl_mmd_device_alloc"><strong>4.1.19 <code>aocl_mmd_device_alloc</code></strong><a class="headerlink" href="#4119-aocl_mmd_device_alloc" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_device_alloc"></div>

<p>Allocate memory that is owned by the device. This pointer can only be accessed by the kernel. It cannot be accessed by the host. The host is able to manipulate the pointer (for example, increment it) and not just access the underlying data. This memory must be deallocated by the <code>aocl_mmd_free()</code> function.</p>
<p><strong>Syntax</strong></p>
<pre>

    void * aocl_mmd_device_alloc (
        int handle, 
        size_t size, 
        size_t alignment, 
        aocl_mmd_mem_properties_t *properties, 
        int* error )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: Device that has access to this memory.</p>
</li>
<li>
<p><code>size</code>: The size of the memory region.</p>
</li>
<li>
<p><code>alignment</code>: The alignment (in bytes) of the memory region.</p>
</li>
<li>
<p><code>properties</code>: Specifies additional information about the allocated memory, described by a property type name and its corresponding value. Each property type name is immediately followed by the corresponding desired value. The list is terminated with a zero.  For example, [<property1>, <value1>, <property2>, <value2>, 0]</p>
</li>
</ol>
<p><strong>Return Value</strong></p>
<p>Returns one of the following error code:</p>
<ul>
<li>AOCL_MMD_ERROR_SUCCESS: No error occurred</li>
<li>AOCL_MMD_ERROR_INVALID_HANDLE: The device handle provided is invalid.</li>
<li>AOCL_MMD_ERROR_OUT_OF_MEMORY: Ran out of memory.</li>
<li>AOCL_MMD_ERROR_UNSUPPORTED_ALIGNMENT: The device does not support the provided alignment.</li>
<li>AOCL_MMD_ERROR_UNSUPPORTED_PROPERTY: The device does not support the provided property.</li>
</ul>
<h4 id="4120-aocl_mmd_shared_alloc"><strong>4.1.20 <code>aocl_mmd_shared_alloc</code></strong><a class="headerlink" href="#4120-aocl_mmd_shared_alloc" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_shared_alloc"></div>

<p>Shared allocations can migrate between the host and one or more associated device. The same pointer to a shared allocation can be used on the host and the supported device. They have address equivalence.</p>
<p><strong>Syntax</strong></p>
<pre>

    void * aocl_mmd_shared_alloc (
        int handle, 
        size_t size, 
        size_t alignment, 
        aocl_mmd_mem_properties_t* properties, 
        int* error )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: Device that needs access to this memory.</p>
</li>
<li>
<p><code>size</code>: The size of the memory region.</p>
</li>
<li>
<p><code>alignment</code>: The alignment (in bytes) of the allocation.</p>
</li>
<li>
<p><code>properties</code>: Specifies additional information about the allocated memory described by a property type name and its corresponding value. Each property type name is immediately followed by the corresponding desired value. The list is terminated with a zero.  For example, [<property1>, <value1>, <property2>, <value2>, 0]</p>
</li>
<li>
<p><code>error</code>: The error code defined by AOCL_MMD_ERROR*.</p>
</li>
</ol>
<ul>
<li>AOCL_MMD_ERROR_SUCCESS: No error occurred.</li>
<li>AOCL_MMD_ERROR_INVALID_HANDLE: The device handle provided is invalid.</li>
<li>AOCL_MMD_ERROR_OUT_OF_MEMORY: Ran out of memory.</li>
<li>AOCL_MMD_ERROR_UNSUPPORTED_ALIGNMENT: The device does not support the provided alignment.</li>
<li>AOCL_MMD_ERROR_UNSUPPORTED_PROPERTY: The device does not support the provided property.</li>
</ul>
<p><strong>Return Value</strong></p>
<p>If the <code>aocl_mmd_shared_alloc</code> function executes successfully, the return value is a valid pointer value. Otherwise, the return value is NULL.</p>
<h4 id="4121-aocl_mmd_shared_migrate"><strong>4.1.21 <code>aocl_mmd_shared_migrate</code></strong><a class="headerlink" href="#4121-aocl_mmd_shared_migrate" title="Permanent link">&para;</a></h4>
<div id="aocl_mmd_shared_migrate"></div>

<p>A call to the <code>aocl_mmd_shared_migrate()</code> function must be made for non-concurrent shared allocations any time the accessor of the allocation changes. For example, the <code>aocl_mmd_shared_migrate()</code> function should be called indicating that the allocation should be migrated to the device before a kernel accessing the allocation is launched on the device. Similarly, the <code>aocl_mmd_shared_migrate()</code> function should be called indicating that the allocation is migrated to the host before the host accesses the memory after kernel completion. For concurrent allocations, this call may be used as a performance hint, but it is not strictly required for functionality.</p>
<p><strong>Syntax</strong></p>
<pre>

    int aocl_mmd_shared_migrate (
        int handle, 
        void* shared_ptr, 
        size_t size, 
        aocl_mmd_migrate_t destination )

</pre>

<p><strong>Function Arguments</strong></p>
<ol>
<li>
<p><code>handle</code>: Device that has access to this memory.</p>
</li>
<li>
<p><code>shared_ptr</code>: Pointer allocated by the <code>aocl_mmd_shared_alloc()</code> function.</p>
</li>
<li>
<p><code>size</code>: Size (in bytes) of the migration. Must be a multiple of a page boundary that the oneAPI ASP supports.</p>
</li>
<li>
<p><code>destination</code>: The destination of the migration.</p>
</li>
</ol>
<p><strong>Return Value</strong></p>
<p>Returns one of the following error code:</p>
<ul>
<li>AOCL_MMD_ERROR_SUCCESS: No error occurred.</li>
<li>AOCL_MMD_ERROR_INVALID_HANDLE: The device handle provided is invalid.</li>
<li>AOCL_MMD_ERROR_INVALID_MIGRATION_SIZE: The migration size is not supported by the device.</li>
</ul>
<h3 id="42-board-utilities"><strong>4.2 Board Utilities</strong><a class="headerlink" href="#42-board-utilities" title="Permanent link">&para;</a></h3>
<div id="board_util"></div>

<p>oneAPI runtime provides a set of options for the <code>aocl</code> utility.</p>
<blockquote>
<p><strong>Note:</strong> <code>aocl</code> is an utility available in the oneAPI runtime environment, please use <code>aocl help</code> command for more information on this.</p>
</blockquote>
<p>Table 4-6 shows the subcommands that <code>aocl</code> utility provides for FPGA platforms.</p>
<p><strong>Table 4-6: <code>aocl</code> Board Utilities</strong></p>
<table>
<thead>
<tr>
<th>Subcommand</th>
<th>Description</th>
<th>Executable Call</th>
</tr>
</thead>
<tbody>
<tr>
<td>install</td>
<td>Install board into the host system. This installs the FPGA Client Driver (FCD) for your FPGA platform. FCD allows runtime to find and load the FPGA platform libraries at runtime</td>
<td>aocl install <code>path-to-FPGA-platform-oneapi-asp</code></td>
</tr>
<tr>
<td>uninstall</td>
<td>Uninstall board from the host system. Removes FCD.</td>
<td>aocl uninstall <code>path-to-FPGA-platform-oneapi-asp</code></td>
</tr>
<tr>
<td>initialize</td>
<td>Configure a default FPGA image onto the board. For more information about initialization refer to <a href="https://www.intel.com/content/www/us/en/docs/oneapi-fpga-add-on/developer-guide/current/fpga-board-initialization.html">Intel® oneAPI DPC++/C++ Compiler Handbook for Intel® FPGAs</a></td>
<td>Two methods are available to initalize the board:<br> 1. aocl initialize <code>device-name</code> <code>board-variant</code><br> 2. aocl initialize <code>device-name</code> <code>oneAPI fat binary</code><br> &gt; <strong>Note:</strong> The second option requires oneAPI Base Toolkit (Base Kit) version 2024.0 &amp; above as well as 2023.3 <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Release for oneAPI Accelerator Support Package and above</td>
</tr>
<tr>
<td>program</td>
<td>Configure a new FPGA image onto the board</td>
<td>aocl program <code>device-name</code> <code>aocx file</code></td>
</tr>
<tr>
<td>diagnose</td>
<td>Runs ICD and FCD diagnostics followed by querying devices in installed platforms. If a <code>device-name</code> is specified in the call, it run board vendor's test program for the FPGA platform</td>
<td>* aocl diagnose : This queries the devices in FPGA platform and supplies a list of valid strings assigned to the list of devices <br> * aocl diagnose <code>device-name</code> : This runs full diagnostic test on the FPGA platform</td>
</tr>
</tbody>
</table>
<p>The runtime expects the routine for each of this utilities to be defined in the oneAPI ASP. It looks for the routine executables in the location specified by the <code>utilbinder</code> element in the <code>board_env.xml</code> file.</p>
<p><strong>install</strong></p>
<p>oneAPI runtime uses the information in <code>board_env.xml</code> file to create a FCD file. The FCD file name matches <code>name</code> attribute of <code>board_env</code> element and the FCD contents are the platform libraries specified in <code>mmdlib</code> element. Refer to section 2.2 for more information about <code>board_env.xml</code> file. The runtime adds the installed platform to the list of installed packages(file used by runtime to track installed platforms) and then invokes the install routine from oneAPI ASP.</p>
<p><strong>uninstall</strong></p>
<p>oneAPI runtime removes the FCD file and removes the platform from list of installed packages. It then invokes the uninstall routine for oneAPI ASP.</p>
<p><strong>initialize</strong></p>
<p>oneAPI runtime invokes initialize routine provided by oneAPI ASPs for installed platforms.</p>
<p><strong>program</strong></p>
<p>oneAPI runtime loads the programming file on the FPGA by invoking program routine provided by the oneAPI ASPs for the installed platform.</p>
<p><strong>diagnose</strong></p>
<p>oneAPI runtime runs ICD and FCD diagnostics to check the ICD and FCD files installed on the system. It then queries for available boards in the installed platform and lists boards matching every installed platform. If a <code>device-name</code> is specified in the call, runtime invokes the diagnostic routine provided in oneAPI ASP.</p>
<p>For more information about the implementation of these routines in oneAPI ASPs for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms, please refer to section 5.5.</p>
<h2 id="50-oneapi-asp-implementation-details"><strong>5.0 <code>oneapi-asp</code> Implementation Details</strong><a class="headerlink" href="#50-oneapi-asp-implementation-details" title="Permanent link">&para;</a></h2>
<div id="oneAPI_asp_impl"></div>

<p><code>oneapi-asp</code> in the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> has four reference platform releases, one is based on Stratix 10® FPGA and the other three are based on Agilex® 7 FPGA.
This chapter aims to explain the architecture and current implementation details of <code>oneapi-asp</code> for these platforms. The <code>oneapi-asp</code> repository is located <a href="https://github.com/OFS/oneapi-asp/tree/master">here</a>.</p>
<p>The next section explains the <code>oneapi-asp</code> directory structure, followed by sections on hardware and MMD layers.</p>
<h3 id="51-oneapi-asp-directory-structure"><strong>5.1 <code>oneapi-asp</code> Directory Structure</strong><a class="headerlink" href="#51-oneapi-asp-directory-structure" title="Permanent link">&para;</a></h3>
<div id="oneAPI_asp_dir"></div>

<p>As described in section 2.0, oneAPI compiler &amp; runtime use the <code>board_env.xml</code> and <code>board_spec.xml</code> files to get information about the FPGA platform. The compiler expects the <code>board_env.xml</code> file to be at the topmost level in the platform directory. The <code>board_env.xml</code> file describes the location of the hardware files &amp; platform libraries.</p>
<pre>

    &lt?xml version=&quot1.0&quot?&gt
    &ltboard_env version=&quotCompiler-version&quot name=&quotofs_Platform-name/FCD-name&quot&gt
      &lthardware dir=&quothardware&quot default=&quotBoard-Variant-1&quot&gt&lt/hardware&gt
      &ltplatform name=&quotlinux64&quot&gt
        &ltmmdlib&gtlibopae-c.so,%b/linux64/lib/libMPF.so,%b/linux64/lib/libintel_opae_mmd.so&lt/mmdlib&gt
        &ltlinkflags&gt-L%a/linux64/lib -L%b/linux64/lib&lt/linkflags&gt
        &ltlinklibs&gt-lintel_opae_mmd -lrt -lMP&lt/linklibs&gt
        &ltutilbindir&gt%b/linux64/libexec&lt/utilbindir&gt
      &lt/platform&gt

    &lt/board_env&gt

</pre>

<p>Snippet above shows a sample board_env.xml file, the corresponding oneAPI ASP directory structure must match the following format. Table 5-1 provides details on each folder. </p>
<p>In addition to below folders, <a href="https://github.com/OFS/oneapi-asp">oneAPI ASP for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms</a> have another folder called <code>commmon</code> (<code>oneapi-asp/common</code>) containing the hardware files common across all reference platforms (<code>oneapi-asp/common/hardware</code>) and source code for the software layer, i.e. MMD &amp; board utilities ( <code>oneapi-asp/common/source</code>). This is because the software layer is compatible with both Stratix 10® FPGA and Agilex® 7 FPGA PCIe attach reference platform ASPs. </p>
<pre>
    oneapi-asp/Platform-Name/
    |--hardware/
    |--|--Board-Variant-1/
    |--|--Board-Variant-2/
    |--linux64/
    |--board_env.xml
</pre>

<blockquote>
<p><strong>Note:</strong><br> In addition to above folders, oneAPI ASPs for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms have additional directories called <code>scripts</code> (in <code>oneapi-asp/common</code> and <code>oneapi-asp/Platform-Name</code>) which contains helper scripts for platform generation and <code>oneapi-asp/common/bringup</code> folder which contains a sample for board bring up. Please refer to the README for each reference platform in the oneASP-asp repository for more information on these additional folders. <br> * README for <code>oneapi-asp</code> targeting Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005 reference platform: <a href="https://github.com/OFS/oneapi-asp/blob/master/d5005/README.md">README</a> <br> * README for <code>oneapi-asp</code> targeting Intel® FPGA SmartNIC N6001-PL reference platform: <a href="https://github.com/OFS/oneapi-asp/blob/master/n6001/README.md">README</a> <br> * README for <code>oneapi-asp</code> targeting Agilex® 7 FPGA F-Series Development Kit (2x F-Tile):<a href="https://github.com/OFS/oneapi-asp/blob/master/fseries-dk/README.md">README</a> <br> * README for <code>oneapi-asp</code> targeting Agilex® 7 FPGA I-Series Development Kit (2x R-Tile and 1xF-Tile): <a href="https://github.com/OFS/oneapi-asp/blob/master/iseries-dk/README.md">README</a></p>
</blockquote>
<p>The <code>Platform-Name</code> is used for identifying the platform and can be alphanumeric value decided by the platform developer. For example, <code>Platform-Name</code> <code>d5005</code> is used for <code>oneapi-asp</code> for Stratix 10® FPGA as the reference platform is Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005.</p>
<p><strong>Table 5-1: Directory Contents</strong></p>
<table>
<thead>
<tr>
<th>Files/Folder (path relative to <code>oneapi-asp/Platform-Name/</code>)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>hardware</code></td>
<td>Contains hardware files (RTL, platform designer files, SDCs, compilation scripts, floorplan settings) and the <code>board_spec.xml</code> files for each board variants. See table 5-2 for more details</td>
</tr>
<tr>
<td><code>../common/source</code></td>
<td>Source code for MMD layer as well as <code>oneapi-asp</code> board utilities</td>
</tr>
<tr>
<td><code>linux64</code></td>
<td>Location for FPGA platform libraries and executables for <code>oneapi-asp</code> board utilities <br> &gt; <strong>Note:</strong> The <code>linux64</code> folder does not exist in the <code>Platform-Name</code> directory, it is added after the <code>oneapi-asp</code> <a href="#52-oneapi-asp-hardware-implementation">build flow</a> is complete</td>
</tr>
<tr>
<td><code>board_env.xml</code></td>
<td>Contains platform installation information. Please refer to section 2.2 for more details on board_env.xml elements</td>
</tr>
</tbody>
</table>
<p>Tables 5-2 to 5-4 give more details on each of these folders for oneAPI ASPs for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms (before oneapi-asp build flow unless noted otherwise, for more information about oneapi-asp build flow refer to section 5.2).</p>
<h4 id="511-hardware-folder"><strong>5.1.1 hardware Folder</strong><a class="headerlink" href="#511-hardware-folder" title="Permanent link">&para;</a></h4>
<div id="hw_dir"></div>

<pre>
oneapi-asp/
|--common
|--|--hardware/
|--Platform-Name
|--|--hardware/
|--|--|--common/
|--|--|--|--build
|--|--|--board-variant-1/
|--|--|--|--build
|--|--|--|--board_spec.xml
|--|--|--|--part-number_dm.xml (Please see note for this file in table 5-2)
</pre>

<p><strong>Table 5-2: <code>hardware</code> Folder Contents</strong></p>
<table>
<thead>
<tr>
<th>Files/Folder (path relative to <code>oneapi-asp/</code>)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>common/hardware</code></td>
<td>Contains hardware design files common to all reference platforms including Quartus® software Settings Files (*.qsf), IP files, common RTL code (*.v, *.sv) as well as scripts to control compile flow</td>
</tr>
<tr>
<td><code>Platform-Name/hardware/common/build</code></td>
<td>Contains platform specific hardware design files (common to each board variant for a platform) including *.sv, *.sdc, Quartus® software ini settings file as well as scripts to control compile flow</td>
</tr>
<tr>
<td><code>Platform-Name/hardware/board-variant-1/build</code></td>
<td>Contains board variant specific hardware design files like variant specific Verilog header file (*.vh), oneapi_afu.json, *.tcl</td>
</tr>
<tr>
<td><code>Platform-Name/hardware/board-variant-1/board_spec.xml</code></td>
<td>Defines compile flow, global memory, kernel interfaces. Please see section 2.1 for more information about <code>board_spec.xml</code> file</td>
</tr>
<tr>
<td><code>Platform-Name/hardware/board-variant-1/part-number_dm.xml</code></td>
<td>Device Model file for Altera® FPGA part on the target platform. The name must be of the format <code>part-number</code>_dm.xml. This file has the total resources available on the device. <br>&gt; <strong>Note:</strong> The device model files provided as part of the oneAPI Base Toolkit (Base Kit) installation are located in <code>$INTELFPGAOCLSDKROOT/share/models/dm</code>, where INTELFPGAOCLSDKROOT is set by the <code>setvars.sh</code> environment setup script provided by <a href="https://www.intel.com/content/www/us/en/docs/oneapi/installation-guide-linux/current/prerequisites.html">oneAPI toolkit</a>. If the device model file for your part number is not included in <code>$INTELFPGAOCLSDKROOT/share/models/dm</code>, it must be created and placed in the same folder as <code>board_spec.xml</code>. In oneapi-asp for reference platforms, this file only exists for platforms whose target device model files are not provided by oneAPI Base Toolkit (Base Kit) installation.</td>
</tr>
</tbody>
</table>
<h4 id="512-commonsource-folder"><strong>5.1.2 common/source Folder</strong><a class="headerlink" href="#512-commonsource-folder" title="Permanent link">&para;</a></h4>
<div id="source_dir"></div>

<pre>
oneapi-asp/common/source/
|--cmake/
|--|--modules
|--extra/
|--|--intel-fpga-bbb
|--host
|--include
|--util
|--CMakeLists.txt
</pre>

<p><strong>Table 5-3: <code>oneapi-asp/common/source</code> Folder Contents</strong></p>
<table>
<thead>
<tr>
<th>Files/Folder</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cmake/modules</code></td>
<td>Contains <code>Find***.cmake</code> files to find packages required for building MMD library</td>
</tr>
<tr>
<td><code>extra/intel-fpga-bbb</code></td>
<td>oneAPI ASP for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms uses a library provided as part of Intel® FPGA Basic Building Blocks (<abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr>) repository. The <code>oneapi-asp</code> build scripts clone this repository in <code>extra</code> directory by default</td>
</tr>
<tr>
<td><code>host</code></td>
<td>Source code for MMD API</td>
</tr>
<tr>
<td><code>include</code></td>
<td>Contains MMD header files</td>
</tr>
<tr>
<td><code>util</code></td>
<td>Contains source code for <code>oneapi-asp</code> reference platform routines for diagnose and program utilities</td>
</tr>
<tr>
<td><code>CMakeLists.txt</code></td>
<td>Top-level CMakeLists.txt file for building MMD and other libraries required by <code>oneapi-asp</code> as well as the executables for diagnose and program utilities</td>
</tr>
</tbody>
</table>
<h4 id="513-linux64-folder"><strong>5.1.3 linux64 Folder</strong><a class="headerlink" href="#513-linux64-folder" title="Permanent link">&para;</a></h4>
<div id="linux64_dir"></div>

<pre>
oneapi-asp/Platform-Name/linux64/
|--include (see note below)
|--lib
|--libexec
</pre>

<blockquote>
<p><strong>Note:</strong> The <code>linux64</code> folder does not exist in the <code>Platform-Name</code> directory, it is present in the <code>oneapi-asp/common</code> folder as the utilities are common for all reference platforms. The <code>include</code> and <code>lib</code> folders also do not exist in the <a href="https://github.com/OFS/oneapi-asp"><code>oneapi-asp</code> repository</a>. These along with the utilities are added to the <code>oneapi-asp/Platform-Name</code> folder after the <code>oneapi-asp</code> <a href="#52-oneapi-asp-hardware-implementation">build flow</a> is complete.</p>
</blockquote>
<p><strong>Table 5-4: <code>linux64</code> Folder Contents</strong></p>
<table>
<thead>
<tr>
<th>Files/Folder</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>include</code></td>
<td>Contains header files from Intel® FPGA <abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr> required by MMD (see section 5.4 for more information on use of MPF from Intel® FPGA <abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr> in MMD)</td>
</tr>
<tr>
<td><code>lib</code></td>
<td>Contains MMD and Intel® FPGA <abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr> libraries</td>
</tr>
<tr>
<td><code>libexec</code></td>
<td>Contains executables/scripts for <code>oneapi-asp</code> board utilities</td>
</tr>
</tbody>
</table>
<h3 id="52-oneapi-asp-build-flow"><strong>5.2 <code>oneapi-asp</code> Build Flow</strong><a class="headerlink" href="#52-oneapi-asp-build-flow" title="Permanent link">&para;</a></h3>
<div id="oneAPI_asp_build_flow"></div>

<p>Figure 1-3 shows a high level overview of the hardware design and Figure 1-4 shows oneAPI ASP as part of the Open FPGA Stack. As shown in these images, all <code>oneapi-asp</code> hardware components reside in the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> region in the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> slot.</p>
<blockquote>
<p><strong>Note:</strong> The architecture of the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> with <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> slot is explained in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> technical reference manuals, please refer to <a href="#13-prerequisites">section 1.3</a> for links to the manuals.</p>
</blockquote>
<p>The <a href="https://github.com/OFS/oneapi-asp"><code>oneapi-asp</code> repository</a> contains source files for components that reside in the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> region for each reference platform. <code>oneapi-asp</code> expects a compiled <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> netlist and a corresponding <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> tree. The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> database is copied to the <code>oneapi-asp</code> during ASP <em>build</em> flow (<code>oneapi-asp/Platform-Name/scripts/build-asp.sh</code>) and ASP <em>compile</em> scripts import the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> database during oneAPI kernel compilation.</p>
<blockquote>
<p><strong>Notes:</strong> <br> 1. <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> developer guide outlines steps to compile a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and generate <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> tree, please refer to section 1.3 for links to <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> developer guides<br> 2. The steps to build <code>oneapi-asp</code> using <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> tree and <code>build-asp.sh</code> script are covered in the <a href="https://ofs.github.io/ofs-2024.1-1/hw/common/user_guides/oneapi_asp/ug_oneapi_asp/">oneAPI Accelerator Support Package (ASP): Getting Started User Guide</a></p>
</blockquote>
<p>The following figure shows the <code>oneapi-asp</code> <em>build</em> process.</p>
<p><strong>Figure 5-1: <code>oneapi-asp</code> Build Flow</strong></p>
<p><a class="glightbox" href="../images/oneAPI-asp_build_flow.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="oneapi-asp Build Flow Image" src="../images/oneAPI-asp_build_flow.png" /></a></p>
<p><strong>Table 5-5 Environment Variables used in Build Flow</strong></p>
<table>
<thead>
<tr>
<th>Variable Number</th>
<th>Environment Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>OFS_PLATFORM_AFU_BBB</td>
<td>Should point to location where ofs-platform-afu-bbb repository is cloned, if this variable is not set, <code>build-asp.sh</code> script clones the repository</td>
</tr>
<tr>
<td>2</td>
<td>OPAE_PLATFORM_ROOT</td>
<td>Must point to the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> tree generated during <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> build, this is a required variable and build flow fails without this</td>
</tr>
<tr>
<td>3</td>
<td>LIBOPAE_C_ROOT</td>
<td>Should point to the installation location for OPAE libraries (please see <a href="https://ofs.github.io/ofs-2024.1-1/hw/common/user_guides/oneapi_asp/ug_oneapi_asp/">oneAPI Accelerator Support Package (ASP): Getting Started User Guide</a> for more information on this variable setting), <code>build-opae.sh</code> script is used to clone &amp; build OPAE library if this variable is not set.</td>
</tr>
<tr>
<td>4</td>
<td>OPAE_SDK_REPO_BRANCH</td>
<td>If <code>LIBOPAE_C_ROOT</code> is not set, it is recommended to set this variable to indicate the <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> branch to be used for building OPAE libraries.<br> &gt; <strong>Note:</strong> <code>build-opae.sh</code> always clones the master branch if <code>OPAE_SDK_REPO_BRANCH</code> environment variable is not set. If you do not have the <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> installed, please ensure the <code>OPAE_SDK_REPO_BRANCH</code> is set to point to the OPAE release tag matching the <a href="https://github.com/orgs/OFS/discussions">release notes</a> for the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> release you are using. Please refer to <a href="https://ofs.github.io/ofs-2024.1-1/hw/common/user_guides/oneapi_asp/ug_oneapi_asp/">oneAPI Accelerator Support Package (ASP): Getting Started User Guide</a> for more information on environment variable and build steps</td>
</tr>
</tbody>
</table>
<p>The scripts required for <code>oneapi-asp</code> <em>build</em> that are common to all <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms are located in <code>oneapi-asp/common/scripts</code> and build scripts specific to individual platforms are located in <code>oneapi-asp/Platform-Name/scripts</code> folders in the <code>oneapi-asp</code> repository, where <code>Platform-Name</code> is:</p>
<ul>
<li><code>n6001</code> for Intel® FPGA SmartNIC N6001-PL reference platform</li>
<li><code>d5005</code> for Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005 reference platform</li>
<li><code>fseries-dk</code> for Agilex® 7 FPGA F-Series Development Kit (2x F-Tile)</li>
<li><code>iseries-dk</code>for Agilex® 7 FPGA I-Series Development Kit (2x R-Tile and 1xF-Tile)</li>
</ul>
<p>The build flow copies the scripts from <code>oneapi-asp/common/scripts</code> into the <code>oneapi-asp/Platform-Name/scripts</code> directory and generates the complete hardware directories for all board variants in <code>oneapi-asp</code>.</p>
<blockquote>
<p><strong>Note:</strong> For more information about the build scripts, please refer to README in <code>oneapi-asp/common/scripts</code> directory.</p>
</blockquote>
<h3 id="53-oneapi-asp-hardware-implementation"><strong>5.3 <code>oneapi-asp</code> Hardware Implementation</strong><a class="headerlink" href="#53-oneapi-asp-hardware-implementation" title="Permanent link">&para;</a></h3>
<div id="oneAPI_asp_hw_impl"></div>

<p>This section goes deeper into the current hardware architecture of the <code>oneapi-asp</code>.</p>
<p>Figure 1-3 shows a high level overview of the hardware design. <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms have different <code>board variants</code> enabling the different paths shown in Figure 1-3. Table below summarizes the board variants and paths enabled in the oneAPI ASP reference design for each. The Path numbers in the table match the ones in Figure 1-3. Figure 5-2 to 5-5 show the detailed diagram for <code>oneapi-asp</code> components in each of these board variants.</p>
<p><strong>Table 5-6: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Reference Platform Board Variants</strong></p>
<table>
<thead>
<tr>
<th>#</th>
<th>Device</th>
<th>Board Variant</th>
<th>Host to EMIF with DMA Engine (Path 1)</th>
<th>Host to Kernel Interface (Path 2)</th>
<th>Kernel to EMIF (Path 3)</th>
<th>Kernel to Unified Shared Memory (Path 4)</th>
<th>Kernel to HSSI (Path 5)</th>
<th>Figure #</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Agilex® 7 FPGA <br> Stratix 10® FPGA</td>
<td><code>oneapi-asp</code> for Agilex® 7 FPGA : <br> * ofs_n6001 <br> * ofs_fseries-dk <br> * ofs_iseries-dk <br> <code>oneapi-asp</code> for Stratix 10® FPGA : <br> * ofs_d5005</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
<td>No</td>
<td>5-2</td>
</tr>
<tr>
<td>2</td>
<td>Agilex® 7 FPGA <br> Stratix 10® FPGA</td>
<td><code>oneapi-asp</code> for Agilex® 7 FPGA : <br> * ofs_n6001_usm <br> * ofs_fseries-dk_usm <br> * ofs_iseries-dk_usm <br> <code>oneapi-asp</code> for Stratix 10® FPGA : <br> * ofs_d5005_usm</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
<td>5-3</td>
</tr>
<tr>
<td>3</td>
<td>Agilex® 7 FPGA</td>
<td><code>oneapi-asp</code> for Agilex® 7 FPGA : <br> * ofs_n6001_iopies</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>5-4</td>
</tr>
<tr>
<td>4</td>
<td>Agilex® 7 FPGA</td>
<td><code>oneapi-asp</code> for Agilex® 7 FPGA : <br> * ofs_n6001_usm_iopipes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>5-5</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note:</strong> Please see <code>oneapi-asp/Platform-Name/hardware</code> folder for the board variants for each <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platform.</p>
</blockquote>
<p><strong>Figure 5-2: <code>oneapi-asp</code> Reference Platform Hardware Design - Board Variant #1</strong></p>
<p><a class="glightbox" href="../images/HW_Implementation_Details.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Hardware Design" src="../images/HW_Implementation_Details.png" /></a></p>
<p><strong>Figure 5-3: <code>oneapi-asp</code> Reference Platform with USM Hardware Design - Board Variant #2</strong></p>
<p><a class="glightbox" href="../images/HW_USM_Implementation_Details.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Hardware Design with USM Support" src="../images/HW_USM_Implementation_Details.png" /></a></p>
<p><strong>Figure 5-4: <code>oneapi-asp</code> Reference Platform with IO Pipes Hardware Design - Board Variant #3</strong></p>
<p><a class="glightbox" href="../images/HW_IOPipes_Implementation_Details.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Hardware Design with IO Pipes" src="../images/HW_IOPipes_Implementation_Details.png" /></a></p>
<p><strong>Figure 5-5: <code>oneapi-asp</code> Reference Platform with IO Pipes and USM Hardware Design - Board Variant #4</strong></p>
<p><a class="glightbox" href="../images/HW_USM_IOPipes_Implementation_Details.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Hardware Design with IO Pipes and USM" src="../images/HW_USM_IOPipes_Implementation_Details.png" /></a></p>
<p>The <code>ofs_plat_afu.sv</code> is the top level entity for the <code>oneapi-asp</code>.</p>
<p>Hardware design files that are common for all <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms (for the components inside <code>ofs_plat_afu</code> module) are located in <code>oneapi-asp/common/hardware/common/build</code> and hardware design file specific to the individual platforms are located in the <code>oneapi-asp/Platform-Name/hardware/Board-Variant/build</code> directory. The common files are copied to the <code>oneapi-asp/Platform-Name/hardware/Board-Variant</code> folder during oneapi-asp build flow. The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> database files imported during <code>oneapi-asp</code> build (section 5.2) are located in <code>oneapi-asp/Platform-Name/hardware/Board-Variant/fim_platform</code> directory.</p>
<p>Tables 5-7 give a brief description of the important design files in all board variants, the location for these files shown in table 5-7 is post <code>oneapi-asp</code> build flow.</p>
<p><strong>Table 5-7: Hardware Design Files in <code>oneapi-asp/Platform-Name/hardware/Board-Variant/build</code></strong></p>
<table>
<thead>
<tr>
<th>Files/Folder</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>afu_ip.qsf</td>
<td>Adds platform specific settings &amp; design files, this file is sourced in the oneapi-asp revision being compiled (e.g.<code>afu_flat.qsf</code>)</td>
</tr>
<tr>
<td>mpf_vtp.qsf</td>
<td>Adds IP components from Intel® FPGA <abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr> (see section 5.3.2 below for information about use of MPF blocks from Intel® FPGA <abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr>) repository used in the design</td>
</tr>
<tr>
<td>asp_design_files.tcl</td>
<td>Adds design files to the project, this file is source in <code>afu_ip.qsf</code></td>
</tr>
<tr>
<td>ip</td>
<td>Contains the HW TCL and Verilog source code files for IP components used in the hardware design</td>
</tr>
<tr>
<td>scripts</td>
<td>Contains scripts to control oneAPI kernel and asp Quartus® software compile flow (see section 5.3.5 for more information on compile flow)</td>
</tr>
<tr>
<td>rtl</td>
<td>Contains the SystemVerilog and Verilog design files shown in figures 5-2 to 5-5 above</td>
</tr>
<tr>
<td>rtl/ofs_plat_afu.sv</td>
<td>Top level wrapper file for <code>oneapi-asp</code>. Contains the Platform Interface Manager (<abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr>) blocks for protocol translation &amp; connecting <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> ports to <code>oneapi-asp</code> ports. For more information about <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr>, see the <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr> subtopic below.</td>
</tr>
<tr>
<td>rtl/afu.sv</td>
<td>Contains the <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr> blocks for VTP address translation and instantiates the <code>kernel_wrapper</code> entity. For more information about <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr>, see the <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr> subtopic below.</td>
</tr>
<tr>
<td>rtl/kernel_wrapper.v</td>
<td>Contains the <code>kernel_system</code> instantiation</td>
</tr>
<tr>
<td>rtl/asp_logic.sv</td>
<td>Contains the DMA engine, <code>board</code> system instantiation, please see information about <code>board_hw.tcl</code>, <code>ddr_board_hw.tcl</code> and <code>ddr_channel_hw.tcl</code> below</td>
</tr>
<tr>
<td>rtl/ofs_asp.vh</td>
<td>Contains the macros to control instantiation of logic on host to memory path, logic required to enable Unified Shared Memory(USM) support and IO pipes support</td>
</tr>
<tr>
<td>rtl/ofs_asp_pkg.sv</td>
<td>Contains Verilog parameters used in controlling values of number of channels (memory/IO pipes), address widths, pipeline stages etc. for logic in the <code>oneapi-asp</code></td>
</tr>
<tr>
<td>board_hw.tcl</td>
<td>Contains the <code>Kernel Interface</code> IP instantiation, register to store board <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> ID and <code>ddr_board</code> system instantiation. Please refer to <code>ddr_board_hw.tcl</code> and <code>ddr_channel_hw.tcl</code> below. <br> &gt; <strong>Note:</strong> The board <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> ID is used by the MMD layer during board discovery</td>
</tr>
<tr>
<td>ddr_board_hw.tcl</td>
<td>Instantiated in the board_hw.tcl, contains IP components in the host to EMIF and kernel to EMIF datapath. <code>Memory Bank Divider</code> is instantiated in this file. Please refer to section 3.1.1 for more details on <code>Memory Bank Divider</code></td>
</tr>
<tr>
<td>ddr_channel_hw.tcl</td>
<td>Instantiated in ddr_board_hw.tcl, contains bridges required for clock domain crossings between PCIe and EMIF clocks as well as kernel and EMIF clock</td>
</tr>
<tr>
<td>ofs_asp.sdc</td>
<td>Contains clock group constraints for all clocks in oneAPI ASP</td>
</tr>
<tr>
<td>../fim_platform</td>
<td>Contains Platform Interface Manager(<abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr>) and <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> database used in the design. See <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr> subtopic below</td>
</tr>
</tbody>
</table>
<p>The hardware implementation diagrams show a PF/VF Mux/De-mux module in the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> region. The PF/VF mux routes packets to <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> component based on <code>pf_num</code> and <code>vf_num</code> information in PCIe TLP header. For more information about the PF/VF mux, please refer to the PF/VF Mapping details in <em>FPGA Interface Manager Technical Reference Manual</em> for your target device (links are available in section 1.3). </p>
<p>The <code>oneapi-asp</code> resides inside the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> region and, depending on the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> configuration, connects to the lowest PF or lowest VF number that routes into the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> slot. Table below summazires the PF/VF mapping in <code>oneapi-asp</code> for some of the different <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> configurations.</p>
<p><strong>Table 5-8: PF/VF Mapping in <code>oneapi-asp</code></strong></p>
<table>
<thead>
<tr>
<th>Target Device for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr></th>
<th><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Configuration*</th>
<th>PF/VF Mapping  in <code>oneapi-asp</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>Stratix 10® FPGA</td>
<td>Default</td>
<td>PF0-VF1</td>
</tr>
<tr>
<td>Agilex® 7 FPGA</td>
<td>Default</td>
<td>PF0-VF0</td>
</tr>
<tr>
<td>Agilex® 7 FPGA</td>
<td>Compiled using <code>&lt;n6001/iseries-dk&gt;_1pf_1vf.ofss</code>, i.e. PCIe Subsystem configuration is set to PF0 with 1 VF</td>
<td>PF0-VF0</td>
</tr>
<tr>
<td>Agilex® 7 FPGA</td>
<td>Compiled using <code>n6001_2pf.ofss</code>, i.e. PCIe Subsystem configuration is set to two physical functions PF0 and PF1</td>
<td>PF1</td>
</tr>
</tbody>
</table>
<blockquote>
<p>*<strong>Note:</strong> For more information on different <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> configurations &amp; how to compile these, please refer to <em>FPGA Interface Manager(<abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>) Developer Guides for Open FPGA Stack</em> for your target device (links are available in section 1.3).</p>
</blockquote>
<p>Sections below provide some more information on some blocks in the hardware design block diagram shown above. Refer to section 3.1 for more information about <code>Memory Bank Divider</code> and to section 3.2 for information about <code>Kernel Interface</code>. </p>
<h4 id="531-platform-interface-managerpim"><strong>5.3.1 Platform Interface Manager(<abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr>)</strong><a class="headerlink" href="#531-platform-interface-managerpim" title="Permanent link">&para;</a></h4>
<div id="pim"></div>

<p>In addition to above files/folders, an important part of the design are the <code>ofs_plat_*</code> modules provided by <a href="https://github.com/OFS/ofs-platform-afu-bbb">Platform Interface Manager (<abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr>)</a>. oneAPI kernel system and <code>oneapi-asp</code> have Avalon® interfaces. <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> components have AXI interfaces. The oneAPI compiler generated <code>kernel_system</code> with Avalon interfaces. The <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr> modules are used for protocol translation. </p>
<p>In addition to this, <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr> blocks are also used for Virtual to Physical (VTP) address translation. The Memory Mapped Device(MMD) layer provides virtual addresses which are converted to physical addresses by the VTP blocks to allow Unified Shared Memory(USM) and DMA transfers to/from host memory.</p>
<blockquote>
<p><strong>Note:</strong> For more information about <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr>, please refer to <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr> README <a href="https://github.com/OFS/ofs-platform-afu-bbb/blob/master/README.md">here</a>.</p>
</blockquote>
<h4 id="532-direct-memory-accessdma-module"><strong>5.3.2 Direct Memory Access(DMA) Module</strong><a class="headerlink" href="#532-direct-memory-accessdma-module" title="Permanent link">&para;</a></h4>
<div id="dma"></div>

<p>The Direct Memory Access(DMA) module is located in the host to EMIF datapath in the <code>oneapi-asp</code> and provides a controller to execute transfers from host to DDR on the board and vice versa. The source files for the DMA module used in <code>oneapi-asp</code> for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms are located in <code>oneapi-asp/Platform-Name/hardware/Board-Variant/build/rtl/dma</code> directory (location post oneapi-asp build flow). Figure below shows the DMA module interface.</p>
<p><strong>Figure 5-7: DMA Controller Block Diagram</strong></p>
<p><a class="glightbox" href="../images/dma_controller_top.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image DMA Controller Block Diagram" src="../images/dma_controller_top.png" /></a></p>
<p>Figure 5-2 shows the instantiation of this dma_top module as <code>dma_controller_inst</code>. Table 5-9 shows the signal names and descriptions. Section 5-5 covers the complete compilation flow.</p>
<p><strong>Table 5-9: DMA Module Signal Descriptions</strong></p>
<table>
<thead>
<tr>
<th>Signal or Port</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>mmio64_if</td>
<td>Control signal from host, connects to DMA Control Status Registers(CSR)</td>
</tr>
<tr>
<td>host_mem_rd_avmm_if</td>
<td>Avalon® memory-mapped interface to read from host memory</td>
</tr>
<tr>
<td>host_mem_wr_avmm_if</td>
<td>Avalon® memory-mapped interface to write to host memory</td>
</tr>
<tr>
<td>local_mem_rd_avmm_if</td>
<td>Avalon® memory-mapped interface to read from on-board DDR4 memory</td>
</tr>
<tr>
<td>local_mem_wr_avmm_if</td>
<td>Avalon® memory-mapped interface to write to on-board DDR4 memory</td>
</tr>
<tr>
<td>dma_irq_host2fpga</td>
<td>Interrupt to indicate completion of host to FPGA DMA transaction (read from host, write to DDR4)</td>
</tr>
<tr>
<td>dma_irq_fpga2host</td>
<td>Interrupt to indicate completion of FPGA DDR4 to host DMA transaction (read from DDR4, write to host)<br>&gt; <strong>Note:</strong> The <code>oneapi-asp</code> for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms uses a host memory write to indicate completion of FPGA to host transaction</td>
</tr>
</tbody>
</table>
<p>The data transfer module manages data movement from source to destination addresses.</p>
<p>To start a data transfer, the data transfer module requires following information, this is set by the <code>dma_dispatcher</code>:</p>
<ul>
<li>Source address</li>
<li>Destination address</li>
<li>Number of bytes to transfer</li>
</ul>
<p><code>oneapi-asp</code> for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms uses <em>virtual</em> addresses in the DMA controller for data transfer. The Memory Properties Factory(MPF) Virtual to Physical(VTP) blocks (i.e.<code>mpf_vtp_*</code> modules) shown in figure 5-2 translate virtual addresses to appropriate host addresses. </p>
<blockquote>
<p><strong>Note:</strong> Memory Properties Factory(MPF) is a part of Intel® FPGA Basic Building Blocks. Please refer to <a href="https://github.com/OPAE/intel-fpga-bbb/wiki/BBB_cci_mpf">Intel® FPGA <abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr> repository</a> for more information.</p>
</blockquote>
<h4 id="533-board_hwtcl-file"><strong>5.3.3 <code>board_hw.tcl</code> File</strong><a class="headerlink" href="#533-board_hwtcl-file" title="Permanent link">&para;</a></h4>
<div id="board_hw_tcl"></div>

<p>As described in table 5-7, the <code>board_hw.tcl</code> contains the <code>Kernel Interface</code> IP instantiation, register to store board <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> ID and <code>ddr_board</code> system instantiation. The <code>board_hw.tcl</code> component has a few parameters that can be used to control the internal composition. Snippet below shows the portion of the TCL script adding these parameters. These are described in table below. </p>
<pre>

# +-----------------------------------
# | parameters
# |
add_parameter NUMBER_OF_MEMORY_BANKS INTEGER 4
set_parameter_property NUMBER_OF_MEMORY_BANKS DEFAULT_VALUE 4
set_parameter_property NUMBER_OF_MEMORY_BANKS DISPLAY_NAME "Number of Memory Banks"
set_parameter_property NUMBER_OF_MEMORY_BANKS AFFECTS_ELABORATION true

add_parameter MEMORY_BANK_ADDRESS_WIDTH INTEGER 32
set_parameter_property MEMORY_BANK_ADDRESS_WIDTH DEFAULT_VALUE 32
set_parameter_property MEMORY_BANK_ADDRESS_WIDTH DISPLAY_NAME "Memory Bank Address Width"
set_parameter_property MEMORY_BANK_ADDRESS_WIDTH AFFECTS_ELABORATION true

add_parameter SNOOP_PORT_ENABLE BOOLEAN false
set_parameter_property SNOOP_PORT_ENABLE DEFAULT_VALUE false
set_parameter_property SNOOP_PORT_ENABLE DISPLAY_NAME "Enable Snoop Port"
set_parameter_property SNOOP_PORT_ENABLE AFFECTS_ELABORATION true

add_parameter MBD_TO_MEMORY_PIPE_STAGES INTEGER 0
set_parameter_property MBD_TO_MEMORY_PIPE_STAGES DEFAULT_VALUE 0
set_parameter_property MBD_TO_MEMORY_PIPE_STAGES DISPLAY_NAME "MBD to Memory Pipeline Stages"
set_parameter_property MBD_TO_MEMORY_PIPE_STAGES AFFECTS_ELABORATION true

</pre>

<p><strong>Table 5-10 <code>board_hw.tcl</code> Parameters</strong> </p>
<table>
<thead>
<tr>
<th>Parameter Name in IP TCL</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AFU_ID_H</td>
<td><abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> ID H</td>
<td>Upper 32 bits of the board <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> ID. <br> &gt; <strong>Note:</strong> The board <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> ID is used by the MMD layer during board discovery</td>
</tr>
<tr>
<td>AFU_ID_L</td>
<td><abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> ID L</td>
<td>Lower 32 bits of the board <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> ID.</td>
</tr>
<tr>
<td>IOPIPE_SUPPORT</td>
<td>IO Pipe Support</td>
<td>Boolean value used to determine if the <code>oneapi-asp</code> has IO pipes support. This must be set to true for <code>oneapi-asp</code> board variant that has the <code>channels</code> element defined in the <code>board_spec.xml</code>. Table 5-6 shows the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platform board variants that have IO pipes enabled. To ensure correct functionality, the HSSI susbsystem in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> must support the settings in the <code>oneapi-asp</code>. For more information about <code>channels</code> element refer to section 2.1.8</td>
</tr>
<tr>
<td>NUMBER_OF_MEMORY_BANKS</td>
<td>Number of Memory Banks</td>
<td>The number of homogenous memory banks in the global memory. This value is used for paramterizing the <code>ddr_board</code> system. The <code>ddr_board</code> system in <code>oneapi-asp</code> for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms has only one global memory (of type DDR4) and a single <code>Memory Bank Divider</code> instantiated. This limits the number of memory banks allowed to 1,2,4 or 8 values (<code>Memory Bank Divider</code> IP requirement). To expand global memory beyond this range, additional <code>Memory Bank Didvider</code> IP will need to be instantiated and connected in <code>ddr_board_hw.tcl</code>. For more information about <code>Memory Bank Divider</code>, please refer to section 3.1.1</td>
</tr>
<tr>
<td>MEMORY_BANK_ADDRESS_WIDTH</td>
<td>Memory Bank Address Width</td>
<td>This is the total addressable width for a single memory bank/interface in the global memory. For example, if the global memory consists of 32 GB on-board DDR4 memory with four 8 GB memory banks, then this memory bank address width parameter must be set to 33 (single 8 GB channel is considered). This value is used for paramterizing the <code>ddr_board</code> system.</td>
</tr>
<tr>
<td>SNOOP_PORT_ENABLE</td>
<td>Enable Snoop Port</td>
<td>Used to enable the <code>acl_asp_snoop</code> port for <code>Memory Bank Divider</code>, for more information about <code>acl_asp_snoop</code> port, refer to Table 3-2</td>
</tr>
<tr>
<td>MBD_TO_MEMORY_PIPE_STAGES</td>
<td>MBD to Memory Pipeline Stages</td>
<td>Value is used to set the number of Avalon-MM pipeline bridges between Memory Bank Divider and the PCIe clock domain to EMIF clock domain clock crossing bridge</td>
</tr>
</tbody>
</table>
<p>The internal component instantiations and connections are done in the composition callback (<code>compose</code> procedure) in <code>board_hw.tcl</code>. The above parameter values are used for the <code>ddr_board</code> instantiation. </p>
<p>For more information about the different component commands and callback used in <code>board_hw.tcl</code>, <code>ddr_board_hw.tcl</code> and <code>ddr_channel.tcl</code>, please refer to the <a href="https://www.intel.com/content/www/us/en/docs/programmable/683609/current/component-interface-tcl-reference.html">Quartus® Prime Pro Edition User Guide: Platform Designer</a>(<em>Component Interface Tcl Reference</em> section)</p>
<h4 id="534-user-datagram-protocoludp-engine"><strong>5.3.4 User Datagram Protocol(UDP) Engine</strong><a class="headerlink" href="#534-user-datagram-protocoludp-engine" title="Permanent link">&para;</a></h4>
<div id="udp_engine"></div>

<p>I/O pipes allow kernel to stream data directly using HSSI. To demonstrate this functionality, reference design in <code>oneapi-asp</code> repository (refer to Figure 5-4 and 5-5) has a UDP protocol engine to allow transmitting UDP/IP packets over HSSI..</p>
<p>Figure below shows a simple block diagram of the UDP engine.</p>
<p><strong>Figure 5-8: UDP Offload Engine</strong></p>
<p><a class="glightbox" href="../images/udp_engine.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="UDP Offload Engine" src="../images/udp_engine.png" /></a></p>
<p>The UDP engine consists of a separate receive (<code>rx</code>) and trasmit (<code>tx</code>) path. The following functionalilty is performed by this reference design engine:</p>
<ul>
<li>Implements an Address Resolution Protocol (ARP) functionality to respond to be able to send &amp; respond to ARP requests. This is needed for routing between different subnets using a gateway. </li>
<li>Packetizes data from kernel to add the required header information (for MAC, IP &amp; UDP layers) </li>
<li>Extracts data from packets received by removing header information</li>
<li>Handles clock crossing between kernel clock and Ethernet MAC clock domains</li>
</ul>
<p>The source files for UDP engine used in <code>oneapi-asp</code> for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platform are located in <code>oneapi-asp/Platform-Name/hardware/Board-Variant/build/rtl/udp_offload_engine</code> directory.</p>
<blockquote>
<p><strong>Note:</strong> The same engine is used in the board variant with USM shown in Figure 5-5. </p>
</blockquote>
<h4 id="535-hardware-compile-flow"><strong>5.3.5 Hardware Compile Flow</strong><a class="headerlink" href="#535-hardware-compile-flow" title="Permanent link">&para;</a></h4>
<div id="compile_flow"></div>

<p>Figure below shows the compile flow overview; the oneAPI compiler generated hardware circuit is compiled by Quartus® software along with design files for <code>oneapi-asp</code>.</p>
<p><strong>Figure 5-9: oneAPI Compile Flow Overview</strong></p>
<p><a class="glightbox" href="../images/Compile_Flow_Overvew.PNG" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image_Compile_Flow_Overvew" src="../images/Compile_Flow_Overvew.PNG" /></a></p>
<p>The oneAPI compiler uses the <code>board_spec.xml</code> to get more information about the <code>oneapi-asp</code> configuration. <code>board_spec.xml</code> file has a <code>compile</code> element to allow control of the Quartus® software compilation flow. The attributes of this element are discussed in section 2.1.2. The <code>oneapi-asp</code> uses tcl scripts to control the Quartus® software compilation flow. Figure 5-10 shows the flow and scripts used. All compilation scripts are located in <code>oneapi-asp/Platform-Name/hardware/Board-Variant/build/scripts</code> folder (location post oneapi-asp build flow).</p>
<p><strong>Figure 5-10: Compilation Scripts in <code>oneapi-asp</code></strong></p>
<p><a class="glightbox" href="../images/Compile_flow_scripts.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Compile Flow Scripts Image" src="../images/Compile_flow_scripts.png" /></a></p>
<p>Table 5-11 summarizes notes for reference numbers 1-2 marked in figure above.</p>
<p><strong>Table 5-11: Notes for Reference Numbers in Figure 5-10</strong></p>
<table>
<thead>
<tr>
<th>Reference Number</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>revision_name is <code>afu_flat</code> for <code>oneapi-asps</code> for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms</td>
</tr>
<tr>
<td>2</td>
<td><code>gen-asp-quartus-report.tcl</code> script generates a report (<code>acl_quartus_report.txt</code>) containing resource utilization and kernel clock frequency summary</td>
</tr>
</tbody>
</table>
<h3 id="54-oneapi-asp-memory-mapped-devicemmd-layer-implementation"><strong>5.4 <code>oneapi-asp</code> Memory Mapped Device(MMD) Layer Implementation</strong><a class="headerlink" href="#54-oneapi-asp-memory-mapped-devicemmd-layer-implementation" title="Permanent link">&para;</a></h3>
<div id="mmd_impl"></div>

<p>As discussed in section 4.1, the MMD provides a set of API that allow the runtime to control the device and communicate with it.</p>
<p>The source code for MMD layer is located in <code>oneapi-asp/common/source/host</code> folder. <code>aocl_mmd.h</code> is the header file for the implemented API and is located in <code>oneapi-asp/common/source/include</code> folder. Table below summarizes the APIs that have been implemented in <code>oneapi-asp</code> for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms.</p>
<blockquote>
<p><strong>Note:</strong> For more details about the API, its arguments and enums please refer to the <code>aocl_mmd.h</code> file and to section 4.1.</p>
</blockquote>
<p><strong>Table 5-12: MMD API Implemented in <code>oneapi-asp</code> for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Reference Platforms</strong></p>
<table>
<thead>
<tr>
<th>API</th>
</tr>
</thead>
<tbody>
<tr>
<td>aocl_mmd_get_offline_info</td>
</tr>
<tr>
<td>aocl_mmd_get_info</td>
</tr>
<tr>
<td>aocl_mmd_open</td>
</tr>
<tr>
<td>aocl_mmd_close</td>
</tr>
<tr>
<td>aocl_mmd_set_interrupt_handler</td>
</tr>
<tr>
<td>aocl_mmd_set_status_handler</td>
</tr>
<tr>
<td>aocl_mmd_yield</td>
</tr>
<tr>
<td>aocl_mmd_read</td>
</tr>
<tr>
<td>aocl_mmd_write</td>
</tr>
<tr>
<td>aocl_mmd_copy</td>
</tr>
<tr>
<td>aocl_mmd_program</td>
</tr>
<tr>
<td>aocl_mmd_host_alloc</td>
</tr>
<tr>
<td>aocl_mmd_free</td>
</tr>
<tr>
<td>aocl_mmd_shared_alloc</td>
</tr>
<tr>
<td>aocl_mmd_shared_migrate</td>
</tr>
</tbody>
</table>
<p>The implementation of these APIs is in <code>oneapi-asp/common/source/host/mmd.cpp</code>. The functions used in the implementation are distributed across various source files. Table below provides details on source code files.</p>
<p><strong>Table 5-13: MMD Source Code Files</strong></p>
<table>
<thead>
<tr>
<th>Files/Folder</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>mmd.cpp</td>
<td>This file has the implementation for all MMD API calls listed in table 5-12</td>
</tr>
<tr>
<td>fpgaconf.h<br>fpgaconf.c</td>
<td>Contains bitstream reconfiguration function declaration(.h) &amp; definition(.c)</td>
</tr>
<tr>
<td>kernel_interrupt.h</td>
<td>Contains <code>KernelInterrupt</code> class declaration; the class consists of functions to handle kernel interrupts</td>
</tr>
<tr>
<td>kernel_interrupt.cpp</td>
<td>Contains <code>KernelInterrupt</code> class constructor and function definitions</td>
</tr>
<tr>
<td>mmd_device.h</td>
<td>Contains <code>Device</code> class declaration, which stores device data and has functions to interact with the device</td>
</tr>
<tr>
<td>mmd_device.cpp</td>
<td>Contains <code>Device</code> class constructor and function definitions</td>
</tr>
<tr>
<td>mmd_dma.h<br>mmd_dma.cpp</td>
<td>Contain DMA functions declaration(.h) &amp; definition(.cpp)</td>
</tr>
<tr>
<td>mmd_iopipes.h</td>
<td>Contains the <code>iopipes</code> class declaration(.h)</td>
</tr>
<tr>
<td>mmd_iopipes.cpp</td>
<td>Contains function definitions, these functions include <code>iopipes</code> class constructor as well as fucntions to detect and setup CSR space for IO pipes feature in board variants that support IO pipes</td>
</tr>
<tr>
<td>zlib_inflate.h<br>zlib_inflate.c</td>
<td>Function declaration(.h) and definition(.c) for decompressing bitstream data</td>
</tr>
<tr>
<td>CMakeLists.txt</td>
<td>CMakeLists.txt file for building MMD source code</td>
</tr>
</tbody>
</table>
<p>The build flow scripts build the MMD library, i.e. <code>libintel_opae_mmd</code>, and place them in <code>oneapi-asp/Platform-Name/linux64/lib</code> folder. The MMD library is specified as part of <code>mmdlib</code>, <code>linklibs</code> element in <code>board_env.xml</code> and used at runtime (refer to section 5-1 for sample <code>board_env.xml</code> file and section 2.2 for more information about <code>board_env.xml</code> elements).</p>
<p><strong>Use of OPAE library in MMD</strong></p>
<div id="opae_in_mmd"></div>

<p>The MMD layer uses API from <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> for various device operations. Hence, the MMD layers requires OPAE library to be loaded to execute successfully. The <code>mmdlib</code> element specifies the <code>libopae-c</code> library to be loaded before the MMD library (demonstrated in sample <code>board_env.xml</code> in section 5-1).</p>
<blockquote>
<p><strong>Note:</strong> Please refer to <a href="https://ofs.github.io/ofs-2024.1-1/hw/common/reference_manual/ofs_sw/mnl_sw_ofs/">Software Reference Manual: Open FPGA Stack</a> for more information about <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> API. The document also has information about linux-dfl driver.</p>
</blockquote>
<p><strong>Use of Memory Properties Factory(MPF) library in MMD</strong></p>
<div id="mpf_in_mmd"></div>

<p>In addition to OPAE, the MMD also uses API from Memory Properties Factory(MPF) software for memory operations. The <code>libMPF</code> library is compiled as part of <code>oneapi-asp</code> build flow and placed in <code>oneapi-asp/Platform-Name/linux64/lib</code>. This library is also loaded before the MMD library by specifying before <code>libintel_opae_mmd</code> in <code>mmdlib</code> element in <code>board_env.xml</code>.</p>
<blockquote>
<p><strong>Note:</strong> Memory Properties Factory(MPF) is a part of Intel® FPGA <abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr>. Please refer to <a href="https://github.com/OPAE/intel-fpga-bbb">Intel® FPGA <abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr> wiki</a> for more information about MPF.</p>
</blockquote>
<h3 id="55-oneapi-asp-utilities-implementation"><strong>5.5 <code>oneapi-asp</code> Utilities Implementation</strong><a class="headerlink" href="#55-oneapi-asp-utilities-implementation" title="Permanent link">&para;</a></h3>
<div id="util_impl"></div>

<p>This section covers the implementation of board utilities (refer to section 4.2 for more information on board utilities) in <code>oneapi-asp</code> for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms.</p>
<p>Table below shows the source code/script locations for the utilities.</p>
<p><strong>Table 5-14: <code>oneapi-asp</code> Utilities Source Code Locations</strong></p>
<table>
<thead>
<tr>
<th>Utility</th>
<th>Source Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>diagnose</td>
<td><code>oneapi-asp/common/source/util/diagnostic</code></td>
</tr>
<tr>
<td>program</td>
<td><code>oneapi-asp/common/source/util/reprogram</code></td>
</tr>
<tr>
<td>install<br>uninstall<br>initialize<br>&gt; <strong>Note: These are executable scripts</strong></td>
<td><code>oneapi-asp/common/linux64/libexec/</code> (copied to <code>oneapi-asp/Platform-Name/linux64/libexec/</code> during oneapi-asp build flow, for more information about oneapi-asp build flow, refer to section 5.2)</td>
</tr>
</tbody>
</table>
<p><code>diagnose</code> and <code>program</code> are compiled as part of the <code>oneapi-asp</code> build flow and executables are placed in <code>oneapi-asp/Platform-Name/linux64/libexec/</code>. A <code>CMakeLists.txt</code> file is provided for building the utilities, located in <code>oneapi-asp/common/source/util</code> directory.</p>
<p>The path to all of the above utility executables is used in <code>utilbinder</code> element in <code>board_env.xml</code> (demonstrated in sample <code>board_env.xml</code> in section 5-1). The runtime uses this when the corresponding <code>aocl</code> utility is invoked.</p>
<p>Brief descriptions for the source code files are given in table below.</p>
<p><strong>Table 5-15: Brief Descriptions of <code>oneapi-asp</code> Utility Routines for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Reference Platforms</strong></p>
<table>
<thead>
<tr>
<th>File</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>setup_permissions.sh</td>
<td>Helper script to configure correct device port permissions, make changes to allow users to lock pages in memory and set the hugepages required for the software stack to function correctly. The helper script is used by <code>install</code>, <code>initialize</code> routines</td>
</tr>
<tr>
<td>install</td>
<td>install routine invokes the <code>setup_permissions.sh</code> script after the FPGA Client Driver (FCD) is setup by the runtime</td>
</tr>
<tr>
<td>uninstall</td>
<td>uninstall routine reverts the port permission, memory locking and hugepage setting changes performed by <code>install</code> routine and is invoked by runtime after the FCD is removed by runtime</td>
</tr>
<tr>
<td>initialize</td>
<td>initialize routine performs the following steps:<br> * looks for the initialization binary for the board variant to be initialized<br> * extracts the FPGA hardware configuration file from the oneAPI fat binary using <code>clang-offload-extract</code> command provided by oneAPI Base Toolkit (Base Kit) version 2024.0 and beyond <br> * invokes the <code>setup_permissions.sh</code> script to set correct device permissions<br> * performs partial reconfiguration of the FPGA device by invoking <code>program</code> routine with the initialization bitstream as an argument <br> &gt;<strong>Note:</strong> For more information about how <code>initialize</code> utility extracts FPGA hardware configuration file from oneAPI fat binary, refer to <a href="https://www.intel.com/content/www/us/en/docs/oneapi-fpga-add-on/developer-guide/current/extracting-the-fpga-hardware-configuration-aocx.html">Intel® oneAPI DPC++/C++ Compiler Handbook for Intel® FPGAs</a></td>
</tr>
<tr>
<td>program</td>
<td><code>program</code> routine allocates memory and loads the supplied initialization bitstream in memory followed by a call to reprogramming function provided by <code>oneapi-asp's</code> MMD library. The MMD library uses <code>fpgaReconfigureSlot</code> API provided by OPAE library to perform device reconfiguration<br>&gt; <strong>Note:</strong> Please refer to <a href="https://ofs.github.io/ofs-2024.1-1/hw/common/reference_manual/ofs_sw/mnl_sw_ofs/">Software Reference Manual: Open FPGA Stack</a> for more information about <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> API</td>
</tr>
<tr>
<td>diagnose</td>
<td><code>diagnose</code> routine scans for the available devices for the installed platform and performs DMA transactions between host &amp; device. It also reports the DMA transfer bandwidth. <code>diagnose</code> routine uses functions provided by the MMD library for scanning &amp; opening connection to available devices</td>
</tr>
</tbody>
</table>
<h2 id="appendix"><strong>Appendix</strong><a class="headerlink" href="#appendix" title="Permanent link">&para;</a></h2>
<div id="appendix"></div>

<h3 id="appendix-a-memory-mapped-devicemmd-layer-debug-variables"><strong>Appendix A: Memory Mapped Device(MMD) Layer Debug Variables</strong><a class="headerlink" href="#appendix-a-memory-mapped-devicemmd-layer-debug-variables" title="Permanent link">&para;</a></h3>
<div id="appendix"></div>

<p>The Memory Mapped Device(MMD) layer provides debug capability for custom ASP and oneAPI application developers. Snippet below shows how to set the variable and table below documents the environment variables that can be used to get debug information from the MMD layer at runtime.</p>
<pre>

export MMD_&ltDMA/ENABLE/PROGRAM&gt_DEBUG = 1
.&ltoneapi-binary&gt # Execute sample with MMD debug environment variable set 

</pre>

<p><strong>Table A-1: Environment Variable to Enable Debug Information in MMD</strong></p>
<table>
<thead>
<tr>
<th>Environment Variable</th>
<th>Set to Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>MMD_DMA_DEBUG</td>
<td>1</td>
<td>Set this environment variable to see debug information for Direct Memory Access (DMA) transactions</td>
</tr>
<tr>
<td>MMD_PROGRAM_DEBUG</td>
<td>1</td>
<td>Set this environment variable to see debug information when the MMD reprograms the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region</td>
</tr>
<tr>
<td>MMD_ENABLE_DEBUG</td>
<td>1</td>
<td>Set this to see debug information for all steps in the MMD layer. Maximum debug information is printed when this environment variable is set&lt;&gt;</td>
</tr>
</tbody>
</table>
<p>In addition to the debug variables provided by the MMD layer, there are debug variables provided by the Intel® FPGA Runtime for OpenCL™ Software Technology used in oneAPI base toolkit. For a full list of runtime debug variables, please refer to the Intel® FPGA Runtime for OpenCL™ Software Technology <a href="https://github.com/intel/fpga-runtime-for-opencl?tab=readme-ov-file#debug-environment-variables">README</a>.</p>
<h2 id="document-revision-history"><strong>Document Revision History</strong><a class="headerlink" href="#document-revision-history" title="Permanent link">&para;</a></h2>
<div id="doc_rev_history"></div>

<table>
<thead>
<tr>
<th>Date</th>
<th>Release</th>
<th>Changes</th>
</tr>
</thead>
<tbody>
<tr>
<td>May 26, 2023</td>
<td>2023.1</td>
<td>First release of <em>oneAPI Accelerator Support Package(ASP) Reference Manual: Open FPGA Stack</em> on https://ofs.github.io/</td>
</tr>
<tr>
<td>September 15, 2023</td>
<td>2023.2</td>
<td>1. Section 1:<br> * Updated Figure 1-3 to add HSSI path<br> 2. Section 2:<br> * Added <code>channels</code> element in figure 2-1 and table 2-1, added information about board variants below this table<br> * Added Section 2.1.8 on <code>channels</code> element<br> 3. Section 4:<br> * Added information about MMD API (table 4-1) and new sections 4.1.1 to 4.1.21<br> 4. Section 5:<br> * Moved <code>oneapi-asp</code> build flow information into new section 5.2<br> * Added new table 5-6 with oneAPI ASP board variants information<br> * Added hardware design diagrams and information about new board variants with I/O pipes support (Hardware Design with IO Pipes and Hardware Design with IO Pipes and USM)<br> * Updated hardware design diagrams to show PF/VF Mux/De-mux and added information about PF/VF mapping in section 5.3<br> * Added new section on UDP engine (section 5.3.4)<br> * Updated figure 5-10 to remove <code>import_opencl_kernel.tcl</code> and <code>add_bbb_to_pr_project.tcl</code><br> * Updated table 5-13 to add <code>mmd_iopipes.h</code> and <code>mmd_iopipes.cpp</code> files</td>
</tr>
<tr>
<td>Dec 13, 2023</td>
<td>2023.3-1</td>
<td>1. Section 2:<br> * Update table 2-5 to add information about port parameter<br> * Added new section 2.1.4.1 on port parameter<br> * Update table &amp; figure numbers<br> * Changed "master" and "slave" ports to "host" &amp; "agent" ports in figures<br> 2. Section 4:<br> * Added new executable call supported by initialize utility<br> 3. Section 5:<br> * Updated <code>initialize</code> utility information to add <code>clang-offload-extract</code>command usage<br> * Updated table with hardware design files information, added information about ofs_asp.sdc<br> * Updated compile flow diagram, added information about new <code>gen-asp-quartus-report.tcl</code> script<br> * Updated hardware implementation diagrams for signal name and IP name changes, replaced <code>mem_if_vtp</code> block with <code>host_mem_if_vtp</code><br> * Updated <code>OpenCL Memory Bank Divider</code> to <code>Memory Bank Divider</code><br> * Updated <code>OpenCL Kernel Interface</code> to <code>Kernel Interface</code></td>
</tr>
<tr>
<td>Feb 2, 2024</td>
<td>2023.3-2</td>
<td>1. Section 5:<br> * Updated Table 5-8 to add PF/VF mapping for different <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> configurations</td>
</tr>
<tr>
<td>Mar 19, 2024</td>
<td>2024.1</td>
<td>1. Section 1:<br> * Added links for <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> developer guides for Agilex® 7 FPGA F-Series Development Kit (2x F-Tile) and Agilex® 7 FPGA I-Series Development Kit (2x R-Tile and 1xF-Tile)<br> * Added link to Intel® oneAPI DPC++/C++ Compiler Handbook for Intel® FPGAs<br> * Updated figure 1-3 to rename <code>OpenCL Memory Bank Divider</code> to <code>Memory Bank Divider</code><br> 2. Section 2:<br> * Replaced links to FPGA Optimization Guide for Intel® oneAPI Toolkits with links to Intel® oneAPI DPC++/C++ Compiler Handbook for Intel® FPGAs<br> * Fixed format for table 2-6 <br> * Updated figure 2-6 to rename <code>OpenCL Memory Bank Divider</code> to <code>Memory Bank Divider</code><br> 3. Section 3:<br> * Updated <code>Memory Bank Divider</code>section to add information about <code>memory_bank_divider_hw.tcl</code>. Replaced figure showing GUI for the IP with parameters in <code>memory_bank_divider_hw.tcl</code> and added information about these parameters in table 3-1 <br> * Updated port name <code>acl_bsp_snoop</code> to <code>acl_asp_snoop</code>and <code>acl_bsp_memorg_host</code> to <code>acl_asp_memorg_host</code> in table 3-2<br> * Updated <code>Kernel Interface</code> section to add information about <code>kernel_interface_hw.tcl</code>. Replaced figure showing GUI for the IP with parameters in <code>kernel_interface_hw.tcl</code> and added information about these parameters in table 3-3<br> 4. Section 5:<br> * Replaced <code>board_env.xml</code> figure with code snippet<br> * Added links to README for <code>fseries-dk</code> &amp; <code>iseries-dk</code> oneapi-asp folders in section 5.1<br> * Updated directory structure in section 5.1 and added information about design files common to oneapi-asp for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms<br> * Update file paths in table 5-2<br> * Update section for script file name changes from <code>build-bsp.sh</code> to <code>build-asp.sh</code>, <code>setup-bsp.py</code> to <code>setup-asp.py</code>, <code>build-bsp-sw.sh</code> to <code>build-asp-sw.sh</code><br> * Updated figure 5-2 to add a step in <code>build-asp.sh</code> script to copy common files to platform directory<br> * Added Note on <code>OPAE_SDK_REPO_BRANCH</code> environment variable in table 5-5<br> * Added new <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platforms (<code>fseries-dk</code> and <code>iseries-dk</code>) in table 5-6<br> * Update section for design file name changes from <code>board.qsys</code> to <code>board_hw.tcl</code>, <code>ddr_board.qsys</code> to <code>ddr_board_hw.tcl</code>, <code>ddr_channel.qsys</code> to <code>ddr_channel_hw.tcl</code>, <code>bsp_logic.sv</code> to <code>asp_logic.sv</code>, <code>bsp_design_files.tcl</code> to <code>asp_design_files.tcl</code><br> * Updated signal names <code>bsp_mem_if</code> to <code>asp_mem_if</code>, <code>acl_bsp_memorg_host</code> to <code>acl_asp_memorg_host</code>, <code>host_mem_if_pa_bsp</code> to <code>host_mem_if_pa_asp</code><br> * Updated hardware implementation diagrams (figure 5-2 to 5-5) for new file, signal names<br> * Added information about RTL files to table 5-7<br> * Added <code>iseries-dk_1pf_1vf.ofss</code> in table 5-8<br> * Fixed section 5.3.1 header and added more information about <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr> blocks in section 5.3.1<br> * Added new section 5.3.3 on <code>board_hw.tcl</code><br> * Updated figure 5-10 to add information about <code>ip-deploy</code> and <code>qsys-generate</code> for <code>board_hw.tcl</code><br> 5. Appendix: <br> * Added appendix section with MMD debug variable information</td>
</tr>
</tbody>
</table>
<h2 id="notices-disclaimers">Notices &amp; Disclaimers<a class="headerlink" href="#notices-disclaimers" title="Permanent link">&para;</a></h2>
<p>Intel<sup>&reg;</sup> technologies may require enabled hardware, software or service activation.
No product or component can be absolutely secure. 
Performance varies by use, configuration and other factors.
Your costs and results may vary. 
You may not use or facilitate the use of this document in connection with any infringement or other legal analysis concerning Intel products described herein. You agree to grant Intel a non-exclusive, royalty-free license to any patent claim thereafter drafted which includes subject matter disclosed herein.
No license (express or implied, by estoppel or otherwise) to any intellectual property rights is granted by this document, with the sole exception that you may publish an unmodified copy. You may create software implementations based on this document and in compliance with the foregoing that are intended to execute on the Intel product(s) referenced in this document. No rights are granted to create modifications or derivatives of this document.
The products described may contain design defects or errors known as errata which may cause the product to deviate from published specifications.  Current characterized errata are available on request.
Intel disclaims all express and implied warranties, including without limitation, the implied warranties of merchantability, fitness for a particular purpose, and non-infringement, as well as any warranty arising from course of performance, course of dealing, or usage in trade.
You are responsible for safety of the overall system, including compliance with applicable safety-related requirements or standards. 
<sup>&copy;</sup> Intel Corporation.  Intel, the Intel logo, and other Intel marks are trademarks of Intel Corporation or its subsidiaries.  Other names and brands may be claimed as the property of others. </p>
<p>OpenCL and the OpenCL logo are trademarks of Apple Inc. used by permission of the Khronos Group™. </p>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.indexes", "search.suggest", "search.highlight", "content.code.copy", "navigation.indexes", "toc.follow"], "search": "../../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "ofs-2023.1", "provider": "mike"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.fac441b0.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>