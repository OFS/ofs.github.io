
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../../../ftile_devkit/dev_guides/fim_dev/ug_ofs_ftile_dk_fim_dev/">
      
      
        <link rel="next" href="../../hps_dev/hps_developer_ug/">
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.9">
    
    
      
        <title>PCIe Attach F-Series (P-Tile/E-Tile) - OFS</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.85bb2934.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#shell-developer-guide-for-open-fpga-stack-intel-fpga-smartnic-n6000-pl-intel-fpga-smartnic-n6001-pl-pcie-attach" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="OFS" class="md-header__button md-logo" aria-label="OFS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OFS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PCIe Attach F-Series (P-Tile/E-Tile)
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ofs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ofs
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../common/user_guides/ug_fpga_developer/ug_fpga_developer/" class="md-tabs__link">
        Start Here
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../doc_modules/contents_s10_pcie_attach/" class="md-tabs__link">
        Stratix® 10 PCIe Attach OFS
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../doc_modules/contents_agx7_pcie_attach/" class="md-tabs__link md-tabs__link--active">
        Agilex® 7 PCIe Attach OFS
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../doc_modules/contents_agx7_soc_attach/" class="md-tabs__link">
        Agilex SoC Attach OFS
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../common/user_guides/oneapi_asp/ug_oneapi_asp/" class="md-tabs__link">
        oneAPI
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../common/reference_manual/ofs_sw/mnl_sw_ofs/" class="md-tabs__link">
        OFS Software
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="OFS" class="md-nav__button md-logo" aria-label="OFS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    OFS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ofs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ofs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Start Here
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Start Here
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_fpga_developer/ug_fpga_developer/" class="md-nav__link">
        FPGA Developer Journey Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../doc_modules/Glossary/" class="md-nav__link">
        Glossary
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Stratix® 10 PCIe Attach OFS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Stratix® 10 PCIe Attach OFS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../doc_modules/contents_s10_pcie_attach/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../d5005/adp_board_installation_guidelines/" class="md-nav__link">
        Board Installation Guide (Intel® FPGA PAC D5005)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/sw_installation/pcie_attach/sw_install_pcie_attach/" class="md-nav__link">
        Software Installation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/user_guides/ug_qs_ofs_d5005/ug_qs_ofs_d5005/" class="md-nav__link">
        Getting Started Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/user_guides/ug_eval_ofs_d5005/ug_eval_script_ofs_d5005/" class="md-nav__link">
        Automated Evaluation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/reference_manuals/ofs_fim/mnl_fim_ofs_d5005/" class="md-nav__link">
        Shell Technical Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/dev_guides/fim_dev/ug_dev_fim_ofs_d5005/" class="md-nav__link">
        Shell Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
          Workload Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_8">
          <span class="md-nav__icon md-icon"></span>
          Workload Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/dev_guides/afu_dev/ug_dev_afu_d5005/" class="md-nav__link">
        Workload Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../d5005/ug_dev_pim_based_afu/" class="md-nav__link">
        PIM Based AFU Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../d5005/ug_dev_afu_sim_env/" class="md-nav__link">
        AFU Simulation Environment User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/user_guides/ug_sim_ofs_d5005/ug_sim_ofs_d5005/" class="md-nav__link">
        Simulation User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_10" id="__nav_3_10_label" tabindex="0">
          Virtualization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_10">
          <span class="md-nav__icon md-icon"></span>
          Virtualization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../d5005/ug_docker/" class="md-nav__link">
        Docker User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../d5005/ug_kvm/" class="md-nav__link">
        KVM User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Agilex® 7 PCIe Attach OFS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Agilex® 7 PCIe Attach OFS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../doc_modules/contents_agx7_pcie_attach/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          Board Installation Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Board Installation Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../n6001/adp_board_installation_guidelines/" class="md-nav__link">
        Intel® FPGA SmartNIC N6000/1-PL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/board_installation/devkit_board_installation/devkit_board_installation_guidelines/" class="md-nav__link">
        Agilex® 7 FPGA I-Series and F-Series Development Kits
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/sw_installation/pcie_attach/sw_install_pcie_attach/" class="md-nav__link">
        Software Installation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
          Getting Started Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Getting Started Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../iseries_devkit/user_guides/ug_qs_ofs_iseries/ug_qs_ofs_iseries/" class="md-nav__link">
        OFS for Agilex® 7 FPGA I-Series Development Kit (2xR-Tile,1xF-Tile)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ftile_devkit/user_guides/ug_qs_ofs_ftile/ug_qs_ofs_ftile/" class="md-nav__link">
        OFS for Agilex® 7 FPGA F-Series Development Kit (2xF-Tile)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/" class="md-nav__link">
        OFS for Intel® FPGA SmartNIC N6001-PL
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_eval_script_ofs_agx7_pcie_attach/ug_eval_script_ofs_agx7_pcie_attach/" class="md-nav__link">
        Automated Evaluation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference_manuals/ofs_fim/mnl_fim_ofs_n6001/" class="md-nav__link">
        Shell Technical Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" checked>
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
          Shell Developer Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4_7">
          <span class="md-nav__icon md-icon"></span>
          Shell Developer Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../iseries_devkit/dev_guides/fim_dev/ug_ofs_iseries_dk_fim_dev/" class="md-nav__link">
        PCIe Attach I-Series (2xR-Tile, F-Tile)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ftile_devkit/dev_guides/fim_dev/ug_ofs_ftile_dk_fim_dev/" class="md-nav__link">
        PCIe Attach F-Series (2xF-Tile)
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          PCIe Attach F-Series (P-Tile/E-Tile)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        PCIe Attach F-Series (P-Tile/E-Tile)
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    1. Introduction
  </a>
  
    <nav class="md-nav" aria-label="1. Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-about-this-document" class="md-nav__link">
    1.1. About This Document
  </a>
  
    <nav class="md-nav" aria-label="1.1. About This Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111-knowledge-pre-requisites" class="md-nav__link">
    1.1.1 Knowledge Pre-Requisites
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-fim-development-theory" class="md-nav__link">
    1.2. FIM Development Theory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#121-default-fim-features" class="md-nav__link">
    1.2.1 Default FIM Features
  </a>
  
    <nav class="md-nav" aria-label="1.2.1 Default FIM Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1211-top-level" class="md-nav__link">
    1.2.1.1 Top Level
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1212-interfaces" class="md-nav__link">
    1.2.1.2 Interfaces
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1213-subsystems" class="md-nav__link">
    1.2.1.3 Subsystems
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1214-host-exercisers" class="md-nav__link">
    1.2.1.4 Host Exercisers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1215-module-access-via-apfbpf" class="md-nav__link">
    1.2.1.5 Module Access via APF/BPF
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122-customization-options" class="md-nav__link">
    1.2.2 Customization Options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-development-environment" class="md-nav__link">
    1.3 Development Environment
  </a>
  
    <nav class="md-nav" aria-label="1.3 Development Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131-development-tools" class="md-nav__link">
    1.3.1 Development Tools
  </a>
  
    <nav class="md-nav" aria-label="1.3.1 Development Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1311-walkthrough-install-quartus-prime-pro-software" class="md-nav__link">
    1.3.1.1 Walkthrough: Install Quartus Prime Pro Software
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132-fim-source-files" class="md-nav__link">
    1.3.2 FIM Source Files
  </a>
  
    <nav class="md-nav" aria-label="1.3.2 FIM Source Files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1321-walkthrough-clone-fim-repository" class="md-nav__link">
    1.3.2.1 Walkthrough: Clone FIM Repository
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#133-environment-variables" class="md-nav__link">
    1.3.3 Environment Variables
  </a>
  
    <nav class="md-nav" aria-label="1.3.3 Environment Variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1331-walkthrough-set-development-environment-variables" class="md-nav__link">
    1.3.3.1 Walkthrough: Set Development Environment Variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#134-walkthrough-set-up-development-environment" class="md-nav__link">
    1.3.4 Walkthrough: Set Up Development Environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-fim-compilation" class="md-nav__link">
    2. FIM Compilation
  </a>
  
    <nav class="md-nav" aria-label="2. FIM Compilation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-compilation-theory" class="md-nav__link">
    2.1 Compilation Theory
  </a>
  
    <nav class="md-nav" aria-label="2.1 Compilation Theory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211-fim-build-script" class="md-nav__link">
    2.1.1 FIM Build Script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2111-build-work-directory" class="md-nav__link">
    2.1.1.1 Build Work Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2112-null-host-exercisers" class="md-nav__link">
    2.1.1.2 Null Host Exercisers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#212-ofss-file-usage" class="md-nav__link">
    2.1.2 OFSS File Usage
  </a>
  
    <nav class="md-nav" aria-label="2.1.2 OFSS File Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2121-platform-ofss-file" class="md-nav__link">
    2.1.2.1 Platform OFSS File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2122-ofs-ip-ofss-file" class="md-nav__link">
    2.1.2.2 OFS IP OFSS File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2123-pcie-ip-ofss-file" class="md-nav__link">
    2.1.2.3 PCIe IP OFSS File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2124-iopll-ip-ofss-file" class="md-nav__link">
    2.1.2.4 IOPLL IP OFSS File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2125-memory-ip-ofss-file" class="md-nav__link">
    2.1.2.5 Memory IP OFSS File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2126-hssi-ip-ofss-file" class="md-nav__link">
    2.1.2.6 HSSI IP OFSS File
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#213-ofs-build-script-outputs" class="md-nav__link">
    2.1.3 OFS Build Script Outputs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-compilation-flows" class="md-nav__link">
    2.2 Compilation Flows
  </a>
  
    <nav class="md-nav" aria-label="2.2 Compilation Flows">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221-flat-fim" class="md-nav__link">
    2.2.1 Flat FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222-in-tree-pr-fim" class="md-nav__link">
    2.2.2 In-Tree PR FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#223-out-of-tree-pr-fim" class="md-nav__link">
    2.2.3 Out-of-Tree PR FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#225-walkthrough-compile-ofs-fim" class="md-nav__link">
    2.2.5 Walkthrough: Compile OFS FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#226-walkthrough-manually-generate-ofs-out-of-tree-pr-fim" class="md-nav__link">
    2.2.6 Walkthrough: Manually Generate OFS Out-Of-Tree PR FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#227-compilation-seed" class="md-nav__link">
    2.2.7 Compilation Seed
  </a>
  
    <nav class="md-nav" aria-label="2.2.7 Compilation Seed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2271-walkthrough-change-the-compilation-seed" class="md-nav__link">
    2.2.7.1 Walkthrough: Change the Compilation Seed
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-fim-simulation" class="md-nav__link">
    3. FIM Simulation
  </a>
  
    <nav class="md-nav" aria-label="3. FIM Simulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-simulation-file-generation" class="md-nav__link">
    3.1 Simulation File Generation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-individual-unit-tests" class="md-nav__link">
    3.2 Individual Unit Tests
  </a>
  
    <nav class="md-nav" aria-label="3.2 Individual Unit Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-walkthrough-run-individual-unit-level-simulation" class="md-nav__link">
    3.2.1 Walkthrough: Run Individual Unit Level Simulation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-regression-unit-tests" class="md-nav__link">
    3.3 Regression Unit Tests
  </a>
  
    <nav class="md-nav" aria-label="3.3 Regression Unit Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#331-walkthrough-run-regression-unit-level-simulation" class="md-nav__link">
    3.3.1 Walkthrough: Run Regression Unit Level Simulation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-fim-customization" class="md-nav__link">
    4. FIM Customization
  </a>
  
    <nav class="md-nav" aria-label="4. FIM Customization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-adding-a-new-module-to-the-fim" class="md-nav__link">
    4.1 Adding a new module to the FIM
  </a>
  
    <nav class="md-nav" aria-label="4.1 Adding a new module to the FIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#411-hello-fim-theory-of-operation" class="md-nav__link">
    4.1.1 Hello FIM Theory of Operation
  </a>
  
    <nav class="md-nav" aria-label="4.1.1 Hello FIM Theory of Operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4111-hello-fim-board-peripheral-fabric-bpf" class="md-nav__link">
    4.1.1.1 Hello FIM Board Peripheral Fabric (BPF)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4112-hello-fim-csr" class="md-nav__link">
    4.1.1.2 Hello FIM CSR
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#412-walkthrough-add-a-new-module-to-the-ofs-fim" class="md-nav__link">
    4.1.2 Walkthrough: Add a new module to the OFS FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#413-walkthrough-modify-and-run-unit-tests-for-a-fim-that-has-a-new-module" class="md-nav__link">
    4.1.3 Walkthrough: Modify and run unit tests for a FIM that has a new module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#414-walkthrough-modify-and-run-uvm-tests-for-a-fim-that-has-a-new-module" class="md-nav__link">
    4.1.4 Walkthrough: Modify and run UVM tests for a FIM that has a new module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#415-walkthrough-hardware-test-a-fim-that-has-a-new-module" class="md-nav__link">
    4.1.5 Walkthrough: Hardware test a FIM that has a new module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#416-walkthrough-debug-the-fim-with-signal-tap" class="md-nav__link">
    4.1.6 Walkthrough: Debug the FIM with Signal Tap
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-preparing-fim-for-afu-development" class="md-nav__link">
    4.2 Preparing FIM for AFU Development
  </a>
  
    <nav class="md-nav" aria-label="4.2 Preparing FIM for AFU Development">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#421-walkthrough-compile-the-fim-in-preparation-for-designing-your-afu" class="md-nav__link">
    4.2.1 Walkthrough: Compile the FIM in preparation for designing your AFU
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-partial-reconfiguration-region" class="md-nav__link">
    4.3 Partial Reconfiguration Region
  </a>
  
    <nav class="md-nav" aria-label="4.3 Partial Reconfiguration Region">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#431-walkthrough-resize-the-partial-reconfiguration-region" class="md-nav__link">
    4.3.1 Walkthrough: Resize the Partial Reconfiguration Region
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-pcie-configuration" class="md-nav__link">
    4.4 PCIe Configuration
  </a>
  
    <nav class="md-nav" aria-label="4.4 PCIe Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#441-pfvf-mux-configuration" class="md-nav__link">
    4.4.1 PF/VF MUX Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#442-pcie-ss-configuration-registers" class="md-nav__link">
    4.4.2 PCIe-SS Configuration Registers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#443-pcie-configuration-using-ofss" class="md-nav__link">
    4.4.3 PCIe Configuration Using OFSS
  </a>
  
    <nav class="md-nav" aria-label="4.4.3 PCIe Configuration Using OFSS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4431-walkthrough-modify-the-pcie-sub-system-and-pfvf-mux-configuration-using-ofss" class="md-nav__link">
    4.4.3.1 Walkthrough: Modify the PCIe Sub-System and PF/VF MUX Configuration Using OFSS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#444-pcie-sub-system-configuration-using-ip-presets" class="md-nav__link">
    4.4.4 PCIe Sub-System configuration Using IP Presets
  </a>
  
    <nav class="md-nav" aria-label="4.4.4 PCIe Sub-System configuration Using IP Presets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4441-walkthrough-modify-pcie-sub-system-and-pfvf-mux-configuration-using-ip-presets" class="md-nav__link">
    4.4.4.1 Walkthrough: Modify PCIe Sub-System and PF/VF MUX Configuration Using IP Presets
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-minimal-fim" class="md-nav__link">
    4.5 Minimal FIM
  </a>
  
    <nav class="md-nav" aria-label="4.5 Minimal FIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#451-walkthrough-create-a-minimal-fim" class="md-nav__link">
    4.5.1 Walkthrough: Create a Minimal FIM
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#46-migrate-to-a-different-agilex-device-number" class="md-nav__link">
    4.6 Migrate to a Different Agilex Device Number
  </a>
  
    <nav class="md-nav" aria-label="4.6 Migrate to a Different Agilex Device Number">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#461-walkthrough-migrate-to-a-different-agilex-device-number" class="md-nav__link">
    4.6.1 Walkthrough: Migrate to a Different Agilex Device Number
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#47-modify-the-memory-sub-system" class="md-nav__link">
    4.7 Modify the Memory Sub-System
  </a>
  
    <nav class="md-nav" aria-label="4.7 Modify the Memory Sub-System">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#471-walkthrough-modify-the-memory-sub-system-using-ip-presets-with-ofss" class="md-nav__link">
    4.7.1 Walkthrough: Modify the Memory Sub-System Using IP Presets With OFSS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#472-walkthrough-add-or-remove-the-memory-sub-system" class="md-nav__link">
    4.7.2 Walkthrough: Add or remove the Memory Sub-System
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#48-modify-the-ethernet-sub-system" class="md-nav__link">
    4.8 Modify the Ethernet Sub-System
  </a>
  
    <nav class="md-nav" aria-label="4.8 Modify the Ethernet Sub-System">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#481-walkthrough-modify-the-ethernet-sub-system-channels-with-pre-made-hssi-ofss" class="md-nav__link">
    4.8.1 Walkthrough: Modify the Ethernet Sub-System Channels With Pre-Made HSSI OFSS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#482-walkthrough-add-channels-to-the-ethernet-sub-system-channels-with-custom-hssi-ofss" class="md-nav__link">
    4.8.2 Walkthrough: Add Channels to the Ethernet Sub-System Channels With Custom HSSI OFSS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#483-walkthrough-modify-the-ethernet-sub-system-with-pre-made-hssi-ofss-plus-additional-modifications" class="md-nav__link">
    4.8.3 Walkthrough: Modify the Ethernet Sub-System With Pre-Made HSSI OFSS Plus Additional Modifications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#484-walkthrough-modify-the-ethernet-sub-system-without-hssi-ofss" class="md-nav__link">
    4.8.4 Walkthrough: Modify the Ethernet Sub-System Without HSSI OFSS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#49-modifying-the-hps" class="md-nav__link">
    4.9 Modifying the HPS
  </a>
  
    <nav class="md-nav" aria-label="4.9 Modifying the HPS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#491-walkthrough-remove-the-hps" class="md-nav__link">
    4.9.1 Walkthrough: Remove the HPS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#491-walkthrough-add-the-hps" class="md-nav__link">
    4.9.1 Walkthrough: Add the HPS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-fpga-configuration" class="md-nav__link">
    5. FPGA Configuration
  </a>
  
    <nav class="md-nav" aria-label="5. FPGA Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-walkthrough-set-up-jtag" class="md-nav__link">
    5.1 Walkthrough: Set up JTAG
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-walkthrough-program-the-fpga-via-jtag" class="md-nav__link">
    5.2 Walkthrough: Program the FPGA via JTAG
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-remote-system-update" class="md-nav__link">
    5.3 Remote System Update
  </a>
  
    <nav class="md-nav" aria-label="5.3 Remote System Update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#531-walkthrough-program-the-fpga-via-rsu" class="md-nav__link">
    5.3.1 Walkthrough: Program the FPGA via RSU
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    Appendix
  </a>
  
    <nav class="md-nav" aria-label="Appendix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#appendix-a-resource-utilization-tables" class="md-nav__link">
    Appendix A: Resource Utilization Tables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#appendix-b-glossary" class="md-nav__link">
    Appendix B: Glossary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notices-disclaimers" class="md-nav__link">
    Notices &amp; Disclaimers
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hps_dev/hps_developer_ug/" class="md-nav__link">
        HPS Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_sim_ofs_agx7_pcie_attach/ug_sim_ofs_agx7_pcie_attach/" class="md-nav__link">
        Simulation User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
          Workload Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          Workload Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/afu_dev/ug_dev_afu_ofs_agx7_pcie_attach/ug_dev_afu_ofs_agx7_pcie_attach/" class="md-nav__link">
        Workload Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../n6001/ug_dev_pim_based_afu/" class="md-nav__link">
        PIM Based AFU Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../n6001/ug_dev_afu_sim_env/" class="md-nav__link">
        AFU Simulation Environment User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
          Virtualization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_11">
          <span class="md-nav__icon md-icon"></span>
          Virtualization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../n6001/ug_docker/" class="md-nav__link">
        Docker User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../n6001/ug_kvm/" class="md-nav__link">
        KVM User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Agilex SoC Attach OFS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Agilex SoC Attach OFS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../doc_modules/contents_agx7_soc_attach/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/board_installation/f2000x_board_installation/f2000x_board_installation/" class="md-nav__link">
        Board Installation Guide (Intel® IPU Platform F2000X-PL)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/sw_installation/soc_attach/sw_install_soc_attach/" class="md-nav__link">
        Software Installation Guide for SoC Attach
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/user_guides/ug_qs_ofs_f2000x/ug_qs_ofs_f2000x/" class="md-nav__link">
        Getting Started Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/user_guides/ug_eval_ofs/ug_eval_script_ofs_f2000x/" class="md-nav__link">
        Automated Evaluation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/reference_manuals/ofs_fim/mnl_fim_ofs/" class="md-nav__link">
        Shell Technical Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/dev_guides/fim_dev/ug_dev_fim_ofs/" class="md-nav__link">
        Shell Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
          Workload Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_8">
          <span class="md-nav__icon md-icon"></span>
          Workload Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/dev_guides/afu_dev/ug_dev_afu_ofs_f2000x/" class="md-nav__link">
        Workload Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../f2000x/ug_dev_pim_based_afu/" class="md-nav__link">
        PIM Based AFU Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../f2000x/ug_dev_afu_sim_env/" class="md-nav__link">
        AFU Simulation Environment User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/user_guides/ug_sim_ofs/ug_sim_ofs/" class="md-nav__link">
        Simulation User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_10" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_10" id="__nav_5_10_label" tabindex="0">
          Virtualization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_10">
          <span class="md-nav__icon md-icon"></span>
          Virtualization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../f2000x/ug_docker/" class="md-nav__link">
        Docker User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../f2000x/ug_kvm/" class="md-nav__link">
        KVM User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          oneAPI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          oneAPI
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/oneapi_asp/ug_oneapi_asp/" class="md-nav__link">
        oneAPI ASP Getting Started User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/reference_manual/oneapi_asp/oneapi_asp_ref_mnl/" class="md-nav__link">
        oneAPI Accelerator Support Package(ASP) Reference Manual
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          OFS Software
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          OFS Software
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/reference_manual/ofs_sw/mnl_sw_ofs/" class="md-nav__link">
        Software Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/sw_installation/pcie_attach/sw_install_pcie_attach/" class="md-nav__link">
        Software Installation Guide OFS for PCIe Attach
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/sw_installation/soc_attach/sw_install_soc_attach/" class="md-nav__link">
        Software Installation Guide OFS for SoC Attach
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
          OPAE FPGA Tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_4">
          <span class="md-nav__icon md-icon"></span>
          OPAE FPGA Tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/fpgainfo/fpgainfo/" class="md-nav__link">
        fpgainfo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/fpgasupdate/fpgasupdate/" class="md-nav__link">
        fpgasupdate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/mmlink/mmlink/" class="md-nav__link">
        mmlink
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/packager/packager/" class="md-nav__link">
        packager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/userclk/userclk/" class="md-nav__link">
        userclk
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/hssi/hssi/" class="md-nav__link">
        hssi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/pci_device/pci_device/" class="md-nav__link">
        pci_device
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/opae.io/opae.io/" class="md-nav__link">
        opae.io
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/rsu/rsu/" class="md-nav__link">
        rsu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/host_exerciser/host_exerciser/" class="md-nav__link">
        host_exerciser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/hssi_ethernet/hssistats/" class="md-nav__link">
        HSSI ethernet statistics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/hssi_ethernet/hssimac/" class="md-nav__link">
        HSSI ethernet mac
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/mem_tg/mem_tg/" class="md-nav__link">
        mem_tg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/vabtool/vabtool/" class="md-nav__link">
        vabtool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/opaevfio/opaevfio/" class="md-nav__link">
        opaevfio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/ofs.uio/ofs.uio/" class="md-nav__link">
        ofs.uio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/opaeuio/opaeuio/" class="md-nav__link">
        opaeuio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/fpgad/fpgad/" class="md-nav__link">
        fpgad
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    1. Introduction
  </a>
  
    <nav class="md-nav" aria-label="1. Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-about-this-document" class="md-nav__link">
    1.1. About This Document
  </a>
  
    <nav class="md-nav" aria-label="1.1. About This Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111-knowledge-pre-requisites" class="md-nav__link">
    1.1.1 Knowledge Pre-Requisites
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-fim-development-theory" class="md-nav__link">
    1.2. FIM Development Theory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#121-default-fim-features" class="md-nav__link">
    1.2.1 Default FIM Features
  </a>
  
    <nav class="md-nav" aria-label="1.2.1 Default FIM Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1211-top-level" class="md-nav__link">
    1.2.1.1 Top Level
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1212-interfaces" class="md-nav__link">
    1.2.1.2 Interfaces
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1213-subsystems" class="md-nav__link">
    1.2.1.3 Subsystems
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1214-host-exercisers" class="md-nav__link">
    1.2.1.4 Host Exercisers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1215-module-access-via-apfbpf" class="md-nav__link">
    1.2.1.5 Module Access via APF/BPF
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122-customization-options" class="md-nav__link">
    1.2.2 Customization Options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-development-environment" class="md-nav__link">
    1.3 Development Environment
  </a>
  
    <nav class="md-nav" aria-label="1.3 Development Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131-development-tools" class="md-nav__link">
    1.3.1 Development Tools
  </a>
  
    <nav class="md-nav" aria-label="1.3.1 Development Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1311-walkthrough-install-quartus-prime-pro-software" class="md-nav__link">
    1.3.1.1 Walkthrough: Install Quartus Prime Pro Software
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132-fim-source-files" class="md-nav__link">
    1.3.2 FIM Source Files
  </a>
  
    <nav class="md-nav" aria-label="1.3.2 FIM Source Files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1321-walkthrough-clone-fim-repository" class="md-nav__link">
    1.3.2.1 Walkthrough: Clone FIM Repository
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#133-environment-variables" class="md-nav__link">
    1.3.3 Environment Variables
  </a>
  
    <nav class="md-nav" aria-label="1.3.3 Environment Variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1331-walkthrough-set-development-environment-variables" class="md-nav__link">
    1.3.3.1 Walkthrough: Set Development Environment Variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#134-walkthrough-set-up-development-environment" class="md-nav__link">
    1.3.4 Walkthrough: Set Up Development Environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-fim-compilation" class="md-nav__link">
    2. FIM Compilation
  </a>
  
    <nav class="md-nav" aria-label="2. FIM Compilation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-compilation-theory" class="md-nav__link">
    2.1 Compilation Theory
  </a>
  
    <nav class="md-nav" aria-label="2.1 Compilation Theory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211-fim-build-script" class="md-nav__link">
    2.1.1 FIM Build Script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2111-build-work-directory" class="md-nav__link">
    2.1.1.1 Build Work Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2112-null-host-exercisers" class="md-nav__link">
    2.1.1.2 Null Host Exercisers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#212-ofss-file-usage" class="md-nav__link">
    2.1.2 OFSS File Usage
  </a>
  
    <nav class="md-nav" aria-label="2.1.2 OFSS File Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2121-platform-ofss-file" class="md-nav__link">
    2.1.2.1 Platform OFSS File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2122-ofs-ip-ofss-file" class="md-nav__link">
    2.1.2.2 OFS IP OFSS File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2123-pcie-ip-ofss-file" class="md-nav__link">
    2.1.2.3 PCIe IP OFSS File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2124-iopll-ip-ofss-file" class="md-nav__link">
    2.1.2.4 IOPLL IP OFSS File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2125-memory-ip-ofss-file" class="md-nav__link">
    2.1.2.5 Memory IP OFSS File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2126-hssi-ip-ofss-file" class="md-nav__link">
    2.1.2.6 HSSI IP OFSS File
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#213-ofs-build-script-outputs" class="md-nav__link">
    2.1.3 OFS Build Script Outputs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-compilation-flows" class="md-nav__link">
    2.2 Compilation Flows
  </a>
  
    <nav class="md-nav" aria-label="2.2 Compilation Flows">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221-flat-fim" class="md-nav__link">
    2.2.1 Flat FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222-in-tree-pr-fim" class="md-nav__link">
    2.2.2 In-Tree PR FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#223-out-of-tree-pr-fim" class="md-nav__link">
    2.2.3 Out-of-Tree PR FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#225-walkthrough-compile-ofs-fim" class="md-nav__link">
    2.2.5 Walkthrough: Compile OFS FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#226-walkthrough-manually-generate-ofs-out-of-tree-pr-fim" class="md-nav__link">
    2.2.6 Walkthrough: Manually Generate OFS Out-Of-Tree PR FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#227-compilation-seed" class="md-nav__link">
    2.2.7 Compilation Seed
  </a>
  
    <nav class="md-nav" aria-label="2.2.7 Compilation Seed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#2271-walkthrough-change-the-compilation-seed" class="md-nav__link">
    2.2.7.1 Walkthrough: Change the Compilation Seed
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-fim-simulation" class="md-nav__link">
    3. FIM Simulation
  </a>
  
    <nav class="md-nav" aria-label="3. FIM Simulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-simulation-file-generation" class="md-nav__link">
    3.1 Simulation File Generation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-individual-unit-tests" class="md-nav__link">
    3.2 Individual Unit Tests
  </a>
  
    <nav class="md-nav" aria-label="3.2 Individual Unit Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-walkthrough-run-individual-unit-level-simulation" class="md-nav__link">
    3.2.1 Walkthrough: Run Individual Unit Level Simulation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-regression-unit-tests" class="md-nav__link">
    3.3 Regression Unit Tests
  </a>
  
    <nav class="md-nav" aria-label="3.3 Regression Unit Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#331-walkthrough-run-regression-unit-level-simulation" class="md-nav__link">
    3.3.1 Walkthrough: Run Regression Unit Level Simulation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-fim-customization" class="md-nav__link">
    4. FIM Customization
  </a>
  
    <nav class="md-nav" aria-label="4. FIM Customization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-adding-a-new-module-to-the-fim" class="md-nav__link">
    4.1 Adding a new module to the FIM
  </a>
  
    <nav class="md-nav" aria-label="4.1 Adding a new module to the FIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#411-hello-fim-theory-of-operation" class="md-nav__link">
    4.1.1 Hello FIM Theory of Operation
  </a>
  
    <nav class="md-nav" aria-label="4.1.1 Hello FIM Theory of Operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4111-hello-fim-board-peripheral-fabric-bpf" class="md-nav__link">
    4.1.1.1 Hello FIM Board Peripheral Fabric (BPF)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4112-hello-fim-csr" class="md-nav__link">
    4.1.1.2 Hello FIM CSR
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#412-walkthrough-add-a-new-module-to-the-ofs-fim" class="md-nav__link">
    4.1.2 Walkthrough: Add a new module to the OFS FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#413-walkthrough-modify-and-run-unit-tests-for-a-fim-that-has-a-new-module" class="md-nav__link">
    4.1.3 Walkthrough: Modify and run unit tests for a FIM that has a new module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#414-walkthrough-modify-and-run-uvm-tests-for-a-fim-that-has-a-new-module" class="md-nav__link">
    4.1.4 Walkthrough: Modify and run UVM tests for a FIM that has a new module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#415-walkthrough-hardware-test-a-fim-that-has-a-new-module" class="md-nav__link">
    4.1.5 Walkthrough: Hardware test a FIM that has a new module
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#416-walkthrough-debug-the-fim-with-signal-tap" class="md-nav__link">
    4.1.6 Walkthrough: Debug the FIM with Signal Tap
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-preparing-fim-for-afu-development" class="md-nav__link">
    4.2 Preparing FIM for AFU Development
  </a>
  
    <nav class="md-nav" aria-label="4.2 Preparing FIM for AFU Development">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#421-walkthrough-compile-the-fim-in-preparation-for-designing-your-afu" class="md-nav__link">
    4.2.1 Walkthrough: Compile the FIM in preparation for designing your AFU
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-partial-reconfiguration-region" class="md-nav__link">
    4.3 Partial Reconfiguration Region
  </a>
  
    <nav class="md-nav" aria-label="4.3 Partial Reconfiguration Region">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#431-walkthrough-resize-the-partial-reconfiguration-region" class="md-nav__link">
    4.3.1 Walkthrough: Resize the Partial Reconfiguration Region
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-pcie-configuration" class="md-nav__link">
    4.4 PCIe Configuration
  </a>
  
    <nav class="md-nav" aria-label="4.4 PCIe Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#441-pfvf-mux-configuration" class="md-nav__link">
    4.4.1 PF/VF MUX Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#442-pcie-ss-configuration-registers" class="md-nav__link">
    4.4.2 PCIe-SS Configuration Registers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#443-pcie-configuration-using-ofss" class="md-nav__link">
    4.4.3 PCIe Configuration Using OFSS
  </a>
  
    <nav class="md-nav" aria-label="4.4.3 PCIe Configuration Using OFSS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4431-walkthrough-modify-the-pcie-sub-system-and-pfvf-mux-configuration-using-ofss" class="md-nav__link">
    4.4.3.1 Walkthrough: Modify the PCIe Sub-System and PF/VF MUX Configuration Using OFSS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#444-pcie-sub-system-configuration-using-ip-presets" class="md-nav__link">
    4.4.4 PCIe Sub-System configuration Using IP Presets
  </a>
  
    <nav class="md-nav" aria-label="4.4.4 PCIe Sub-System configuration Using IP Presets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4441-walkthrough-modify-pcie-sub-system-and-pfvf-mux-configuration-using-ip-presets" class="md-nav__link">
    4.4.4.1 Walkthrough: Modify PCIe Sub-System and PF/VF MUX Configuration Using IP Presets
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-minimal-fim" class="md-nav__link">
    4.5 Minimal FIM
  </a>
  
    <nav class="md-nav" aria-label="4.5 Minimal FIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#451-walkthrough-create-a-minimal-fim" class="md-nav__link">
    4.5.1 Walkthrough: Create a Minimal FIM
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#46-migrate-to-a-different-agilex-device-number" class="md-nav__link">
    4.6 Migrate to a Different Agilex Device Number
  </a>
  
    <nav class="md-nav" aria-label="4.6 Migrate to a Different Agilex Device Number">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#461-walkthrough-migrate-to-a-different-agilex-device-number" class="md-nav__link">
    4.6.1 Walkthrough: Migrate to a Different Agilex Device Number
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#47-modify-the-memory-sub-system" class="md-nav__link">
    4.7 Modify the Memory Sub-System
  </a>
  
    <nav class="md-nav" aria-label="4.7 Modify the Memory Sub-System">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#471-walkthrough-modify-the-memory-sub-system-using-ip-presets-with-ofss" class="md-nav__link">
    4.7.1 Walkthrough: Modify the Memory Sub-System Using IP Presets With OFSS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#472-walkthrough-add-or-remove-the-memory-sub-system" class="md-nav__link">
    4.7.2 Walkthrough: Add or remove the Memory Sub-System
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#48-modify-the-ethernet-sub-system" class="md-nav__link">
    4.8 Modify the Ethernet Sub-System
  </a>
  
    <nav class="md-nav" aria-label="4.8 Modify the Ethernet Sub-System">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#481-walkthrough-modify-the-ethernet-sub-system-channels-with-pre-made-hssi-ofss" class="md-nav__link">
    4.8.1 Walkthrough: Modify the Ethernet Sub-System Channels With Pre-Made HSSI OFSS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#482-walkthrough-add-channels-to-the-ethernet-sub-system-channels-with-custom-hssi-ofss" class="md-nav__link">
    4.8.2 Walkthrough: Add Channels to the Ethernet Sub-System Channels With Custom HSSI OFSS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#483-walkthrough-modify-the-ethernet-sub-system-with-pre-made-hssi-ofss-plus-additional-modifications" class="md-nav__link">
    4.8.3 Walkthrough: Modify the Ethernet Sub-System With Pre-Made HSSI OFSS Plus Additional Modifications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#484-walkthrough-modify-the-ethernet-sub-system-without-hssi-ofss" class="md-nav__link">
    4.8.4 Walkthrough: Modify the Ethernet Sub-System Without HSSI OFSS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#49-modifying-the-hps" class="md-nav__link">
    4.9 Modifying the HPS
  </a>
  
    <nav class="md-nav" aria-label="4.9 Modifying the HPS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#491-walkthrough-remove-the-hps" class="md-nav__link">
    4.9.1 Walkthrough: Remove the HPS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#491-walkthrough-add-the-hps" class="md-nav__link">
    4.9.1 Walkthrough: Add the HPS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-fpga-configuration" class="md-nav__link">
    5. FPGA Configuration
  </a>
  
    <nav class="md-nav" aria-label="5. FPGA Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-walkthrough-set-up-jtag" class="md-nav__link">
    5.1 Walkthrough: Set up JTAG
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-walkthrough-program-the-fpga-via-jtag" class="md-nav__link">
    5.2 Walkthrough: Program the FPGA via JTAG
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-remote-system-update" class="md-nav__link">
    5.3 Remote System Update
  </a>
  
    <nav class="md-nav" aria-label="5.3 Remote System Update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#531-walkthrough-program-the-fpga-via-rsu" class="md-nav__link">
    5.3.1 Walkthrough: Program the FPGA via RSU
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    Appendix
  </a>
  
    <nav class="md-nav" aria-label="Appendix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#appendix-a-resource-utilization-tables" class="md-nav__link">
    Appendix A: Resource Utilization Tables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#appendix-b-glossary" class="md-nav__link">
    Appendix B: Glossary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notices-disclaimers" class="md-nav__link">
    Notices &amp; Disclaimers
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="shell-developer-guide-for-open-fpga-stack-intel-fpga-smartnic-n6000-pl-intel-fpga-smartnic-n6001-pl-pcie-attach">Shell Developer Guide for Open FPGA Stack: Intel® FPGA SmartNIC N6000-PL / Intel® FPGA SmartNIC N6001-PL PCIe Attach<a class="headerlink" href="#shell-developer-guide-for-open-fpga-stack-intel-fpga-smartnic-n6000-pl-intel-fpga-smartnic-n6001-pl-pcie-attach" title="Permanent link">&para;</a></h1>
<p>Last updated: <strong>May 03, 2024</strong> </p>
<h2 id="1-introduction"><strong>1. Introduction</strong><a class="headerlink" href="#1-introduction" title="Permanent link">&para;</a></h2>
<h3 id="11-about-this-document"><strong>1.1. About This Document</strong><a class="headerlink" href="#11-about-this-document" title="Permanent link">&para;</a></h3>
<p>This document serves as a guide for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach developers targeting the Intel® FPGA SmartNIC N6000-PL and Intel® FPGA SmartNIC N6001-PL. The following topics are covered in this guide:</p>
<ul>
<li>Compiling the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design</li>
<li>Simulating the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach design</li>
<li>Customizing the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design</li>
<li>Configuring the FPGA with an <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design</li>
</ul>
<p>The <em><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Development Walkthroughs Table</em> lists all of the walkthroughs provided in this guide. These walkthroughs provide step-by-step instructions for performing different <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Development tasks.</p>
<p><em>Table: <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Development Walkthroughs</em></p>
<table>
<thead>
<tr>
<th>Walkthrough Name</th>
<th>Category</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1311-walkthrough-install-quartus-prime-pro-software">Install Quartus Prime Pro Software</a></td>
<td>Setup</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a></td>
<td>Setup</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a></td>
<td>Setup</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a></td>
<td>Setup</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#225-walkthrough-compile-ofs-fim">Compile <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a></td>
<td>Compilation</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#226-walkthrough-manually-generate-ofs-out-of-tree-pr-fim">Manually Generate <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Out-Of-Tree <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a></td>
<td>Compilation</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#2271-walkthrough-change-the-compilation-seed">Change the Compilation Seed</a></td>
<td>Compilation</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#321-walkthrough-run-individual-unit-level-simulation">Run Individual Unit Level Simulation</a></td>
<td>Simulation</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#331-walkthrough-run-regression-unit-level-simulation">Run Regression Unit Level Simulation</a></td>
<td>Simulation</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#412-walkthrough-add-a-new-module-to-the-ofs-fim">Add a new module to the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#413-walkthrough-modify-and-run-unit-tests-for-a-fim-that-has-a-new-module">Modify and run unit tests for a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that has a new module</a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#414-walkthrough-modify-and-run-uvm-tests-for-a-fim-that-has-a-new-module">Modify and run <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> tests for a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that has a new module</a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#415-walkthrough-hardware-test-a-fim-that-has-a-new-module">Hardware test a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that has a new module</a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#416-walkthrough-debug-the-fim-with-signal-tap">Debug the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> with Signal Tap</a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#421-walkthrough-compile-the-fim-in-preparation-for-designing-your-afu">Compile the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> in preparation for designing your <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr></a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#431-walkthrough-resize-the-partial-reconfiguration-region">Resize the Partial Reconfiguration Region</a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#4431-walkthrough-modify-the-pcie-sub-system-and-pfvf-mux-configuration-using-ofss">Modify the PCIe Sub-System and PF/VF MUX Configuration Using OFSS</a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#4441-walkthrough-modify-pcie-sub-system-and-pfvf-mux-configuration-using-ip-presets">Modify PCIe Sub-System and PF/VF MUX Configuration Using IP Presets</a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#451-walkthrough-create-a-minimal-fim">Create a Minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#461-walkthrough-migrate-to-a-different-agilex-device-number">Migrate to a Different Agilex Device Number</a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#471-walkthrough-modify-the-memory-sub-system-using-ip-presets-with-ofss">Modify the Memory Sub-System Using IP Presets With OFSS</a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#481-walkthrough-modify-the-ethernet-sub-system-channels-with-pre-made-hssi-ofss">Modify the Ethernet Sub-System Channels With Pre-Made HSSI OFSS</a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#482-walkthrough-add-channels-to-the-ethernet-sub-system-channels-with-custom-hssi-ofss">Add Channels to the Ethernet Sub-System Channels With Custom HSSI OFSS</a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#483-walkthrough-modify-the-ethernet-sub-system-with-pre-made-hssi-ofss-plus-additional-modifications">Modify the Ethernet Sub-System With Pre-Made HSSI OFSS Plus Additional Modifications</a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#484-walkthrough-modify-the-ethernet-sub-system-without-hssi-ofss">Modify the Ethernet Sub-System Without HSSI OFSS</a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#491-walkthrough-remove-the-hps">Remove the HPS</a></td>
<td>Customization</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#51-walkthrough-set-up-jtag">Set up <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr></a></td>
<td>Configuration</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#52-walkthrough-program-the-fpga-via-jtag">Program the FPGA via <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr></a></td>
<td>Configuration</td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#531-walkthrough-program-the-fpga-via-rsu">Program the FPGA via <abbr title="Remote System Update, A Remote System Update operation sends an instruction to the Intel FPGA PAC D5005 device that triggers a power cycle of the card only, forcing reconfiguration.">RSU</abbr></a></td>
<td>Configuration</td>
</tr>
</tbody>
</table>
<h4 id="111-knowledge-pre-requisites"><strong>1.1.1 Knowledge Pre-Requisites</strong><a class="headerlink" href="#111-knowledge-pre-requisites" title="Permanent link">&para;</a></h4>
<p>It is recommended that you have the following knowledge and skills before using this developer guide.</p>
<ul>
<li>Basic understanding of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> and the difference between <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> designs. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1"><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Welcome Page</a>.</li>
<li>Review the <a href="https://github.com/OFS/ofs-agx7-pcie-attach/releases/tag/ofs-2024.1-1">release notes</a> for the Intel Agilex 7 PCIe Attach Reference Shells, with careful consideration of the <strong>Known Issues</strong>.</li>
<li>Review of <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/">Getting Started Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach FPGAs (Intel® FPGA SmartNIC N6001-PL/N6000-PL)</a>.</li>
<li>FPGA compilation flows using Intel® Quartus® Prime Pro Edition.</li>
<li>Static Timing closure, including familiarity with the Timing Analyzer tool in Intel® Quartus® Prime Pro Edition, applying timing constraints, Synopsys* Design Constraints (.sdc) language and Tcl scripting, and design methods to close on timing critical paths.</li>
<li>RTL (System Verilog) and coding practices to create synthesized logic.</li>
<li>RTL simulation tools.</li>
<li>Intel® Quartus® Prime Pro Edition Signal Tap Logic Analyzer tool software.</li>
</ul>
<h3 id="12-fim-development-theory"><strong>1.2. <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Development Theory</strong><a class="headerlink" href="#12-fim-development-theory" title="Permanent link">&para;</a></h3>
<p>This section will help you understand how the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> can be developed to fit your design goals.</p>
<p>The <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#121-default-fim-features">Default <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Features</a> section provides general information about the default features of the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> so you can become familiar with the default design. For more detailed information about the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> architecture, refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/reference_manuals/ofs_fim/mnl_fim_ofs_n6001/">Shell Technical Reference Manual: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach FPGAs</a>.</p>
<p>The <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#122-customization-options">Customization Options</a> section then gives suggestions of how this default design can be customized. Step-by-step walkthroughs for many of the suggested customizations are later described in the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#4-fim-customization"><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Customization</a> section.</p>
<p><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> development for a new acceleration card generally consists of the following steps:</p>
<ol>
<li>Install <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> and familiarize yourself with provided scripts and source code</li>
<li>Develop high level design with your specific functionality<ol>
<li>Determine requirements and key performance metrics</li>
<li>Select IP cores</li>
<li>Select FPGA device</li>
<li>Develop software memory map</li>
</ol>
</li>
<li>Select and implement <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Physical interfaces including:<ol>
<li>External clock sources and creation of internal PLL clocks</li>
<li>General I/O</li>
<li>Ethernet modules</li>
<li>External memories</li>
<li>FPGA programming methodology</li>
</ol>
</li>
<li>Develop device physical implementation<ol>
<li>FPGA device pin assignment</li>
<li>Create logic lock regions</li>
<li>Create of timing constraints</li>
<li>Create Intel Quartus Prime Pro <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> test project and validate:<ol>
<li>Placement</li>
<li>Timing constraints</li>
<li>Build script process</li>
<li>Review test <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> FPGA resource usage</li>
</ol>
</li>
</ol>
</li>
<li>Select <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> to <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> interfaces and development of <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr></li>
<li>Implement <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design<ol>
<li>Develop RTL</li>
<li>Instantiate IPs</li>
<li>Develop test <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> to validate <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></li>
<li>Develop unit and device level simulation</li>
<li>Develop timing constraints and build scripts</li>
<li>Perform timing closure and build validation</li>
</ol>
</li>
<li>Create <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> documentation to support <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> development and synthesis</li>
<li>Software Device Feature discovery</li>
<li>Integrate, validate, and debug hardware/software</li>
<li>Prepare for high volume production</li>
</ol>
<h3 id="121-default-fim-features"><strong>1.2.1 Default <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Features</strong><a class="headerlink" href="#121-default-fim-features" title="Permanent link">&para;</a></h3>
<h4 id="1211-top-level"><strong>1.2.1.1 Top Level</strong><a class="headerlink" href="#1211-top-level" title="Permanent link">&para;</a></h4>
<p>The top level block diagram for the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach reference design is shown below.</p>
<p><em>Figure: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Top-Level Diagram</em></p>
<p><a class="glightbox" href="../images/n6001_pcie_attach_top_level_diagram.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="top_level_diagram" src="../images/n6001_pcie_attach_top_level_diagram.png" /></a></p>
<h4 id="1212-interfaces"><strong>1.2.1.2 Interfaces</strong><a class="headerlink" href="#1212-interfaces" title="Permanent link">&para;</a></h4>
<p>The key interfaces in the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach design are listed in the <em>Release Capabilities</em> tables below. They describe the capabilities of the n6001 and n6000 hardware as well as the capabilities of the default <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach reference designs targeting the n6001 and the n6000.</p>
<p><em>Table: Intel® FPGA SmartNIC N6001-PL <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Release Capabilities</em></p>
<table>
<thead>
<tr>
<th>Interface</th>
<th>Intel® FPGA SmartNIC N6001-PL Hardware Capabilities</th>
<th>n6001 <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach Reference Design Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td>Host Interface</td>
<td>PCIe Gen4x16</td>
<td>PCIe Gen4x16</td>
</tr>
<tr>
<td>Network Interface</td>
<td>2 x QSFP-28/56 cages</td>
<td>2x4x25GbE | 2x1x100GbE | 2x4x10GbE</td>
</tr>
<tr>
<td>External Memory</td>
<td>5xDDR4 DIMMs sockets - 40-bits (1 available for HPS)</td>
<td>4xDDR4 - 2400MHz - 4GB (1Gb x 32) - 32-bits - No ECC</br>1xDDR4 - 2400MHz - 1GB (256Mb x 32 with 256 Mb x8 ECC) - 40-bits - With ECC - For HPS</td>
</tr>
</tbody>
</table>
<p><em>Table: Intel® FPGA SmartNIC N6000-PL <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Release Capabilities</em></p>
<table>
<thead>
<tr>
<th>Interface</th>
<th>Intel® FPGA SmartNIC N6000-PL Hardware Capabilities</th>
<th>n6000 <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach Reference Design Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td>Host Interface</td>
<td>To Agilex 7: PCIe Gen4x8 </br> To E810: PCIe Gen4x8</td>
<td>To Agilex 7: PCIe Gen4x8 </br> To E810: PCIe Gen4x8</td>
</tr>
<tr>
<td>Network Interface</td>
<td>2 x QSFP-28/56 cages</td>
<td>2x2x100GbE</td>
</tr>
<tr>
<td>External Memory</td>
<td>5xDDR4 DIMMs sockets - 40-bits (1 available for HPS)</td>
<td>Not enabled by default, but can support:</br> 4xDDR4 - 2400MHz - 4GB (1Gb x 32) - 32-bits - No ECC</br>1xDDR4 - 2400MHz - 1GB (256Mb x 32 with 256 Mb x8 ECC) - 40-bits - With ECC - For HPS</td>
</tr>
</tbody>
</table>
<h4 id="1213-subsystems"><strong>1.2.1.3 Subsystems</strong><a class="headerlink" href="#1213-subsystems" title="Permanent link">&para;</a></h4>
<p>The <em><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Subsystems</em> Table  describes the Platform Designer IP subsystems used in the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach n6001 <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<p><em>Table: <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Subsystems</em></p>
<table>
<thead>
<tr>
<th>Subsystem</th>
<th>User Guide</th>
<th>Document ID</th>
</tr>
</thead>
<tbody>
<tr>
<td>PCIe Subsystem</td>
<td><a href="https://www.intel.com/content/www/us/en/secure/content-details/690604/pcie-subsystem-intel-fpga-ip-user-guide-for-intel-agilex-ofs.html?wapkw=690604&amp;DocID=690604">PCIe Subsystem Intel FPGA IP User Guide for Intel Agilex <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr></a></td>
<td>N/A</td>
</tr>
<tr>
<td>Memory Subsystem</td>
<td><a href="https://www.intel.com/content/www/us/en/secure/content-details/686148/memory-subsystem-intel-fpga-ip-user-guide-for-intel-agilex-ofs.html?wapkw=686148&amp;DocID=686148">Memory Subsystem Intel FPGA IP User Guide for Intel Agilex <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr></a></td>
<td>686148<sup><strong>[1]</strong></sup></td>
</tr>
<tr>
<td>Ethernet Subsystem</td>
<td><a href="https://www.intel.com/content/www/us/en/docs/programmable/773413/23-1-22-5-0/ethernet-subsystem-intel-fpga-ip-overview.html">Ethernet Subsystem Intel FPGA IP User Guide</a></td>
<td>773413<sup><strong>[1]</strong></sup></td>
</tr>
</tbody>
</table>
<p><sup><strong>[1]</strong></sup> You must log in to myIntel and request entitled access.</p>
<h4 id="1214-host-exercisers"><strong>1.2.1.4 Host Exercisers</strong><a class="headerlink" href="#1214-host-exercisers" title="Permanent link">&para;</a></h4>
<p>The default <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> workload in the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach n6001/n6000 <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> contains several modules called Host Exercisers which are used to exercise the interfaces on the board. The <em>Host Exerciser Descriptions</em> Table describes these modules.</p>
<p><em>Table: Host Exerciser Descriptions</em></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Acronym</th>
<th>Description</th>
<th>OPAE Command</th>
</tr>
</thead>
<tbody>
<tr>
<td>Host Exerciser Loopback</td>
<td>HE-LB</td>
<td>Used to exercise and characterize host to FPGA data transfer.</td>
<td><code>host_exerciser</code></td>
</tr>
<tr>
<td>Host Exerciser Memory</td>
<td>HE_MEM</td>
<td>Used to exercise and characterize host to Memory data transfer.</td>
<td><code>host_exerciser</code></td>
</tr>
<tr>
<td>Host Exerciser Memory Traffic Generator</td>
<td>HE_MEM_TG</td>
<td>Used to exercise and test available memory channels with a configurable traffic pattern.</td>
<td><code>mem_tg</code></td>
</tr>
<tr>
<td>Host Exerciser High Speed Serial Interface</td>
<td>HE-HSSI</td>
<td>n6001: Used to exercise and characterize HSSI interfaces. </br> n6000: Used to pass through data between the E810 to the QSFPs.</td>
<td><code>hssi</code></td>
</tr>
</tbody>
</table>
<p>The host exercisers can be removed from the design at compile-time using command line arguments for the build script.</p>
<h4 id="1215-module-access-via-apfbpf"><strong>1.2.1.5 Module Access via APF/BPF</strong><a class="headerlink" href="#1215-module-access-via-apfbpf" title="Permanent link">&para;</a></h4>
<p>The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach n6001 <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> uses AXI4-Lite interconnect logic named the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Peripheral Fabric (APF) and Board Peripheral Fabric (BPF) to access the registers of the various modules in the design. The APF/BPF modules define master/slave interactions, namely between the host software and <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> and board peripherals. The <em>APF Address Map Table</em> describes the address mapping of the APF, followed by the <em>BPF Address Map Table</em> which describes the address mapping of the BPF.</p>
<p><em>Table: APF Address Map</em></p>
<table>
<thead>
<tr>
<th>Address</th>
<th>Size (Bytes)</th>
<th>Feature</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00000–0x3FFFF</td>
<td>256K</td>
<td>Board Peripherals (See <em>BPF Address Map</em> table)</td>
</tr>
<tr>
<td>0x40000 – 0x4FFFF</td>
<td>64K</td>
<td>ST2MM</td>
</tr>
<tr>
<td>0x50000 – 0x5FFFF</td>
<td>64K</td>
<td>Reserved</td>
</tr>
<tr>
<td>0x60000 – 0x60FFF</td>
<td>4K</td>
<td>UART</td>
</tr>
<tr>
<td>0x61000 – 0x6FFFF</td>
<td>4K</td>
<td>Reserved</td>
</tr>
<tr>
<td>0x70000 – 0x7FFFF</td>
<td>56K</td>
<td><abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> Gasket:4K= <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> Gasket DFH, control and status4K= Port DFH4K=User Clock52K=Remote STP</td>
</tr>
<tr>
<td>0x80000 – 0x80FFF</td>
<td>4K</td>
<td><abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Error Reporting</td>
</tr>
</tbody>
</table>
<p><em>Table: BPF Address Map</em></p>
<table>
<thead>
<tr>
<th>Address</th>
<th>Size (Bytes)</th>
<th>Feature</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00000 - 0x0FFFF</td>
<td>64K</td>
<td><abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr></td>
</tr>
<tr>
<td>0x10000 - 0x10FFF</td>
<td>4K</td>
<td>PCIe</td>
</tr>
<tr>
<td>0x11000 - 0x11FFF</td>
<td>4K</td>
<td>Reserved</td>
</tr>
<tr>
<td>0x12000 - 0x12FFF</td>
<td>4K</td>
<td>QSFP0</td>
</tr>
<tr>
<td>0x13000 - 0x13FFF</td>
<td>4K</td>
<td>QSFP1</td>
</tr>
<tr>
<td>0x14000 - 0x14FFF</td>
<td>4K</td>
<td>HSSI</td>
</tr>
<tr>
<td>0x15000 - 0x15FFF</td>
<td>4K</td>
<td>EMIF</td>
</tr>
<tr>
<td>0x20000 - 0x3FFFF</td>
<td>128K</td>
<td>PMCI Controller</td>
</tr>
</tbody>
</table>
<h3 id="122-customization-options"><strong>1.2.2 Customization Options</strong><a class="headerlink" href="#122-customization-options" title="Permanent link">&para;</a></h3>
<p><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> is designed to be easily customizable to meet your design needs. The <em><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Customization Examples Table</em> lists the general user flows for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach n6001/n6000 <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> development, along with example customizations for each user flow, plus links to step-by-step walkthroughs where available.</p>
<p><em>Table: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Customization Examples</em></p>
<table>
<thead>
<tr>
<th>Walkthrough Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#412-walkthrough-add-a-new-module-to-the-ofs-fim">Add a new module to the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#413-walkthrough-modify-and-run-unit-tests-for-a-fim-that-has-a-new-module">Modify and run unit tests for a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that has a new module</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#414-walkthrough-modify-and-run-uvm-tests-for-a-fim-that-has-a-new-module">Modify and run <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> tests for a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that has a new module</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#415-walkthrough-hardware-test-a-fim-that-has-a-new-module">Hardware test a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that has a new module</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#416-walkthrough-debug-the-fim-with-signal-tap">Debug the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> with Signal Tap</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#421-walkthrough-compile-the-fim-in-preparation-for-designing-your-afu">Compile the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> in preparation for designing your <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr></a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#431-walkthrough-resize-the-partial-reconfiguration-region">Resize the Partial Reconfiguration Region</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#4431-walkthrough-modify-the-pcie-sub-system-and-pfvf-mux-configuration-using-ofss">Modify the PCIe Sub-System and PF/VF MUX Configuration Using OFSS</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#4441-walkthrough-modify-pcie-sub-system-and-pfvf-mux-configuration-using-ip-presets">Modify PCIe Sub-System and PF/VF MUX Configuration Using IP Presets</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#451-walkthrough-create-a-minimal-fim">Create a Minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#461-walkthrough-migrate-to-a-different-agilex-device-number">Migrate to a Different Agilex Device Number</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#471-walkthrough-modify-the-memory-sub-system-using-ip-presets-with-ofss">Modify the Memory Sub-System Using IP Presets With OFSS</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#481-walkthrough-modify-the-ethernet-sub-system-channels-with-pre-made-hssi-ofss">Modify the Ethernet Sub-System Channels With Pre-Made HSSI OFSS</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#482-walkthrough-add-channels-to-the-ethernet-sub-system-channels-with-custom-hssi-ofss">Add Channels to the Ethernet Sub-System Channels With Custom HSSI OFSS</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#483-walkthrough-modify-the-ethernet-sub-system-with-pre-made-hssi-ofss-plus-additional-modifications">Modify the Ethernet Sub-System With Pre-Made HSSI OFSS Plus Additional Modifications</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#484-walkthrough-modify-the-ethernet-sub-system-without-hssi-ofss">Modify the Ethernet Sub-System Without HSSI OFSS</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#491-walkthrough-remove-the-hps">Remove the HPS</a></td>
</tr>
</tbody>
</table>
<!-- | | Change I/O assignments | N/A | -->
<!-- | | Port code to another platform | N/A | -->
<!-- | | Modify Memory Subsystem Settings | N/A | -->
<!-- | | Modify Memory Interface speed/width | N/A | -->
<!-- | | Modify Ethernet Subsystem Settings | N/A | -->
<!-- | | Modify Memory Subsystem to add an additional channel | N/A | -->

<h3 id="13-development-environment"><strong>1.3 Development Environment</strong><a class="headerlink" href="#13-development-environment" title="Permanent link">&para;</a></h3>
<p>This section describes the components required for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> development, and provides a walkthrough for setting up the environment on your development machine.</p>
<p>Note that your development machine may be different than your deployment machine where the FPGA acceleration card is installed. FPGA development work and deployment work can be performed either on the same machine, or on different machines as desired. Please see the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/">Getting Started Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach FPGAs (Intel® FPGA SmartNIC N6001-PL/N6000-PL)</a> for instructions on setting up the environment for deployment machines.</p>
<h4 id="131-development-tools"><strong>1.3.1 Development Tools</strong><a class="headerlink" href="#131-development-tools" title="Permanent link">&para;</a></h4>
<p>The <em>Development Environment Table</em> describes the Best Known Configuration (<abbr title="Best Known Configuration, The exact hardware configuration Intel has optimized and validated the solution against.">BKC</abbr>) for the tools that are required for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> development.</p>
<p><em>Table: Development Environment <abbr title="Best Known Configuration, The exact hardware configuration Intel has optimized and validated the solution against.">BKC</abbr></em></p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Version</th>
<th>Installation Walkthrough</th>
</tr>
</thead>
<tbody>
<tr>
<td>Operating System</td>
<td>RedHat® Enterprise Linux® (RHEL) 8.6</td>
<td>N/A</td>
</tr>
<tr>
<td>Intel Quartus Prime Software</td>
<td>Quartus Prime Pro Version 23.4 for Linux + Patches 0.17 patch (PCIe)</td>
<td>Section 1.3.1.1</td>
</tr>
<tr>
<td>Python</td>
<td>3.6.8 or later</td>
<td>N/A</td>
</tr>
<tr>
<td>GCC</td>
<td>8.5.0 or later</td>
<td>N/A</td>
</tr>
<tr>
<td>cmake</td>
<td>3.15 or later</td>
<td>N/A</td>
</tr>
<tr>
<td><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Source Files</td>
<td>ofs-2024.1-1</td>
<td>Section 1.3.2.1</td>
</tr>
</tbody>
</table>
<h5 id="1311-walkthrough-install-quartus-prime-pro-software"><strong>1.3.1.1 Walkthrough: Install Quartus Prime Pro Software</strong><a class="headerlink" href="#1311-walkthrough-install-quartus-prime-pro-software" title="Permanent link">&para;</a></h5>
<p><strong>Intel Quartus Prime Pro Version 23.4</strong> is verified to work with the latest <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> release ofs-2024.1-1.  However, you have the option to port and verify the release on newer versions of Intel Quartus Prime Pro software.</p>
<p>Use RedHat® Enterprise Linux® (RHEL) 8.6 for compatibility with your development flow and also testing your <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design in your platform. </p>
<p>Prior to installing Quartus:</p>
<ol>
<li>
<p>Ensure you have at least 64 GB of free space for Quartus Prime Pro installation and your development work.</p>
<ul>
<li>Intel® recommends that your system be configured to provide virtual memory equal in size or larger than the recommended physical RAM size that is required to process your design.</li>
<li>The disk space may be significantly more based on the device families included in the install. Prior to installation, the disk space should be enough to hold both zipped tar files and uncompressed installation files. After successful installation, delete the downloaded zipped files and uncompressed zip files to release the disk space.</li>
</ul>
</li>
<li>
<p>Perform the following steps to satisfy the required dependencies.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>gcc<span class="w"> </span>gcc-c++<span class="w"> </span>make<span class="w"> </span>cmake<span class="w"> </span>libuuid-devel<span class="w"> </span>rpm-build<span class="w"> </span>autoconf<span class="w"> </span>automake<span class="w"> </span>bison<span class="w"> </span>boost<span class="w"> </span>boost-devel<span class="w"> </span>libxml2<span class="w"> </span>libxml2-devel<span class="w"> </span>make<span class="w"> </span>ncurses<span class="w"> </span>grub2<span class="w"> </span>bc<span class="w"> </span>csh<span class="w"> </span>flex<span class="w"> </span>glibc-locale-source<span class="w"> </span>libnsl<span class="w"> </span>ncurses-compat-libs<span class="w"> </span>
</code></pre></div>
<p>Apply the following configurations.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>localedef<span class="w"> </span>-f<span class="w"> </span>UTF-8<span class="w"> </span>-i<span class="w"> </span>en_US<span class="w"> </span>en_US.UTF-8<span class="w"> </span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>$<span class="w"> </span>sudo<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/usr/lib64/libncurses.so.6<span class="w"> </span>/usr/lib64/libncurses.so.5<span class="w"> </span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>$<span class="w"> </span>sudo<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/usr/bin/python3<span class="w"> </span>/usr/bin/python
</code></pre></div>
</li>
<li>
<p>Create the default installation path: <home directory>/intelFPGA_pro/<version number>, where <home directory> is the default path of the Linux workstation, or as set by the system administrator and <version> is your Quartus version number.</p>
<p>The installation path must satisfy the following requirements:</p>
<ul>
<li>Contain only alphanumeric characters</li>
<li>No special characters or symbols, such as !$%@^&amp;*&lt;&gt;,</li>
<li>Only English characters</li>
<li>No spaces</li>
</ul>
</li>
<li>
<p>Download your required Quartus Prime Pro Linux version <a href="https://www.intel.com/content/www/us/en/products/details/fpga/development-tools/quartus-prime/resource.html">here</a>.</p>
</li>
<li>
<p>Install required Quartus patches. The Quartus patch <code>.run</code> files can be found in the <strong>Assets</strong> tab on the <a href="https://github.com/OFS/ofs-agx7-pcie-attach/releases/tag/ofs-2024.1-1"><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Release GitHub page</a>. The patches for this release are 0.17 patch (PCIe).</p>
</li>
<li>
<p>After running the Quartus Prime Pro installer, set the PATH environment variable to make utilities <code>quartus</code>, <code>jtagconfig</code>, and <code>quartus_pgm</code> discoverable. Edit your bashrc file <code>~/.bashrc</code> to add the following line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>&lt;Quartus<span class="w"> </span>install<span class="w"> </span>directory&gt;/quartus/bin:<span class="nv">$PATH</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>&lt;Quartus<span class="w"> </span>install<span class="w"> </span>directory&gt;/qsys/bin:<span class="nv">$PATH</span>
</code></pre></div>
<p>For example, if the Quartus install directory is /home/intelFPGA_pro/23.4 then the new line is:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>/home/intelFPGA_pro/23.4/quartus/bin:<span class="nv">$PATH</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>/home/intelFPGA_pro/23.4/qsys/bin:<span class="nv">$PATH</span>
</code></pre></div>
</li>
<li>
<p>Verify, Quartus is discoverable by opening a new shell:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>$ which quartus
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>/home/intelFPGA_pro/23.4/quartus/bin/quartus
</code></pre></div>
</li>
</ol>
<h4 id="132-fim-source-files"><strong>1.3.2 <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Source Files</strong><a class="headerlink" href="#132-fim-source-files" title="Permanent link">&para;</a></h4>
<p>The source files for the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> are provided in the following repository: <a href="https://github.com/OFS/ofs-agx7-pcie-attach/releases/tag/ofs-2024.1-1">https://github.com/<abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>/ofs-agx7-pcie-attach/releases/tag/ofs-2024.1-1</a>.</p>
<p>Some essential directories in the repository are described as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>ofs-agx7-pcie-attach
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="p">|</span><span class="w">  </span>syn<span class="w">                      </span>//<span class="w"> </span>Contains<span class="w"> </span>files<span class="w"> </span>related<span class="w"> </span>to<span class="w"> </span>synthesis
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>board<span class="w">                     </span>//<span class="w"> </span>Contains<span class="w"> </span>synthesis<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>several<span class="w"> </span>cards,<span class="w"> </span>including<span class="w"> </span>the<span class="w"> </span>n6001<span class="w"> </span>and<span class="w"> </span>n6000
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>n6001<span class="w">                  </span>//<span class="w"> </span>Contains<span class="w"> </span>synthesis<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>n6001<span class="w"> </span>and<span class="w"> </span>n6000
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>setup<span class="w">                       </span>//<span class="w"> </span>Contains<span class="w"> </span>setup<span class="w"> </span>files,<span class="w"> </span>including<span class="w"> </span>pin<span class="w"> </span>constraints<span class="w"> </span>and<span class="w"> </span>location<span class="w"> </span>constraints
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>syn_top<span class="w">                     </span>//<span class="w"> </span>Contains<span class="w"> </span>Quartus<span class="w"> </span>project<span class="w"> </span>files
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="p">|</span><span class="w">  </span>verification<span class="w">             </span>//<span class="w"> </span>Contains<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>UVM<span class="w"> </span>testing
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="p">|</span><span class="w">  </span>ipss<span class="w">                     </span>//<span class="w"> </span>Contains<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>IP<span class="w"> </span>Sub-Systems
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>qsfp<span class="w">                      </span>//<span class="w"> </span>Contains<span class="w"> </span><span class="nb">source</span><span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>QSFP<span class="w"> </span>Sub-System
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>hssi<span class="w">                      </span>//<span class="w"> </span>Contains<span class="w"> </span><span class="nb">source</span><span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>HSSI<span class="w"> </span>Sub-System
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>pmci<span class="w">                      </span>//<span class="w"> </span>Contains<span class="w"> </span><span class="nb">source</span><span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>PMCI<span class="w"> </span>Sub-System<span class="w"> </span><span class="o">(</span>not<span class="w"> </span>used<span class="w"> </span><span class="k">in</span><span class="w"> </span>F-Tile<span class="w"> </span>FIM<span class="o">)</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>pcie<span class="w">                      </span>//<span class="w"> </span>Contains<span class="w"> </span><span class="nb">source</span><span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>PCIe<span class="w"> </span>Sub-System
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>mem<span class="w">                       </span>//<span class="w"> </span>Contains<span class="w"> </span><span class="nb">source</span><span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>Memory<span class="w"> </span>Sub-System
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="p">|</span><span class="w">  </span>sim<span class="w">                      </span>//<span class="w"> </span>Contains<span class="w"> </span>simulation<span class="w"> </span>files
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>unit_test<span class="w">                 </span>//<span class="w"> </span>Contains<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>all<span class="w"> </span>unit<span class="w"> </span>tests
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>scripts<span class="w">                    </span>//<span class="w"> </span>Contains<span class="w"> </span>script<span class="w"> </span>to<span class="w"> </span>run<span class="w"> </span>regression<span class="w"> </span>unit<span class="w"> </span>tests
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="p">|</span><span class="w">  </span>license<span class="w">                  </span>//<span class="w"> </span>Contains<span class="w"> </span>Quartus<span class="w"> </span>patch
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="p">|</span><span class="w">  </span>ofs-common<span class="w">               </span>//<span class="w"> </span>Contains<span class="w"> </span>files<span class="w"> </span>which<span class="w"> </span>are<span class="w"> </span>common<span class="w"> </span>across<span class="w"> </span>OFS<span class="w"> </span>platforms
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>verification<span class="w">              </span>//<span class="w"> </span>Contains<span class="w"> </span>common<span class="w"> </span>UVM<span class="w"> </span>files
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>scripts<span class="w">                   </span>//<span class="w"> </span>Contains<span class="w"> </span>common<span class="w"> </span>scripts
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>common
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>syn<span class="w">                         </span>//<span class="w"> </span>Contains<span class="w"> </span>common<span class="w"> </span>scripts<span class="w"> </span><span class="k">for</span><span class="w"> </span>synthesis,<span class="w"> </span>including<span class="w"> </span>build<span class="w"> </span>script
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>sim<span class="w">                         </span>//<span class="w"> </span>Contains<span class="w"> </span>common<span class="w"> </span>scripts<span class="w"> </span><span class="k">for</span><span class="w"> </span>simulation
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>tools<span class="w">                     </span>//<span class="w"> </span>Contains<span class="w"> </span>common<span class="w"> </span>tools<span class="w"> </span>files
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>mk_csr_module<span class="w">              </span>//<span class="w"> </span>Contains<span class="w"> </span>common<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>CSR<span class="w"> </span>modules
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>fabric_generation<span class="w">          </span>//<span class="w"> </span>Contains<span class="w"> </span>common<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>APF/BPF<span class="w"> </span>fabric<span class="w"> </span>generation
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>ofss_config<span class="w">                </span>//<span class="w"> </span>Contains<span class="w"> </span>common<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>OFSS<span class="w"> </span>configuration<span class="w"> </span>tool
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>ip_params<span class="w">                   </span>//<span class="w"> </span>Contains<span class="w"> </span>default<span class="w"> </span>IP<span class="w"> </span>parameters<span class="w"> </span><span class="k">for</span><span class="w"> </span>certain<span class="w"> </span>Sub-Systems<span class="w"> </span>when<span class="w"> </span>using<span class="w"> </span>OFSS
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>src<span class="w">                       </span>//<span class="w"> </span>Contains<span class="w"> </span>common<span class="w"> </span><span class="nb">source</span><span class="w"> </span>files,<span class="w"> </span>including<span class="w"> </span>host<span class="w"> </span>exercisers
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a><span class="p">|</span><span class="w">  </span>tools<span class="w">                    </span>//
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>ofss_config<span class="w">               </span>//<span class="w"> </span>Contains<span class="w"> </span>top<span class="w"> </span>level<span class="w"> </span>OFSS<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>each<span class="w"> </span>pre-made<span class="w"> </span>board<span class="w"> </span>configuration
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>hssi<span class="w">                       </span>//<span class="w"> </span>Contains<span class="w"> </span>OFSS<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>Ethernet-SS<span class="w"> </span>configuraiton
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>memory<span class="w">                     </span>//<span class="w"> </span>Contains<span class="w"> </span>OFSS<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>Memory-SS<span class="w"> </span>configuration
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>pcie<span class="w">                       </span>//<span class="w"> </span>Contains<span class="w"> </span>OFSS<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>PCIe-SS<span class="w"> </span>configuration
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>iopll<span class="w">                      </span>//<span class="w"> </span>Contains<span class="w"> </span>OFSS<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>IOPLL<span class="w"> </span>configuration
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a><span class="p">|</span><span class="w">  </span>src<span class="w">                      </span>//<span class="w"> </span>Contains<span class="w"> </span><span class="nb">source</span><span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>Agilex<span class="w"> </span>PCIe<span class="w"> </span>Attach<span class="w"> </span>FIM
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>pd_qsys<span class="w">                   </span>//<span class="w"> </span>Contains<span class="w"> </span><span class="nb">source</span><span class="w"> </span>files<span class="w"> </span>related<span class="w"> </span>to<span class="w"> </span>APF/BPF<span class="w"> </span>fabric
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>includes<span class="w">                  </span>//<span class="w"> </span>Contains<span class="w"> </span><span class="nb">source</span><span class="w"> </span>file<span class="w"> </span>header<span class="w"> </span>files
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>top<span class="w">                       </span>//<span class="w"> </span>Contains<span class="w"> </span>top-level<span class="w"> </span><span class="nb">source</span><span class="w"> </span>files,<span class="w"> </span>including<span class="w"> </span>design<span class="w"> </span>top<span class="w"> </span>module
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>afu_top<span class="w">                   </span>//<span class="w"> </span>Contains<span class="w"> </span>top-level<span class="w"> </span><span class="nb">source</span><span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>AFU
</code></pre></div>
<h5 id="1321-walkthrough-clone-fim-repository"><strong>1.3.2.1 Walkthrough: Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</strong><a class="headerlink" href="#1321-walkthrough-clone-fim-repository" title="Permanent link">&para;</a></h5>
<p>Perform the following steps to clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex® 7 PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository:</p>
<ol>
<li>
<p>Create a new directory to use as a clean starting point to store the retrieved files.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>mkdir<span class="w"> </span>OFS_BUILD_ROOT
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nb">cd</span><span class="w"> </span>OFS_BUILD_ROOT
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OFS_BUILD_ROOT</span><span class="o">=</span><span class="nv">$PWD</span>
</code></pre></div></p>
</li>
<li>
<p>Clone GitHub repository using the HTTPS git method
    <div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>git<span class="w"> </span>clone<span class="w"> </span>--recurse-submodules<span class="w"> </span>https://github.com/OFS/ofs-agx7-pcie-attach.git
</code></pre></div></p>
</li>
<li>
<p>Check out the correct tag of the repository
    <div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nb">cd</span><span class="w"> </span>ofs-agx7-pcie-attach
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>git<span class="w"> </span>checkout<span class="w"> </span>--recurse-submodules<span class="w"> </span>tags/ofs-2024.1-1
</code></pre></div></p>
</li>
<li>
<p>Ensure that <code>ofs-common</code> has been cloned as well</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>git<span class="w"> </span>submodule<span class="w"> </span>status
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>ea585a4f48d50faf3ae7ecfbec82525a8d22c730<span class="w"> </span>ofs-common<span class="w"> </span><span class="o">(</span>ofs-2024.1-1<span class="o">)</span>
</code></pre></div>
</li>
</ol>
<h4 id="133-environment-variables"><strong>1.3.3 Environment Variables</strong><a class="headerlink" href="#133-environment-variables" title="Permanent link">&para;</a></h4>
<p>The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> compilation and simulation scripts require certain environment variables be set prior to execution.</p>
<h5 id="1331-walkthrough-set-development-environment-variables"><strong>1.3.3.1 Walkthrough: Set Development Environment Variables</strong><a class="headerlink" href="#1331-walkthrough-set-development-environment-variables" title="Permanent link">&para;</a></h5>
<p>Perform the following steps to set the required environment variables. These environment variables must be set prior to simulation or compilation tasks so it is recommended that you create a script to set these variables.</p>
<ol>
<li>
<p>Navigate to the top level directory of the cloned <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nb">cd</span><span class="w"> </span>ofs-agx7-pcie-attach
</code></pre></div>
</li>
<li>
<p>Set project variables
  <div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># Set OFS Root Directory - e.g. this is the top level directory of the cloned OFS FIM repository</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OFS_ROOTDIR</span><span class="o">=</span><span class="nv">$PWD</span>
</code></pre></div></p>
</li>
<li>
<p>Set variables based on your development environment
  <div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Set proxies if required for your server</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">http_proxy</span><span class="o">=</span>&lt;YOUR_HTTP_PROXY&gt;
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">https_proxy</span><span class="o">=</span>&lt;YOUR_HTTPS_PROXY&gt;
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">ftp_proxy</span><span class="o">=</span>&lt;YOUR_FTP_PROXY&gt;
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">socks_proxy</span><span class="o">=</span>&lt;YOUR_SOCKS_PROXY&gt;
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">no_proxy</span><span class="o">=</span>&lt;YOUR_NO_PROXY&gt;
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="c1"># Set Quartus license path</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="nb">export</span><span class="w"> </span><span class="nv">LM_LICENSE_FILE</span><span class="o">=</span>&lt;YOUR_LM_LICENSE_FILE&gt;
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="c1"># Set Synopsys License path (if using Synopsys for simulation)</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="nb">export</span><span class="w"> </span><span class="nv">DW_LICENSE_FILE</span><span class="o">=</span>&lt;YOUR_DW_LICENSE_FILE&gt;
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="nb">export</span><span class="w"> </span><span class="nv">SNPSLMD_LICENSE_FILE</span><span class="o">=</span>&lt;YOUR_SNPSLMD_LICENSE_FILE&gt;
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="c1"># Set Quartus Installation Directory - e.g. $QUARTUS_ROOTDIR/bin contains Quartus executables</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_ROOTDIR</span><span class="o">=</span>&lt;YOUR_QUARTUS_INSTALLATION_DIRECTORY&gt;
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="c1"># Set the Tools Directory - e.g. $TOOLS_LOCATION contains the &#39;synopsys&#39; directory if you are using Synopsys. Refer to the $VCS_HOME variable for an example.</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TOOLS_LOCATION</span><span class="o">=</span>&lt;YOUR_TOOLS_LOCATION&gt;
</code></pre></div></p>
</li>
<li>
<p>Set generic environment variables</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Set Work directory </span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">WORKDIR</span><span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="c1"># Set Quartus Tools variables</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_HOME</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_INSTALL_DIR</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_ROOTDIR_OVERRIDE</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_VER_AC</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="nb">export</span><span class="w"> </span><span class="nv">IP_ROOTDIR</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/../ip
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="nb">export</span><span class="w"> </span><span class="nv">IMPORT_IP_ROOTDIR</span><span class="o">=</span><span class="nv">$IP_ROOTDIR</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QSYS_ROOTDIR</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/../qsys/bin
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="c1"># Set Verification Tools variables (if running simulations)</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="nb">export</span><span class="w"> </span><span class="nv">DESIGNWARE_HOME</span><span class="o">=</span><span class="nv">$TOOLS_LOCATION</span>/synopsys/vip_common/vip_Q-2020.03A
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="nb">export</span><span class="w"> </span><span class="nv">UVM_HOME</span><span class="o">=</span><span class="nv">$TOOLS_LOCATION</span>/synopsys/vcsmx/S-2021.09-SP1/linux64/rhel/etc/uvm
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="nb">export</span><span class="w"> </span><span class="nv">VCS_HOME</span><span class="o">=</span><span class="nv">$TOOLS_LOCATION</span>/synopsys/vcsmx/S-2021.09-SP1/linux64/rhel
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="nb">export</span><span class="w"> </span><span class="nv">MTI_HOME</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/../questa_fse
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="nb">export</span><span class="w"> </span><span class="nv">VERDIR</span><span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>/verification
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="nb">export</span><span class="w"> </span><span class="nv">VIPDIR</span><span class="o">=</span><span class="nv">$VERDIR</span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="c1"># Set OPAE variables</span>
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OPAE_SDK_REPO_BRANCH</span><span class="o">=</span>release/2.12.0
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a>
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="c1"># Set PATH to include compilation and simulation tools</span>
<a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$QUARTUS_HOME</span>/bin:<span class="nv">$QUARTUS_HOME</span>/../qsys/bin:<span class="nv">$QUARTUS_HOME</span>/sopc_builder/bin/:<span class="nv">$IOFS_BUILD_ROOT</span>/opae-sdk/install-opae-sdk/bin:<span class="nv">$MTI_HOME</span>/linux_x86_64/:<span class="nv">$MTI_HOME</span>/bin/:<span class="nv">$DESIGNWARE_HOME</span>/bin:<span class="nv">$VCS_HOME</span>/bin:<span class="nv">$PATH</span>
</code></pre></div>
</li>
</ol>
<h4 id="134-walkthrough-set-up-development-environment"><strong>1.3.4 Walkthrough: Set Up Development Environment</strong><a class="headerlink" href="#134-walkthrough-set-up-development-environment" title="Permanent link">&para;</a></h4>
<p>This walkthrough guides you through the process of setting up your development environment in preparation for <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> development. This flow only needs to be done once on your development machine.</p>
<ol>
<li>
<p>Ensure that Quartus Prime Pro Version 23.4 for Linux with Intel Agilex FPGA device support is installed on your development machine. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1311-walkthrough-install-quartus-prime-pro-software">Install Quartus Prime Pro Software</a> section for step-by-step installation instructions.</p>
<ol>
<li>Verify version number<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>quartus_sh<span class="w"> </span>--version
</code></pre></div>
<p>Example Output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>Quartus<span class="w"> </span>Prime<span class="w"> </span>Shell
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>Version<span class="w"> </span><span class="m">23</span>.4<span class="w"> </span>Build<span class="w"> </span><span class="m">94</span><span class="w"> </span><span class="m">06</span>/14/2023<span class="w"> </span>SC<span class="w"> </span>Pro<span class="w"> </span>Edition
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>Copyright<span class="w"> </span><span class="o">(</span>C<span class="o">)</span><span class="w"> </span><span class="m">2023</span><span class="w">  </span>Intel<span class="w"> </span>Corporation.<span class="w"> </span>All<span class="w"> </span>rights<span class="w"> </span>reserved.
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Ensure that all support tools are installed on your development machine, and that they meet the version requirements.</p>
<ol>
<li>
<p>Python 3.6.8 or later</p>
<ol>
<li>
<p>Verify version number</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>python<span class="w"> </span>--version
</code></pre></div>
<p>Example Output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>Python<span class="w"> </span><span class="m">3</span>.6.8
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>GCC 8.5.0 or later</p>
<ol>
<li>
<p>Verify version number</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>gcc<span class="w"> </span>--version
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>gcc<span class="w"> </span><span class="o">(</span>GCC<span class="o">)</span><span class="w"> </span><span class="m">8</span>.5.0
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>cmake 3.15 or later</p>
<ol>
<li>
<p>Verify version number</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>cmake<span class="w"> </span>--version
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>cmake<span class="w"> </span>version<span class="w"> </span><span class="m">3</span>.15
</code></pre></div>
</li>
</ol>
</li>
</ol>
</li>
<li>
<p>Clone the ofs-agx7-pcie-attach repository. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Install UART IP license patch <code>.02</code>.</p>
<ol>
<li>
<p>Navigate to the <code>license</code> directory</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$IOFS_BUILD_ROOT</span>/license
</code></pre></div>
</li>
<li>
<p>Install Patch 0.02</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>sudo<span class="w"> </span>./quartus-0.0-0.02iofs-linux.run
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Install Quartus Patches 0.17 patch (PCIe). All required patches are provided in the <strong>Assets</strong> of the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Release: https://github.com/<abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>/ofs-agx7-pcie-attach/releases/tag/ofs-2024.1-1</p>
<ol>
<li>
<p>Extract and unzip the <code>patch-agx7-2024-1.tar.gz</code> file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>tar<span class="w"> </span>-xvzf<span class="w"> </span>patch-agx7-2024-1.tar.gz
</code></pre></div>
</li>
<li>
<p>Run each patch <code>.run</code> file. As an example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>sudo<span class="w"> </span>./quartus-23.4-0.17-linux.run
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Verify that patches have been installed correctly. They should be listed in the output of the following command.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>quartus_sh<span class="w"> </span>--version
</code></pre></div>
</li>
<li>
<p>Set required environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
</ol>
<p>This concludes the walkthrough for setting up your development environment. At this point you are ready to begin <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> development.</p>
<h2 id="2-fim-compilation"><strong>2. <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Compilation</strong><a class="headerlink" href="#2-fim-compilation" title="Permanent link">&para;</a></h2>
<p>This section describes the process of compiling <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> designs using the provided build scripts. It contains two main sections:</p>
<ul>
<li><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#21-compilation-theory">Compilation Theory</a> - Describes the theory behind <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> compilation</li>
<li><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#22-compilation-flows">Compilation Flows</a> - Describes the process of compiling a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></li>
</ul>
<p>The walkthroughs provided in this section are:</p>
<ul>
<li><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#225-walkthrough-compile-ofs-fim">Compile <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a></li>
<li><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#226-walkthrough-manually-generate-ofs-out-of-tree-pr-fim">Manually Generate <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Out-Of-Tree <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a></li>
</ul>
<h3 id="21-compilation-theory"><strong>2.1 Compilation Theory</strong><a class="headerlink" href="#21-compilation-theory" title="Permanent link">&para;</a></h3>
<p>This section describes the theory behind <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> compilation.</p>
<h4 id="211-fim-build-script"><strong>2.1.1 <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Build Script</strong><a class="headerlink" href="#211-fim-build-script" title="Permanent link">&para;</a></h4>
<p>The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Common Repository contains a script named <code>build_top.sh</code> which is used to build <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> designs and generate output files that can be programmed to the board. After cloning the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (with the ofs-common repository included), the build script can be found in the following location:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="nv">$OFS_ROOTDIR</span>/ofs-common/scripts/common/syn/build_top.sh
</code></pre></div>
<p>The usage of the <code>build_top.sh</code> script is as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>build_top.sh<span class="w"> </span><span class="o">[</span>-k<span class="o">]</span><span class="w"> </span><span class="o">[</span>-p<span class="o">]</span><span class="w"> </span><span class="o">[</span>-e<span class="o">]</span><span class="w"> </span><span class="o">[</span>--stage<span class="o">=</span>&lt;action&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--ofss<span class="o">=</span>&lt;ip_config&gt;<span class="o">]</span><span class="w"> </span>&lt;build_target&gt;<span class="o">[</span>:&lt;fim_options&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>&lt;work_dir_name&gt;<span class="o">]</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Field</th>
<th>Options</th>
<th>Description</th>
<th>Requirement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-k</code></td>
<td>None</td>
<td>Keep. Preserves and rebuilds within an existing work tree instead of overwriting it.</td>
<td>Optional</td>
</tr>
<tr>
<td><code>-p</code></td>
<td>None</td>
<td>When set, and if the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> supports partial reconfiguration, a <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> template tree is generated at the end of the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> build. The <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> template tree is located in the top of the work directory but is relocatable and uses only relative paths. See $OFS_ROOTDIR/syn/common/scripts generate_pr_release.sh for details.</td>
<td>Optional</td>
</tr>
<tr>
<td><code>-e</code></td>
<td>None</td>
<td>Run only Quartus analysis and elaboration. It completes the <code>setup</code> stage, passes <code>-end synthesis</code> to the Quartus compilation flow and exits without running the <code>finish</code> stage.</td>
<td>Optional</td>
</tr>
<tr>
<td><code>--stage</code></td>
<td><code>all</code> | <code>setup</code> | <code>compile</code> | <code>finish</code></td>
<td>Controls which portion of the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> build is run.</br>&nbsp;&nbsp;- <code>all</code>: Run all build stages (default)</br>&nbsp;&nbsp;- <code>setup</code>: Initialize a project in the work directory</br>&nbsp;&nbsp;- <code>compile</code>: Run the Quartus compilation flow on a project that was already initialized with <code>setup</code></br>&nbsp;&nbsp;- <code>finish</code>: Complete <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> post-compilation tasks, such as generating flash images and, if <code>-p</code> is set, generating a release.</td>
<td>Optional</td>
</tr>
<tr>
<td><code>--ofss</code></td>
<td><code>&lt;ip_config&gt;</code></td>
<td>Used to modify IP, such as the PCIe SS, using .ofss configuration files. This parameter is consumed during the setup stage and IP is updated only inside the work tree. More than one .ofss file may be passed to the <code>--ofss</code> switch by concatenating them separated by commas. For example: <code>--ofss config_a.ofss,config_b.ofss</code>.</td>
<td>Optional</td>
</tr>
<tr>
<td><code>&lt;build_target&gt;</code></td>
<td><code>n6000</code> | <code>n6001</code> | <code>fseries-dk</code> | <code>iseries-dk</code></td>
<td>Specifies which board is being targeted.</td>
<td>Required</td>
</tr>
<tr>
<td><code>&lt;fim_options&gt;</code></td>
<td><code>flat</code> | <code>null_he_lb</code> | <code>null_he_hssi</code> | <code>null_he_mem</code> | <code>null_he_mem_tg</code> | <code>no_hssi</code></td>
<td>Used to change how the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> is built.</br>&nbsp;&nbsp;&bull; <code>flat</code> - Compiles a flat design (no <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> assignments). This is useful for bringing up the design on a new board without dealing with <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> complexity.</br>&nbsp;&nbsp;&bull; <code>null_he_lb</code> - Replaces the Host Exerciser Loopback (HE_LBK) with <code>he_null</code>.</br>&nbsp;&nbsp;&bull; <code>null_he_hssi</code> - Replaces the Host Exerciser HSSI (HE_HSSI) with <code>he_null</code>.</br>&nbsp;&nbsp;&bull; <code>null_he_mem</code> - Replaces the Host Exerciser Memory (HE_MEM) with <code>he_null</code>.</br>&nbsp;&nbsp;&bull; <code>null_he_mem_tg</code> - Replaces the Host Exerciser Memory Traffic Generator with <code>he_null</code>. </br>&nbsp;&nbsp;&bull; <code>no_hssi</code> - Removes the HSSI-SS from the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. </br>More than one <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> option may be passed included in the <code>&lt;fim_options&gt;</code> list by concatenating them separated by commas. For example: <code>&lt;build_target&gt;:flat,null_he_lb,null_he_hssi</code></td>
<td>Optional</td>
</tr>
<tr>
<td><code>&lt;work_dir_name&gt;</code></td>
<td>String</td>
<td>Specifies the name of the work directory in which the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> will be built. If not specified, the default target is <code>$OFS_ROOTDIR/work</code></td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p>Refer to <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#225-walkthrough-compile-ofs-fim">Compile <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a> which provides step-by-step instructions for running the <code>build_top.sh</code> script with some of the different available options.</p>
<h4 id="2111-build-work-directory"><strong>2.1.1.1 Build Work Directory</strong><a class="headerlink" href="#2111-build-work-directory" title="Permanent link">&para;</a></h4>
<p>The build script copies source files from the existing cloned repository into the specified work directory, which are then used for compilation. As such, any changes made in the base source files will be included in all subsequent builds, unless the <code>-k</code> option is used, in which case an existing work directories files are used as-is. Likewise, any changes made in a work directory is only applied to that work directory, and will not be updated in the base repository by default. When using OFSS files to modify the design, the build script will create a work directory and make the modifications in the work directory.</p>
<h4 id="2112-null-host-exercisers"><strong>2.1.1.2 Null Host Exercisers</strong><a class="headerlink" href="#2112-null-host-exercisers" title="Permanent link">&para;</a></h4>
<p>An HE_NULL <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> refers to a design with one, some, or all of the Host Exercisers replaced by <code>he_null</code> blocks. The <code>he_null</code> is a minimal block with CSRs that responds to PCIe <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> requests in order to keep PCIe alive. You may use any of the build flows (flat, in-tree, out-of-tree) with the HE_NULL compile options. The HE_NULL compile options are as follows:</p>
<ul>
<li><code>null_he_lb</code> - Replaces the Host Exerciser Loopback (HE_LBK) with <code>he_null</code></li>
<li><code>null_he_hssi</code> - Replaces the Host Exerciser HSSI (HE_HSSI) with <code>he_null</code></li>
<li><code>null_he_mem</code> - Replaces the Host Exerciser Memory (HE_MEM) with <code>he_null</code></li>
<li><code>null_he_mem_tg</code> - Replaces the Host Exerciser Memory Traffic Generator with <code>he_null</code></li>
</ul>
<p>The <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#225-walkthrough-compile-ofs-fim">Compile <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a> section gives step-by-step instructions for this flow.</p>
<h4 id="212-ofss-file-usage"><strong>2.1.2 OFSS File Usage</strong><a class="headerlink" href="#212-ofss-file-usage" title="Permanent link">&para;</a></h4>
<p>The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> build script can use OFSS files to easily customize design IP prior to compilation using preset configurations. The OFSS files specify certain parameters for different IPs. Using OFSS is provided as a convenience feature for building FIMs. The <em>Provided OFSS Files</em> table below describes the pre-made OFSS files for the n6001 that can be found in the <code>$OFS_ROOTDIR/tools/ofss_config</code> directory. Only the OFSS files listed in this table are compatible with the n6001 In order to compile an n6001 <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>, you must supply OFSS files corresponding to each IP that is present in your design.</p>
<p><em>Table: Provided OFSS Files</em></p>
<table>
<thead>
<tr>
<th>OFSS File Name</th>
<th>Location</th>
<th>Type</th>
<th>Description</th>
<th>Supported Board</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>n6001.ofss</code></td>
<td><code>$OFS_ROOTDIR/tools/ofss_config</code></td>
<td>Top</td>
<td>Includes the following OFSS files:</br> &nbsp;&nbsp;&bull; <code>n6001_base.ofss</code></br> &nbsp;&nbsp;&bull; <code>pcie_host.ofss</code></br> &nbsp;&nbsp;&bull; <code>iopll.ofss</code></br> &nbsp;&nbsp;&bull; <code>memory.ofss</code></td>
<td>N6001</td>
</tr>
<tr>
<td><code>n6001_2pf.ofss</code></td>
<td><code>$OFS_ROOTDIR/tools/ofss_config</code></td>
<td>Top</td>
<td>Includes the following OFSS files:</br> &nbsp;&nbsp;&bull; <code>n6001_base.ofss</code></br> &nbsp;&nbsp;&bull; <code>pcie_2pf.ofss</code></br> &nbsp;&nbsp;&bull; <code>iopll.ofss</code></br> &nbsp;&nbsp;&bull; <code>memory.ofss</code></td>
<td>N6001</td>
</tr>
<tr>
<td><code>n6001_1pf_1vf.ofss</code></td>
<td><code>$OFS_ROOTDIR/tools/ofss_config</code></td>
<td>Top</td>
<td>Includes the following OFSS files:</br> &nbsp;&nbsp;&bull; <code>n6001_base.ofss</code></br> &nbsp;&nbsp;&bull; <code>pcie_1pf_1vf.ofss</code></br> &nbsp;&nbsp;&bull; <code>iopll.ofss</code></br> &nbsp;&nbsp;&bull; <code>memory.ofss</code></td>
<td>N6001</td>
</tr>
<tr>
<td><code>n6000.ofss</code></td>
<td><code>$OFS_ROOTDIR/tools/ofss_config</code></td>
<td>Top</td>
<td>Includes the following OFSS files:</br> &nbsp;&nbsp;&bull; <code>n6000_base.ofss</code></br> &nbsp;&nbsp;&bull; <code>pcie_host_n6000.ofss</code></br> &nbsp;&nbsp;&bull; <code>iopll_n6000.ofss</code></br> &nbsp;&nbsp;&bull; <code>hssi_4x100.ofss</code></td>
<td>N6000</td>
</tr>
<tr>
<td><code>n6001_base.ofss</code></td>
<td><code>$OFS_ROOTDIR/tools/ofss_config</code></td>
<td>ofs</td>
<td>Defines certain attributes of the design, including the platform name, device family, fim type, part number, and device ID.</td>
<td>N6001</td>
</tr>
<tr>
<td><code>n6000_base.ofss</code></td>
<td><code>$OFS_ROOTDIR/tools/ofss_config</code></td>
<td>ofs</td>
<td>Defines certain attributes of the design, including the platform name, device family, fim type, part number, and device ID.</td>
<td>N6000</td>
</tr>
<tr>
<td><code>pcie_host.ofss</code></td>
<td><code>$OFS_ROOTDIR/tools/ofss_config/pcie</code></td>
<td>pcie</td>
<td>Defines the PCIe Subsystem for the N6001 with the following configuration:</br>&nbsp;&nbsp;&bull; PF0 (3 VFs)</br>&nbsp;&nbsp;&bull; PF1 (0 VFs)</br>&nbsp;&nbsp;&bull; PF2 (0 VFs)</br>&nbsp;&nbsp;&bull; PF3 (0 VFs)</br>&nbsp;&nbsp;&bull; PF4 (0 VFs)</td>
<td>N6001</td>
</tr>
<tr>
<td><code>pcie_2pf.ofss</code></td>
<td><code>$OFS_ROOTDIR/tools/ofss_config/pcie</code></td>
<td>pcie</td>
<td>Defines the PCIe Subsystem with the following configuration:</br>&nbsp;&nbsp;&bull; PF0 (0 VFs)</br>&nbsp;&nbsp;&bull; PF1 (0 VFs)</td>
<td>N6001</td>
</tr>
<tr>
<td><code>pcie_1pf_1vf.ofss</code></td>
<td><code>$OFS_ROOTDIR/tools/ofss_config/pcie</code></td>
<td>pcie</td>
<td>Defines the PCIe Subsystem with the following configuration:</br>&nbsp;&nbsp;&bull; PF0 (1 VF)</td>
<td>N6001</td>
</tr>
<tr>
<td><code>pcie_host_n6000.ofss</code></td>
<td><code>$OFS_ROOTDIR/tools/ofss_config/pcie</code></td>
<td>pcie</td>
<td>Defines the PCIe Subsystem for the N6000 with the following configuration:</br>&nbsp;&nbsp;&bull; PF0 (3 VFs)</br>&nbsp;&nbsp;&bull; PF1 (0 VFs)</br>&nbsp;&nbsp;&bull; PF2 (0 VFs)</br>&nbsp;&nbsp;&bull; PF3 (0 VFs)</br>&nbsp;&nbsp;&bull; PF4 (0 VFs)</td>
<td>N6001</td>
</tr>
<tr>
<td><code>iopll.ofss</code></td>
<td><code>$OFS_ROOTDIR/tools/ofss_config/iopll</code></td>
<td>iopll</td>
<td>Sets the IOPLL frequency to <code>470 MHz</code></td>
<td>N6001</td>
</tr>
<tr>
<td><code>iopll_n6000.ofss</code></td>
<td><code>$OFS_ROOTDIR/tools/ofss_config/iopll</code></td>
<td>iopll</td>
<td>Sets the IOPLL frequency to <code>350 MHz</code></td>
<td>N6000</td>
</tr>
<tr>
<td><code>memory.ofss</code></td>
<td><code>$OFS_ROOTDIR/tools/ofss_config/memory</code></td>
<td>memory</td>
<td>Defines the memory IP preset file to be used during the build as <code>n6001</code></td>
<td>N6001 | N6000 <sup><strong>[1]</strong></sup></td>
</tr>
<tr>
<td><code>hssi_8x25.ofss</code></td>
<td><code>$OFSS_ROOTDIR/tools/ofss_config/hssi</code></td>
<td>hssi</td>
<td>Defines the Ethernet-SS IP configuration to be 8x25 GbE</td>
<td>N6001</td>
</tr>
<tr>
<td><code>hssi_8x10.ofss</code></td>
<td><code>$OFSS_ROOTDIR/tools/ofss_config/hssi</code></td>
<td>hssi</td>
<td>Defines the Ethernet-SS IP configuration to be 8x10 GbE</td>
<td>N6001</td>
</tr>
<tr>
<td><code>hssi_2x100.ofss</code></td>
<td><code>$OFSS_ROOTDIR/tools/ofss_config/hssi</code></td>
<td>hssi</td>
<td>Defines the Ethernet-SS IP configuration to be 2x100 GbE</td>
<td>N6001</td>
</tr>
<tr>
<td><code>hssi_4x100.ofss</code></td>
<td><code>$OFSS_ROOTDIR/tools/ofss_config/hssi</code></td>
<td>hssi</td>
<td>Defines the Ethernet-SS IP configuration to be 4x100 GbE</td>
<td>N6000</td>
</tr>
</tbody>
</table>
<p><sup><strong>[1]</strong></sup> The <code>memory.ofss</code> file can be used for the N6000, however, the default N6000 <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> does not implement the Memory Sub-system. Refer to Section 4.7.2 for step-by-step instructions on how to enable the Memory sub-system</p>
<p>There can typically be three sections contained within an OFSS file.</p>
<ul>
<li>
<p><strong><code>[include]</code></strong></p>
<ul>
<li>This section of an OFSS file contains elements separated by a newline, where each element is the path to an OFSS file that is to be included for configuration by the OFSS Configuration Tool. Ensure that any environment variables (e.g. <code>$OFS_ROOTDIR</code>) is set correctly. The OFSS Config tool uses breadth first search to include all of the specified OFSS files; the ordering of OFSS files does not matter</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong><code>[ip]</code></strong></p>
<ul>
<li>This section of an OFSS file contains a key value pair that allows the OFSS Config tool to determine which IP configuration is being passed in. The currently supported values of IP are <code>ofs</code>, <code>iopll</code>, <code>pcie</code>, <code>memory</code>, and <code>hssi</code>.</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong><code>[settings]</code></strong></p>
<ul>
<li>This section of an OFSS file contains IP specific settings. Refer to an existing IP OFSS file to see what IP settings are set. For the IP type `ofss``, the settings will be information of the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> device (platform, family, fim, part #, device_id)</li>
</ul>
</li>
</ul>
<h5 id="2121-platform-ofss-file"><strong>2.1.2.1 Platform OFSS File</strong><a class="headerlink" href="#2121-platform-ofss-file" title="Permanent link">&para;</a></h5>
<p>The <code>&lt;platform&gt;.ofss</code> file (e.g. <code>$OFS_ROOTDIR/tools/ofss_config/n6001.ofss</code>) is the platform level OFSS wrapper file. This is typically the OFSS file that is provided to the build script. It only contains an <code>include</code> section which lists all other OFSS files that are to be used when the <code>&lt;platform&gt;.ofss</code> file is passed to the build script.</p>
<p>The generic structure of a <code>&lt;platform&gt;.ofss</code> file is as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="o">[</span>include<span class="o">]</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>&lt;PATH_TO_PLATFORM_BASE_OFSS_FILE&gt;
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>&lt;PATH_TO_PCIE_OFSS_FILE&gt;
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>&lt;PATH_TO_IOPLL_OFSS_FILE&gt;
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>&lt;PATH_TO_MEMORY_OFSS_FILE&gt;
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>&lt;PATH_TO_HSSI_OFSS_FILE&gt;
</code></pre></div>
<h5 id="2122-ofs-ip-ofss-file"><strong>2.1.2.2 <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> IP OFSS File</strong><a class="headerlink" href="#2122-ofs-ip-ofss-file" title="Permanent link">&para;</a></h5>
<p>An OFSS file with IP type <code>ofs</code> (e.g. <code>$OFS_ROOTDIR/tools/ofss_config/n6001_base.ofss</code>) contains board specific information for the target board.</p>
<p>Currently supported configuration options for an OFSS file with IP type <code>ofs</code> are described in the <em><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> IP OFSS File Options</em> table.</p>
<p><em>Table: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> IP OFSS File Options</em></p>
<table>
<thead>
<tr>
<th>Section</th>
<th>Parameter</th>
<th>n6001 Default Value</th>
<th>n6000 Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[ip]</code></td>
<td><code>type</code></td>
<td><code>ofs</code></td>
<td><code>ofs</code></td>
</tr>
<tr>
<td><code>[settings]</code></td>
<td><code>platform</code></td>
<td><code>n6001</code></td>
<td><code>n6000</code></td>
</tr>
<tr>
<td></td>
<td><code>family</code></td>
<td><code>agilex</code></td>
<td><code>agilex</code></td>
</tr>
<tr>
<td></td>
<td><code>fim</code></td>
<td><code>base_x16</code></td>
<td><code>base_x16</code></td>
</tr>
<tr>
<td></td>
<td><code>part</code></td>
<td><code>AGFB014R24A2E2V</code></td>
<td><code>AGFB014R24A2E2V</code></td>
</tr>
<tr>
<td></td>
<td><code>device_id</code></td>
<td><code>6001</code></td>
<td><code>6000</code></td>
</tr>
</tbody>
</table>
<h5 id="2123-pcie-ip-ofss-file"><strong>2.1.2.3 PCIe IP OFSS File</strong><a class="headerlink" href="#2123-pcie-ip-ofss-file" title="Permanent link">&para;</a></h5>
<p>An OFSS file with IP type <code>pcie</code> (e.g. <code>$OFS_ROOTDIR/tools/ofss_config/pcie/pcie_host.ofss</code>) is used to configure the PCIe-SS in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<p>The PCIe OFSS file has a special section type (<code>[pf*]</code>) which is used to define physical functions (PFs) in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. Each PF has a dedicated section, where the <code>*</code> character is replaced with the PF number. For example, <code>[pf0]</code>, <code>[pf1]</code>, etc. For reference <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> configurations, you must have at least 1 PF with 1VF, or 2PFs. This is because the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region cannot be left unconnected. PFs must be consecutive. The <em>PFVF Limitations</em> table describes the supported number of PFs and VFs.</p>
<p><em>Table: PF/VF Limitations</em></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Min # of PFs</td>
<td>1 (on PF0)</td>
</tr>
<tr>
<td>Max # of PFs</td>
<td>8</td>
</tr>
<tr>
<td>Min # of VFs</td>
<td>0 (if 2PFs are used)</td>
</tr>
<tr>
<td>Max # of VFs</td>
<td>2000 distributed across all PFs</td>
</tr>
</tbody>
</table>
<p>Currently supported configuration options for an OFSS file with IP type <code>pcie</code> are described in the <em>PCIe IP OFSS File Options</em> table.</p>
<p><em>Table: PCIe IP OFSS File Options</em></p>
<table>
<thead>
<tr>
<th>Section</th>
<th>Parameter</th>
<th>Options</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[ip]</code></td>
<td><code>type</code></td>
<td><code>pcie</code></td>
<td>Specifies that this OFSS file configures the PCIe-SS</td>
</tr>
<tr>
<td><code>[settings]</code></td>
<td><code>output_name</code></td>
<td><code>pcie_ss</code></td>
<td>Specifies the output name of the PCIe-SS IP</td>
</tr>
<tr>
<td></td>
<td><code>preset</code></td>
<td><em>String</em></td>
<td>OPTIONAL - Specifies the name of a PCIe-SS IP presets file to use when building the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. When used, a presets file will take priority over any other parameters set in this OFSS file.</td>
</tr>
<tr>
<td><code>[pf*]</code></td>
<td><code>num_vfs</code></td>
<td>Integer</td>
<td>Specifies the number of Virtual Functions in the current PF</td>
</tr>
<tr>
<td></td>
<td><code>bar0_address_width</code></td>
<td>Integer</td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>bar4_address_width</code></td>
<td>Integer</td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>vf_bar0_address_width</code></td>
<td>Integer</td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>ats_cap_enable</code></td>
<td><code>0</code> | <code>1</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>vf_ats_cap_enable</code></td>
<td><code>0</code> | <code>1</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>prs_ext_cap_enable</code></td>
<td><code>0</code> | <code>1</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>pasid_cap_enable</code></td>
<td><code>0</code> | <code>1</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>pci_type0_vendor_id</code></td>
<td>32'h Value</td>
<td><code>0x00008086</code></td>
</tr>
<tr>
<td></td>
<td><code>pci_type0_device_id</code></td>
<td>32'h Value</td>
<td><code>0x0000bcce</code></td>
</tr>
<tr>
<td></td>
<td><code>revision_id</code></td>
<td>32'h Value</td>
<td><code>0x00000001</code></td>
</tr>
<tr>
<td></td>
<td><code>class_code</code></td>
<td>32'h Value</td>
<td><code>0x00120000</code></td>
</tr>
<tr>
<td></td>
<td><code>subsys_vendor_id</code></td>
<td>32'h Value</td>
<td><code>0x00008086</code></td>
</tr>
<tr>
<td></td>
<td><code>subsys_dev_id</code></td>
<td>32'h Value</td>
<td><code>0x00001771</code></td>
</tr>
<tr>
<td></td>
<td><code>sriov_vf_device_id</code></td>
<td>32'h Value</td>
<td><code>0x0000bccf</code></td>
</tr>
<tr>
<td></td>
<td><code>exvf_subsysid</code></td>
<td>32'h Value</td>
<td><code>0x00001771</code></td>
</tr>
</tbody>
</table>
<p>The default values for all PCIe-SS parameters (that are not defined in the PCIe IP OFSS file) are defined in <code>$OFS_ROOTDIR/ofs-common/tools/ofss_config/ip_params/pcie_ss_component_parameters.py</code>. When using a PCIe IP OFSS file during compilation, the PCIe-SS IP that is used will be defined based on the values in the PCIe IP OFSS file plus the parameters defined in <code>pcie_ss_component_parameters.py</code>.</p>
<h5 id="2124-iopll-ip-ofss-file"><strong>2.1.2.4 IOPLL IP OFSS File</strong><a class="headerlink" href="#2124-iopll-ip-ofss-file" title="Permanent link">&para;</a></h5>
<p>An OFSS file with IP type <code>iopll</code> (e.g. <code>$OFS_ROOTDIR/tools/ofss_config/iopll/iopll.ofss</code>) is used to configure the IOPLL in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<p>The IOPLL OFSS file has a special section type (<code>[p_clk]</code>) which is used to define the IOPLL clock frequency.</p>
<p>Currently supported configuration options for an OFSS file with IP type <code>iopll</code> are described in the <em>IOPLL OFSS File Options</em> table.</p>
<p><em>Table: IOPLL OFSS File Options</em></p>
<table>
<thead>
<tr>
<th>Section</th>
<th>Parameter</th>
<th>Options</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[ip]</code></td>
<td><code>type</code></td>
<td><code>iopll</code></td>
<td>Specifies that this OFSS file configures the IOPLL</td>
</tr>
<tr>
<td><code>[settings]</code></td>
<td><code>output_name</code></td>
<td><code>sys_pll</code></td>
<td>Specifies the output name of the IOPLL.</td>
</tr>
<tr>
<td></td>
<td><code>instance_name</code></td>
<td><code>iopll_0</code></td>
<td>Specifies the instance name of the IOPLL.</td>
</tr>
<tr>
<td><code>[p_clk]</code></td>
<td><code>freq</code></td>
<td>Integer: 250 - 470</td>
<td>Specifies the IOPLL clock frequency in MHz.</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note:</strong> The following frequencies have been tested on reference boards: 350MHz, 400MHz, 470MHz.</p>
</blockquote>
<h5 id="2125-memory-ip-ofss-file"><strong>2.1.2.5 Memory IP OFSS File</strong><a class="headerlink" href="#2125-memory-ip-ofss-file" title="Permanent link">&para;</a></h5>
<p>An OFSS file with IP type <code>memory</code> (e.g. <code>$OFS_ROOTDIR/tools/ofss_config/memory/memory.ofss</code>) is used to configure the Memory-SS in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<p>The Memory OFSS file specifies a <code>preset</code> value, which selects a presets file (<code>.qprs</code>) to configure the Memory-SS.</p>
<p>Currently supported configuration options for an OFSS file with IP type <code>memory</code> are described in the <em>Memory OFSS File Options</em> table.</p>
<p><em>Table: Memory OFSS File Options</em></p>
<table>
<thead>
<tr>
<th>Section</th>
<th>Parameter</th>
<th>Options</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[ip]</code></td>
<td><code>type</code></td>
<td><code>memory</code></td>
<td>Specifies that this OFSS file configures the Memory-SS</td>
</tr>
<tr>
<td><code>[settings]</code></td>
<td><code>output_name</code></td>
<td><code>mem_ss_fm</code></td>
<td>Specifies the output name of the Memory-SS.</td>
</tr>
<tr>
<td></td>
<td><code>preset</code></td>
<td><code>n6001</code> | <em>String</em><sup><strong>[1]</strong></sup></td>
<td>Specifies the name of the <code>.qprs</code> presets file that will be used to build the Memory-SS.</td>
</tr>
</tbody>
</table>
<p><sup><strong>[1]</strong></sup> You may generate your own <code>.qprs</code> presets file with a unique name using Quartus. </p>
<p>Memory-SS presets files are stored in the <code>$OFS_ROOTDIR/ipss/mem/qip/presets</code> directory.</p>
<h5 id="2126-hssi-ip-ofss-file"><strong>2.1.2.6 HSSI IP OFSS File</strong><a class="headerlink" href="#2126-hssi-ip-ofss-file" title="Permanent link">&para;</a></h5>
<p>An OFSS file with IP type <code>hssi</code> (e.g. <code>$OFS_ROOTDIR/tools/ofss_config/hssi/hssi_8x25.ofss</code>) is used to configure the Ethernet-SS in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<p>Currently supported configuration options for an OFSS file with IP type <code>hssi</code> are described in the <em>HSSI OFSS File Options</em> table.</p>
<p><em>Table: HSSI OFSS File Options</em></p>
<table>
<thead>
<tr>
<th>Section</th>
<th>Parameter</th>
<th>Options</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[ip]</code></td>
<td><code>type</code></td>
<td><code>hssi</code></td>
<td>Specifies that this OFSS file configures the Ethernet-SS</td>
</tr>
<tr>
<td><code>[settings]</code></td>
<td><code>output_name</code></td>
<td><code>hssi_ss</code></td>
<td>Specifies the output name of the Ethernet-SS</td>
</tr>
<tr>
<td></td>
<td><code>num_channels</code></td>
<td>Integer</td>
<td>Specifies the number of channels.</td>
</tr>
<tr>
<td></td>
<td><code>data_rate</code></td>
<td><code>10GbE</code> | <code>25GbE</code> | <code>100GCAUI-4</code></td>
<td>Specifies the data rate</td>
</tr>
<tr>
<td></td>
<td><code>preset</code></td>
<td>None | <em>String</em><sup><strong>[1]</strong></sup></td>
<td>OPTIONAL - Selects the platform whose preset <code>.qprs</code> file will be used to build the Ethernet-SS. When used, this will overwrite the other settings in this OFSS file.</td>
</tr>
</tbody>
</table>
<p><sup><strong>[1]</strong></sup> You may generate your own <code>.qprs</code> presets file with a unique name using Quartus. </p>
<p>Ethernet-SS presets are stored in  <code>$OFS_ROOTDIR/ipss/hssi/qip/hssi_ss/presets</code> directory.</p>
<h4 id="213-ofs-build-script-outputs"><strong>2.1.3 <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Build Script Outputs</strong><a class="headerlink" href="#213-ofs-build-script-outputs" title="Permanent link">&para;</a></h4>
<p>The output files resulting from running the the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> <code>build_top.sh</code> build script are copied to a single directory during the <code>finish</code> stage of the build script. The path for this directory is: </p>
<ul>
<li>For N6001: <code>$OFS_ROOTDIR/&lt;WORK_DIRECTORY&gt;/syn/board/n6001/syn_top/output_files</code></li>
<li>For N6000: <code>$OFS_ROOTDIR/&lt;WORK_DIRECTORY&gt;/syn/board/n6000/syn_top/output_files</code></li>
</ul>
<p>The output files include programmable images and compilation reports. The <em><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Build Script Output Descriptions</em> table describes the images that are generated by the build script.</p>
<p><em>Table: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Build Script Output Descriptions</em></p>
<table>
<thead>
<tr>
<th>File</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ofs_top[_hps].bin</td>
<td>This is an intermediate, raw binary file. This intermediate raw binary file is produced by taking the Quartus generated <em>.sof file, and converting it to *.pof using quartus_pfg, then converting the *.pof to *.hexout using quartus_cpf, and finally converting the *.hexout to *.bin using objcopy. Depending on whether the FPGA design contains an HPS block, a different file will be generated. <br /><br />**ofs_top.bin*</em> - Raw binary image of the FPGA generated if there is no HPS present in the design. <br /><strong>ofs_top_hps.bin</strong> - Raw binary image of the FPGA generated if there is an HPS present in the design.</td>
</tr>
<tr>
<td>ofs_top_page1.bin</td>
<td>This is the binary of the Factory Image and is the input to PACSign utility to generate <strong>ofs_top_page1_unsigned.bin</strong> binary image file. <br />This image will carry binary content for the HPS if it is included in the SOF image.</td>
</tr>
<tr>
<td>ofs_top_page0_factory.bin</td>
<td>This is an input file to PACSign to generate <strong>ofs_top_page0_unsigned_factory.bin</strong>.</td>
</tr>
<tr>
<td>ofs_top_page0_unsigned_factory.bin</td>
<td>This is the unsigned PACSign output generated for the Factory Image.</td>
</tr>
<tr>
<td>ofs_top_page1_user1.bin</td>
<td>This is an input file to PACSign to generate <strong>ofs_top_page1_unsigned_user1.bin</strong>. This file is created by taking the ofs_top_[hps].bin file and assigning the User1 or appending factory block information.</td>
</tr>
<tr>
<td>ofs_top_page1_unsigned_user1.bin</td>
<td>This is the unsigned FPGA binary image generated by the PACSign utility for the User1 Image. This file is used to load the FPGA flash User1 Image using the fpgasupdate tool.</td>
</tr>
<tr>
<td>ofs_top_page2_user2.bin</td>
<td>This is an input file to PACSign to generate <strong>ofs_top_page2_unsigned_user2.bin</strong>. This file is created by taking the ofs_top_[hps].bin file and assigning the User2 or appending factory block information.</td>
</tr>
<tr>
<td>ofs_top_page2_unsigned_user2.bin</td>
<td>This is the unsigned FPGA binary image generated by the PACSign utility for the User2 Image. This file is used to load the FPGA flash User2 Image using the fpgasupdate tool.</td>
</tr>
<tr>
<td>ofs_top_hps.sof</td>
<td>If your design contains an Agilex® 7 FPGA Hard Processor System, then the build assembly process combines the FPGA ofs_top.sof programming file with <code>u-boot-spl-dtb.hex</code> to produce this file.</td>
</tr>
</tbody>
</table>
<h3 id="22-compilation-flows"><strong>2.2 Compilation Flows</strong><a class="headerlink" href="#22-compilation-flows" title="Permanent link">&para;</a></h3>
<p>This section provides information for using the build script to generate different <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> types. Walkthroughs are provided for each compilation flow. These walkthroughs require that the development environment has been set up as described in the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> section.</p>
<h4 id="221-flat-fim"><strong>2.2.1 Flat <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong><a class="headerlink" href="#221-flat-fim" title="Permanent link">&para;</a></h4>
<p>A flat <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> is compiled such that there is no partial reconfiguration region, and the entire design is built as a flat design. This is useful for compiling new designs without worrying about the complexity introduced by partial reconfiguration. The flat compile removes the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region and <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> IP; thus, you cannot use the <code>-p</code> build flag when using the <code>flat</code> compile setting. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#225-walkthrough-compile-ofs-fim">Compile <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a> Section for step-by-step instructions for this flow.</p>
<h4 id="222-in-tree-pr-fim"><strong>2.2.2 In-Tree <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong><a class="headerlink" href="#222-in-tree-pr-fim" title="Permanent link">&para;</a></h4>
<p>An In-Tree <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> is the default compilation if no compile flags or compile settings are used. This flow will compile the design with the partial reconfiguration region, but it will not create a relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> directory tree to aid in <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> development. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#225-walkthrough-compile-ofs-fim">Compile <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a> Section for step-by-step instructions for this flow.</p>
<h4 id="223-out-of-tree-pr-fim"><strong>2.2.3 Out-of-Tree <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong><a class="headerlink" href="#223-out-of-tree-pr-fim" title="Permanent link">&para;</a></h4>
<p>An Out-of-Tree <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> will compile the design with the partial reconfiguration region, and will create a relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> directory tree to aid in <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> workload development. This is especially useful if you are developing a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> to be used by another team developing <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> workloads. This is the recommended build flow in most cases. There are two ways to create the relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> directory tree:</p>
<ul>
<li>Run the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> build script with the <code>-p</code> option. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#225-walkthrough-compile-ofs-fim">Compile <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a> Section for step-by-step instructions for this flow.</li>
<li>Run the <code>generate_pr_release.sh</code> script after running the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> build script. Refer to the <strong>Walkthrough: Manually Generate <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Out-Of-Tree <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong> Section step-by-step instructions for this flow.</li>
</ul>
<p>In both cases, the <code>generate_pr_release.sh</code> is run to create the relocatable build tree. This script is located at <code>$OFS_ROOTDIR/ofs-common/scripts/common/syn/generate_pr_release.sh</code>. Usage for this script is as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>generate_pr_release.sh<span class="w"> </span>-t<span class="w"> </span>&lt;PATH_OF_RELOCATABLE_PR_TREE&gt;<span class="w"> </span>&lt;BOARD_TARGET&gt;<span class="w"> </span>&lt;WORK_DIRECTORY&gt;
</code></pre></div>
<p>The <em>Generate <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> Release Script Options</em> table describes the options for the <code>generate_pr_release.sh</code> script.</p>
<p><em>Table: Generate <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> Release Script Options</em></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Options</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;PATH_OF_RELOCATABLE_PR_TREE&gt;</code></td>
<td>String</td>
<td>Specifies the location of the relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> directory tree to be created.</td>
</tr>
<tr>
<td><code>&lt;BOARD_TARGET&gt;</code></td>
<td><code>n6001</code> | <code>n6000</code> | <code>fseries-dk</code> | <code>iseries-dk</code></td>
<td>Specifies the name of the board target.</td>
</tr>
<tr>
<td><code>&lt;WORK_DIRECTORY&gt;</code></td>
<td>String</td>
<td>Specifies the existing work directory from which the relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> directory tree will be created from.</td>
</tr>
</tbody>
</table>
<p>After generating the relocatable build tree, it is located in the <code>$OFS_ROOTDIR/&lt;WORK_DIRECTORY&gt;/pr_build_template</code> directory (or the directory you specified if generated separately). The contents of this directory have the following structure:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>├──<span class="w"> </span>bin
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>├──<span class="w"> </span>├──<span class="w"> </span>afu_synth
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>├──<span class="w"> </span>├──<span class="w"> </span>qar_gen
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>├──<span class="w"> </span>├──<span class="w"> </span>update_pim
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>├──<span class="w"> </span>├──<span class="w"> </span>run.sh
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>├──<span class="w"> </span>├──<span class="w"> </span>build_env_config
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>├──<span class="w"> </span>README
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>├──<span class="w"> </span>hw
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>├──<span class="w"> </span>├──<span class="w"> </span>lib
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>├──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>build
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a>├──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>fme-ifc-id.txt
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>├──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>platform
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>├──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>fme-platform-class.txt
<a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>├──<span class="w"> </span>├──<span class="w"> </span>blue_bits
<a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a>├──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>ofs_top_hps.sof
<a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a>└──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>ofs_top.sof
</code></pre></div>
<h4 id="225-walkthrough-compile-ofs-fim"><strong>2.2.5 Walkthrough: Compile <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong><a class="headerlink" href="#225-walkthrough-compile-ofs-fim" title="Permanent link">&para;</a></h4>
<p>Perform the following steps to compile the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> for n6001 or n6000:</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Navigate to the root directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
</code></pre></div>
</li>
<li>
<p>Run the <code>build_top.sh</code> script with the desired compile options. Some examples are provided:</p>
<ul>
<li>
<p>Out-of-Tree <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> using OFSS (Standard Flow)</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001<span class="w"> </span>work_n6001_oot_pr
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6000.ofss<span class="w"> </span>n6000<span class="w"> </span>work_n6000_oot_pr
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p>Flat <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> using OFSS</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001:flat<span class="w"> </span>work_n6001_flat
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6000.ofss<span class="w"> </span>n6000:flat<span class="w"> </span>work_n6000_flat
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p>In-Tree <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> using OFSS</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001<span class="w"> </span>work_n6001_in_tree_pr
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6000.ofss<span class="w"> </span>n6000<span class="w"> </span>work_n6000_in_tree_pr
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p>Flat <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> using OFSS with Host Exercisers Removed</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001:flat,null_he_lb,null_he_hssi,null_he_mem,null_he_mem_tg<span class="w"> </span>work_n6001_flat
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6000.ofss<span class="w"> </span>n6000:flat,null_he_lb,null_he_hssi,null_he_mem,null_he_mem_tg<span class="w"> </span>work_n6000_flat
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p>In-Tree <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> using Source</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>n6001<span class="w"> </span>work_n6001
</code></pre></div>
</li>
</ul>
<ul>
<li>N6000 - Not supported by default configuration</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Once the build script is complete, the build summary should report that the build is complete and passes timing. For example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>***********************************
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>***
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>***<span class="w">        </span>OFS_PROJECT:<span class="w"> </span>n6001
<a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>***<span class="w">        </span>OFS_BOARD:<span class="w"> </span>n6001
<a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>***<span class="w">        </span>Q_PROJECT:<span class="w">  </span>ofs_top
<a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a>***<span class="w">        </span>Q_REVISION:<span class="w"> </span>ofs_top
<a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>***<span class="w">        </span>SEED:<span class="w"> </span><span class="m">6</span>
<a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a>***<span class="w">        </span>Build<span class="w"> </span>Complete
<a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a>***<span class="w">        </span>Timing<span class="w"> </span>Passed!
<a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a>***
<a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a>***********************************
</code></pre></div>
</li>
</ol>
<h4 id="226-walkthrough-manually-generate-ofs-out-of-tree-pr-fim"><strong>2.2.6 Walkthrough: Manually Generate <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Out-Of-Tree <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong><a class="headerlink" href="#226-walkthrough-manually-generate-ofs-out-of-tree-pr-fim" title="Permanent link">&para;</a></h4>
<p>This walkthrough describes how to manually generate an Out-Of-Tree <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. This can be automatically done for you if you run the build script with the <code>-p</code> option. This process is not applicable if you run the build script with the <code>flat</code> option.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Navigate to the root directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
</code></pre></div>
</li>
<li>
<p>Run the <code>build_top.sh</code> script with the desired compile options using the n6001 OFSS presets. In order to create the relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> tree, you may not compile with the <code>flat</code> option. For example:</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001<span class="w"> </span>work_n6001
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6000.ofss<span class="w"> </span>n6000<span class="w"> </span>work_n6000
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>Run the <code>generate_pr_release.sh</code> script to create the relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> tree.</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>./ofs-common/scripts/common/syn/generate_pr_release.sh<span class="w"> </span>-t<span class="w"> </span>work_n6001/pr_build_template<span class="w"> </span>n6001<span class="w"> </span>work_n6001
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>./ofs-common/scripts/common/syn/generate_pr_release.sh<span class="w"> </span>-t<span class="w"> </span>work_n6000/pr_build_template<span class="w"> </span>n6000<span class="w"> </span>work_n6000
</code></pre></div>
</li>
</ul>
</li>
</ol>
<h4 id="227-compilation-seed"><strong>2.2.7 Compilation Seed</strong><a class="headerlink" href="#227-compilation-seed" title="Permanent link">&para;</a></h4>
<p>You may change the seed which is used by the build script during Quartus compilation to change the starting point of the fitter. Trying different seeds is useful when your design is failing timing by a small amount.</p>
<h5 id="2271-walkthrough-change-the-compilation-seed"><strong>2.2.7.1 Walkthrough: Change the Compilation Seed</strong><a class="headerlink" href="#2271-walkthrough-change-the-compilation-seed" title="Permanent link">&para;</a></h5>
<p>Perform the following steps to change the compilation seed for the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> build.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Edit the <code>SEED</code> assignment in the <code>$OFS_ROOTDIR/syn/board/&lt;board_name&gt;/syn_top/ofs_top.qsf</code> file to your desired seed value. The value can be any non-negative integer value.</p>
<p>For example, for n6001:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>vim $OFS_ROOTDIR/syn/board/n6001/syn_top/ofs_top.qsf
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>set_global_assignment -name SEED 1
</code></pre></div>
</li>
<li>
<p>Build the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#225-walkthrough-compile-ofs-fim">Compile <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a> section for instructions.</p>
</li>
</ol>
<h2 id="3-fim-simulation"><strong>3. <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Simulation</strong><a class="headerlink" href="#3-fim-simulation" title="Permanent link">&para;</a></h2>
<p>Unit level simulation of key components in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> is provided for verification of the following areas:</p>
<ul>
<li>Ethernet</li>
<li>PCIe</li>
<li>External Memory</li>
<li>Core <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></li>
</ul>
<p>The Unit Level simulations work with Synopsys VCS/VCSMX or Mentor Graphics Questasim simulators. The scripts to run each unit level simulation are located in <code>$OFS_ROOTDIR/sim/unit_test</code>. Each unit test directory contains a README which describes the test in detail.</p>
<h3 id="31-simulation-file-generation"><strong>3.1 Simulation File Generation</strong><a class="headerlink" href="#31-simulation-file-generation" title="Permanent link">&para;</a></h3>
<p>The simulation files must be generated prior to running unit level simulations. The script to generate simulation files is in the following location:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="nv">$OFS_ROOTDIR</span>/ofs-common/scripts/common/sim/gen_sim_files.sh
</code></pre></div>
<p>The usage of the <code>gen_sim_files.sh</code> script is as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>gen_sim_files.sh<span class="w"> </span><span class="o">[</span>--ofss<span class="o">=</span>&lt;ip_config&gt;<span class="o">]</span><span class="w"> </span>&lt;build_target&gt;<span class="o">[</span>:&lt;fim_options&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>&lt;device&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>&lt;family&gt;<span class="o">]</span>
</code></pre></div>
<p>The <em>Gen Sim Files Script Options</em> table describes the options for the <code>gen_sim_files.sh</code> script.</p>
<p><em>Table: Gen Sim Files Script Options</em></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Options</th>
<th>Description</th>
<th>Requirement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--ofss</code></td>
<td><code>&lt;ip_config&gt;</code></td>
<td>Used to modify IP, such as the PCIe SS, using .ofss configuration files. More than one .ofss file may be passed to the <code>--ofss</code> switch by concatenating them separated by commas. For example: <code>--ofss config_a.ofss,config_b.ofss</code>.</td>
<td>Platform Dependent<sup><strong>[1]</strong></sup></td>
</tr>
<tr>
<td><code>&lt;build_target&gt;</code></td>
<td><code>n6001</code> | <code>n6000</code> | <code>fseries-dk</code> | <code>iseries-dk</code></td>
<td>Specifies which board is being targeted.</td>
<td>Required</td>
</tr>
<tr>
<td><code>&lt;fim_options&gt;</code></td>
<td><code>null_he_lb</code> | <code>null_he_hssi</code> | <code>null_he_mem</code> | <code>null_he_mem_tg</code></td>
<td>Used to change how the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> is built.</br>&nbsp;&nbsp;- <code>null_he_lb</code> - Replaces the Host Exerciser Loopback (HE_LBK) with <code>he_null</code>.</br>&nbsp;&nbsp;- <code>null_he_hssi</code> - Replaces the Host Exerciser HSSI (HE_HSSI) with <code>he_null</code>.</br>&nbsp;&nbsp;- <code>null_he_mem</code> - Replaces the Host Exerciser Memory (HE_MEM) with <code>he_null</code>.</br>&nbsp;&nbsp;- <code>null_he_mem_tg</code> - Replaces the Host Exerciser Memory Traffic Generator with <code>he_null</code>. </br>More than one <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> option may be passed included in the <code>&lt;fim_options&gt;</code> list by concatenating them separated by commas. For example: <code>&lt;build_target&gt;:null_he_lb,null_he_hssi</code></td>
<td>Optional</td>
</tr>
<tr>
<td><code>&lt;device&gt;</code></td>
<td>string</td>
<td>Specifies the device ID for the target FPGA. If not specified, the default device is parsed from the <code>QSF</code> file for the project.</td>
<td>Optional</td>
</tr>
<tr>
<td><code>&lt;family&gt;</code></td>
<td>string</td>
<td>Specifies the family for the target FPGA. If not specified, the default family is parsed from the <code>QSF</code> file for the project.</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p><sup><strong>[1]</strong></sup> Using OFSS is required for the N6000, F-Series Development Kit (2xF-Tile), and the I-Series Development Kit (2xR-Tile, 1xF-Tile).</p>
<p>Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#321-walkthrough-run-individual-unit-level-simulation">Run Individual Unit Level Simulation</a> section for an example of the simulation files generation flow.</p>
<p>When running regression tests, you may use the <code>-g</code> command line argument to generate simulation files; refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#331-walkthrough-run-regression-unit-level-simulation">Run Regression Unit Level Simulation</a> section for step-by-step instructions.</p>
<h3 id="32-individual-unit-tests"><strong>3.2 Individual Unit Tests</strong><a class="headerlink" href="#32-individual-unit-tests" title="Permanent link">&para;</a></h3>
<p>Each unit test may be run individually using the <code>run_sim.sh</code> script located in the following directory:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="nv">$OFS_ROOTDIR</span>/ofs-common/scripts/common/sim/run_sim.sh
</code></pre></div>
<p>The usage for the <code>run_sim.sh</code> script is as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>sh<span class="w"> </span>run_sim.sh<span class="w"> </span><span class="nv">TEST</span><span class="o">=</span>&lt;test&gt;<span class="w"> </span><span class="o">[</span><span class="nv">VCSMX</span><span class="o">=</span>&lt;<span class="m">0</span><span class="p">|</span><span class="m">1</span>&gt;<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nv">MSIM</span><span class="o">=</span>&lt;<span class="m">0</span><span class="p">|</span><span class="m">1</span>&gt;<span class="o">]</span>
</code></pre></div>
<p>The <em>Run Sim Script Options</em> table describes the options for the <code>run_sim.sh</code> script.</p>
<p><em>Table: Run Sim Script Options</em></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Options</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>TEST</code></td>
<td>String</td>
<td>Specify the name of the test to run, e.g. <code>dfh_walker</code></td>
</tr>
<tr>
<td><code>VCSMX</code></td>
<td><code>0</code> | <code>1</code></td>
<td>When set, the VCSMX simulator will be used</td>
</tr>
<tr>
<td><code>MSIM</code></td>
<td><code>0</code> | <code>1</code></td>
<td>When set, the QuestaSim simulator will be used</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note:</strong> The default simulator is VCS if neither <code>VCSMX</code> nor <code>MSIM</code> are set.</p>
</blockquote>
<p>The log for a unit test is stored in a transcript file in the simulation directory of the test that was run.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="nv">$OFS_ROOTDIR</span>/sim/unit_test/&lt;TEST_NAME&gt;/&lt;SIMULATOR&gt;/transcript
</code></pre></div>
<p>For example, the log for the DFH walker test using VCSMX would be found at:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="nv">$OFS_ROOTDIR</span>/sim/unit_test/dfh_walker/sim_vcsmx/transcript
</code></pre></div>
<p>The simulation waveform database is saved as vcdplus.vpd for post simulation review.</p>
<h4 id="321-walkthrough-run-individual-unit-level-simulation"><strong>3.2.1 Walkthrough: Run Individual Unit Level Simulation</strong><a class="headerlink" href="#321-walkthrough-run-individual-unit-level-simulation" title="Permanent link">&para;</a></h4>
<p>Perform the following steps to run an individual unit test.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Navigate to the simulation directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ofs-common/scripts/common/sim
</code></pre></div>
</li>
<li>
<p>Generate the simulation files for the target design.</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>./gen_sim_files.sh<span class="w"> </span>--ofss<span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>/tools/ofss_config/n6001.ofss<span class="w"> </span>n6001
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>./gen_sim_files.sh<span class="w"> </span>--ofss<span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>/tools/ofss_config/n6000.ofss<span class="w"> </span>n6000
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>Navigate to the common simulation directory
  <div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ofs-common/scripts/common/sim
</code></pre></div></p>
</li>
<li>
<p>Run the desired unit test using your desired simulator</p>
<ul>
<li>
<p>Using VCS</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>sh<span class="w"> </span>run_sim.sh<span class="w"> </span><span class="nv">TEST</span><span class="o">=</span>&lt;test_name&gt;
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>Using VCSMX</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>sh<span class="w"> </span>run_sim.sh<span class="w"> </span><span class="nv">TEST</span><span class="o">=</span>&lt;test_name&gt;<span class="w"> </span><span class="nv">VCSMX</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>Using QuestaSim</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>sh<span class="w"> </span>run_sim.sh<span class="w"> </span><span class="nv">TEST</span><span class="o">=</span>&lt;test_name&gt;<span class="w"> </span><span class="nv">MSIM</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>For example, to run the DFH walker test using VCSMX:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>sh<span class="w"> </span>run_sim.sh<span class="w"> </span><span class="nv">TEST</span><span class="o">=</span>dfh_walker<span class="w"> </span><span class="nv">VCSMX</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>Once the test is complete, check the output for the simulation results. Review the log for detailed test results.</p>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>Test<span class="w"> </span>status:<span class="w"> </span>OK
<a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>
<a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a>********************
<a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a><span class="w">  </span>Test<span class="w"> </span>summary
<a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a>********************
<a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a><span class="w">   </span>test_dfh_walking<span class="w"> </span><span class="o">(</span><span class="nv">id</span><span class="o">=</span><span class="m">0</span><span class="o">)</span><span class="w"> </span>-<span class="w"> </span>pass
<a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a>Test<span class="w"> </span>passed!
<a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a>Assertion<span class="w"> </span>count:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-65-9" name="__codelineno-65-9" href="#__codelineno-65-9"></a><span class="nv">$finish</span><span class="w"> </span>called<span class="w"> </span>from<span class="w"> </span>file<span class="w"> </span><span class="s2">&quot;/home/ofs-agx7-pcie-attach/sim/unit_test/scripts/../../bfm/rp_bfm_simple/tester.sv&quot;</span>,<span class="w"> </span>line<span class="w"> </span><span class="m">210</span>.
<a id="__codelineno-65-10" name="__codelineno-65-10" href="#__codelineno-65-10"></a><span class="nv">$finish</span><span class="w"> </span>at<span class="w"> </span>simulation<span class="w"> </span><span class="nb">time</span><span class="w">         </span><span class="m">356233750000</span>
<a id="__codelineno-65-11" name="__codelineno-65-11" href="#__codelineno-65-11"></a><span class="w">           </span>V<span class="w"> </span>C<span class="w"> </span>S<span class="w">   </span>S<span class="w"> </span>i<span class="w"> </span>m<span class="w"> </span>u<span class="w"> </span>l<span class="w"> </span>a<span class="w"> </span>t<span class="w"> </span>i<span class="w"> </span>o<span class="w"> </span>n<span class="w">   </span>R<span class="w"> </span>e<span class="w"> </span>p<span class="w"> </span>o<span class="w"> </span>r<span class="w"> </span>t
<a id="__codelineno-65-12" name="__codelineno-65-12" href="#__codelineno-65-12"></a>Time:<span class="w"> </span><span class="m">356233750000</span><span class="w"> </span>fs
<a id="__codelineno-65-13" name="__codelineno-65-13" href="#__codelineno-65-13"></a>CPU<span class="w"> </span>Time:<span class="w">     </span><span class="m">57</span>.730<span class="w"> </span>seconds<span class="p">;</span><span class="w">       </span>Data<span class="w"> </span>structure<span class="w"> </span>size:<span class="w">  </span><span class="m">47</span>.2Mb
<a id="__codelineno-65-14" name="__codelineno-65-14" href="#__codelineno-65-14"></a>Tue<span class="w"> </span>Sep<span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="m">09</span>:44:19<span class="w"> </span><span class="m">2023</span>
<a id="__codelineno-65-15" name="__codelineno-65-15" href="#__codelineno-65-15"></a>run_sim.sh:<span class="w"> </span>USER_DEFINED_SIM_OPTIONS<span class="w"> </span>+vcs<span class="w"> </span>-l<span class="w"> </span>./transcript
<a id="__codelineno-65-16" name="__codelineno-65-16" href="#__codelineno-65-16"></a>run_sim.sh:<span class="w"> </span>run_sim.sh<span class="w"> </span>DONE!
</code></pre></div>
</li>
</ol>
<h3 id="33-regression-unit-tests"><strong>3.3 Regression Unit Tests</strong><a class="headerlink" href="#33-regression-unit-tests" title="Permanent link">&para;</a></h3>
<p>You may use the regression script <code>regress_run.py</code> to run some or all of the unit tests available with a single command. The regression script is in the following location:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="nv">$OFS_ROOTDIR</span>/sim/unit_test/scripts/regress_run.py
</code></pre></div>
<p>The usage of the regression script is as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>regress_run.py<span class="w"> </span><span class="o">[</span>-h<span class="o">]</span><span class="w"> </span><span class="o">[</span>-l<span class="o">]</span><span class="w"> </span><span class="o">[</span>-n<span class="w"> </span>&lt;num_procs&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>-k<span class="w"> </span>&lt;test_package&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>-s<span class="w"> </span>&lt;simulator&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>-g<span class="o">]</span><span class="w"> </span><span class="o">[</span>--ofss<span class="w"> </span>&lt;ip_config&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>-b<span class="w"> </span>&lt;board_name&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>-e<span class="o">]</span>
</code></pre></div>
<p>The <em>Regression Unit Test Script Options</em> table describes the options for the <code>regress_run.py</code> script.</p>
<p><em>Table: Regression Unit Test Script Options</em></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Options</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-h</code> | <code>--help</code></td>
<td>N/A</td>
<td>Show the help message and exit</td>
</tr>
<tr>
<td><code>-l</code> | <code>--local</code></td>
<td>N/A</td>
<td>Run regression locally</td>
</tr>
<tr>
<td><code>-n</code> | <code>--n_procs</code></td>
<td>Integer</td>
<td>Maximum number of processes/tests to run in parallel when run locally. This has no effect on farm runs.</td>
</tr>
<tr>
<td><code>-k</code> | <code>--pack</code></td>
<td><code>all</code> | <code>fme</code> | <code>he</code> | <code>hssi</code> | <code>list</code> | <code>mem</code> | <code>pmci</code></td>
<td>Test package to run during regression. The "list" option will look for a text file named "list.txt" in the "unit_test" directory for a text list of tests to run (top directory names). The default test package is <code>all</code>.</td>
</tr>
<tr>
<td><code>-s</code> | <code>--sim</code></td>
<td><code>vcs</code> | <code>vcsmx</code> | <code>msim</code></td>
<td>Specifies the simulator used for the regression tests. The default simulator is <code>vcs</code></td>
</tr>
<tr>
<td><code>-g</code> | <code>--gen_sim_files</code></td>
<td>N/A</td>
<td>Generate simulation files. This only needs to be done once per repo update. This is the equivalent of running the <code>gen_sim_files.sh</code> script.</td>
</tr>
<tr>
<td><code>-o</code> | <code>--ofss</code></td>
<td><code>&lt;ip_config&gt;</code></td>
<td>Used to modify IP, such as the PCIe SS, using .ofss configuration files. More than one .ofss file may be passed to the <code>--ofss</code> switch by concatenating them separated by commas. For example: <code>--ofss config_a.ofss,config_b.ofss</code>.</td>
</tr>
<tr>
<td><code>-b</code> | <code>--board_name</code></td>
<td><code>n6001</code> | <code>n6000</code> | <code>fseries-dk</code> | <code>iseries-dk</code></td>
<td>Specifies the board target</td>
</tr>
<tr>
<td><code>-e</code> | <code>--email_list</code></td>
<td>String</td>
<td>Specifies email list to send results to multiple recipients</td>
</tr>
</tbody>
</table>
<p>The log for each unit test that is run by the regression script is stored in a transcript file in the simulation directory of the test that was run.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="nv">$OFS_ROOTDIR</span>/sim/unit_test/&lt;TEST_NAME&gt;/&lt;SIMULATOR&gt;/transcript
</code></pre></div>
<p>For example, the log for the DFH walker test using VCSMX would be found at:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="nv">$OFS_ROOTDIR</span>/sim/unit_test/dfh_walker/sim_vcsmx/transcript
</code></pre></div>
<p>The simulation waveform database is saved as vcdplus.vpd for post simulation review.</p>
<h4 id="331-walkthrough-run-regression-unit-level-simulation"><strong>3.3.1 Walkthrough: Run Regression Unit Level Simulation</strong><a class="headerlink" href="#331-walkthrough-run-regression-unit-level-simulation" title="Permanent link">&para;</a></h4>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Navigate to the unit test scripts directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/sim/unit_test/scripts
</code></pre></div>
</li>
<li>
<p>Run regression test with the your desired options. For example, to simulate with the options to generate simulation files, run locally, use 8 processes, run all tests, use VCS simulator, and target the desired board:</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>python<span class="w"> </span>regress_run.py<span class="w"> </span>--ofss<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/tools/ofss_config/n6001.ofss<span class="w"> </span>-g<span class="w"> </span>-l<span class="w"> </span>-n<span class="w"> </span><span class="m">8</span><span class="w"> </span>-k<span class="w"> </span>all<span class="w"> </span>-s<span class="w"> </span>vcs<span class="w"> </span>-b<span class="w"> </span>n6001
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a>python<span class="w"> </span>regress_run.py<span class="w"> </span>--ofss<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/tools/ofss_config/n6000.ofss<span class="w"> </span>-g<span class="w"> </span>-l<span class="w"> </span>-n<span class="w"> </span><span class="m">8</span><span class="w"> </span>-k<span class="w"> </span>all<span class="w"> </span>-s<span class="w"> </span>vcs<span class="w"> </span>-b<span class="w"> </span>n6000
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>Once all tests are complete, check that the tests have passed.</p>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,362:<span class="w"> </span>Passing<span class="w"> </span>Unit<span class="w"> </span>Tests:38/38<span class="w"> </span>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
<a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,362:<span class="w">    </span>bfm_test:.............................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:00:56.125802
<a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,362:<span class="w">    </span>csr_test:.............................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:01:14.072803
<a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,362:<span class="w">    </span>dfh_walker:...........................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:01:00.565714
<a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,362:<span class="w">    </span>flr:..................................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:00:57.453471
<a id="__codelineno-73-6" name="__codelineno-73-6" href="#__codelineno-73-6"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,362:<span class="w">    </span>fme_csr_access:.......................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:00:38.447496
<a id="__codelineno-73-7" name="__codelineno-73-7" href="#__codelineno-73-7"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,362:<span class="w">    </span>fme_csr_directed:.....................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:00:47.593359
<a id="__codelineno-73-8" name="__codelineno-73-8" href="#__codelineno-73-8"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,362:<span class="w">    </span>he_lb_test:...........................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:01:51.150977
<a id="__codelineno-73-9" name="__codelineno-73-9" href="#__codelineno-73-9"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,362:<span class="w">    </span>he_mem_lb_test:.......................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:01:55.940398
<a id="__codelineno-73-10" name="__codelineno-73-10" href="#__codelineno-73-10"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>he_null_test:.........................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:09:34.463979
<a id="__codelineno-73-11" name="__codelineno-73-11" href="#__codelineno-73-11"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>hssi_csr_test:........................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:07:18.181326
<a id="__codelineno-73-12" name="__codelineno-73-12" href="#__codelineno-73-12"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>hssi_kpi_test:........................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:5:45:38.792493
<a id="__codelineno-73-13" name="__codelineno-73-13" href="#__codelineno-73-13"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>hssi_test:............................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:5:48:39.722731
<a id="__codelineno-73-14" name="__codelineno-73-14" href="#__codelineno-73-14"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>indirect_csr:.........................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:00:42.677518
<a id="__codelineno-73-15" name="__codelineno-73-15" href="#__codelineno-73-15"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>mem_ss_csr_test:......................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:00:56.534377
<a id="__codelineno-73-16" name="__codelineno-73-16" href="#__codelineno-73-16"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>mem_ss_rst_test:......................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:00:55.852359
<a id="__codelineno-73-17" name="__codelineno-73-17" href="#__codelineno-73-17"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>mem_tg_test:..........................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:00:55.624567
<a id="__codelineno-73-18" name="__codelineno-73-18" href="#__codelineno-73-18"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pcie_ats_basic_test:..................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:00:58.659382
<a id="__codelineno-73-19" name="__codelineno-73-19" href="#__codelineno-73-19"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pcie_csr_test:........................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:00:58.918341
<a id="__codelineno-73-20" name="__codelineno-73-20" href="#__codelineno-73-20"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pf_vf_access_test:....................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:00:57.045204
<a id="__codelineno-73-21" name="__codelineno-73-21" href="#__codelineno-73-21"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_csr_test:........................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:01:05.479277
<a id="__codelineno-73-22" name="__codelineno-73-22" href="#__codelineno-73-22"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_mailbox_test:....................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:02:34.899524
<a id="__codelineno-73-23" name="__codelineno-73-23" href="#__codelineno-73-23"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_multi_master_test:...............<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:41:09.670790
<a id="__codelineno-73-24" name="__codelineno-73-24" href="#__codelineno-73-24"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_qsfp_telemetry_test:.............<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:40:07.885015
<a id="__codelineno-73-25" name="__codelineno-73-25" href="#__codelineno-73-25"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_rd_default_value_test:...........<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:01:06.944379
<a id="__codelineno-73-26" name="__codelineno-73-26" href="#__codelineno-73-26"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_ro_mailbox_test:.................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:10:48.580894
<a id="__codelineno-73-27" name="__codelineno-73-27" href="#__codelineno-73-27"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_vdm_b2b_drop_err_scenario_test:..<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:09:11.081908
<a id="__codelineno-73-28" name="__codelineno-73-28" href="#__codelineno-73-28"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_vdm_len_err_scenario_test:.......<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:14:43.763718
<a id="__codelineno-73-29" name="__codelineno-73-29" href="#__codelineno-73-29"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_vdm_mctp_mmio_b2b_test:..........<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:01:45.543515
<a id="__codelineno-73-30" name="__codelineno-73-30" href="#__codelineno-73-30"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_vdm_multipkt_error_scenario_test:<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:1:42:53.665294
<a id="__codelineno-73-31" name="__codelineno-73-31" href="#__codelineno-73-31"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_vdm_multipkt_tlp_err_test:.......<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:21:01.225008
<a id="__codelineno-73-32" name="__codelineno-73-32" href="#__codelineno-73-32"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_vdm_tlp_error_scenario_test:.....<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:20:36.006368
<a id="__codelineno-73-33" name="__codelineno-73-33" href="#__codelineno-73-33"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_vdm_tx_rx_all_random_lpbk_test:..<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:11:11.355724
<a id="__codelineno-73-34" name="__codelineno-73-34" href="#__codelineno-73-34"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_vdm_tx_rx_all_toggle_test:.......<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:08:15.821700
<a id="__codelineno-73-35" name="__codelineno-73-35" href="#__codelineno-73-35"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>pmci_vdm_tx_rx_lpbk_test:.............<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:08:25.528899
<a id="__codelineno-73-36" name="__codelineno-73-36" href="#__codelineno-73-36"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>port_gasket_test:.....................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:00:59.764194
<a id="__codelineno-73-37" name="__codelineno-73-37" href="#__codelineno-73-37"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>qsfp_test:............................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:07:09.847066
<a id="__codelineno-73-38" name="__codelineno-73-38" href="#__codelineno-73-38"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>remote_stp_test:......................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:01:01.852028
<a id="__codelineno-73-39" name="__codelineno-73-39" href="#__codelineno-73-39"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">    </span>uart_csr:.............................<span class="w"> </span>PASS<span class="w"> </span>--<span class="w"> </span>Time<span class="w"> </span>Elapsed:0:01:26.403271
<a id="__codelineno-73-40" name="__codelineno-73-40" href="#__codelineno-73-40"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w"> </span>Failing<span class="w"> </span>Unit<span class="w"> </span>Tests:<span class="w"> </span><span class="m">0</span>/38<span class="w"> </span>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
<a id="__codelineno-73-41" name="__codelineno-73-41" href="#__codelineno-73-41"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w"> </span>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
<a id="__codelineno-73-42" name="__codelineno-73-42" href="#__codelineno-73-42"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">       </span>Number<span class="w"> </span>of<span class="w"> </span>Unit<span class="w"> </span><span class="nb">test</span><span class="w"> </span>results<span class="w"> </span>captured:<span class="w"> </span><span class="m">38</span>
<a id="__codelineno-73-43" name="__codelineno-73-43" href="#__codelineno-73-43"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">       </span>Number<span class="w"> </span>of<span class="w"> </span>Unit<span class="w"> </span><span class="nb">test</span><span class="w"> </span>results<span class="w"> </span>passing.:<span class="w"> </span><span class="m">38</span>
<a id="__codelineno-73-44" name="__codelineno-73-44" href="#__codelineno-73-44"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">       </span>Number<span class="w"> </span>of<span class="w"> </span>Unit<span class="w"> </span><span class="nb">test</span><span class="w"> </span>results<span class="w"> </span>failing.:<span class="w">  </span><span class="m">0</span>
<a id="__codelineno-73-45" name="__codelineno-73-45" href="#__codelineno-73-45"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">     </span>End<span class="w"> </span>Unit<span class="w"> </span>regression<span class="w"> </span>running<span class="w"> </span>at<span class="w"> </span>date/time................:<span class="w"> </span><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47.363814
<a id="__codelineno-73-46" name="__codelineno-73-46" href="#__codelineno-73-46"></a><span class="m">2024</span>-02-15<span class="w"> </span><span class="m">16</span>:06:47,363:<span class="w">     </span>Elapsed<span class="w"> </span><span class="nb">time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>Unit<span class="w"> </span>regression<span class="w"> </span>run....................:<span class="w"> </span><span class="m">5</span>:58:50.474807
</code></pre></div>
</li>
</ol>
<h2 id="4-fim-customization"><strong>4. <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Customization</strong><a class="headerlink" href="#4-fim-customization" title="Permanent link">&para;</a></h2>
<p>This section describes how to perform specific customizations of the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>, and provides step-by-step walkthroughs for these customizations. Each walkthrough can be done independently. These walkthroughs require a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment. The <em><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Customization Walkthroughs</em> table lists the walkthroughs that are provided in this section. Some walkthroughs include steps for testing on hardware. Testing on hardware requires that you have a deployment environment set up. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/">Getting Started Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach FPGAs (Intel® FPGA SmartNIC N6001-PL/N6000-PL)</a> for instructions on setting up a deployment environment.</p>
<p><em>Table: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Customization Examples</em></p>
<table>
<thead>
<tr>
<th>Walkthrough Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#412-walkthrough-add-a-new-module-to-the-ofs-fim">Add a new module to the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#413-walkthrough-modify-and-run-unit-tests-for-a-fim-that-has-a-new-module">Modify and run unit tests for a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that has a new module</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#414-walkthrough-modify-and-run-uvm-tests-for-a-fim-that-has-a-new-module">Modify and run <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> tests for a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that has a new module</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#415-walkthrough-hardware-test-a-fim-that-has-a-new-module">Hardware test a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that has a new module</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#416-walkthrough-debug-the-fim-with-signal-tap">Debug the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> with Signal Tap</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#421-walkthrough-compile-the-fim-in-preparation-for-designing-your-afu">Compile the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> in preparation for designing your <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr></a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#431-walkthrough-resize-the-partial-reconfiguration-region">Resize the Partial Reconfiguration Region</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#4431-walkthrough-modify-the-pcie-sub-system-and-pfvf-mux-configuration-using-ofss">Modify the PCIe Sub-System and PF/VF MUX Configuration Using OFSS</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#4441-walkthrough-modify-pcie-sub-system-and-pfvf-mux-configuration-using-ip-presets">Modify PCIe Sub-System and PF/VF MUX Configuration Using IP Presets</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#451-walkthrough-create-a-minimal-fim">Create a Minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#461-walkthrough-migrate-to-a-different-agilex-device-number">Migrate to a Different Agilex Device Number</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#471-walkthrough-modify-the-memory-sub-system-using-ip-presets-with-ofss">Modify the Memory Sub-System Using IP Presets With OFSS</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#481-walkthrough-modify-the-ethernet-sub-system-channels-with-pre-made-hssi-ofss">Modify the Ethernet Sub-System Channels With Pre-Made HSSI OFSS</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#482-walkthrough-add-channels-to-the-ethernet-sub-system-channels-with-custom-hssi-ofss">Add Channels to the Ethernet Sub-System Channels With Custom HSSI OFSS</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#483-walkthrough-modify-the-ethernet-sub-system-with-pre-made-hssi-ofss-plus-additional-modifications">Modify the Ethernet Sub-System With Pre-Made HSSI OFSS Plus Additional Modifications</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#484-walkthrough-modify-the-ethernet-sub-system-without-hssi-ofss">Modify the Ethernet Sub-System Without HSSI OFSS</a></td>
</tr>
<tr>
<td><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#491-walkthrough-remove-the-hps">Remove the HPS</a></td>
</tr>
</tbody>
</table>
<h3 id="41-adding-a-new-module-to-the-fim"><strong>4.1 Adding a new module to the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong><a class="headerlink" href="#41-adding-a-new-module-to-the-fim" title="Permanent link">&para;</a></h3>
<p>This section provides a information for adding a custom module to the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>, simulating the new design, compiling the new design, implementing and testing the new design on hardware, and debugging the new design on hardware.</p>
<h4 id="411-hello-fim-theory-of-operation"><strong>4.1.1 Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Theory of Operation</strong><a class="headerlink" href="#411-hello-fim-theory-of-operation" title="Permanent link">&para;</a></h4>
<p>If you intend to add a new module to the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> area, then you will need to inform the host software of the new module. The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> exposes its functionalities to host software through a set of CSR registers that are mapped to an <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> region (Memory Mapped IO). This set of CSR registers and their operation is described in <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> Regions.</p>
<p>See FPGA Device Feature List (<abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr>) Framework Overview for a description of the software process to read and process the linked list of Device Feature Header (DFH) CSRs within a FPGA.</p>
<p>This example will add a <code>hello_fim</code> module to the design. The Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> example adds a simple DFH register and 64bit scratchpad register connected to the Board Peripheral Fabric (BPF) that can be accessed by the Host. You can use this example as the basis for adding a new feature to your <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<p>For the purposes of this example, the <code>hello_fim</code> module instantiation sets the DFH feature ID (<code>FEAT_ID</code>) to 0x100 which is not currently defined. Using an undefined feature ID will result in no driver being used. Normally, a defined feature ID will be used to associate a specific driver with the FPGA module. Refer to the <a href="https://github.com/OFS/dfl-feature-id/blob/main/dfl-feature-ids.rst">Device Feature List Feature IDs</a> for a list of <abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr> feature types and IDs. If you are adding a new module to your design, make sure the Type/ID pair does not conflict with existing Type/ID pairs. You may reserve Type/ID pairs by submitting a pull request at the link above.</p>
<p>The Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design can be verified by Unit Level simulation, Universal Verification Methodology (<abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr>) simulation, and running in hardware on the n6001 card. The process for these are described in this section.</p>
<h5 id="4111-hello-fim-board-peripheral-fabric-bpf"><strong>4.1.1.1 Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Board Peripheral Fabric (BPF)</strong><a class="headerlink" href="#4111-hello-fim-board-peripheral-fabric-bpf" title="Permanent link">&para;</a></h5>
<p>The Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module will be connected to the Board Peripheral Fabric (BPF), and will be connected such that it can be mastered by the Host. The BPF is an interconnect generated by Platform Designer. The <em>Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> BPF Interface Diagram</em> figure shows the APF/BPF Master/Slave interactions, as well as the added Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module.</p>
<p><em>Figure: Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> BPF Interface Diagram</em></p>
<p><a class="glightbox" href="../images/hello_fim_bpf.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="hello_fim_apf_bpf" src="../images/hello_fim_bpf.png" /></a></p>
<p>The BPF fabric is defined in <code>$OFS_ROOTDIR/src/pd_qsys/fabric/bpf.txt</code>.</p>
<p>We will add the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module to an un-used address space in the <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> region. The <em>Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> Address Layout</em> table below shows the <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> region for the Host with the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module added at base address 0x16000.</p>
<p><em>Table: Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> Address Layout</em></p>
<table>
<thead>
<tr>
<th align="left">Offset</th>
<th align="left">Feature CSR set</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">0x00000</td>
<td align="left"><abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr> <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr></td>
</tr>
<tr>
<td align="left">0x10000</td>
<td align="left">PCIe Interface</td>
</tr>
<tr>
<td align="left">0x12000</td>
<td align="left">QSFP Controller 0</td>
</tr>
<tr>
<td align="left">0x13000</td>
<td align="left">QSFP Controller 1</td>
</tr>
<tr>
<td align="left">0x14000</td>
<td align="left">E-Tile Ethernet  Interface</td>
</tr>
<tr>
<td align="left">0x15000</td>
<td align="left">EMIF</td>
</tr>
<tr>
<td align="left"><strong>0x16000</strong></td>
<td align="left"><strong>Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong></td>
</tr>
<tr>
<td align="left">0x20000</td>
<td align="left">PMCI Controller</td>
</tr>
<tr>
<td align="left">0x40000</td>
<td align="left">ST2MM (Streaming to Memory-Mapped)</td>
</tr>
<tr>
<td align="left">0x60000</td>
<td align="left">VUART</td>
</tr>
<tr>
<td align="left">0x70000</td>
<td align="left"><abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> Control &amp; Status (Port Gasket)</td>
</tr>
<tr>
<td align="left">0x71000</td>
<td align="left">Port CSRs (Port Gasket)</td>
</tr>
<tr>
<td align="left">0x72000</td>
<td align="left">User Clock (Port Gasket)</td>
</tr>
<tr>
<td align="left">0x74000</td>
<td align="left">Remote SignalTap (Port Gasket)</td>
</tr>
<tr>
<td align="left">0x80000</td>
<td align="left"><abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Errors (<abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Interface Handler)</td>
</tr>
</tbody>
</table>
<h5 id="4112-hello-fim-csr"><strong>4.1.1.2 Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> CSR</strong><a class="headerlink" href="#4112-hello-fim-csr" title="Permanent link">&para;</a></h5>
<p>The Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> CSR will consist of the three registers shown in the <em>Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> CSR</em> table below. The DFH and Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> ID registers are read-only. The Scratchpad register supports read and write accesses.</p>
<p><em>Table: Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> CSR</em></p>
<table>
<thead>
<tr>
<th align="left">Offset</th>
<th align="left">Attribute</th>
<th align="left">Description</th>
<th align="left">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">0x016000</td>
<td align="left">RO</td>
<td align="left">DFH(Device Feature Headers) register</td>
<td align="left">0x30000006a0000100</td>
</tr>
<tr>
<td align="left">0x016030</td>
<td align="left">RW</td>
<td align="left">Scrachpad register</td>
<td align="left">0x0</td>
</tr>
<tr>
<td align="left">0x016038</td>
<td align="left">RO</td>
<td align="left">Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> ID register</td>
<td align="left">0x6626070150000034</td>
</tr>
</tbody>
</table>
<h4 id="412-walkthrough-add-a-new-module-to-the-ofs-fim"><strong>4.1.2 Walkthrough: Add a new module to the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong><a class="headerlink" href="#412-walkthrough-add-a-new-module-to-the-ofs-fim" title="Permanent link">&para;</a></h4>
<p>Perform the following steps to add a new module to the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that can be accessed by the Host.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Make <code>hello_fim</code> source directory</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a>mkdir<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/src/hello_fim
</code></pre></div>
</li>
<li>
<p>Create <code>hello_fim_top.sv</code> file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a>touch<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/src/hello_fim/hello_fim_top.sv
</code></pre></div>
<p>Copy the following code into <code>hello_fim_top.sv</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="c1">// ***************************************************************************</span>
<a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a><span class="c1">//                               INTEL CONFIDENTIAL</span>
<a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a><span class="c1">//</span>
<a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a><span class="c1">//        Copyright (C) 2023 Intel Corporation All Rights Reserved.</span>
<a id="__codelineno-76-5" name="__codelineno-76-5" href="#__codelineno-76-5"></a><span class="c1">//</span>
<a id="__codelineno-76-6" name="__codelineno-76-6" href="#__codelineno-76-6"></a><span class="c1">// The source code contained or described herein and all  documents related to</span>
<a id="__codelineno-76-7" name="__codelineno-76-7" href="#__codelineno-76-7"></a><span class="c1">// the  source  code  (&quot;Material&quot;)  are  owned  by  Intel  Corporation  or its</span>
<a id="__codelineno-76-8" name="__codelineno-76-8" href="#__codelineno-76-8"></a><span class="c1">// suppliers  or  licensors.    Title  to  the  Material  remains  with  Intel</span>
<a id="__codelineno-76-9" name="__codelineno-76-9" href="#__codelineno-76-9"></a><span class="c1">// Corporation or  its suppliers  and licensors.  The Material  contains trade</span>
<a id="__codelineno-76-10" name="__codelineno-76-10" href="#__codelineno-76-10"></a><span class="c1">// secrets  and  proprietary  and  confidential  information  of  Intel or its</span>
<a id="__codelineno-76-11" name="__codelineno-76-11" href="#__codelineno-76-11"></a><span class="c1">// suppliers and licensors.  The Material is protected  by worldwide copyright</span>
<a id="__codelineno-76-12" name="__codelineno-76-12" href="#__codelineno-76-12"></a><span class="c1">// and trade secret laws and treaty provisions. No part of the Material may be</span>
<a id="__codelineno-76-13" name="__codelineno-76-13" href="#__codelineno-76-13"></a><span class="c1">// used,   copied,   reproduced,   modified,   published,   uploaded,  posted,</span>
<a id="__codelineno-76-14" name="__codelineno-76-14" href="#__codelineno-76-14"></a><span class="c1">// transmitted,  distributed,  or  disclosed  in any way without Intel&#39;s prior</span>
<a id="__codelineno-76-15" name="__codelineno-76-15" href="#__codelineno-76-15"></a><span class="c1">// express written permission.</span>
<a id="__codelineno-76-16" name="__codelineno-76-16" href="#__codelineno-76-16"></a><span class="c1">//</span>
<a id="__codelineno-76-17" name="__codelineno-76-17" href="#__codelineno-76-17"></a><span class="c1">// No license under any patent,  copyright, trade secret or other intellectual</span>
<a id="__codelineno-76-18" name="__codelineno-76-18" href="#__codelineno-76-18"></a><span class="c1">// property  right  is  granted  to  or  conferred  upon  you by disclosure or</span>
<a id="__codelineno-76-19" name="__codelineno-76-19" href="#__codelineno-76-19"></a><span class="c1">// delivery  of  the  Materials, either expressly, by implication, inducement,</span>
<a id="__codelineno-76-20" name="__codelineno-76-20" href="#__codelineno-76-20"></a><span class="c1">// estoppel or otherwise.  Any license under such intellectual property rights</span>
<a id="__codelineno-76-21" name="__codelineno-76-21" href="#__codelineno-76-21"></a><span class="c1">// must be express and approved by Intel in writing.</span>
<a id="__codelineno-76-22" name="__codelineno-76-22" href="#__codelineno-76-22"></a><span class="c1">//</span>
<a id="__codelineno-76-23" name="__codelineno-76-23" href="#__codelineno-76-23"></a><span class="c1">// You will not, and will not allow any third party to modify, adapt, enhance, </span>
<a id="__codelineno-76-24" name="__codelineno-76-24" href="#__codelineno-76-24"></a><span class="c1">// disassemble, decompile, reverse engineer, change or create derivative works </span>
<a id="__codelineno-76-25" name="__codelineno-76-25" href="#__codelineno-76-25"></a><span class="c1">// from the Software except and only to the extent as specifically required by </span>
<a id="__codelineno-76-26" name="__codelineno-76-26" href="#__codelineno-76-26"></a><span class="c1">// mandatory applicable laws or any applicable third party license terms </span>
<a id="__codelineno-76-27" name="__codelineno-76-27" href="#__codelineno-76-27"></a><span class="c1">// accompanying the Software.</span>
<a id="__codelineno-76-28" name="__codelineno-76-28" href="#__codelineno-76-28"></a><span class="c1">//</span>
<a id="__codelineno-76-29" name="__codelineno-76-29" href="#__codelineno-76-29"></a><span class="c1">// -----------------------------------------------------------------------------</span>
<a id="__codelineno-76-30" name="__codelineno-76-30" href="#__codelineno-76-30"></a><span class="c1">// Engineer     : </span>
<a id="__codelineno-76-31" name="__codelineno-76-31" href="#__codelineno-76-31"></a><span class="c1">// Create Date  : September 2023</span>
<a id="__codelineno-76-32" name="__codelineno-76-32" href="#__codelineno-76-32"></a><span class="c1">// Module Name  : hello_fim_top.sv</span>
<a id="__codelineno-76-33" name="__codelineno-76-33" href="#__codelineno-76-33"></a><span class="c1">// Project      : OFS</span>
<a id="__codelineno-76-34" name="__codelineno-76-34" href="#__codelineno-76-34"></a><span class="c1">// -----------------------------------------------------------------------------</span>
<a id="__codelineno-76-35" name="__codelineno-76-35" href="#__codelineno-76-35"></a><span class="c1">//</span>
<a id="__codelineno-76-36" name="__codelineno-76-36" href="#__codelineno-76-36"></a><span class="c1">// Description: </span>
<a id="__codelineno-76-37" name="__codelineno-76-37" href="#__codelineno-76-37"></a><span class="c1">// This is a simple module that implements DFH registers and </span>
<a id="__codelineno-76-38" name="__codelineno-76-38" href="#__codelineno-76-38"></a><span class="c1">// AVMM address decoding logic.</span>
<a id="__codelineno-76-39" name="__codelineno-76-39" href="#__codelineno-76-39"></a>
<a id="__codelineno-76-40" name="__codelineno-76-40" href="#__codelineno-76-40"></a><span class="k">module</span><span class="w"> </span><span class="n">hello_fim_top</span><span class="w">  </span><span class="p">#(</span>
<a id="__codelineno-76-41" name="__codelineno-76-41" href="#__codelineno-76-41"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="n">ADDR_WIDTH</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">12</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-76-42" name="__codelineno-76-42" href="#__codelineno-76-42"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="n">DATA_WIDTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-76-43" name="__codelineno-76-43" href="#__codelineno-76-43"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">11</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">FEAT_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">12&#39;h100</span><span class="p">,</span>
<a id="__codelineno-76-44" name="__codelineno-76-44" href="#__codelineno-76-44"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">FEAT_VER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">4&#39;h0</span><span class="p">,</span>
<a id="__codelineno-76-45" name="__codelineno-76-45" href="#__codelineno-76-45"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">23</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">NEXT_DFH_OFFSET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">24&#39;h1000</span><span class="p">,</span>
<a id="__codelineno-76-46" name="__codelineno-76-46" href="#__codelineno-76-46"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="n">END_OF_LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span>
<a id="__codelineno-76-47" name="__codelineno-76-47" href="#__codelineno-76-47"></a><span class="p">)(</span>
<a id="__codelineno-76-48" name="__codelineno-76-48" href="#__codelineno-76-48"></a><span class="w">   </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w">    </span><span class="n">clk</span><span class="p">,</span>
<a id="__codelineno-76-49" name="__codelineno-76-49" href="#__codelineno-76-49"></a><span class="w">   </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w">    </span><span class="n">reset</span><span class="p">,</span>
<a id="__codelineno-76-50" name="__codelineno-76-50" href="#__codelineno-76-50"></a><span class="c1">// -----------------------------------------------------------</span>
<a id="__codelineno-76-51" name="__codelineno-76-51" href="#__codelineno-76-51"></a><span class="c1">//  AXI4LITE Interface</span>
<a id="__codelineno-76-52" name="__codelineno-76-52" href="#__codelineno-76-52"></a><span class="c1">// -----------------------------------------------------------</span>
<a id="__codelineno-76-53" name="__codelineno-76-53" href="#__codelineno-76-53"></a><span class="w">   </span><span class="n">ofs_fim_axi_lite_if</span><span class="p">.</span><span class="n">slave</span><span class="w">   </span><span class="n">csr_lite_if</span>
<a id="__codelineno-76-54" name="__codelineno-76-54" href="#__codelineno-76-54"></a><span class="p">);</span>
<a id="__codelineno-76-55" name="__codelineno-76-55" href="#__codelineno-76-55"></a>
<a id="__codelineno-76-56" name="__codelineno-76-56" href="#__codelineno-76-56"></a><span class="kn">import</span> <span class="nn">ofs_fim_cfg_pkg::*</span><span class="p">;</span>
<a id="__codelineno-76-57" name="__codelineno-76-57" href="#__codelineno-76-57"></a><span class="kn">import</span> <span class="nn">ofs_csr_pkg::*</span><span class="p">;</span>
<a id="__codelineno-76-58" name="__codelineno-76-58" href="#__codelineno-76-58"></a>
<a id="__codelineno-76-59" name="__codelineno-76-59" href="#__codelineno-76-59"></a><span class="c1">//-------------------------------------</span>
<a id="__codelineno-76-60" name="__codelineno-76-60" href="#__codelineno-76-60"></a><span class="c1">// Signals</span>
<a id="__codelineno-76-61" name="__codelineno-76-61" href="#__codelineno-76-61"></a><span class="c1">//-------------------------------------</span>
<a id="__codelineno-76-62" name="__codelineno-76-62" href="#__codelineno-76-62"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">ADDR_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_waddr</span><span class="p">;</span>
<a id="__codelineno-76-63" name="__codelineno-76-63" href="#__codelineno-76-63"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">DATA_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_wdata</span><span class="p">;</span>
<a id="__codelineno-76-64" name="__codelineno-76-64" href="#__codelineno-76-64"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">DATA_WIDTH</span><span class="o">/</span><span class="mh">8</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">            </span><span class="n">csr_wstrb</span><span class="p">;</span>
<a id="__codelineno-76-65" name="__codelineno-76-65" href="#__codelineno-76-65"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_write</span><span class="p">;</span>
<a id="__codelineno-76-66" name="__codelineno-76-66" href="#__codelineno-76-66"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_slv_wready</span><span class="p">;</span>
<a id="__codelineno-76-67" name="__codelineno-76-67" href="#__codelineno-76-67"></a><span class="w">   </span><span class="n">csr_access_type_t</span><span class="w">                   </span><span class="n">csr_write_type</span><span class="p">;</span>
<a id="__codelineno-76-68" name="__codelineno-76-68" href="#__codelineno-76-68"></a>
<a id="__codelineno-76-69" name="__codelineno-76-69" href="#__codelineno-76-69"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">ADDR_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_raddr</span><span class="p">;</span>
<a id="__codelineno-76-70" name="__codelineno-76-70" href="#__codelineno-76-70"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_read</span><span class="p">;</span>
<a id="__codelineno-76-71" name="__codelineno-76-71" href="#__codelineno-76-71"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_read_32b</span><span class="p">;</span>
<a id="__codelineno-76-72" name="__codelineno-76-72" href="#__codelineno-76-72"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">DATA_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_readdata</span><span class="p">;</span>
<a id="__codelineno-76-73" name="__codelineno-76-73" href="#__codelineno-76-73"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_readdata_valid</span><span class="p">;</span>
<a id="__codelineno-76-74" name="__codelineno-76-74" href="#__codelineno-76-74"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">ADDR_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_addr</span><span class="p">;</span>
<a id="__codelineno-76-75" name="__codelineno-76-75" href="#__codelineno-76-75"></a>
<a id="__codelineno-76-76" name="__codelineno-76-76" href="#__codelineno-76-76"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">                        </span><span class="n">com_csr_writedata</span><span class="p">;</span>
<a id="__codelineno-76-77" name="__codelineno-76-77" href="#__codelineno-76-77"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">com_csr_read</span><span class="p">;</span>
<a id="__codelineno-76-78" name="__codelineno-76-78" href="#__codelineno-76-78"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">com_csr_write</span><span class="p">;</span>
<a id="__codelineno-76-79" name="__codelineno-76-79" href="#__codelineno-76-79"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">                        </span><span class="n">com_csr_readdata</span><span class="p">;</span>
<a id="__codelineno-76-80" name="__codelineno-76-80" href="#__codelineno-76-80"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">com_csr_readdatavalid</span><span class="p">;</span>
<a id="__codelineno-76-81" name="__codelineno-76-81" href="#__codelineno-76-81"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">                         </span><span class="n">com_csr_address</span><span class="p">;</span>
<a id="__codelineno-76-82" name="__codelineno-76-82" href="#__codelineno-76-82"></a>
<a id="__codelineno-76-83" name="__codelineno-76-83" href="#__codelineno-76-83"></a><span class="c1">// AXI-M CSR interfaces</span>
<a id="__codelineno-76-84" name="__codelineno-76-84" href="#__codelineno-76-84"></a><span class="n">ofs_fim_axi_mmio_if</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-76-85" name="__codelineno-76-85" href="#__codelineno-76-85"></a><span class="w">   </span><span class="p">.</span><span class="n">AWID_WIDTH</span><span class="w">   </span><span class="p">(</span><span class="n">ofs_fim_cfg_pkg</span><span class="o">::</span><span class="n">MMIO_TID_WIDTH</span><span class="p">),</span>
<a id="__codelineno-76-86" name="__codelineno-76-86" href="#__codelineno-76-86"></a><span class="w">   </span><span class="p">.</span><span class="n">AWADDR_WIDTH</span><span class="w"> </span><span class="p">(</span><span class="n">ADDR_WIDTH</span><span class="p">),</span>
<a id="__codelineno-76-87" name="__codelineno-76-87" href="#__codelineno-76-87"></a><span class="w">   </span><span class="p">.</span><span class="n">WDATA_WIDTH</span><span class="w">  </span><span class="p">(</span><span class="n">ofs_fim_cfg_pkg</span><span class="o">::</span><span class="n">MMIO_DATA_WIDTH</span><span class="p">),</span>
<a id="__codelineno-76-88" name="__codelineno-76-88" href="#__codelineno-76-88"></a><span class="w">   </span><span class="p">.</span><span class="n">ARID_WIDTH</span><span class="w">   </span><span class="p">(</span><span class="n">ofs_fim_cfg_pkg</span><span class="o">::</span><span class="n">MMIO_TID_WIDTH</span><span class="p">),</span>
<a id="__codelineno-76-89" name="__codelineno-76-89" href="#__codelineno-76-89"></a><span class="w">   </span><span class="p">.</span><span class="n">ARADDR_WIDTH</span><span class="w"> </span><span class="p">(</span><span class="n">ADDR_WIDTH</span><span class="p">),</span>
<a id="__codelineno-76-90" name="__codelineno-76-90" href="#__codelineno-76-90"></a><span class="w">   </span><span class="p">.</span><span class="n">RDATA_WIDTH</span><span class="w">  </span><span class="p">(</span><span class="n">ofs_fim_cfg_pkg</span><span class="o">::</span><span class="n">MMIO_DATA_WIDTH</span><span class="p">)</span>
<a id="__codelineno-76-91" name="__codelineno-76-91" href="#__codelineno-76-91"></a><span class="p">)</span><span class="w"> </span><span class="n">csr_if</span><span class="p">();</span>
<a id="__codelineno-76-92" name="__codelineno-76-92" href="#__codelineno-76-92"></a>
<a id="__codelineno-76-93" name="__codelineno-76-93" href="#__codelineno-76-93"></a><span class="c1">// AXI4-lite to AXI-M adapter</span>
<a id="__codelineno-76-94" name="__codelineno-76-94" href="#__codelineno-76-94"></a><span class="n">axi_lite2mmio</span><span class="w"> </span><span class="n">axi_lite2mmio</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-76-95" name="__codelineno-76-95" href="#__codelineno-76-95"></a><span class="w">   </span><span class="p">.</span><span class="n">clk</span><span class="w">       </span><span class="p">(</span><span class="n">clk</span><span class="p">),</span>
<a id="__codelineno-76-96" name="__codelineno-76-96" href="#__codelineno-76-96"></a><span class="w">   </span><span class="p">.</span><span class="n">rst_n</span><span class="w">     </span><span class="p">(</span><span class="o">~</span><span class="n">reset</span><span class="p">),</span>
<a id="__codelineno-76-97" name="__codelineno-76-97" href="#__codelineno-76-97"></a><span class="w">   </span><span class="p">.</span><span class="n">lite_if</span><span class="w">   </span><span class="p">(</span><span class="n">csr_lite_if</span><span class="p">),</span>
<a id="__codelineno-76-98" name="__codelineno-76-98" href="#__codelineno-76-98"></a><span class="w">   </span><span class="p">.</span><span class="n">mmio_if</span><span class="w">   </span><span class="p">(</span><span class="n">csr_if</span><span class="p">)</span>
<a id="__codelineno-76-99" name="__codelineno-76-99" href="#__codelineno-76-99"></a><span class="p">);</span>
<a id="__codelineno-76-100" name="__codelineno-76-100" href="#__codelineno-76-100"></a>
<a id="__codelineno-76-101" name="__codelineno-76-101" href="#__codelineno-76-101"></a><span class="c1">//---------------------------------</span>
<a id="__codelineno-76-102" name="__codelineno-76-102" href="#__codelineno-76-102"></a><span class="c1">// Map AXI write/read request to CSR write/read,</span>
<a id="__codelineno-76-103" name="__codelineno-76-103" href="#__codelineno-76-103"></a><span class="c1">// and send the write/read response back</span>
<a id="__codelineno-76-104" name="__codelineno-76-104" href="#__codelineno-76-104"></a><span class="c1">//---------------------------------</span>
<a id="__codelineno-76-105" name="__codelineno-76-105" href="#__codelineno-76-105"></a><span class="n">ofs_fim_axi_csr_slave</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-76-106" name="__codelineno-76-106" href="#__codelineno-76-106"></a><span class="w">   </span><span class="p">.</span><span class="n">ADDR_WIDTH</span><span class="w"> </span><span class="p">(</span><span class="n">ADDR_WIDTH</span><span class="p">),</span>
<a id="__codelineno-76-107" name="__codelineno-76-107" href="#__codelineno-76-107"></a><span class="w">   </span><span class="p">.</span><span class="n">USE_SLV_READY</span><span class="w"> </span><span class="p">(</span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">)</span>
<a id="__codelineno-76-108" name="__codelineno-76-108" href="#__codelineno-76-108"></a>
<a id="__codelineno-76-109" name="__codelineno-76-109" href="#__codelineno-76-109"></a><span class="w">   </span><span class="p">)</span><span class="w"> </span><span class="n">csr_slave</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-76-110" name="__codelineno-76-110" href="#__codelineno-76-110"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_if</span><span class="w">             </span><span class="p">(</span><span class="n">csr_if</span><span class="p">),</span>
<a id="__codelineno-76-111" name="__codelineno-76-111" href="#__codelineno-76-111"></a>
<a id="__codelineno-76-112" name="__codelineno-76-112" href="#__codelineno-76-112"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_write</span><span class="w">          </span><span class="p">(</span><span class="n">csr_write</span><span class="p">),</span>
<a id="__codelineno-76-113" name="__codelineno-76-113" href="#__codelineno-76-113"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_waddr</span><span class="w">          </span><span class="p">(</span><span class="n">csr_waddr</span><span class="p">),</span>
<a id="__codelineno-76-114" name="__codelineno-76-114" href="#__codelineno-76-114"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_write_type</span><span class="w">     </span><span class="p">(</span><span class="n">csr_write_type</span><span class="p">),</span>
<a id="__codelineno-76-115" name="__codelineno-76-115" href="#__codelineno-76-115"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_wdata</span><span class="w">          </span><span class="p">(</span><span class="n">csr_wdata</span><span class="p">),</span>
<a id="__codelineno-76-116" name="__codelineno-76-116" href="#__codelineno-76-116"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_wstrb</span><span class="w">          </span><span class="p">(</span><span class="n">csr_wstrb</span><span class="p">),</span>
<a id="__codelineno-76-117" name="__codelineno-76-117" href="#__codelineno-76-117"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_slv_wready</span><span class="w">     </span><span class="p">(</span><span class="n">csr_slv_wready</span><span class="p">),</span>
<a id="__codelineno-76-118" name="__codelineno-76-118" href="#__codelineno-76-118"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_read</span><span class="w">           </span><span class="p">(</span><span class="n">csr_read</span><span class="p">),</span>
<a id="__codelineno-76-119" name="__codelineno-76-119" href="#__codelineno-76-119"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_raddr</span><span class="w">          </span><span class="p">(</span><span class="n">csr_raddr</span><span class="p">),</span>
<a id="__codelineno-76-120" name="__codelineno-76-120" href="#__codelineno-76-120"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_read_32b</span><span class="w">       </span><span class="p">(</span><span class="n">csr_read_32b</span><span class="p">),</span>
<a id="__codelineno-76-121" name="__codelineno-76-121" href="#__codelineno-76-121"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_readdata</span><span class="w">       </span><span class="p">(</span><span class="n">csr_readdata</span><span class="p">),</span>
<a id="__codelineno-76-122" name="__codelineno-76-122" href="#__codelineno-76-122"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_readdata_valid</span><span class="w"> </span><span class="p">(</span><span class="n">csr_readdata_valid</span><span class="p">)</span>
<a id="__codelineno-76-123" name="__codelineno-76-123" href="#__codelineno-76-123"></a><span class="p">);</span>
<a id="__codelineno-76-124" name="__codelineno-76-124" href="#__codelineno-76-124"></a>
<a id="__codelineno-76-125" name="__codelineno-76-125" href="#__codelineno-76-125"></a><span class="c1">// Address mapping</span>
<a id="__codelineno-76-126" name="__codelineno-76-126" href="#__codelineno-76-126"></a><span class="k">assign</span><span class="w"> </span><span class="n">csr_addr</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="n">csr_write</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">csr_waddr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">csr_raddr</span><span class="p">;</span>
<a id="__codelineno-76-127" name="__codelineno-76-127" href="#__codelineno-76-127"></a><span class="k">assign</span><span class="w"> </span><span class="n">com_csr_address</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">csr_addr</span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span><span class="w">  </span><span class="c1">// byte address</span>
<a id="__codelineno-76-128" name="__codelineno-76-128" href="#__codelineno-76-128"></a><span class="k">assign</span><span class="w"> </span><span class="n">csr_slv_wready</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="w"> </span><span class="p">;</span>
<a id="__codelineno-76-129" name="__codelineno-76-129" href="#__codelineno-76-129"></a><span class="c1">// Write data mapping</span>
<a id="__codelineno-76-130" name="__codelineno-76-130" href="#__codelineno-76-130"></a><span class="k">assign</span><span class="w"> </span><span class="n">com_csr_writedata</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">csr_wdata</span><span class="p">;</span>
<a id="__codelineno-76-131" name="__codelineno-76-131" href="#__codelineno-76-131"></a>
<a id="__codelineno-76-132" name="__codelineno-76-132" href="#__codelineno-76-132"></a><span class="c1">// Read-Write mapping</span>
<a id="__codelineno-76-133" name="__codelineno-76-133" href="#__codelineno-76-133"></a><span class="k">always_comb</span>
<a id="__codelineno-76-134" name="__codelineno-76-134" href="#__codelineno-76-134"></a><span class="k">begin</span>
<a id="__codelineno-76-135" name="__codelineno-76-135" href="#__codelineno-76-135"></a><span class="w">   </span><span class="n">com_csr_read</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-76-136" name="__codelineno-76-136" href="#__codelineno-76-136"></a><span class="w">   </span><span class="n">com_csr_write</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-76-137" name="__codelineno-76-137" href="#__codelineno-76-137"></a><span class="w">   </span><span class="k">casez</span><span class="w"> </span><span class="p">(</span><span class="n">csr_addr</span><span class="p">[</span><span class="mh">11</span><span class="o">:</span><span class="mh">6</span><span class="p">])</span>
<a id="__codelineno-76-138" name="__codelineno-76-138" href="#__codelineno-76-138"></a><span class="w">      </span><span class="mh">6&#39;h00</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span><span class="c1">// Common CSR</span>
<a id="__codelineno-76-139" name="__codelineno-76-139" href="#__codelineno-76-139"></a><span class="w">         </span><span class="n">com_csr_read</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">csr_read</span><span class="p">;</span>
<a id="__codelineno-76-140" name="__codelineno-76-140" href="#__codelineno-76-140"></a><span class="w">         </span><span class="n">com_csr_write</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">csr_write</span><span class="p">;</span>
<a id="__codelineno-76-141" name="__codelineno-76-141" href="#__codelineno-76-141"></a><span class="w">      </span><span class="k">end</span><span class="w">   </span>
<a id="__codelineno-76-142" name="__codelineno-76-142" href="#__codelineno-76-142"></a><span class="w">      </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-76-143" name="__codelineno-76-143" href="#__codelineno-76-143"></a><span class="w">         </span><span class="n">com_csr_read</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-76-144" name="__codelineno-76-144" href="#__codelineno-76-144"></a><span class="w">         </span><span class="n">com_csr_write</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-76-145" name="__codelineno-76-145" href="#__codelineno-76-145"></a><span class="w">      </span><span class="k">end</span>
<a id="__codelineno-76-146" name="__codelineno-76-146" href="#__codelineno-76-146"></a><span class="w">   </span><span class="k">endcase</span>
<a id="__codelineno-76-147" name="__codelineno-76-147" href="#__codelineno-76-147"></a><span class="k">end</span>
<a id="__codelineno-76-148" name="__codelineno-76-148" href="#__codelineno-76-148"></a>
<a id="__codelineno-76-149" name="__codelineno-76-149" href="#__codelineno-76-149"></a><span class="c1">// Read data mapping</span>
<a id="__codelineno-76-150" name="__codelineno-76-150" href="#__codelineno-76-150"></a><span class="k">always_comb</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-76-151" name="__codelineno-76-151" href="#__codelineno-76-151"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">com_csr_readdatavalid</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-76-152" name="__codelineno-76-152" href="#__codelineno-76-152"></a><span class="w">      </span><span class="n">csr_readdata</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">com_csr_readdata</span><span class="p">;</span>
<a id="__codelineno-76-153" name="__codelineno-76-153" href="#__codelineno-76-153"></a><span class="w">      </span><span class="n">csr_readdata_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
<a id="__codelineno-76-154" name="__codelineno-76-154" href="#__codelineno-76-154"></a><span class="w">   </span><span class="k">end</span>
<a id="__codelineno-76-155" name="__codelineno-76-155" href="#__codelineno-76-155"></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-76-156" name="__codelineno-76-156" href="#__codelineno-76-156"></a><span class="w">      </span><span class="n">csr_readdata</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="m">&#39;0</span><span class="p">;</span>
<a id="__codelineno-76-157" name="__codelineno-76-157" href="#__codelineno-76-157"></a><span class="w">      </span><span class="n">csr_readdata_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-76-158" name="__codelineno-76-158" href="#__codelineno-76-158"></a><span class="w">   </span><span class="k">end</span>
<a id="__codelineno-76-159" name="__codelineno-76-159" href="#__codelineno-76-159"></a><span class="k">end</span>
<a id="__codelineno-76-160" name="__codelineno-76-160" href="#__codelineno-76-160"></a>
<a id="__codelineno-76-161" name="__codelineno-76-161" href="#__codelineno-76-161"></a><span class="n">hello_fim_com</span><span class="w">  </span><span class="p">#(</span>
<a id="__codelineno-76-162" name="__codelineno-76-162" href="#__codelineno-76-162"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_ID</span><span class="w">          </span><span class="p">(</span><span class="n">FEAT_ID</span><span class="p">),</span>
<a id="__codelineno-76-163" name="__codelineno-76-163" href="#__codelineno-76-163"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_VER</span><span class="w">         </span><span class="p">(</span><span class="n">FEAT_VER</span><span class="p">),</span>
<a id="__codelineno-76-164" name="__codelineno-76-164" href="#__codelineno-76-164"></a><span class="w">   </span><span class="p">.</span><span class="n">NEXT_DFH_OFFSET</span><span class="w">  </span><span class="p">(</span><span class="n">NEXT_DFH_OFFSET</span><span class="p">),</span>
<a id="__codelineno-76-165" name="__codelineno-76-165" href="#__codelineno-76-165"></a><span class="w">   </span><span class="p">.</span><span class="n">END_OF_LIST</span><span class="w">      </span><span class="p">(</span><span class="n">END_OF_LIST</span><span class="p">)</span>
<a id="__codelineno-76-166" name="__codelineno-76-166" href="#__codelineno-76-166"></a><span class="p">)</span><span class="w"> </span><span class="n">hello_fim_com_inst</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-76-167" name="__codelineno-76-167" href="#__codelineno-76-167"></a><span class="w">   </span><span class="p">.</span><span class="n">clk</span><span class="w">                   </span><span class="p">(</span><span class="n">clk</span><span class="w">                     </span><span class="p">),</span>
<a id="__codelineno-76-168" name="__codelineno-76-168" href="#__codelineno-76-168"></a><span class="w">   </span><span class="p">.</span><span class="n">reset</span><span class="w">                 </span><span class="p">(</span><span class="n">reset</span><span class="w">                   </span><span class="p">),</span>
<a id="__codelineno-76-169" name="__codelineno-76-169" href="#__codelineno-76-169"></a><span class="w">   </span><span class="p">.</span><span class="n">writedata</span><span class="w">             </span><span class="p">(</span><span class="n">com_csr_writedata</span><span class="w">       </span><span class="p">),</span>
<a id="__codelineno-76-170" name="__codelineno-76-170" href="#__codelineno-76-170"></a><span class="w">   </span><span class="p">.</span><span class="n">read</span><span class="w">                  </span><span class="p">(</span><span class="n">com_csr_read</span><span class="w">            </span><span class="p">),</span>
<a id="__codelineno-76-171" name="__codelineno-76-171" href="#__codelineno-76-171"></a><span class="w">   </span><span class="p">.</span><span class="n">write</span><span class="w">                 </span><span class="p">(</span><span class="n">com_csr_write</span><span class="w">           </span><span class="p">),</span>
<a id="__codelineno-76-172" name="__codelineno-76-172" href="#__codelineno-76-172"></a><span class="w">   </span><span class="p">.</span><span class="n">byteenable</span><span class="w">            </span><span class="p">(</span><span class="mh">4&#39;hF</span><span class="w">                    </span><span class="p">),</span>
<a id="__codelineno-76-173" name="__codelineno-76-173" href="#__codelineno-76-173"></a><span class="w">   </span><span class="p">.</span><span class="n">readdata</span><span class="w">              </span><span class="p">(</span><span class="n">com_csr_readdata</span><span class="w">        </span><span class="p">),</span>
<a id="__codelineno-76-174" name="__codelineno-76-174" href="#__codelineno-76-174"></a><span class="w">   </span><span class="p">.</span><span class="n">readdatavalid</span><span class="w">         </span><span class="p">(</span><span class="n">com_csr_readdatavalid</span><span class="w">   </span><span class="p">),</span>
<a id="__codelineno-76-175" name="__codelineno-76-175" href="#__codelineno-76-175"></a><span class="w">   </span><span class="p">.</span><span class="n">address</span><span class="w">               </span><span class="p">(</span><span class="n">com_csr_address</span><span class="w">         </span><span class="p">)</span>
<a id="__codelineno-76-176" name="__codelineno-76-176" href="#__codelineno-76-176"></a><span class="w">   </span><span class="p">);</span>
<a id="__codelineno-76-177" name="__codelineno-76-177" href="#__codelineno-76-177"></a><span class="k">endmodule</span>
</code></pre></div>
</li>
<li>
<p>Create <code>hello_fim_com.sv</code> file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a>touch<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/src/hello_fim/hello_fim_com.sv
</code></pre></div>
<p>Copy the following code to <code>hello_fim_com.sv</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a><span class="k">module</span><span class="w"> </span><span class="n">hello_fim_com</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">11</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">FEAT_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">12&#39;h100</span><span class="p">,</span>
<a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">FEAT_VER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">4&#39;h0</span><span class="p">,</span>
<a id="__codelineno-78-4" name="__codelineno-78-4" href="#__codelineno-78-4"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">23</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">NEXT_DFH_OFFSET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">24&#39;h1000</span><span class="p">,</span>
<a id="__codelineno-78-5" name="__codelineno-78-5" href="#__codelineno-78-5"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="n">END_OF_LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span>
<a id="__codelineno-78-6" name="__codelineno-78-6" href="#__codelineno-78-6"></a><span class="p">)(</span>
<a id="__codelineno-78-7" name="__codelineno-78-7" href="#__codelineno-78-7"></a><span class="k">input</span><span class="w"> </span><span class="n">clk</span><span class="p">,</span>
<a id="__codelineno-78-8" name="__codelineno-78-8" href="#__codelineno-78-8"></a><span class="k">input</span><span class="w"> </span><span class="n">reset</span><span class="p">,</span>
<a id="__codelineno-78-9" name="__codelineno-78-9" href="#__codelineno-78-9"></a><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">writedata</span><span class="p">,</span>
<a id="__codelineno-78-10" name="__codelineno-78-10" href="#__codelineno-78-10"></a><span class="k">input</span><span class="w"> </span><span class="n">read</span><span class="p">,</span>
<a id="__codelineno-78-11" name="__codelineno-78-11" href="#__codelineno-78-11"></a><span class="k">input</span><span class="w"> </span><span class="n">write</span><span class="p">,</span>
<a id="__codelineno-78-12" name="__codelineno-78-12" href="#__codelineno-78-12"></a><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">byteenable</span><span class="p">,</span>
<a id="__codelineno-78-13" name="__codelineno-78-13" href="#__codelineno-78-13"></a><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">readdata</span><span class="p">,</span>
<a id="__codelineno-78-14" name="__codelineno-78-14" href="#__codelineno-78-14"></a><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="n">readdatavalid</span><span class="p">,</span>
<a id="__codelineno-78-15" name="__codelineno-78-15" href="#__codelineno-78-15"></a><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">address</span>
<a id="__codelineno-78-16" name="__codelineno-78-16" href="#__codelineno-78-16"></a><span class="p">);</span>
<a id="__codelineno-78-17" name="__codelineno-78-17" href="#__codelineno-78-17"></a>
<a id="__codelineno-78-18" name="__codelineno-78-18" href="#__codelineno-78-18"></a><span class="kt">wire</span><span class="w"> </span><span class="n">reset_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">reset</span><span class="p">;</span><span class="w">  </span>
<a id="__codelineno-78-19" name="__codelineno-78-19" href="#__codelineno-78-19"></a><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">rdata_comb</span><span class="p">;</span>
<a id="__codelineno-78-20" name="__codelineno-78-20" href="#__codelineno-78-20"></a><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">scratch_reg</span><span class="p">;</span>
<a id="__codelineno-78-21" name="__codelineno-78-21" href="#__codelineno-78-21"></a>
<a id="__codelineno-78-22" name="__codelineno-78-22" href="#__codelineno-78-22"></a><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">negedge</span><span class="w"> </span><span class="n">reset_n</span><span class="w"> </span><span class="p">,</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span><span class="w">  </span>
<a id="__codelineno-78-23" name="__codelineno-78-23" href="#__codelineno-78-23"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">reset_n</span><span class="p">)</span><span class="w"> </span><span class="n">readdata</span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">readdata</span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">rdata_comb</span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
<a id="__codelineno-78-24" name="__codelineno-78-24" href="#__codelineno-78-24"></a>
<a id="__codelineno-78-25" name="__codelineno-78-25" href="#__codelineno-78-25"></a><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">negedge</span><span class="w"> </span><span class="n">reset_n</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span>
<a id="__codelineno-78-26" name="__codelineno-78-26" href="#__codelineno-78-26"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">reset_n</span><span class="p">)</span><span class="w"> </span><span class="n">readdatavalid</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">readdatavalid</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">read</span><span class="p">;</span>
<a id="__codelineno-78-27" name="__codelineno-78-27" href="#__codelineno-78-27"></a>
<a id="__codelineno-78-28" name="__codelineno-78-28" href="#__codelineno-78-28"></a><span class="kt">wire</span><span class="w"> </span><span class="n">wr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">write</span><span class="p">;</span>
<a id="__codelineno-78-29" name="__codelineno-78-29" href="#__codelineno-78-29"></a><span class="kt">wire</span><span class="w"> </span><span class="n">re</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read</span><span class="p">;</span>
<a id="__codelineno-78-30" name="__codelineno-78-30" href="#__codelineno-78-30"></a><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
<a id="__codelineno-78-31" name="__codelineno-78-31" href="#__codelineno-78-31"></a><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">din</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">writedata</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
<a id="__codelineno-78-32" name="__codelineno-78-32" href="#__codelineno-78-32"></a><span class="kt">wire</span><span class="w"> </span><span class="n">wr_scratch_reg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wr</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">addr</span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="o">==</span><span class="w"> </span><span class="mh">6&#39;h30</span><span class="p">)</span><span class="o">?</span><span class="w"> </span><span class="n">byteenable</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="o">:</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-78-33" name="__codelineno-78-33" href="#__codelineno-78-33"></a>
<a id="__codelineno-78-34" name="__codelineno-78-34" href="#__codelineno-78-34"></a><span class="c1">// 64 bit scratch register</span>
<a id="__codelineno-78-35" name="__codelineno-78-35" href="#__codelineno-78-35"></a><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="w"> </span><span class="k">negedge</span><span class="w">  </span><span class="n">reset_n</span><span class="p">,</span><span class="w">  </span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span>
<a id="__codelineno-78-36" name="__codelineno-78-36" href="#__codelineno-78-36"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">reset_n</span><span class="p">)</span><span class="w">  </span><span class="k">begin</span>
<a id="__codelineno-78-37" name="__codelineno-78-37" href="#__codelineno-78-37"></a><span class="w">      </span><span class="n">scratch_reg</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="p">;</span>
<a id="__codelineno-78-38" name="__codelineno-78-38" href="#__codelineno-78-38"></a><span class="w">   </span><span class="k">end</span>
<a id="__codelineno-78-39" name="__codelineno-78-39" href="#__codelineno-78-39"></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-78-40" name="__codelineno-78-40" href="#__codelineno-78-40"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wr_scratch_reg</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span>
<a id="__codelineno-78-41" name="__codelineno-78-41" href="#__codelineno-78-41"></a><span class="w">      </span><span class="n">scratch_reg</span><span class="w"> </span><span class="o">&lt;=</span><span class="w">  </span><span class="n">din</span><span class="p">;</span><span class="w">  </span>
<a id="__codelineno-78-42" name="__codelineno-78-42" href="#__codelineno-78-42"></a><span class="w">   </span><span class="k">end</span>
<a id="__codelineno-78-43" name="__codelineno-78-43" href="#__codelineno-78-43"></a><span class="k">end</span>
<a id="__codelineno-78-44" name="__codelineno-78-44" href="#__codelineno-78-44"></a>
<a id="__codelineno-78-45" name="__codelineno-78-45" href="#__codelineno-78-45"></a><span class="k">always</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a id="__codelineno-78-46" name="__codelineno-78-46" href="#__codelineno-78-46"></a><span class="k">begin</span>
<a id="__codelineno-78-47" name="__codelineno-78-47" href="#__codelineno-78-47"></a><span class="n">rdata_comb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h0000000000000000</span><span class="p">;</span>
<a id="__codelineno-78-48" name="__codelineno-78-48" href="#__codelineno-78-48"></a><span class="w">   </span><span class="k">if</span><span class="p">(</span><span class="n">re</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-78-49" name="__codelineno-78-49" href="#__codelineno-78-49"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="w">  </span>
<a id="__codelineno-78-50" name="__codelineno-78-50" href="#__codelineno-78-50"></a><span class="w">        </span><span class="mh">6&#39;h00</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-78-51" name="__codelineno-78-51" href="#__codelineno-78-51"></a><span class="w">                </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">11</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">FEAT_ID</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_feature_id  is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-78-52" name="__codelineno-78-52" href="#__codelineno-78-52"></a><span class="w">                </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">12</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">FEAT_VER</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_feature_rev    is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-78-53" name="__codelineno-78-53" href="#__codelineno-78-53"></a><span class="w">                </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">16</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">NEXT_DFH_OFFSET</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_dfh_ofst is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-78-54" name="__codelineno-78-54" href="#__codelineno-78-54"></a><span class="w">                </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">40</span><span class="p">]</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">END_OF_LIST</span><span class="w"> </span><span class="p">;</span><span class="w">        </span><span class="c1">//dfh_end_of_list</span>
<a id="__codelineno-78-55" name="__codelineno-78-55" href="#__codelineno-78-55"></a><span class="w">                </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">59</span><span class="o">:</span><span class="mh">40</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">20&#39;h00000</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_rsvd1     is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-78-56" name="__codelineno-78-56" href="#__codelineno-78-56"></a><span class="w">                </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">60</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">4&#39;h3</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_feat_type  is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-78-57" name="__codelineno-78-57" href="#__codelineno-78-57"></a><span class="w">        </span><span class="k">end</span>
<a id="__codelineno-78-58" name="__codelineno-78-58" href="#__codelineno-78-58"></a><span class="w">        </span><span class="mh">6&#39;h30</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-78-59" name="__codelineno-78-59" href="#__codelineno-78-59"></a><span class="w">                </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">scratch_reg</span><span class="p">;</span><span class="w"> </span>
<a id="__codelineno-78-60" name="__codelineno-78-60" href="#__codelineno-78-60"></a><span class="w">        </span><span class="k">end</span>
<a id="__codelineno-78-61" name="__codelineno-78-61" href="#__codelineno-78-61"></a><span class="w">        </span><span class="mh">6&#39;h38</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-78-62" name="__codelineno-78-62" href="#__codelineno-78-62"></a><span class="w">                </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h6626</span><span class="n">_0701_5000_0034</span><span class="p">;</span>
<a id="__codelineno-78-63" name="__codelineno-78-63" href="#__codelineno-78-63"></a><span class="w">        </span><span class="k">end</span>
<a id="__codelineno-78-64" name="__codelineno-78-64" href="#__codelineno-78-64"></a><span class="w">        </span><span class="k">default</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-78-65" name="__codelineno-78-65" href="#__codelineno-78-65"></a><span class="w">                </span><span class="n">rdata_comb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h0000000000000000</span><span class="p">;</span>
<a id="__codelineno-78-66" name="__codelineno-78-66" href="#__codelineno-78-66"></a><span class="w">        </span><span class="k">end</span>
<a id="__codelineno-78-67" name="__codelineno-78-67" href="#__codelineno-78-67"></a><span class="w">      </span><span class="k">endcase</span>
<a id="__codelineno-78-68" name="__codelineno-78-68" href="#__codelineno-78-68"></a><span class="w">   </span><span class="k">end</span>
<a id="__codelineno-78-69" name="__codelineno-78-69" href="#__codelineno-78-69"></a><span class="k">end</span>
<a id="__codelineno-78-70" name="__codelineno-78-70" href="#__codelineno-78-70"></a>
<a id="__codelineno-78-71" name="__codelineno-78-71" href="#__codelineno-78-71"></a><span class="k">endmodule</span>
</code></pre></div>
</li>
<li>
<p>Create <code>hello_fim_design_files.tcl</code> file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a>touch<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/src/hello_fim/hello_fim_design_files.tcl
</code></pre></div>
<p>Copy the following code into <code>hello_fim_design_files.tcl</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="c"># Copyright 2023 Intel Corporation.</span>
<a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a><span class="c">#</span>
<a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a><span class="c"># THIS SOFTWARE MAY CONTAIN PREPRODUCTION CODE AND IS PROVIDED BY THE</span>
<a id="__codelineno-80-4" name="__codelineno-80-4" href="#__codelineno-80-4"></a><span class="c"># COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED</span>
<a id="__codelineno-80-5" name="__codelineno-80-5" href="#__codelineno-80-5"></a><span class="c"># WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF</span>
<a id="__codelineno-80-6" name="__codelineno-80-6" href="#__codelineno-80-6"></a><span class="c"># MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<a id="__codelineno-80-7" name="__codelineno-80-7" href="#__codelineno-80-7"></a><span class="c"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE</span>
<a id="__codelineno-80-8" name="__codelineno-80-8" href="#__codelineno-80-8"></a><span class="c"># LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
<a id="__codelineno-80-9" name="__codelineno-80-9" href="#__codelineno-80-9"></a><span class="c"># CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
<a id="__codelineno-80-10" name="__codelineno-80-10" href="#__codelineno-80-10"></a><span class="c"># SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR</span>
<a id="__codelineno-80-11" name="__codelineno-80-11" href="#__codelineno-80-11"></a><span class="c"># BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,</span>
<a id="__codelineno-80-12" name="__codelineno-80-12" href="#__codelineno-80-12"></a><span class="c"># WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE</span>
<a id="__codelineno-80-13" name="__codelineno-80-13" href="#__codelineno-80-13"></a><span class="c"># OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,</span>
<a id="__codelineno-80-14" name="__codelineno-80-14" href="#__codelineno-80-14"></a><span class="c"># EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a id="__codelineno-80-15" name="__codelineno-80-15" href="#__codelineno-80-15"></a><span class="c">#</span>
<a id="__codelineno-80-16" name="__codelineno-80-16" href="#__codelineno-80-16"></a><span class="c"># Hello FIM Files</span>
<a id="__codelineno-80-17" name="__codelineno-80-17" href="#__codelineno-80-17"></a><span class="c">#--------------------</span>
<a id="__codelineno-80-18" name="__codelineno-80-18" href="#__codelineno-80-18"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>SYSTEMVERILOG_FILE<span class="w"> </span><span class="nv">$::env</span><span class="k">(</span><span class="nv">BUILD_ROOT_REL</span><span class="k">)</span><span class="o">/</span>src<span class="o">/</span>hello_fim<span class="o">/</span>hello_fim_com.sv
<a id="__codelineno-80-19" name="__codelineno-80-19" href="#__codelineno-80-19"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>SYSTEMVERILOG_FILE<span class="w"> </span><span class="nv">$::env</span><span class="k">(</span><span class="nv">BUILD_ROOT_REL</span><span class="k">)</span><span class="o">/</span>src<span class="o">/</span>hello_fim<span class="o">/</span>hello_fim_top.sv
</code></pre></div>
</li>
<li>
<p>Modify <code>ofs_top.qsf</code> for the target board to include Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a>vim<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/syn_top/ofs_top.qsf
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a>vim<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6000/syn_top/ofs_top.qsf
</code></pre></div>
</li>
</ul>
<p>Add the following line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="c">######################################################</span>
<a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a><span class="c"># Verilog Macros</span>
<a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a><span class="c">######################################################</span>
<a id="__codelineno-83-4" name="__codelineno-83-4" href="#__codelineno-83-4"></a><span class="nv">.....</span>
<a id="__codelineno-83-5" name="__codelineno-83-5" href="#__codelineno-83-5"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>VERILOG_MACRO<span class="w"> </span><span class="s2">&quot;INCLUDE_HELLO_FIM&quot;</span><span class="w">     </span><span class="err">#</span><span class="w"> </span>Includes<span class="w"> </span>Hello<span class="w"> </span>FIM
</code></pre></div>
</li>
<li>
<p>Modify <code>ofs_top_sources.tcl</code> for the target board to include Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design files</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a>vim<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/syn_top/ofs_top_sources.tcl
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a>vim<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6000/syn_top/ofs_top_sources.tcl
</code></pre></div>
</li>
</ul>
<p>Add the following line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a><span class="c">############################################</span>
<a id="__codelineno-86-2" name="__codelineno-86-2" href="#__codelineno-86-2"></a><span class="c"># Design Files</span>
<a id="__codelineno-86-3" name="__codelineno-86-3" href="#__codelineno-86-3"></a><span class="c">############################################</span>
<a id="__codelineno-86-4" name="__codelineno-86-4" href="#__codelineno-86-4"></a><span class="nv">...</span>
<a id="__codelineno-86-5" name="__codelineno-86-5" href="#__codelineno-86-5"></a><span class="c"># Subsystems</span>
<a id="__codelineno-86-6" name="__codelineno-86-6" href="#__codelineno-86-6"></a><span class="nv">...</span>
<a id="__codelineno-86-7" name="__codelineno-86-7" href="#__codelineno-86-7"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>SOURCE_TCL_SCRIPT_FILE<span class="w"> </span><span class="nv">$::env</span><span class="k">(</span><span class="nv">BUILD_ROOT_REL</span><span class="k">)</span><span class="o">/</span>src<span class="o">/</span>hello_fim<span class="o">/</span>hello_fim_design_files.tcl
</code></pre></div>
</li>
<li>
<p>Modify <code>fabric_design_files.tcl</code> to include BPF Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Slave IP.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a>vim<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/src/pd_qsys/fabric/fabric_design_files.tcl
</code></pre></div>
<p>Add the following line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a><span class="c">#--------------------</span>
<a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a><span class="c"># BPF</span>
<a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a><span class="c">#--------------------</span>
<a id="__codelineno-88-4" name="__codelineno-88-4" href="#__codelineno-88-4"></a><span class="nv">...</span>
<a id="__codelineno-88-5" name="__codelineno-88-5" href="#__codelineno-88-5"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>IP_FILE<span class="w">   </span><span class="nv">$::env</span><span class="k">(</span><span class="nv">BUILD_ROOT_REL</span><span class="k">)</span><span class="o">/</span>src<span class="o">/</span>pd_qsys<span class="o">/</span>fabric<span class="o">/</span>ip<span class="o">/</span>bpf<span class="o">/</span>bpf_hello_fim_slv.ip
</code></pre></div>
</li>
<li>
<p>Modify <code>fabric_width_pkg.sv</code> to add Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> slave information and update EMIF slave next offset.</p>
<ol>
<li>
<p>Open <code>fabric_width_pkg.sv</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a>vim<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/src/includes/fabric_width_pkg.sv
</code></pre></div>
</li>
<li>
<p>Add/modify the following lines:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a><span class="k">localparam</span><span class="w"> </span><span class="n">bpf_hello_fim_slv_baseaddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">&#39;h16000</span><span class="p">;</span><span class="w">    </span><span class="c1">// New</span>
<a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a><span class="k">localparam</span><span class="w"> </span><span class="n">bpf_hello_fim_slv_address_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">12</span><span class="p">;</span><span class="w">       </span><span class="c1">// New</span>
<a id="__codelineno-90-3" name="__codelineno-90-3" href="#__codelineno-90-3"></a><span class="k">localparam</span><span class="w"> </span><span class="n">bpf_emif_slv_next_dfh_offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">&#39;h1000</span><span class="p">;</span><span class="w">      </span><span class="c1">// Old value: &#39;hB000</span>
<a id="__codelineno-90-4" name="__codelineno-90-4" href="#__codelineno-90-4"></a><span class="k">localparam</span><span class="w"> </span><span class="n">bpf_hello_fim_slv_next_dfh_offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">&#39;hA000</span><span class="p">;</span><span class="w"> </span><span class="c1">// New</span>
<a id="__codelineno-90-5" name="__codelineno-90-5" href="#__codelineno-90-5"></a><span class="k">localparam</span><span class="w"> </span><span class="n">bpf_hello_fim_slv_eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mb">&#39;b0</span><span class="p">;</span><span class="w">                </span><span class="c1">// New</span>
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Modify <code>top.sv</code> to support the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module.</p>
<ol>
<li>
<p>Open <code>top.sv</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a>vim<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/src/top/top.sv
</code></pre></div>
</li>
<li>
<p>Add <code>bpf_hello_fim_slv_if</code> to AXI interfaces</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a><span class="c1">// AXI4-lite interfaces</span>
<a id="__codelineno-92-2" name="__codelineno-92-2" href="#__codelineno-92-2"></a><span class="p">...</span>
<a id="__codelineno-92-3" name="__codelineno-92-3" href="#__codelineno-92-3"></a><span class="n">ofs_fim_axi_lite_if</span><span class="w"> </span><span class="p">#(.</span><span class="n">AWADDR_WIDTH</span><span class="p">(</span><span class="n">fabric_width_pkg</span><span class="o">::</span><span class="n">bpf_hello_fim_slv_address_width</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">ARADDR_WIDTH</span><span class="p">(</span><span class="n">fabric_width_pkg</span><span class="o">::</span><span class="n">bpf_hello_fim_slv_address_width</span><span class="p">))</span><span class="w"> </span><span class="n">bpf_hello_fim_slv_if</span><span class="p">();</span>
</code></pre></div>
</li>
<li>
<p>Add Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> instantiation</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a><span class="c1">//*******************************</span>
<a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a><span class="c1">// Hello FIM Subsystem</span>
<a id="__codelineno-93-3" name="__codelineno-93-3" href="#__codelineno-93-3"></a><span class="c1">//*******************************</span>
<a id="__codelineno-93-4" name="__codelineno-93-4" href="#__codelineno-93-4"></a>
<a id="__codelineno-93-5" name="__codelineno-93-5" href="#__codelineno-93-5"></a><span class="no">`ifdef</span><span class="w"> </span><span class="n">INCLUDE_HELLO_FIM</span>
<a id="__codelineno-93-6" name="__codelineno-93-6" href="#__codelineno-93-6"></a><span class="n">hello_fim_top</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-93-7" name="__codelineno-93-7" href="#__codelineno-93-7"></a><span class="w">   </span><span class="p">.</span><span class="n">ADDR_WIDTH</span><span class="w">       </span><span class="p">(</span><span class="n">fabric_width_pkg</span><span class="o">::</span><span class="n">bpf_hello_fim_slv_address_width</span><span class="p">),</span>
<a id="__codelineno-93-8" name="__codelineno-93-8" href="#__codelineno-93-8"></a><span class="w">   </span><span class="p">.</span><span class="n">DATA_WIDTH</span><span class="w">       </span><span class="p">(</span><span class="mh">64</span><span class="p">),</span>
<a id="__codelineno-93-9" name="__codelineno-93-9" href="#__codelineno-93-9"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_ID</span><span class="w">          </span><span class="p">(</span><span class="mh">12&#39;h100</span><span class="p">),</span>
<a id="__codelineno-93-10" name="__codelineno-93-10" href="#__codelineno-93-10"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_VER</span><span class="w">         </span><span class="p">(</span><span class="mh">4&#39;h0</span><span class="p">),</span>
<a id="__codelineno-93-11" name="__codelineno-93-11" href="#__codelineno-93-11"></a><span class="w">   </span><span class="p">.</span><span class="n">NEXT_DFH_OFFSET</span><span class="w">  </span><span class="p">(</span><span class="n">fabric_width_pkg</span><span class="o">::</span><span class="n">bpf_hello_fim_slv_next_dfh_offset</span><span class="p">),</span>
<a id="__codelineno-93-12" name="__codelineno-93-12" href="#__codelineno-93-12"></a><span class="w">   </span><span class="p">.</span><span class="n">END_OF_LIST</span><span class="w">      </span><span class="p">(</span><span class="n">fabric_width_pkg</span><span class="o">::</span><span class="n">bpf_hello_fim_slv_eol</span><span class="p">)</span>
<a id="__codelineno-93-13" name="__codelineno-93-13" href="#__codelineno-93-13"></a><span class="p">)</span><span class="w"> </span><span class="n">hello_fim_top_inst</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-93-14" name="__codelineno-93-14" href="#__codelineno-93-14"></a><span class="w">    </span><span class="p">.</span><span class="n">clk</span><span class="w"> </span><span class="p">(</span><span class="n">clk_csr</span><span class="p">),</span>
<a id="__codelineno-93-15" name="__codelineno-93-15" href="#__codelineno-93-15"></a><span class="w">    </span><span class="p">.</span><span class="n">reset</span><span class="p">(</span><span class="o">~</span><span class="n">rst_n_csr</span><span class="p">),</span>
<a id="__codelineno-93-16" name="__codelineno-93-16" href="#__codelineno-93-16"></a><span class="w">    </span><span class="p">.</span><span class="n">csr_lite_if</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">)</span>
<a id="__codelineno-93-17" name="__codelineno-93-17" href="#__codelineno-93-17"></a><span class="p">);</span>
<a id="__codelineno-93-18" name="__codelineno-93-18" href="#__codelineno-93-18"></a><span class="no">`else</span>
<a id="__codelineno-93-19" name="__codelineno-93-19" href="#__codelineno-93-19"></a><span class="n">dummy_csr</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-93-20" name="__codelineno-93-20" href="#__codelineno-93-20"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_ID</span><span class="w">          </span><span class="p">(</span><span class="mh">12&#39;h100</span><span class="p">),</span>
<a id="__codelineno-93-21" name="__codelineno-93-21" href="#__codelineno-93-21"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_VER</span><span class="w">         </span><span class="p">(</span><span class="mh">4&#39;h0</span><span class="p">),</span>
<a id="__codelineno-93-22" name="__codelineno-93-22" href="#__codelineno-93-22"></a><span class="w">   </span><span class="p">.</span><span class="n">NEXT_DFH_OFFSET</span><span class="w">  </span><span class="p">(</span><span class="n">fabric_width_pkg</span><span class="o">::</span><span class="n">bpf_hello_fim_slv_next_dfh_offset</span><span class="p">),</span>
<a id="__codelineno-93-23" name="__codelineno-93-23" href="#__codelineno-93-23"></a><span class="w">   </span><span class="p">.</span><span class="n">END_OF_LIST</span><span class="w">      </span><span class="p">(</span><span class="n">fabric_width_pkg</span><span class="o">::</span><span class="n">bpf_hello_fim_slv_eol</span><span class="p">)</span>
<a id="__codelineno-93-24" name="__codelineno-93-24" href="#__codelineno-93-24"></a><span class="p">)</span><span class="w"> </span><span class="n">hello_fim_dummy</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-93-25" name="__codelineno-93-25" href="#__codelineno-93-25"></a><span class="w">   </span><span class="p">.</span><span class="n">clk</span><span class="w">         </span><span class="p">(</span><span class="n">clk_csr</span><span class="p">),</span>
<a id="__codelineno-93-26" name="__codelineno-93-26" href="#__codelineno-93-26"></a><span class="w">   </span><span class="p">.</span><span class="n">rst_n</span><span class="w">       </span><span class="p">(</span><span class="n">rst_n_csr</span><span class="p">),</span>
<a id="__codelineno-93-27" name="__codelineno-93-27" href="#__codelineno-93-27"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_lite_if</span><span class="w"> </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">)</span>
<a id="__codelineno-93-28" name="__codelineno-93-28" href="#__codelineno-93-28"></a><span class="p">);</span>
<a id="__codelineno-93-29" name="__codelineno-93-29" href="#__codelineno-93-29"></a>
<a id="__codelineno-93-30" name="__codelineno-93-30" href="#__codelineno-93-30"></a><span class="no">`endif</span>
</code></pre></div>
</li>
<li>
<p>Add interfaces for Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> slv to bpf instantiation</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a><span class="n">bpf</span><span class="w"> </span><span class="n">bpf</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a><span class="p">...</span>
<a id="__codelineno-94-3" name="__codelineno-94-3" href="#__codelineno-94-3"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_awaddr</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">awaddr</span><span class="w">  </span><span class="p">),</span>
<a id="__codelineno-94-4" name="__codelineno-94-4" href="#__codelineno-94-4"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_awprot</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">awprot</span><span class="w">  </span><span class="p">),</span>
<a id="__codelineno-94-5" name="__codelineno-94-5" href="#__codelineno-94-5"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_awvalid</span><span class="w">  </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">awvalid</span><span class="w"> </span><span class="p">),</span>
<a id="__codelineno-94-6" name="__codelineno-94-6" href="#__codelineno-94-6"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_awready</span><span class="w">  </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">awready</span><span class="w"> </span><span class="p">),</span>
<a id="__codelineno-94-7" name="__codelineno-94-7" href="#__codelineno-94-7"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_wdata</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">wdata</span><span class="w">   </span><span class="p">),</span>
<a id="__codelineno-94-8" name="__codelineno-94-8" href="#__codelineno-94-8"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_wstrb</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">wstrb</span><span class="w">   </span><span class="p">),</span>
<a id="__codelineno-94-9" name="__codelineno-94-9" href="#__codelineno-94-9"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_wvalid</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">wvalid</span><span class="w">  </span><span class="p">),</span>
<a id="__codelineno-94-10" name="__codelineno-94-10" href="#__codelineno-94-10"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_wready</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">wready</span><span class="w">  </span><span class="p">),</span>
<a id="__codelineno-94-11" name="__codelineno-94-11" href="#__codelineno-94-11"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_bresp</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">bresp</span><span class="w">   </span><span class="p">),</span>
<a id="__codelineno-94-12" name="__codelineno-94-12" href="#__codelineno-94-12"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_bvalid</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">bvalid</span><span class="w">  </span><span class="p">),</span>
<a id="__codelineno-94-13" name="__codelineno-94-13" href="#__codelineno-94-13"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_bready</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">bready</span><span class="w">  </span><span class="p">),</span>
<a id="__codelineno-94-14" name="__codelineno-94-14" href="#__codelineno-94-14"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_araddr</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">araddr</span><span class="w">  </span><span class="p">),</span>
<a id="__codelineno-94-15" name="__codelineno-94-15" href="#__codelineno-94-15"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_arprot</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">arprot</span><span class="w">  </span><span class="p">),</span>
<a id="__codelineno-94-16" name="__codelineno-94-16" href="#__codelineno-94-16"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_arvalid</span><span class="w">  </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">arvalid</span><span class="w"> </span><span class="p">),</span>
<a id="__codelineno-94-17" name="__codelineno-94-17" href="#__codelineno-94-17"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_arready</span><span class="w">  </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">arready</span><span class="w"> </span><span class="p">),</span>
<a id="__codelineno-94-18" name="__codelineno-94-18" href="#__codelineno-94-18"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_rdata</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">rdata</span><span class="w">   </span><span class="p">),</span>
<a id="__codelineno-94-19" name="__codelineno-94-19" href="#__codelineno-94-19"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_rresp</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">rresp</span><span class="w">   </span><span class="p">),</span>
<a id="__codelineno-94-20" name="__codelineno-94-20" href="#__codelineno-94-20"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_rvalid</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">rvalid</span><span class="w">  </span><span class="p">),</span>
<a id="__codelineno-94-21" name="__codelineno-94-21" href="#__codelineno-94-21"></a><span class="w">  </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_rready</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">rready</span><span class="w">  </span><span class="p">),</span>
<a id="__codelineno-94-22" name="__codelineno-94-22" href="#__codelineno-94-22"></a><span class="p">...</span>
<a id="__codelineno-94-23" name="__codelineno-94-23" href="#__codelineno-94-23"></a><span class="p">);</span>
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Modify <code>$OFS_ROOTDIR/src/pd_qsys/fabric/bpf.txt</code> to add the <code>hello_fim</code> module as a slave to the <code>apf</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a># NAME   FABRIC      BASEADDRESS    ADDRESS_WIDTH SLAVES
<a id="__codelineno-95-2" name="__codelineno-95-2" href="#__codelineno-95-2"></a>apf         mst     n/a             18            fme,pcie,pmci,qsfp0,qsfp1,emif,hssi,hello_fim
<a id="__codelineno-95-3" name="__codelineno-95-3" href="#__codelineno-95-3"></a>...
<a id="__codelineno-95-4" name="__codelineno-95-4" href="#__codelineno-95-4"></a>hello_fim   slv     0x16000         12            n/a
</code></pre></div>
</li>
<li>
<p>Execute helper script to generate BPF design files</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/src/pd_qsys/fabric/
<a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a>
<a id="__codelineno-96-3" name="__codelineno-96-3" href="#__codelineno-96-3"></a>sh<span class="w"> </span>gen_fabrics.sh
</code></pre></div>
</li>
<li>
<p>Once the script completes, the following new IP is created: <code>$OFS_ROOTDIR/src/pd_qsys/fabric/ip/bpf/bpf_hello_fim_slv.ip</code>.</p>
</li>
<li>
<p>[OPTIONAL] You may verify the BPF changes have been made correctly by opening <code>bpf.qsys</code> to analyze the BPF.</p>
<ol>
<li>
<p>Navigate to the <code>$OFS_ROOTDIR/src/pd_qsys/fabric</code> directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/src/pd_qsys/fabric
</code></pre></div>
</li>
<li>
<p>Open the <code>bpf.qsys</code> file.</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a>qsys-edit<span class="w"> </span>bpf.qsys<span class="w"> </span>--quartus-project<span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/syn_top/ofs_top.qpf
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a>qsys-edit<span class="w"> </span>bpf.qsys<span class="w"> </span>--quartus-project<span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6000/syn_top/ofs_top.qpf
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>Find the <code>bpf_hello_fim_slv</code> instance:</p>
<p><a class="glightbox" href="../images/hello_fim_auto_bpf.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="hello_fim_bpf_qsys" src="../images/hello_fim_auto_bpf.png" /></a></p>
</li>
</ol>
</li>
<li>
<p>Compile the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design:</p>
<ol>
<li>
<p>Return to the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> root directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
</code></pre></div>
</li>
<li>
<p>Call the <code>build_top.sh</code> script for the target board.</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001<span class="w"> </span>work_n6001_hello_fim
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6000.ofss<span class="w"> </span>n6000<span class="w"> </span>work_n6000_hello_fim
</code></pre></div>
</li>
</ul>
</li>
</ol>
</li>
</ol>
<h4 id="413-walkthrough-modify-and-run-unit-tests-for-a-fim-that-has-a-new-module"><strong>4.1.3 Walkthrough: Modify and run unit tests for a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that has a new module</strong><a class="headerlink" href="#413-walkthrough-modify-and-run-unit-tests-for-a-fim-that-has-a-new-module" title="Permanent link">&para;</a></h4>
<p>Perform the following steps to modify the unit test files to support a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that has had a new module added to it.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>This walkthrough uses a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design that has had a Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module added to it. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#412-walkthrough-add-a-new-module-to-the-ofs-fim">Add a new module to the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a> section for step-by-step instructions for creating a Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design. You do not need to compile the design in order to simulate.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Modify <code>$OFS_ROOTDIR/sim/unit_test/dfh_walker/test_csr_defs.sv</code></p>
<ol>
<li>
<p>Add <code>HELLO_FIM_IDX</code> entry to <code>t_dfh_idx</code> enumeration.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a><span class="p">...</span>
<a id="__codelineno-103-2" name="__codelineno-103-2" href="#__codelineno-103-2"></a><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-103-3" name="__codelineno-103-3" href="#__codelineno-103-3"></a><span class="w">    </span><span class="n">FME_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-4" name="__codelineno-103-4" href="#__codelineno-103-4"></a><span class="w">    </span><span class="n">THERM_MNGM_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-5" name="__codelineno-103-5" href="#__codelineno-103-5"></a><span class="w">    </span><span class="n">GLBL_PERF_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-6" name="__codelineno-103-6" href="#__codelineno-103-6"></a><span class="w">    </span><span class="n">GLBL_ERROR_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-7" name="__codelineno-103-7" href="#__codelineno-103-7"></a><span class="w">    </span><span class="n">QSFP0_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-8" name="__codelineno-103-8" href="#__codelineno-103-8"></a><span class="w">    </span><span class="n">QSFP1_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-9" name="__codelineno-103-9" href="#__codelineno-103-9"></a><span class="w">    </span><span class="n">HSSI_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-10" name="__codelineno-103-10" href="#__codelineno-103-10"></a><span class="w">    </span><span class="n">EMIF_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-11" name="__codelineno-103-11" href="#__codelineno-103-11"></a><span class="w">    </span><span class="n">HELLO_FIM_DFH_IDX</span><span class="p">,</span><span class="w">  </span><span class="c1">// New</span>
<a id="__codelineno-103-12" name="__codelineno-103-12" href="#__codelineno-103-12"></a><span class="w">    </span><span class="n">PMCI_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-13" name="__codelineno-103-13" href="#__codelineno-103-13"></a><span class="w">    </span><span class="n">ST2MM_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-14" name="__codelineno-103-14" href="#__codelineno-103-14"></a><span class="w">    </span><span class="n">VUART_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-15" name="__codelineno-103-15" href="#__codelineno-103-15"></a><span class="w">    </span><span class="n">PG_PR_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-16" name="__codelineno-103-16" href="#__codelineno-103-16"></a><span class="w">    </span><span class="n">PG_PORT_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-17" name="__codelineno-103-17" href="#__codelineno-103-17"></a><span class="w">    </span><span class="n">PG_USER_CLK_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-18" name="__codelineno-103-18" href="#__codelineno-103-18"></a><span class="w">    </span><span class="n">PG_REMOTE_STP_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-19" name="__codelineno-103-19" href="#__codelineno-103-19"></a><span class="w">    </span><span class="n">AFU_ERR_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-103-20" name="__codelineno-103-20" href="#__codelineno-103-20"></a><span class="w">    </span><span class="n">MAX_DFH_IDX</span>
<a id="__codelineno-103-21" name="__codelineno-103-21" href="#__codelineno-103-21"></a><span class="p">}</span><span class="w"> </span><span class="n">t_dfh_idx</span><span class="p">;</span>
<a id="__codelineno-103-22" name="__codelineno-103-22" href="#__codelineno-103-22"></a><span class="p">...</span>
</code></pre></div>
</li>
<li>
<p>Add <code>HELLO_FIM_DFH</code> to <code>get_dfh_names</code> function.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a><span class="p">...</span>
<a id="__codelineno-104-2" name="__codelineno-104-2" href="#__codelineno-104-2"></a><span class="k">function</span><span class="w"> </span><span class="k">automatic</span><span class="w"> </span><span class="n">dfh_name</span><span class="p">[</span><span class="n">MAX_DFH_IDX</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">get_dfh_names</span><span class="p">();</span>
<a id="__codelineno-104-3" name="__codelineno-104-3" href="#__codelineno-104-3"></a><span class="p">...</span>
<a id="__codelineno-104-4" name="__codelineno-104-4" href="#__codelineno-104-4"></a><span class="w">  </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">PMCI_DFH_IDX</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;PMCI_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-104-5" name="__codelineno-104-5" href="#__codelineno-104-5"></a><span class="w">  </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">HELLO_FIM_DFH_IDX</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;HELLO_FIM_DFH&quot;</span><span class="p">;</span><span class="w">  </span><span class="c1">// New</span>
<a id="__codelineno-104-6" name="__codelineno-104-6" href="#__codelineno-104-6"></a><span class="w">  </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">ST2MM_DFH_IDX</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ST2MM_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-104-7" name="__codelineno-104-7" href="#__codelineno-104-7"></a><span class="p">...</span>
<a id="__codelineno-104-8" name="__codelineno-104-8" href="#__codelineno-104-8"></a><span class="k">return</span><span class="w"> </span><span class="n">dfh_names</span><span class="p">;</span>
<a id="__codelineno-104-9" name="__codelineno-104-9" href="#__codelineno-104-9"></a><span class="p">...</span>
</code></pre></div>
</li>
<li>
<p>Add expected DFH value for Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> to the <code>get_dfh_values</code> function.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a><span class="p">...</span>
<a id="__codelineno-105-2" name="__codelineno-105-2" href="#__codelineno-105-2"></a><span class="k">function</span><span class="w"> </span><span class="k">automatic</span><span class="w"> </span><span class="p">[</span><span class="n">MAX_DFH_IDX</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">][</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">get_dfh_values</span><span class="p">();</span>
<a id="__codelineno-105-3" name="__codelineno-105-3" href="#__codelineno-105-3"></a><span class="p">...</span>
<a id="__codelineno-105-4" name="__codelineno-105-4" href="#__codelineno-105-4"></a><span class="w">  </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">PMCI_DFH_IDX</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_xxxxxx_1012</span><span class="p">;</span>
<a id="__codelineno-105-5" name="__codelineno-105-5" href="#__codelineno-105-5"></a><span class="w">  </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">PMCI_DFH_IDX</span><span class="p">][</span><span class="mh">39</span><span class="o">:</span><span class="mh">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fabric_width_pkg</span><span class="o">::</span><span class="n">bpf_pmci_slv_next_dfh_offset</span><span class="p">;</span>
<a id="__codelineno-105-6" name="__codelineno-105-6" href="#__codelineno-105-6"></a>
<a id="__codelineno-105-7" name="__codelineno-105-7" href="#__codelineno-105-7"></a><span class="w">  </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">HELLO_FIM_DFH_IDX</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_xxxxxx_0100</span><span class="p">;</span><span class="w">  </span><span class="c1">// New</span>
<a id="__codelineno-105-8" name="__codelineno-105-8" href="#__codelineno-105-8"></a><span class="w">  </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">HELLO_FIM_DFH_IDX</span><span class="p">][</span><span class="mh">39</span><span class="o">:</span><span class="mh">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fabric_width_pkg</span><span class="o">::</span><span class="n">bpf_hello_fim_slv_next_dfh_offset</span><span class="p">;</span><span class="w"> </span><span class="c1">// New</span>
<a id="__codelineno-105-9" name="__codelineno-105-9" href="#__codelineno-105-9"></a>
<a id="__codelineno-105-10" name="__codelineno-105-10" href="#__codelineno-105-10"></a><span class="w">  </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">ST2MM_DFH_IDX</span><span class="p">]</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_xxxxxx_0014</span><span class="p">;</span>
<a id="__codelineno-105-11" name="__codelineno-105-11" href="#__codelineno-105-11"></a><span class="w">  </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">ST2MM_DFH_IDX</span><span class="p">][</span><span class="mh">39</span><span class="o">:</span><span class="mh">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fabric_width_pkg</span><span class="o">::</span><span class="n">apf_st2mm_slv_next_dfh_offset</span><span class="p">;</span>
<a id="__codelineno-105-12" name="__codelineno-105-12" href="#__codelineno-105-12"></a><span class="p">...</span>
<a id="__codelineno-105-13" name="__codelineno-105-13" href="#__codelineno-105-13"></a><span class="k">return</span><span class="w"> </span><span class="n">dfh_values</span><span class="p">;</span>
<a id="__codelineno-105-14" name="__codelineno-105-14" href="#__codelineno-105-14"></a><span class="p">...</span>
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Generate simulation files:</p>
<ol>
<li>
<p>Navigate to the sim directory. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ofs-common/scripts/common/sim
</code></pre></div>
</li>
<li>
<p>Run the <code>gen_sim_files.sh</code> script.</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a>./gen_sim_files.sh<span class="w"> </span>--ofss<span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>/tools/ofss_config/n6001.ofss<span class="w"> </span>n6001
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-108-1" name="__codelineno-108-1" href="#__codelineno-108-1"></a>./gen_sim_files.sh<span class="w"> </span>--ofss<span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>/tools/ofss_config/n6000.ofss<span class="w"> </span>n6000
</code></pre></div>
</li>
</ul>
</li>
</ol>
</li>
<li>
<p>Run DFH Walker Simulation</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-109-1" name="__codelineno-109-1" href="#__codelineno-109-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ofs-common/scripts/common/sim
<a id="__codelineno-109-2" name="__codelineno-109-2" href="#__codelineno-109-2"></a>
<a id="__codelineno-109-3" name="__codelineno-109-3" href="#__codelineno-109-3"></a>sh<span class="w"> </span>run_sim.sh<span class="w"> </span><span class="nv">TEST</span><span class="o">=</span>dfh_walker
</code></pre></div>
</li>
<li>
<p>Verify that the test passes, and that the output shows the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> in the DFH sequence.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-110-1" name="__codelineno-110-1" href="#__codelineno-110-1"></a>********************************************
<a id="__codelineno-110-2" name="__codelineno-110-2" href="#__codelineno-110-2"></a><span class="w"> </span>Running<span class="w"> </span>TEST<span class="o">(</span><span class="m">0</span><span class="o">)</span><span class="w"> </span>:<span class="w"> </span>test_dfh_walking
<a id="__codelineno-110-3" name="__codelineno-110-3" href="#__codelineno-110-3"></a>********************************************
<a id="__codelineno-110-4" name="__codelineno-110-4" href="#__codelineno-110-4"></a>...
<a id="__codelineno-110-5" name="__codelineno-110-5" href="#__codelineno-110-5"></a>
<a id="__codelineno-110-6" name="__codelineno-110-6" href="#__codelineno-110-6"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00015000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-110-7" name="__codelineno-110-7" href="#__codelineno-110-7"></a>
<a id="__codelineno-110-8" name="__codelineno-110-8" href="#__codelineno-110-8"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-110-9" name="__codelineno-110-9" href="#__codelineno-110-9"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-110-10" name="__codelineno-110-10" href="#__codelineno-110-10"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000010001009
<a id="__codelineno-110-11" name="__codelineno-110-11" href="#__codelineno-110-11"></a>
<a id="__codelineno-110-12" name="__codelineno-110-12" href="#__codelineno-110-12"></a>EMIF_DFH
<a id="__codelineno-110-13" name="__codelineno-110-13" href="#__codelineno-110-13"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x15000<span class="o">)</span>
<a id="__codelineno-110-14" name="__codelineno-110-14" href="#__codelineno-110-14"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000010001009<span class="o">)</span>
<a id="__codelineno-110-15" name="__codelineno-110-15" href="#__codelineno-110-15"></a>
<a id="__codelineno-110-16" name="__codelineno-110-16" href="#__codelineno-110-16"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00016000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-110-17" name="__codelineno-110-17" href="#__codelineno-110-17"></a>
<a id="__codelineno-110-18" name="__codelineno-110-18" href="#__codelineno-110-18"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-110-19" name="__codelineno-110-19" href="#__codelineno-110-19"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-110-20" name="__codelineno-110-20" href="#__codelineno-110-20"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x30000000a0000100
<a id="__codelineno-110-21" name="__codelineno-110-21" href="#__codelineno-110-21"></a>
<a id="__codelineno-110-22" name="__codelineno-110-22" href="#__codelineno-110-22"></a>HELLO_FIM_DFH
<a id="__codelineno-110-23" name="__codelineno-110-23" href="#__codelineno-110-23"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x16000<span class="o">)</span>
<a id="__codelineno-110-24" name="__codelineno-110-24" href="#__codelineno-110-24"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x30000000a0000100<span class="o">)</span>
<a id="__codelineno-110-25" name="__codelineno-110-25" href="#__codelineno-110-25"></a>
<a id="__codelineno-110-26" name="__codelineno-110-26" href="#__codelineno-110-26"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00020000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-110-27" name="__codelineno-110-27" href="#__codelineno-110-27"></a>
<a id="__codelineno-110-28" name="__codelineno-110-28" href="#__codelineno-110-28"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-110-29" name="__codelineno-110-29" href="#__codelineno-110-29"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-110-30" name="__codelineno-110-30" href="#__codelineno-110-30"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000200001012
<a id="__codelineno-110-31" name="__codelineno-110-31" href="#__codelineno-110-31"></a>
<a id="__codelineno-110-32" name="__codelineno-110-32" href="#__codelineno-110-32"></a>PMCI_DFH
<a id="__codelineno-110-33" name="__codelineno-110-33" href="#__codelineno-110-33"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x20000<span class="o">)</span>
<a id="__codelineno-110-34" name="__codelineno-110-34" href="#__codelineno-110-34"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000200001012<span class="o">)</span>
<a id="__codelineno-110-35" name="__codelineno-110-35" href="#__codelineno-110-35"></a>
<a id="__codelineno-110-36" name="__codelineno-110-36" href="#__codelineno-110-36"></a>...
<a id="__codelineno-110-37" name="__codelineno-110-37" href="#__codelineno-110-37"></a>
<a id="__codelineno-110-38" name="__codelineno-110-38" href="#__codelineno-110-38"></a>Test<span class="w"> </span>status:<span class="w"> </span>OK
<a id="__codelineno-110-39" name="__codelineno-110-39" href="#__codelineno-110-39"></a>
<a id="__codelineno-110-40" name="__codelineno-110-40" href="#__codelineno-110-40"></a>********************
<a id="__codelineno-110-41" name="__codelineno-110-41" href="#__codelineno-110-41"></a><span class="w">  </span>Test<span class="w"> </span>summary
<a id="__codelineno-110-42" name="__codelineno-110-42" href="#__codelineno-110-42"></a>********************
<a id="__codelineno-110-43" name="__codelineno-110-43" href="#__codelineno-110-43"></a><span class="w">   </span>test_dfh_walking<span class="w"> </span><span class="o">(</span><span class="nv">id</span><span class="o">=</span><span class="m">0</span><span class="o">)</span><span class="w"> </span>-<span class="w"> </span>pass
<a id="__codelineno-110-44" name="__codelineno-110-44" href="#__codelineno-110-44"></a>Test<span class="w"> </span>passed!
<a id="__codelineno-110-45" name="__codelineno-110-45" href="#__codelineno-110-45"></a>Assertion<span class="w"> </span>count:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-110-46" name="__codelineno-110-46" href="#__codelineno-110-46"></a><span class="nv">$finish</span><span class="w"> </span>called<span class="w"> </span>from<span class="w"> </span>file<span class="w"> </span><span class="s2">&quot;/home/ofs-agx7-pcie-attach/sim/unit_test/scripts/../../bfm/rp_bfm_simple/tester.sv&quot;</span>,<span class="w"> </span>line<span class="w"> </span><span class="m">210</span>.
<a id="__codelineno-110-47" name="__codelineno-110-47" href="#__codelineno-110-47"></a><span class="nv">$finish</span><span class="w"> </span>at<span class="w"> </span>simulation<span class="w"> </span><span class="nb">time</span><span class="w">         </span><span class="m">356791250000</span>
<a id="__codelineno-110-48" name="__codelineno-110-48" href="#__codelineno-110-48"></a><span class="w">           </span>V<span class="w"> </span>C<span class="w"> </span>S<span class="w">   </span>S<span class="w"> </span>i<span class="w"> </span>m<span class="w"> </span>u<span class="w"> </span>l<span class="w"> </span>a<span class="w"> </span>t<span class="w"> </span>i<span class="w"> </span>o<span class="w"> </span>n<span class="w">   </span>R<span class="w"> </span>e<span class="w"> </span>p<span class="w"> </span>o<span class="w"> </span>r<span class="w"> </span>t
<a id="__codelineno-110-49" name="__codelineno-110-49" href="#__codelineno-110-49"></a>Time:<span class="w"> </span><span class="m">356791250000</span><span class="w"> </span>fs
<a id="__codelineno-110-50" name="__codelineno-110-50" href="#__codelineno-110-50"></a>CPU<span class="w"> </span>Time:<span class="w">     </span><span class="m">61</span>.560<span class="w"> </span>seconds<span class="p">;</span><span class="w">       </span>Data<span class="w"> </span>structure<span class="w"> </span>size:<span class="w">  </span><span class="m">47</span>.4Mb
<a id="__codelineno-110-51" name="__codelineno-110-51" href="#__codelineno-110-51"></a>Tue<span class="w"> </span>Aug<span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">16</span>:29:45<span class="w"> </span><span class="m">2023</span>
<a id="__codelineno-110-52" name="__codelineno-110-52" href="#__codelineno-110-52"></a>run_sim.sh:<span class="w"> </span>USER_DEFINED_SIM_OPTIONS<span class="w"> </span>+vcs<span class="w"> </span>-l<span class="w"> </span>./transcript
<a id="__codelineno-110-53" name="__codelineno-110-53" href="#__codelineno-110-53"></a>run_sim.sh:<span class="w"> </span>run_sim.sh<span class="w"> </span>DONE!
</code></pre></div>
</li>
</ol>
<h4 id="414-walkthrough-modify-and-run-uvm-tests-for-a-fim-that-has-a-new-module"><strong>4.1.4 Walkthrough: Modify and run <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> tests for a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that has a new module</strong><a class="headerlink" href="#414-walkthrough-modify-and-run-uvm-tests-for-a-fim-that-has-a-new-module" title="Permanent link">&para;</a></h4>
<p>Perform the following steps to modify the <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> simulation files to support the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<ul>
<li>This walkthrough uses a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design that has had a Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module added to it. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#412-walkthrough-add-a-new-module-to-the-ofs-fim">Add a new module to the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a> section for step-by-step instructions for creating a Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design. You do not need to compile the design in order to simulate.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Modify <code>$OFS_ROOTDIR/verification/tests/sequences/dfh_walking_seq.svh</code></p>
<ol>
<li>
<p>Modify the <code>dfh_offset_array</code> to insert the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> at <code>dfh_offset_array[8]</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-111-1" name="__codelineno-111-1" href="#__codelineno-111-1"></a><span class="n">dfh_offset_array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="p">[</span><span class="mh">17</span><span class="p">];</span>
<a id="__codelineno-111-2" name="__codelineno-111-2" href="#__codelineno-111-2"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tb_cfg0</span><span class="p">.</span><span class="n">PF0_BAR0</span><span class="p">;</span><span class="w">                    </span><span class="c1">// FME_DFH                   0x8000_0000</span>
<a id="__codelineno-111-3" name="__codelineno-111-3" href="#__codelineno-111-3"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">  </span><span class="c1">// THERM_MNGM_DFH            0x8000_1000</span>
<a id="__codelineno-111-4" name="__codelineno-111-4" href="#__codelineno-111-4"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_2000</span><span class="p">;</span><span class="w">  </span><span class="c1">// GLBL_PERF_DFH             0x8000_3000</span>
<a id="__codelineno-111-5" name="__codelineno-111-5" href="#__codelineno-111-5"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">  </span><span class="c1">// GLBL_ERROR_DFH            0x8000_4000</span>
<a id="__codelineno-111-6" name="__codelineno-111-6" href="#__codelineno-111-6"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_E000</span><span class="p">;</span><span class="w">  </span><span class="c1">// QSFP0_DFH                 0x8001_2000</span>
<a id="__codelineno-111-7" name="__codelineno-111-7" href="#__codelineno-111-7"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">  </span><span class="c1">// QSFP1_DFH                 0x8001_3000</span>
<a id="__codelineno-111-8" name="__codelineno-111-8" href="#__codelineno-111-8"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">  </span><span class="c1">// HSSI_DFH                  0x8001_4000</span>
<a id="__codelineno-111-9" name="__codelineno-111-9" href="#__codelineno-111-9"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">7</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">6</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">  </span><span class="c1">// EMIF_DFH                  0x8001_5000</span>
<a id="__codelineno-111-10" name="__codelineno-111-10" href="#__codelineno-111-10"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">7</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">  </span><span class="c1">// HELLO_FIM_DFH                  0x8001_6000</span>
<a id="__codelineno-111-11" name="__codelineno-111-11" href="#__codelineno-111-11"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">9</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">8</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_A000</span><span class="p">;</span><span class="w">  </span><span class="c1">// PMCI_DFH                  0x8002_0000</span>
<a id="__codelineno-111-12" name="__codelineno-111-12" href="#__codelineno-111-12"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">9</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h2</span><span class="n">_0000</span><span class="p">;</span><span class="w">  </span><span class="c1">// ST2MM_DFH                 0x8004_0000</span>
<a id="__codelineno-111-13" name="__codelineno-111-13" href="#__codelineno-111-13"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">11</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">10</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h2</span><span class="n">_0000</span><span class="p">;</span><span class="w">  </span><span class="c1">// VUART_DFH                 0x8006_0000</span>
<a id="__codelineno-111-14" name="__codelineno-111-14" href="#__codelineno-111-14"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">12</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">11</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h1</span><span class="n">_0000</span><span class="p">;</span><span class="w">  </span><span class="c1">// PG_PR_DFH_IDX             0x8007_0000</span>
<a id="__codelineno-111-15" name="__codelineno-111-15" href="#__codelineno-111-15"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">13</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">12</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">  </span><span class="c1">// PG_PORT_DFH_IDX           0x8007_1000</span>
<a id="__codelineno-111-16" name="__codelineno-111-16" href="#__codelineno-111-16"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">14</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">13</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">  </span><span class="c1">// PG_USER_CLK_DFH_IDX       0x8007_2000</span>
<a id="__codelineno-111-17" name="__codelineno-111-17" href="#__codelineno-111-17"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">14</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">  </span><span class="c1">// PG_REMOTE_STP_DFH_IDX     0x8007_3000</span>
<a id="__codelineno-111-18" name="__codelineno-111-18" href="#__codelineno-111-18"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">15</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_D000</span><span class="p">;</span><span class="w">  </span><span class="c1">// PG_AFU_ERR_DFH_IDX        0x8008_0000</span>
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Modify `$OFS_ROOTDIR/verification/tests/sequences/mmio_seq.svh``</p>
<ol>
<li>
<p>Add test code related to the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. This code will verify the scratchpad register at 0x16030 and read only the register at 0x16038.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-112-1" name="__codelineno-112-1" href="#__codelineno-112-1"></a><span class="c1">// HELLO_FIM_Scratchpad 64 bit access</span>
<a id="__codelineno-112-2" name="__codelineno-112-2" href="#__codelineno-112-2"></a><span class="no">`uvm_info</span><span class="p">(</span><span class="n">get_name</span><span class="p">(),</span><span class="w"> </span><span class="n">$psprintf</span><span class="p">(</span><span class="s">&quot;////Accessing PF0 HELLO_FIM_Scratchpad Register %0h+&#39;h16030////&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">tb_cfg0</span><span class="p">.</span><span class="n">PF0_BAR0</span><span class="p">),</span><span class="w"> </span><span class="n">UVM_LOW</span><span class="p">)</span>
<a id="__codelineno-112-3" name="__codelineno-112-3" href="#__codelineno-112-3"></a>
<a id="__codelineno-112-4" name="__codelineno-112-4" href="#__codelineno-112-4"></a><span class="n">assert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">randomize</span><span class="p">(</span><span class="n">wdata</span><span class="p">));</span>
<a id="__codelineno-112-5" name="__codelineno-112-5" href="#__codelineno-112-5"></a><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tb_cfg0</span><span class="p">.</span><span class="n">PF0_BAR0</span><span class="o">+</span><span class="mh">&#39;h1</span><span class="n">_6000</span><span class="o">+</span><span class="mh">&#39;h30</span><span class="p">;</span>
<a id="__codelineno-112-6" name="__codelineno-112-6" href="#__codelineno-112-6"></a>
<a id="__codelineno-112-7" name="__codelineno-112-7" href="#__codelineno-112-7"></a><span class="n">mmio_write64</span><span class="p">(.</span><span class="n">addr_</span><span class="p">(</span><span class="n">addr</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">data_</span><span class="p">(</span><span class="n">wdata</span><span class="p">));</span>
<a id="__codelineno-112-8" name="__codelineno-112-8" href="#__codelineno-112-8"></a><span class="n">mmio_read64</span><span class="w"> </span><span class="p">(.</span><span class="n">addr_</span><span class="p">(</span><span class="n">addr</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">data_</span><span class="p">(</span><span class="n">rdata</span><span class="p">));</span>
<a id="__codelineno-112-9" name="__codelineno-112-9" href="#__codelineno-112-9"></a>
<a id="__codelineno-112-10" name="__codelineno-112-10" href="#__codelineno-112-10"></a><span class="k">if</span><span class="p">(</span><span class="n">wdata</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="n">rdata</span><span class="p">)</span>
<a id="__codelineno-112-11" name="__codelineno-112-11" href="#__codelineno-112-11"></a><span class="w">    </span><span class="no">`uvm_error</span><span class="p">(</span><span class="n">get_name</span><span class="p">(),</span><span class="w"> </span><span class="n">$psprintf</span><span class="p">(</span><span class="s">&quot;Data mismatch 64! Addr = %0h, Exp = %0h, Act = %0h&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="n">wdata</span><span class="p">,</span><span class="w"> </span><span class="n">rdata</span><span class="p">))</span>
<a id="__codelineno-112-12" name="__codelineno-112-12" href="#__codelineno-112-12"></a><span class="k">else</span>
<a id="__codelineno-112-13" name="__codelineno-112-13" href="#__codelineno-112-13"></a><span class="w">    </span><span class="no">`uvm_info</span><span class="p">(</span><span class="n">get_name</span><span class="p">(),</span><span class="w"> </span><span class="n">$psprintf</span><span class="p">(</span><span class="s">&quot;Data match 64! addr = %0h, data = %0h&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="n">rdata</span><span class="p">),</span><span class="w"> </span><span class="n">UVM_LOW</span><span class="p">)</span>
<a id="__codelineno-112-14" name="__codelineno-112-14" href="#__codelineno-112-14"></a>
<a id="__codelineno-112-15" name="__codelineno-112-15" href="#__codelineno-112-15"></a><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tb_cfg0</span><span class="p">.</span><span class="n">PF0_BAR0</span><span class="o">+</span><span class="mh">&#39;h1</span><span class="n">_6000</span><span class="o">+</span><span class="mh">&#39;h38</span><span class="p">;</span>
<a id="__codelineno-112-16" name="__codelineno-112-16" href="#__codelineno-112-16"></a><span class="n">wdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h6626</span><span class="n">_0701_5000_0034</span><span class="p">;</span>
<a id="__codelineno-112-17" name="__codelineno-112-17" href="#__codelineno-112-17"></a><span class="n">mmio_read64</span><span class="w"> </span><span class="p">(.</span><span class="n">addr_</span><span class="p">(</span><span class="n">addr</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">data_</span><span class="p">(</span><span class="n">rdata</span><span class="p">));</span>
<a id="__codelineno-112-18" name="__codelineno-112-18" href="#__codelineno-112-18"></a><span class="k">if</span><span class="p">(</span><span class="n">wdata</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="n">rdata</span><span class="p">)</span>
<a id="__codelineno-112-19" name="__codelineno-112-19" href="#__codelineno-112-19"></a><span class="w">    </span><span class="no">`uvm_error</span><span class="p">(</span><span class="n">get_name</span><span class="p">(),</span><span class="w"> </span><span class="n">$psprintf</span><span class="p">(</span><span class="s">&quot;Data mismatch 64! Addr = %0h, Exp = %0h, Act = %0h&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="n">wdata</span><span class="p">,</span><span class="w"> </span><span class="n">rdata</span><span class="p">))</span>
<a id="__codelineno-112-20" name="__codelineno-112-20" href="#__codelineno-112-20"></a><span class="k">else</span>
<a id="__codelineno-112-21" name="__codelineno-112-21" href="#__codelineno-112-21"></a><span class="w">    </span><span class="no">`uvm_info</span><span class="p">(</span><span class="n">get_name</span><span class="p">(),</span><span class="w"> </span><span class="n">$psprintf</span><span class="p">(</span><span class="s">&quot;Data match 64! addr = %0h, data = %0h&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="n">rdata</span><span class="p">),</span><span class="w"> </span><span class="n">UVM_LOW</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Note: uvm_info and uvm_error statements will put a message into log file.</p>
</blockquote>
</li>
</ol>
</li>
<li>
<p>Modify <code>$OFS_ROOTDIR/verification/scripts/Makefile_VCS.mk</code></p>
<ol>
<li>
<p>Add <code>INCLUDE_HELLO_FIM</code> define option to enable Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> on <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-113-1" name="__codelineno-113-1" href="#__codelineno-113-1"></a><span class="nv">VLOG_OPT</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span>+define+INCLUDE_HELLO_FIM
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Re-generate the <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> files</p>
<ol>
<li>
<p>Navigate to the verification scripts directory</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-114-1" name="__codelineno-114-1" href="#__codelineno-114-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$VERDIR</span>/scripts
</code></pre></div>
</li>
<li>
<p>Clean the output of previous builds</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-115-1" name="__codelineno-115-1" href="#__codelineno-115-1"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>clean
</code></pre></div>
</li>
<li>
<p>Compile the IP files</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-116-1" name="__codelineno-116-1" href="#__codelineno-116-1"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>cmplib_adp
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-117-1" name="__codelineno-117-1" href="#__codelineno-117-1"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>cmplib_adp<span class="w"> </span><span class="nv">n6000_100G</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">DISABLE_EMIF</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<blockquote>
<p><strong>Note:</strong> The default N6000 shell has the Memory Sub-System removed, so the <code>DISABLE_EMIF</code> flag must be set when compiling IP files for <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> simulation. If you add the Memory Sub-System back to the shell design, you must run this command without the <code>DISABLE_EMIF</code> flag.</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>Build the RTL and Test Benches</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-118-1" name="__codelineno-118-1" href="#__codelineno-118-1"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>build_adp<span class="w"> </span><span class="nv">DUMP</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">DEBUG</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-119-1" name="__codelineno-119-1" href="#__codelineno-119-1"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>build_adp<span class="w"> </span><span class="nv">DUMP</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">DEBUG</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">n6000_100G</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">DISABLE_EMIF</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<blockquote>
<p><strong>Note:</strong> The default N6000 shell has the Memory Sub-System removed, so the <code>DISABLE_EMIF</code> flag must be set when building the RTL and Test Benches for <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> simulation. If you add the Memory Sub-System back to the shell design, you must run this command without the <code>DISABLE_EMIF</code> flag.</p>
</blockquote>
</li>
</ul>
</li>
</ol>
</li>
<li>
<p>Run the <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> DFH Walker Simulation </p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-120-1" name="__codelineno-120-1" href="#__codelineno-120-1"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>run<span class="w"> </span><span class="nv">TESTNAME</span><span class="o">=</span>dfh_walking_test<span class="w"> </span><span class="nv">DUMP</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">DEBUG</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-121-1" name="__codelineno-121-1" href="#__codelineno-121-1"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>run<span class="w"> </span><span class="nv">TESTNAME</span><span class="o">=</span>dfh_walking_test<span class="w"> </span><span class="nv">DUMP</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">DEBUG</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">n6000_100G</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">DISABLE_EMIF</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<blockquote>
<p><strong>Note:</strong> The default N6000 shell has the Memory Sub-System removed, so the <code>DISABLE_EMIF</code> flag must be set when running <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> simulations. If you add the Memory Sub-System back to the shell design, you must run this command without the <code>DISABLE_EMIF</code> flag.</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>Verify the DFH Walker test results</p>
<ol>
<li>
<p>The output logs are stored in the $VERDIR/sim/dfh_walking_test directory. The main files to note are described in Table 5-3:</p>
<p><strong>Table 5-3</strong> <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> Output Logs</p>
<table>
<thead>
<tr>
<th>File Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>runsim.log</td>
<td>A log file of <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr></td>
</tr>
<tr>
<td>trans.log</td>
<td>A log file of transactions on PCIe bus</td>
</tr>
<tr>
<td>inter.vpd</td>
<td>A waveform for VCS</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Run the following command to quickly verify that the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module was successfully accessed. In the example below, the message <code>DFH offset Match! Exp = 80016000 Act = 80016000</code> shows that the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module was successfully accessed.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-122-1" name="__codelineno-122-1" href="#__codelineno-122-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$VERDIR</span>/sim/dfh_walking_test
<a id="__codelineno-122-2" name="__codelineno-122-2" href="#__codelineno-122-2"></a>cat<span class="w"> </span>runsim.log<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;DFH offset&quot;</span>
</code></pre></div>
<p>Expected output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-123-1" name="__codelineno-123-1" href="#__codelineno-123-1"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">111950000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80000000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80000000</span>
<a id="__codelineno-123-2" name="__codelineno-123-2" href="#__codelineno-123-2"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">112586000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80001000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80001000</span>
<a id="__codelineno-123-3" name="__codelineno-123-3" href="#__codelineno-123-3"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">113222000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80003000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80003000</span>
<a id="__codelineno-123-4" name="__codelineno-123-4" href="#__codelineno-123-4"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">113858000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80004000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80004000</span>
<a id="__codelineno-123-5" name="__codelineno-123-5" href="#__codelineno-123-5"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">114494000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80012000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80012000</span>
<a id="__codelineno-123-6" name="__codelineno-123-6" href="#__codelineno-123-6"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">115147000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80013000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80013000</span>
<a id="__codelineno-123-7" name="__codelineno-123-7" href="#__codelineno-123-7"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">115801000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80014000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80014000</span>
<a id="__codelineno-123-8" name="__codelineno-123-8" href="#__codelineno-123-8"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">116628000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80015000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80015000</span>
<a id="__codelineno-123-9" name="__codelineno-123-9" href="#__codelineno-123-9"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">117283000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80016000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80016000</span>
<a id="__codelineno-123-10" name="__codelineno-123-10" href="#__codelineno-123-10"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">117928000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80080000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80080000</span>
<a id="__codelineno-123-11" name="__codelineno-123-11" href="#__codelineno-123-11"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">118594000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80100000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80100000</span>
<a id="__codelineno-123-12" name="__codelineno-123-12" href="#__codelineno-123-12"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">119248000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80130000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80130000</span>
<a id="__codelineno-123-13" name="__codelineno-123-13" href="#__codelineno-123-13"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">119854000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80131000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80131000</span>
<a id="__codelineno-123-14" name="__codelineno-123-14" href="#__codelineno-123-14"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">120460000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80132000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80132000</span>
<a id="__codelineno-123-15" name="__codelineno-123-15" href="#__codelineno-123-15"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">121065000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80133000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80133000</span>
<a id="__codelineno-123-16" name="__codelineno-123-16" href="#__codelineno-123-16"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">121672000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80140000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80140000</span>
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Run the <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> Simulation </p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-124-1" name="__codelineno-124-1" href="#__codelineno-124-1"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>run<span class="w"> </span><span class="nv">TESTNAME</span><span class="o">=</span>mmio_test<span class="w"> </span><span class="nv">DUMP</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">DEBUG</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-125-1" name="__codelineno-125-1" href="#__codelineno-125-1"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>run<span class="w"> </span><span class="nv">TESTNAME</span><span class="o">=</span>mmio_test<span class="w"> </span><span class="nv">DUMP</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">DEBUG</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">n6000_100G</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">DISABLE_EMIF</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<blockquote>
<p><strong>Note:</strong> The default N6000 shell has the Memory Sub-System removed, so the <code>DISABLE_EMIF</code> flag must be set when running <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> simulations. If you add the Memory Sub-System back to the shell design, you must run this command without the <code>DISABLE_EMIF</code> flag.</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>Verify the <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> test results. Run the following commands to show the result of the scratchpad register and Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> ID register. You can see the "Data match" message indicating that the registers are successfuly verified.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-126-1" name="__codelineno-126-1" href="#__codelineno-126-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$VERDIR</span>/sim/mmio_test
<a id="__codelineno-126-2" name="__codelineno-126-2" href="#__codelineno-126-2"></a>cat<span class="w"> </span>runsim.log<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;Data&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">1603</span>
</code></pre></div>
<p>Expected output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-127-1" name="__codelineno-127-1" href="#__codelineno-127-1"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/mmio_seq.svh<span class="o">(</span><span class="m">68</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">115466000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>Data<span class="w"> </span>match<span class="w"> </span><span class="m">64</span>!<span class="w"> </span><span class="nv">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80016030</span>,<span class="w"> </span><span class="nv">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>880312f9558c00e1
<a id="__codelineno-127-2" name="__codelineno-127-2" href="#__codelineno-127-2"></a>UVM_INFO<span class="w"> </span>/home/ofs-agx7-pcie-attach/verification/tests/sequences/mmio_seq.svh<span class="o">(</span><span class="m">76</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">116112000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>Data<span class="w"> </span>match<span class="w"> </span><span class="m">64</span>!<span class="w"> </span><span class="nv">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80016038</span>,<span class="w"> </span><span class="nv">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6626070150000034</span>
</code></pre></div>
</li>
</ol>
<h4 id="415-walkthrough-hardware-test-a-fim-that-has-a-new-module"><strong>4.1.5 Walkthrough: Hardware test a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that has a new module</strong><a class="headerlink" href="#415-walkthrough-hardware-test-a-fim-that-has-a-new-module" title="Permanent link">&para;</a></h4>
<p>Perform the following steps to program and hardware test a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that has had a new module added to it.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires an <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach deployment environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/">Getting Started Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach FPGAs (Intel® FPGA SmartNIC N6001-PL/N6000-PL)</a> for instructions on setting up a deployment environment.</li>
</ul>
<ul>
<li>This walkthrough uses a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design that has been generated with a Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module added to it. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#412-walkthrough-add-a-new-module-to-the-ofs-fim">Add a new module to the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a> section for step-by-step instructions for generating a Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>[OPTIONAL] In the work directory where the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> was compiled, determine the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> Interface ID of your design. You can use this value at the end of the walkthrough to verify that the design has been configured to the FPGA.</p>
<ol>
<li>
<p>Navigate to the <code>syn_top</code> directory of the target board in the work directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-128-1" name="__codelineno-128-1" href="#__codelineno-128-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/&lt;work_directory&gt;/syn/board/&lt;target_board&gt;/syn_top/
</code></pre></div>
<p>As an example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-129-1" name="__codelineno-129-1" href="#__codelineno-129-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/work_n6001/syn/board/n6001/syn_top/
</code></pre></div>
</li>
<li>
<p>View the contents of <code>fme-ifc-id.txt</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-130-1" name="__codelineno-130-1" href="#__codelineno-130-1"></a>cat<span class="w"> </span>fme-ifc-id.txt
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-131-1" name="__codelineno-131-1" href="#__codelineno-131-1"></a>5d4500ed-e5e5-5521-8865-e47f0c517fac
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Switch to your deployment environment.</p>
</li>
<li>
<p>Program the FPGA with the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> image. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#531-walkthrough-program-the-fpga-via-rsu">Program the FPGA via <abbr title="Remote System Update, A Remote System Update operation sends an instruction to the Intel FPGA PAC D5005 device that triggers a power cycle of the card only, forcing reconfiguration.">RSU</abbr></a> Section for step-by-step programming instructions.</p>
</li>
<li>
<p>Run <code>fpgainfo</code> to determine the PCIe B:D.F of your board, and to verify the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> Interface ID matches the ID you found in Step 1.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-132-1" name="__codelineno-132-1" href="#__codelineno-132-1"></a>fpgainfo<span class="w"> </span>fme
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-133-1" name="__codelineno-133-1" href="#__codelineno-133-1"></a>Intel<span class="w"> </span>Acceleration<span class="w"> </span>Development<span class="w"> </span>Platform<span class="w"> </span>N6001
<a id="__codelineno-133-2" name="__codelineno-133-2" href="#__codelineno-133-2"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller<span class="w"> </span>NIOS<span class="w"> </span>FW<span class="w"> </span>version:<span class="w"> </span><span class="m">3</span>.15.0
<a id="__codelineno-133-3" name="__codelineno-133-3" href="#__codelineno-133-3"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller<span class="w"> </span>Build<span class="w"> </span>version:<span class="w"> </span><span class="m">3</span>.15.0
<a id="__codelineno-133-4" name="__codelineno-133-4" href="#__codelineno-133-4"></a>PBA:<span class="w"> </span>B#FB2CG1@AGF14-A0P2
<a id="__codelineno-133-5" name="__codelineno-133-5" href="#__codelineno-133-5"></a>MMID:<span class="w"> </span><span class="m">217000</span>
<a id="__codelineno-133-6" name="__codelineno-133-6" href="#__codelineno-133-6"></a>SN:<span class="w"> </span>Q171211700050
<a id="__codelineno-133-7" name="__codelineno-133-7" href="#__codelineno-133-7"></a>//******<span class="w"> </span>FME<span class="w"> </span>******//
<a id="__codelineno-133-8" name="__codelineno-133-8" href="#__codelineno-133-8"></a>Interface<span class="w">                        </span>:<span class="w"> </span>DFL
<a id="__codelineno-133-9" name="__codelineno-133-9" href="#__codelineno-133-9"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xEF00000
<a id="__codelineno-133-10" name="__codelineno-133-10" href="#__codelineno-133-10"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.0
<a id="__codelineno-133-11" name="__codelineno-133-11" href="#__codelineno-133-11"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-133-12" name="__codelineno-133-12" href="#__codelineno-133-12"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-133-13" name="__codelineno-133-13" href="#__codelineno-133-13"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-133-14" name="__codelineno-133-14" href="#__codelineno-133-14"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-133-15" name="__codelineno-133-15" href="#__codelineno-133-15"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x00
<a id="__codelineno-133-16" name="__codelineno-133-16" href="#__codelineno-133-16"></a>Ports<span class="w"> </span>Num<span class="w">                        </span>:<span class="w"> </span><span class="m">01</span>
<a id="__codelineno-133-17" name="__codelineno-133-17" href="#__codelineno-133-17"></a>Bitstream<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span><span class="m">360571653789875893</span>
<a id="__codelineno-133-18" name="__codelineno-133-18" href="#__codelineno-133-18"></a>Bitstream<span class="w"> </span>Version<span class="w">                </span>:<span class="w"> </span><span class="m">5</span>.0.1
<a id="__codelineno-133-19" name="__codelineno-133-19" href="#__codelineno-133-19"></a>Pr<span class="w"> </span>Interface<span class="w"> </span>Id<span class="w">                  </span>:<span class="w"> </span>5d4500ed-e5e5-5521-8865-e47f0c517fac
<a id="__codelineno-133-20" name="__codelineno-133-20" href="#__codelineno-133-20"></a>Boot<span class="w"> </span>Page<span class="w">                        </span>:<span class="w"> </span>user1
<a id="__codelineno-133-21" name="__codelineno-133-21" href="#__codelineno-133-21"></a>Factory<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">               </span>:<span class="w"> </span>9035190d637c383453173deb5de25fdd
<a id="__codelineno-133-22" name="__codelineno-133-22" href="#__codelineno-133-22"></a>User1<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">                 </span>:<span class="w"> </span>893e691edfccfd0aecb1c332ad69551b
<a id="__codelineno-133-23" name="__codelineno-133-23" href="#__codelineno-133-23"></a>User2<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">                 </span>:<span class="w"> </span>8cd2ae8073e194525bcd682f50935fc7
</code></pre></div>
</li>
<li>
<p>Initialize opae.io</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-134-1" name="__codelineno-134-1" href="#__codelineno-134-1"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span>&lt;B:D.F&gt;
</code></pre></div>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-135-1" name="__codelineno-135-1" href="#__codelineno-135-1"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span><span class="m">98</span>:00.0
</code></pre></div>
</li>
<li>
<p>Run DFH walker. Note the value read back from offset <code>0x16000</code> indicates the DFH ID is <code>0x100</code> which matches the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-136-1" name="__codelineno-136-1" href="#__codelineno-136-1"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>walk<span class="w"> </span>-d<span class="w"> </span>&lt;B:D.F&gt;
</code></pre></div>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-137-1" name="__codelineno-137-1" href="#__codelineno-137-1"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>walk<span class="w"> </span>-d<span class="w"> </span><span class="m">98</span>:00.0
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-138-1" name="__codelineno-138-1" href="#__codelineno-138-1"></a>...
<a id="__codelineno-138-2" name="__codelineno-138-2" href="#__codelineno-138-2"></a>offset:<span class="w"> </span>0x15000,<span class="w"> </span>value:<span class="w"> </span>0x3000000010001009
<a id="__codelineno-138-3" name="__codelineno-138-3" href="#__codelineno-138-3"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x9,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-138-4" name="__codelineno-138-4" href="#__codelineno-138-4"></a>offset:<span class="w"> </span>0x16000,<span class="w"> </span>value:<span class="w"> </span>0x30000000a0000100
<a id="__codelineno-138-5" name="__codelineno-138-5" href="#__codelineno-138-5"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x100,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0xa000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-138-6" name="__codelineno-138-6" href="#__codelineno-138-6"></a>offset:<span class="w"> </span>0x20000,<span class="w"> </span>value:<span class="w"> </span>0x3000000200001012
<a id="__codelineno-138-7" name="__codelineno-138-7" href="#__codelineno-138-7"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x12,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x20000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-138-8" name="__codelineno-138-8" href="#__codelineno-138-8"></a>...
</code></pre></div>
</li>
<li>
<p>Read all of the registers in the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module</p>
<ol>
<li>
<p>Read the DFH Register</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-139-1" name="__codelineno-139-1" href="#__codelineno-139-1"></a>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">98</span>:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x16000
</code></pre></div>
<p>Example Output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-140-1" name="__codelineno-140-1" href="#__codelineno-140-1"></a>0x30000006a0000100
</code></pre></div>
</li>
<li>
<p>Read the Scratchpad Register</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-141-1" name="__codelineno-141-1" href="#__codelineno-141-1"></a>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">98</span>:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x16030
</code></pre></div>
<p>Example Output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-142-1" name="__codelineno-142-1" href="#__codelineno-142-1"></a>0x0
</code></pre></div>
</li>
<li>
<p>Read the ID Register</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-143-1" name="__codelineno-143-1" href="#__codelineno-143-1"></a>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">98</span>:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x16038
</code></pre></div>
<p>Example Output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-144-1" name="__codelineno-144-1" href="#__codelineno-144-1"></a>0x6626070150000034
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Verify the scratchpad register at 0x16030 by writing and reading back from it.</p>
<ol>
<li>
<p>Write to Scratchpad register</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-145-1" name="__codelineno-145-1" href="#__codelineno-145-1"></a>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:15:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x16030<span class="w"> </span>0x123456789abcdef
</code></pre></div>
</li>
<li>
<p>Read from Scratchpad register</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-146-1" name="__codelineno-146-1" href="#__codelineno-146-1"></a>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">15</span>:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x16030
</code></pre></div>
<p>Expected output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-147-1" name="__codelineno-147-1" href="#__codelineno-147-1"></a>0x123456789abcdef
</code></pre></div>
</li>
<li>
<p>Write to Scratchpad register</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-148-1" name="__codelineno-148-1" href="#__codelineno-148-1"></a>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">15</span>:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x16030<span class="w"> </span>0xfedcba9876543210
</code></pre></div>
</li>
<li>
<p>Read from Scratchpad register</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-149-1" name="__codelineno-149-1" href="#__codelineno-149-1"></a>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">15</span>:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x16030
</code></pre></div>
<p>Expected output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-150-1" name="__codelineno-150-1" href="#__codelineno-150-1"></a>0xfedcba9876543210
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Release the opae.io tool</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-151-1" name="__codelineno-151-1" href="#__codelineno-151-1"></a>opae.io<span class="w"> </span>release<span class="w"> </span>-d<span class="w"> </span><span class="m">15</span>:00.0
</code></pre></div>
</li>
<li>
<p>Confirm the driver has been set back to <code>dfl-pci</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-152-1" name="__codelineno-152-1" href="#__codelineno-152-1"></a>opae.io<span class="w"> </span>ls
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-153-1" name="__codelineno-153-1" href="#__codelineno-153-1"></a><span class="o">[</span><span class="m">0000</span>:98:00.0<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086:0xbcce<span class="w"> </span>0x8086:0x1771<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>Acceleration<span class="w"> </span>Development<span class="w"> </span>Platform<span class="w"> </span>N6001<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
</code></pre></div>
</li>
</ol>
<h4 id="416-walkthrough-debug-the-fim-with-signal-tap"><strong>4.1.6 Walkthrough: Debug the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> with Signal Tap</strong><a class="headerlink" href="#416-walkthrough-debug-the-fim-with-signal-tap" title="Permanent link">&para;</a></h4>
<p>The following steps guide you through the process of adding a Signal Tap instance to your design. The added Signal Tap instance provides hardware to capture the desired internal signals and connect the stored trace information via <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr>. Please be aware that the added Signal Tap hardware will consume FPGA resources and may require additional floorplanning steps to accommodate these resources. Some areas of the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> use logic lock regions and these regions may need to be re-sized.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<ul>
<li>This walkthrough requires an <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach deployment environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/">Getting Started Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach FPGAs (Intel® FPGA SmartNIC N6001-PL/N6000-PL)</a> for instructions on setting up a deployment environment.</li>
</ul>
<ul>
<li>This walkthrough uses a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design that has had a Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module added to it. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#412-walkthrough-add-a-new-module-to-the-ofs-fim">Add a new module to the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a> section for step-by-step instructions for creating a Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design. You do not need to compile the design.</li>
</ul>
<p>Perform the following steps in your development environment:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Synthesize the design using the <code>-e</code> build script option. You may skip this step if you are using a pre-synthesized design.</p>
<ol>
<li>Navigate to the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> root directory</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-154-1" name="__codelineno-154-1" href="#__codelineno-154-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
</code></pre></div>
<ol>
<li>
<p>Run the <code>build_top.sh</code> script for the target board with the <code>-e</code> option.</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-155-1" name="__codelineno-155-1" href="#__codelineno-155-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-e<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001<span class="w"> </span>work_hello_fim_with_stp
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-156-1" name="__codelineno-156-1" href="#__codelineno-156-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-e<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6000.ofss<span class="w"> </span>n6000<span class="w"> </span>work_hello_fim_with_stp
</code></pre></div>
</li>
</ul>
</li>
</ol>
</li>
<li>
<p>Open the design in Quartus. The <strong>Compilation Dashboard</strong> should show that the <code>Analysis &amp; Synthesis</code> step has completed.</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-157-1" name="__codelineno-157-1" href="#__codelineno-157-1"></a>quartus<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/work_hello_fim_with_stp/syn/board/n6001/syn_top/ofs_top.qpf
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-158-1" name="__codelineno-158-1" href="#__codelineno-158-1"></a>quartus<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/work_hello_fim_with_stp/syn/board/n6000/syn_top/ofs_top.qpf
</code></pre></div>
</li>
</ul>
<p><a class="glightbox" href="../images/synthesis_compilation_dashboard.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="synthesis_compilation_dashboard" src="../images/synthesis_compilation_dashboard.png" /></a></p>
<blockquote>
<p><strong>Note:</strong> If a full compile has been done in the work directory you are using, you may need to switch from the <code>ofs_pr_afu</code> view to the <code>ofs_top</code> view.</p>
</blockquote>
</li>
<li>
<p>Open <strong>Tools -&gt; Signal Tap Logic Analyzer</strong></p>
<p><a class="glightbox" href="../images/signal_tap_log_analyizer_menu.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="tools_signal_tap" src="../images/signal_tap_log_analyizer_menu.png" /></a></p>
<ol>
<li>
<p>Select the <code>Default</code> template and click <strong>Create</strong></p>
</li>
<li>
<p>Assign the clock for sampling the Signal Tap instrumented signals of interest. Note that the clock selected should correspond to the signals you want to view for best trace fidelity. Different clocks can be used, however, there maybe issues with trace inaccuracy due to sampling time differences. This example instruments the hello_fim_top module previously intetegrated into the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. If unfamiliar with code, it is helpful to use the Quartus Project Navigator to find the block of interest and open the design instance for review.</p>
<ol>
<li>
<p>In the <strong>Signal Configuration -&gt; Clock</strong> box of the <strong>Signal Tap Logic Analyzer</strong> window, click the "<strong>...</strong>" button</p>
<p><a class="glightbox" href="../images/stp_hello_fim_clk_search.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_hello_fim_clk_search.png" /></a></p>
</li>
<li>
<p>In the <strong>Node Finder</strong> tool that opens, type <code>clock</code> into the <strong>Named</strong> field, and select <code>hello_fim_top_inst</code> in the <strong>Look in</strong> field, then click <strong>Search</strong>. Select the <code>hello_fim_top_inst|clk</code> signal from the <strong>Matching Nodes</strong> box and click the <strong>"&gt;"</strong> button to move it to the <strong>Nodes Found</strong> box. Click <strong>OK</strong> to close the Node Finder dialog.</p>
<p><a class="glightbox" href="../images/stp_node_finder_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_node_finder_hello_fim.png" /></a></p>
</li>
</ol>
</li>
<li>
<p>Update the sample depth and other Signal Tap settings as needed for your debugging criteria.</p>
<p><a class="glightbox" href="../images/STP_Configs_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/STP_Configs_hello_fim.png" /></a></p>
</li>
<li>
<p>In the Signal Tap GUI add the nodes to be instrumented by double-clicking on the "Double-click to add nodes" legend.</p>
<p><a class="glightbox" href="../images/STP_Add_Nodes_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/STP_Add_Nodes_hello_fim.png" /></a></p>
</li>
<li>
<p>This brings up the Node Finder to add the signals to be traced. In this example we will monitor the memory mapped interface to the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. </p>
<ol>
<li>
<p>In the <strong>Named</strong> field, enter <code>csr_lite_if*</code>. In the <strong>Look In</strong> field, select <code>hello_fim_top_inst</code>.</p>
</li>
<li>
<p>Add the desired nets. In the <strong>Object type</strong> field select <code>net</code>. Select the nets that appear in the <strong>Matching Nodes</strong> box. Click the <strong>&gt;</strong> button to add them to the <strong>Nodes Found</strong> box.</p>
<p><a class="glightbox" href="../images/stp_traced_signals_hello_fim_nets.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_traced_signals_hello_fim_nets.png" /></a></p>
</li>
<li>
<p>Add the desired net busses. In the <strong>Object type</strong> field select <code>net_bus</code>. Select the busses that appear in the <strong>Matching Nodes</strong> box. Click the <strong>&gt;</strong> button to add them to the <strong>Nodes Found</strong> box.</p>
<p><a class="glightbox" href="../images/stp_traced_signals_hello_fim_net_busses.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_traced_signals_hello_fim_net_busses.png" /></a></p>
</li>
<li>
<p>Click Insert and close the Node Finder dialog.</p>
</li>
</ol>
</li>
<li>
<p>To provide a unique name for your Signal Tap instance, select "auto_signaltap_0", right-click, and select <strong>Rename Instance (F2)</strong>. Provide a descriptive name for your instance, for example, <code>stp_for_hello_fim</code>.</p>
<p><a class="glightbox" href="../images/stp_rename_instance_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_rename_instance_hello_fim.png" /></a></p>
</li>
<li>
<p>Save the newly created Signal Tap file, in the <code>$OFS_ROOTDIR/work_hello_fim_with_stp/syn/board/n6001/syn_top/</code> directory, and give it the same name as the instance. Ensure that the <strong>Add file to current project</strong> checkbox is ticked.</p>
<p><a class="glightbox" href="../images/save_STP_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/save_STP_hello_fim.png" /></a></p>
</li>
<li>
<p>In the dialog that pops up, click "Yes" to add the newly created Signal Tap file to the project settings files.</p>
<p><a class="glightbox" href="../images/add_STP_Project_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/add_STP_Project_hello_fim.png" /></a></p>
<p>This will automatically add the following lines to <code>$OFS_ROOTDIR/work_hello_fim_with_stp/syn/board/&lt;board_target&gt;/syn_top/ofs_top.qsf</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-159-1" name="__codelineno-159-1" href="#__codelineno-159-1"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>ENABLE_SIGNALTAP<span class="w"> </span>ON
<a id="__codelineno-159-2" name="__codelineno-159-2" href="#__codelineno-159-2"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>USE_SIGNALTAP_FILE<span class="w"> </span>stp_for_hello_fim.stp
<a id="__codelineno-159-3" name="__codelineno-159-3" href="#__codelineno-159-3"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>SIGNALTAP_FILE<span class="w"> </span>stp_for_hello_fim.stp
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Close all Quartus GUIs.</p>
</li>
<li>
<p>Compile the project with the Signal Tap file added to the project. Use the <strong>-k</strong> switch to perform the compilation using the files in a specified working directory and not the original ones from the cloned repository. </p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-160-1" name="__codelineno-160-1" href="#__codelineno-160-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>-k<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001<span class="w"> </span>work_hello_fim_with_stp
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-161-1" name="__codelineno-161-1" href="#__codelineno-161-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>-k<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6000.ofss<span class="w"> </span>n6000<span class="w"> </span>work_hello_fim_with_stp
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>Ensure that the compile completes successfully and meets timing.</p>
<p>As an example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-162-1" name="__codelineno-162-1" href="#__codelineno-162-1"></a>***********************************
<a id="__codelineno-162-2" name="__codelineno-162-2" href="#__codelineno-162-2"></a>***
<a id="__codelineno-162-3" name="__codelineno-162-3" href="#__codelineno-162-3"></a>***<span class="w">        </span>OFS_PROJECT:<span class="w"> </span>ofs-agx7-pcie-attach
<a id="__codelineno-162-4" name="__codelineno-162-4" href="#__codelineno-162-4"></a>***<span class="w">        </span>OFS_BOARD:<span class="w"> </span>n6001
<a id="__codelineno-162-5" name="__codelineno-162-5" href="#__codelineno-162-5"></a>***<span class="w">        </span>Q_PROJECT:<span class="w">  </span>ofs_top
<a id="__codelineno-162-6" name="__codelineno-162-6" href="#__codelineno-162-6"></a>***<span class="w">        </span>Q_REVISION:<span class="w"> </span>ofs_top
<a id="__codelineno-162-7" name="__codelineno-162-7" href="#__codelineno-162-7"></a>***<span class="w">        </span>SEED:<span class="w"> </span><span class="m">6</span>
<a id="__codelineno-162-8" name="__codelineno-162-8" href="#__codelineno-162-8"></a>***<span class="w">        </span>Build<span class="w"> </span>Complete
<a id="__codelineno-162-9" name="__codelineno-162-9" href="#__codelineno-162-9"></a>***<span class="w">        </span>Timing<span class="w"> </span>Passed!
<a id="__codelineno-162-10" name="__codelineno-162-10" href="#__codelineno-162-10"></a>***
<a id="__codelineno-162-11" name="__codelineno-162-11" href="#__codelineno-162-11"></a>***********************************
</code></pre></div>
</li>
<li>
<p>Set up a <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> connection to the n6001 or n6000. Refer to <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#51-walkthrough-set-up-jtag">Set up <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr></a> section for step-by-step instructions.</p>
</li>
<li>
<p>Copy the <code>ofs_top.sof</code> and <code>stp_for_hello_fim.stp</code> files to the machine which is connected to the n6001/n6000 via <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr>.</p>
</li>
<li>
<p>From the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> connected machine, program the <code>$OFS_ROOTDIR/work_hello_fim_with_stp/syn/board/&lt;board_target&gt;/syn_top/output_files/ofs_top.sof</code> image to the n6001 or n6000 FPGA. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#52-walkthrough-program-the-fpga-via-jtag">Program the FPGA via <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr></a> section for step-by-step programming instructions.</p>
</li>
<li>
<p>Open the Quartus Signal Tap GUI</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-163-1" name="__codelineno-163-1" href="#__codelineno-163-1"></a><span class="nv">$QUARTUS_ROOTDIR</span>/bin/quartus_stpw
</code></pre></div>
</li>
<li>
<p>In the Signal Tap Logic Analyzer window, select <strong>File -&gt; Open</strong>, and choose the <code>stp_for_hello_fim.stp</code> file.</p>
<p><a class="glightbox" href="../images/stp_open_STP_For_Hello_FIM.stp.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_open_STP_For_Hello_FIM.stp.png" /></a></p>
</li>
<li>
<p>In the right pane of the Signal Tap GUI, in the <strong>Hardware:</strong> selection box select the cable for the n6001/n6000. In the <strong>Device:</strong> selection box select the Agilex device.</p>
<p><a class="glightbox" href="../images/stp_select_usbBlasterII_hardware.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_select_usbBlasterII_hardware.png" /></a></p>
</li>
<li>
<p>If the Agilex Device is not displayed in the <strong>Device:</strong> list, click the <strong>'Scan Chain'</strong> button to re-scan the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> device chain.</p>
</li>
<li>
<p>Create the trigger conditions. In this example, we will capture data on a rising edge of the Read Address Valid signal.</p>
<p><a class="glightbox" href="../images/stp_set_trigger_conditions.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_set_trigger_conditions.png" /></a></p>
</li>
<li>
<p>Start analysis by selecting the <strong>'stp_for_hello_fim'</strong> instance and pressing <strong>'F5'</strong> or clicking the <strong>Run Analysis</strong> icon in the toolbar. You should see a green message indicating the Acquisition is in progress. Then, move to the <strong>Data</strong> Tab to observe the signals captured.</p>
<p><a class="glightbox" href="../images/stp_start_signal_capture.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_start_signal_capture.png" /></a></p>
</li>
<li>
<p>To generate traffic in the <strong>csr_lite_if</strong> signals of the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module, walk the DFH list or peek/poke the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> registers.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-164-1" name="__codelineno-164-1" href="#__codelineno-164-1"></a>opae.io init -d 0000:98:00.0
<a id="__codelineno-164-2" name="__codelineno-164-2" href="#__codelineno-164-2"></a>opae.io walk -d 0000:98:00.0
<a id="__codelineno-164-3" name="__codelineno-164-3" href="#__codelineno-164-3"></a>opae.io release -d 0000:98:00.0
</code></pre></div>
<p>The signals should be captured on the rising edge of <code>arvalid</code> in this example. Zoom in to get a better view of the signals.</p>
<p><a class="glightbox" href="../images/stp_captured_csr_lite_if_traces.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_captured_csr_lite_if_traces.png" /></a></p>
</li>
</ol>
<h3 id="42-preparing-fim-for-afu-development"><strong>4.2 Preparing <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> for <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Development</strong><a class="headerlink" href="#42-preparing-fim-for-afu-development" title="Permanent link">&para;</a></h3>
<p>To save area, the default Host Excercisers in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> can be replaced by a "he_null" blocks. There are a few things to note:</p>
<ul>
<li>"he_null" is a minimal block with registers that responds to PCIe <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> request. <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> responses are required to keep PCIe alive (end points enabled in PCIe-SS needs service downstream requests).</li>
<li>If an exerciser with other I/O connections such as "he_mem" or "he_hssi" is replaced, then then those I/O ports are simply tied off.</li>
<li>The options supported are <code>null_he_lb</code>, <code>null_he_hssi</code>, <code>null_he_mem</code> and <code>null_he_mem_tg</code>. Any combination and order can be enabled at the same time. </li>
<li>Finer grain control is provided for you to, for example, turn off only the exercisers in the Static Region in order to save area.</li>
</ul>
<h4 id="421-walkthrough-compile-the-fim-in-preparation-for-designing-your-afu"><strong>4.2.1 Walkthrough: Compile the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> in preparation for designing your <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr></strong><a class="headerlink" href="#421-walkthrough-compile-the-fim-in-preparation-for-designing-your-afu" title="Permanent link">&para;</a></h4>
<p>Perform the following steps to compile a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> for where the exercisers are removed and replaced with an he_null module while keeping the PF/VF multiplexor connections.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Compile the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> with the HE_NULL compile options</p>
<ol>
<li>
<p>Navigate to the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> root directory</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-165-1" name="__codelineno-165-1" href="#__codelineno-165-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
</code></pre></div>
</li>
<li>
<p>Run the <code>build_top.sh</code> script with the null host exerciser options.</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-166-1" name="__codelineno-166-1" href="#__codelineno-166-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001:null_he_lb,null_he_hssi,null_he_mem,null_he_mem_tg<span class="w"> </span>work_n6001
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-167-1" name="__codelineno-167-1" href="#__codelineno-167-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6000.ofss<span class="w"> </span>n6000:null_he_lb,null_he_hssi,null_he_mem,null_he_mem_tg<span class="w"> </span>work_n6000
</code></pre></div>
</li>
</ul>
</li>
</ol>
</li>
</ol>
<h3 id="43-partial-reconfiguration-region"><strong>4.3 Partial Reconfiguration Region</strong><a class="headerlink" href="#43-partial-reconfiguration-region" title="Permanent link">&para;</a></h3>
<p>To take advantage of the available resources in the Agilex® 7 FPGA for an <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> design, you can adjust the size of the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> partition. An example reason for the changing the size of <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region is if you add more logic to the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> region, then you may need to adjust the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region to fit the additional logic into the static region.  Similarly, if you reduce logic in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> region, then you can adjust the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region to provide more logic resources for the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>.</p>
<p>After the compilation of the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>, the resources usage broken down by partitions as reported in the following two files</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-168-1" name="__codelineno-168-1" href="#__codelineno-168-1"></a><span class="nv">$OFS_ROOTDIR</span>/&lt;WORDK_DIRECTORY&gt;/syn/board/&lt;TARGET_BOARD&gt;/syn_top/output_files/ofs_top.fit.place.rpt
<a id="__codelineno-168-2" name="__codelineno-168-2" href="#__codelineno-168-2"></a><span class="nv">$OFS_ROOTDIR</span>/&lt;WORDK_DIRECTORY&gt;/syn/board/&lt;TARGET_BOARD&gt;/syn_top/output_files/ofs_top.fit.rpt
</code></pre></div>
<p>An example report of the resources usage by partitions defined for the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> is shown below.</p>
<p><a class="glightbox" href="../images/IOFS_FLOW_Logic_lock_region_usage_summary.PNG" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/IOFS_FLOW_Logic_lock_region_usage_summary.PNG" /></a></p>
<p>In this case, the default size for the afu_top|port_gasket|pr_slot|afu_main <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> partition is large enough to hold the logic of the default <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>, which is mainly occupied by the Host Exercisers. However, larger designs might require additional resources.</p>
<h4 id="431-walkthrough-resize-the-partial-reconfiguration-region"><strong>4.3.1 Walkthrough: Resize the Partial Reconfiguration Region</strong><a class="headerlink" href="#431-walkthrough-resize-the-partial-reconfiguration-region" title="Permanent link">&para;</a></h4>
<p>Perform the following steps to customize the resources allocated to the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> in the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> regions:</p>
<ol>
<li>
<p>The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> flow provides the TCL file <code>$OFS_ROOTDIR/syn/board/&lt;TARGET_BOARD&gt;/setup/pr_assignments.tcl</code> which defines the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> partition where the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> is allocated.</p>
<p>Example contents of this file for the n6000 are shown as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-169-1" name="__codelineno-169-1" href="#__codelineno-169-1"></a><span class="c">#####################################################</span>
<a id="__codelineno-169-2" name="__codelineno-169-2" href="#__codelineno-169-2"></a><span class="c"># Main PR Partition -- green_region</span>
<a id="__codelineno-169-3" name="__codelineno-169-3" href="#__codelineno-169-3"></a><span class="c">#####################################################</span>
<a id="__codelineno-169-4" name="__codelineno-169-4" href="#__codelineno-169-4"></a><span class="nv">set_instance_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>PARTITION<span class="w"> </span>green_region<span class="w"> </span><span class="o">-</span>to<span class="w"> </span>afu_top<span class="o">|</span>pg_afu.port_gasket<span class="o">|</span>pr_slot<span class="o">|</span>afu_main
<a id="__codelineno-169-5" name="__codelineno-169-5" href="#__codelineno-169-5"></a><span class="nv">set_instance_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>CORE_ONLY_PLACE_REGION<span class="w"> </span>ON<span class="w"> </span><span class="o">-</span>to<span class="w"> </span>afu_top<span class="o">|</span>pg_afu.port_gasket<span class="o">|</span>pr_slot<span class="o">|</span>afu_main
<a id="__codelineno-169-6" name="__codelineno-169-6" href="#__codelineno-169-6"></a><span class="nv">set_instance_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>RESERVE_PLACE_REGION<span class="w"> </span>ON<span class="w"> </span><span class="o">-</span>to<span class="w"> </span>afu_top<span class="o">|</span>pg_afu.port_gasket<span class="o">|</span>pr_slot<span class="o">|</span>afu_main
<a id="__codelineno-169-7" name="__codelineno-169-7" href="#__codelineno-169-7"></a><span class="nv">set_instance_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>PARTIAL_RECONFIGURATION_PARTITION<span class="w"> </span>ON<span class="w"> </span><span class="o">-</span>to<span class="w"> </span>afu_top<span class="o">|</span>pg_afu.port_gasket<span class="o">|</span>pr_slot<span class="o">|</span>afu_main
<a id="__codelineno-169-8" name="__codelineno-169-8" href="#__codelineno-169-8"></a>
<a id="__codelineno-169-9" name="__codelineno-169-9" href="#__codelineno-169-9"></a><span class="nv">set_instance_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>PLACE_REGION<span class="w"> </span><span class="s2">&quot;X76 Y30 X300 Y195&quot;</span><span class="w"> </span><span class="o">-</span>to<span class="w"> </span>afu_top<span class="o">|</span>pg_afu.port_gasket<span class="o">|</span>pr_slot<span class="o">|</span>afu_main
<a id="__codelineno-169-10" name="__codelineno-169-10" href="#__codelineno-169-10"></a><span class="nv">set_instance_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>ROUTE_REGION<span class="w"> </span><span class="s2">&quot;X0 Y0 X344 Y212&quot;</span><span class="w"> </span><span class="o">-</span>to<span class="w"> </span>afu_top<span class="o">|</span>pg_afu.port_gasket<span class="o">|</span>pr_slot<span class="o">|</span>afu_main
</code></pre></div>
</li>
<li>
<p>Use Quartus Chip Planner to identify the locations of the resources available within the Agilex® 7 FPGA chip for placement and routing your <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>. You need to identify a pair of coordinates, the origin (X0, Y0) and top right corner (X1, Y1) of the new or existing rectangles to modify as shown in the following image of the n6000 Chip Planner view.</p>
<p><a class="glightbox" href="../images/chip_planner_coordinates.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/chip_planner_coordinates.png" /></a></p>
</li>
</ol>
<p>The coordinates of the top right corner of the lock regions are computed indirectly based on the Width and Height, as follows.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-170-1" name="__codelineno-170-1" href="#__codelineno-170-1"></a>X1 = X0 + Width 
<a id="__codelineno-170-2" name="__codelineno-170-2" href="#__codelineno-170-2"></a>Y1 = Y0 + Height
</code></pre></div>
<ol>
<li>
<p>Make changes to the pr_assignments.tcl based on your findings in Quartus Chip Planner. You can modify the size and location of existing lock regions or add new ones and assign them to the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> partition.</p>
</li>
<li>
<p>Build your <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and create the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> relocatable build tree using the <code>build_top.sh</code> script. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#225-walkthrough-compile-ofs-fim">Compile <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a> section for step-by-step compilation instructions.</p>
</li>
<li>
<p>Analyze the resource utilization report per partition produced after recompiling the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
</li>
<li>
<p>Perform further modification to the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> regions until the results are satisfactory. Make sure timing constraints are met.</p>
</li>
</ol>
<p>For more information on how to optimize the floor plan of your Partial Reconfiguration design refer to the following online documentation.</p>
<ul>
<li><a href="https://www.intel.com/content/www/us/en/docs/programmable/683641/21-4/analyzing-and-optimizing-the-design-03170.html">Analyzing and Optimizing the Design Floorplan</a></li>
</ul>
<ul>
<li><a href="https://www.intel.com/content/www/us/en/docs/programmable/683834/21-4/step-3-floorplan-the-design.html">Partial Reconfiguration Design Flow - Step 3 - Floorplan the Design</a></li>
</ul>
<h3 id="44-pcie-configuration"><strong>4.4 PCIe Configuration</strong><a class="headerlink" href="#44-pcie-configuration" title="Permanent link">&para;</a></h3>
<p>The PCIe sub-system IP and PF/VF MUX can be modified either using the OFSS flow or the IP Presets flow. The OFSS flow supports a subset of all available PCIe Sub-system settings, while the IP Preset flow can make any available PCIe Sub-system settings change. With PCIe-SS modifcations related to the PFs and VFs, the PF/VF MUX logic is automatically configured based on the PCIe-SS configuration when using OFSS. The sections below describe each flow.</p>
<ul>
<li><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#443-pcie-configuration-using-ofss">PCIe Configuration Using OFSS</a></li>
<li><a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#444-pcie-sub-system-configuration-using-ip-presets">PCIe Sub-System configuration Using IP Presets</a></li>
</ul>
<h4 id="441-pfvf-mux-configuration"><strong>4.4.1 PF/VF MUX Configuration</strong><a class="headerlink" href="#441-pfvf-mux-configuration" title="Permanent link">&para;</a></h4>
<p>The default PF/VF MUX configuration for <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> for the n6001 can support up to 8 PFs and 2000 VFs distributed accross all PFs.</p>
<p>For reference <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> configurations, you must have at least 1 PF with 1VF, or 2PFs. This is because the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region cannot be left unconnected. PFs must be consecutive. The <em>PFVF Limitations</em> table describes the supported number of PFs and VFs.</p>
<p><em>Table: PF/VF Limitations</em></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Min # of PFs</td>
<td>1 (on PF0)</td>
</tr>
<tr>
<td>Max # of PFs</td>
<td>8</td>
</tr>
<tr>
<td>Min # of VFs</td>
<td>1 on PF0 (0 if 2PFs present)</td>
</tr>
<tr>
<td>Max # of VFs</td>
<td>2000 distributed across all PFs</td>
</tr>
</tbody>
</table>
<p>New PF or VF instances will automatically have a null_afu module instantiated and connected to the new PF or VF.</p>
<h4 id="442-pcie-ss-configuration-registers"><strong>4.4.2 PCIe-SS Configuration Registers</strong><a class="headerlink" href="#442-pcie-ss-configuration-registers" title="Permanent link">&para;</a></h4>
<p>The PCIe-SS configuration registers contain the Vendor, Device and Subsystem Vendor ID registers which are used in PCIe add-in cards to uniquely identify the card for assignment to software drivers. <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> has these registers set with Intel values for out of the box usage. If you are using <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for a PCIe add in card that your company manufactures, then update the PCIe Subsytem Subsystem ID and Vendor ID registers as described below and change OPAE provided software code to properly operate with your company's register values.</p>
<p>The Vendor ID is assigned to your company by the PCI-SIG (Special Interest Group). The PCI-SIG is the only body officially licensed to give out IDs. You must be a member of PCI-SIG to request your own ID. Information about joining PCI-SIG is available here: PCI-SIG. You select the Subsystem Device ID for your PCIe add in card.</p>
<h4 id="443-pcie-configuration-using-ofss"><strong>4.4.3 PCIe Configuration Using OFSS</strong><a class="headerlink" href="#443-pcie-configuration-using-ofss" title="Permanent link">&para;</a></h4>
<p>The general flow for using OFSS to modify the PCIe Sub-system and PF/VF MUX is as follows:</p>
<ol>
<li>Create or modify a PCIe OFSS file with the desired PCIe configuration. </li>
<li>Call this PCIe OFSS file when running the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> build script.</li>
</ol>
<p>The <em>PCIe IP OFSS File Options</em> table lists all of the configuration options supported by the OFSS flow. Any other customizations to the PCIe sub-system must be done with the IP Presets Flow.</p>
<p><em>Table: PCIe IP OFSS File Options</em></p>
<table>
<thead>
<tr>
<th>Section</th>
<th>Parameter</th>
<th>Options</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[ip]</code></td>
<td><code>type</code></td>
<td><code>pcie</code></td>
<td>N/A</td>
<td>Specifies that this OFSS file configures the PCIe-SS</td>
</tr>
<tr>
<td><code>[settings]</code></td>
<td><code>output_name</code></td>
<td><code>pcie_ss</code></td>
<td>N/A</td>
<td>Specifies the output name of the PCIe-SS IP</td>
</tr>
<tr>
<td></td>
<td><code>preset</code></td>
<td><em>String</em></td>
<td>N/A</td>
<td>OPTIONAL - Specifies the name of a PCIe-SS IP presets file to use when building the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. When used, a presets file will take priority over any other parameters set in this OFSS file.</td>
</tr>
<tr>
<td><code>[pf*]</code></td>
<td><code>num_vfs</code></td>
<td>Integer</td>
<td><code>0</code></td>
<td>Specifies the number of Virtual Functions in the current PF</td>
</tr>
<tr>
<td></td>
<td><code>bar0_address_width</code></td>
<td>Integer</td>
<td><code>12</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>bar4_address_width</code></td>
<td>Integer</td>
<td><code>14</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>vf_bar0_address_width</code></td>
<td>Integer</td>
<td><code>12</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>ats_cap_enable</code></td>
<td><code>0</code> | <code>1</code></td>
<td><code>0</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>vf_ats_cap_enable</code></td>
<td><code>0</code> | <code>1</code></td>
<td><code>0</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>prs_ext_cap_enable</code></td>
<td><code>0</code> | <code>1</code></td>
<td><code>0</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>pasid_cap_enable</code></td>
<td><code>0</code> | <code>1</code></td>
<td><code>0</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>pci_type0_vendor_id</code></td>
<td>32'h Value</td>
<td><code>0x00008086</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>pci_type0_device_id</code></td>
<td>32'h Value</td>
<td><code>0x0000bcce</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>revision_id</code></td>
<td>32'h Value</td>
<td><code>0x00000001</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>class_code</code></td>
<td>32'h Value</td>
<td><code>0x00120000</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>subsys_vendor_id</code></td>
<td>32'h Value</td>
<td><code>0x00008086</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>subsys_dev_id</code></td>
<td>32'h Value</td>
<td><code>0x00001771</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>sriov_vf_device_id</code></td>
<td>32'h Value</td>
<td><code>0x0000bccf</code></td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>exvf_subsysid</code></td>
<td>32'h Value</td>
<td><code>0x00001771</code></td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="4431-walkthrough-modify-the-pcie-sub-system-and-pfvf-mux-configuration-using-ofss"><strong>4.4.3.1 Walkthrough: Modify the PCIe Sub-System and PF/VF MUX Configuration Using OFSS</strong><a class="headerlink" href="#4431-walkthrough-modify-the-pcie-sub-system-and-pfvf-mux-configuration-using-ofss" title="Permanent link">&para;</a></h5>
<p>Perform the following steps to modify the PF/VF MUX configuration.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<ul>
<li>This walkthrough requires an <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach deployment environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/">Getting Started Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach FPGAs (Intel® FPGA SmartNIC N6001-PL/N6000-PL)</a> for instructions on setting up a deployment environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>View the default PCIe OFSS file contents. For example, the n6001 default PCIe OFSS configuration is defined in the <code>$OFS_ROOTDIR/tools/ofss_config/pcie/pcie_host.ofss</code> file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-171-1" name="__codelineno-171-1" href="#__codelineno-171-1"></a><span class="o">[</span>ip<span class="o">]</span>
<a id="__codelineno-171-2" name="__codelineno-171-2" href="#__codelineno-171-2"></a><span class="nb">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie
<a id="__codelineno-171-3" name="__codelineno-171-3" href="#__codelineno-171-3"></a>
<a id="__codelineno-171-4" name="__codelineno-171-4" href="#__codelineno-171-4"></a><span class="o">[</span>settings<span class="o">]</span>
<a id="__codelineno-171-5" name="__codelineno-171-5" href="#__codelineno-171-5"></a><span class="nv">output_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss
<a id="__codelineno-171-6" name="__codelineno-171-6" href="#__codelineno-171-6"></a>
<a id="__codelineno-171-7" name="__codelineno-171-7" href="#__codelineno-171-7"></a><span class="o">[</span>pf0<span class="o">]</span>
<a id="__codelineno-171-8" name="__codelineno-171-8" href="#__codelineno-171-8"></a><span class="nv">num_vfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>
<a id="__codelineno-171-9" name="__codelineno-171-9" href="#__codelineno-171-9"></a><span class="nv">bar0_address_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>
<a id="__codelineno-171-10" name="__codelineno-171-10" href="#__codelineno-171-10"></a><span class="nv">vf_bar0_address_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>
<a id="__codelineno-171-11" name="__codelineno-171-11" href="#__codelineno-171-11"></a>
<a id="__codelineno-171-12" name="__codelineno-171-12" href="#__codelineno-171-12"></a><span class="o">[</span>pf1<span class="o">]</span>
<a id="__codelineno-171-13" name="__codelineno-171-13" href="#__codelineno-171-13"></a>
<a id="__codelineno-171-14" name="__codelineno-171-14" href="#__codelineno-171-14"></a><span class="o">[</span>pf2<span class="o">]</span>
<a id="__codelineno-171-15" name="__codelineno-171-15" href="#__codelineno-171-15"></a><span class="nv">bar0_address_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">18</span>
<a id="__codelineno-171-16" name="__codelineno-171-16" href="#__codelineno-171-16"></a>
<a id="__codelineno-171-17" name="__codelineno-171-17" href="#__codelineno-171-17"></a><span class="o">[</span>pf3<span class="o">]</span>
<a id="__codelineno-171-18" name="__codelineno-171-18" href="#__codelineno-171-18"></a>
<a id="__codelineno-171-19" name="__codelineno-171-19" href="#__codelineno-171-19"></a><span class="o">[</span>pf4<span class="o">]</span>
</code></pre></div>
</li>
<li>
<p>Create a new PCIe OFSS file from the existing <code>pcie_host.ofss</code> file</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-172-1" name="__codelineno-172-1" href="#__codelineno-172-1"></a>cp<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/tools/ofss_config/pcie/pcie_host.ofss<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/tools/ofss_config/pcie/pcie_pfvf_mod.ofss
</code></pre></div>
</li>
<li>
<p>Configure the new <code>pcie_pfvf_mod.ofss</code> with your desired settings. In this example we will add PF5 with 2 VFs.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-173-1" name="__codelineno-173-1" href="#__codelineno-173-1"></a><span class="o">[</span>ip<span class="o">]</span>
<a id="__codelineno-173-2" name="__codelineno-173-2" href="#__codelineno-173-2"></a><span class="nb">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie
<a id="__codelineno-173-3" name="__codelineno-173-3" href="#__codelineno-173-3"></a>
<a id="__codelineno-173-4" name="__codelineno-173-4" href="#__codelineno-173-4"></a><span class="o">[</span>settings<span class="o">]</span>
<a id="__codelineno-173-5" name="__codelineno-173-5" href="#__codelineno-173-5"></a><span class="nv">output_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss
<a id="__codelineno-173-6" name="__codelineno-173-6" href="#__codelineno-173-6"></a>
<a id="__codelineno-173-7" name="__codelineno-173-7" href="#__codelineno-173-7"></a><span class="o">[</span>pf0<span class="o">]</span>
<a id="__codelineno-173-8" name="__codelineno-173-8" href="#__codelineno-173-8"></a><span class="nv">num_vfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>
<a id="__codelineno-173-9" name="__codelineno-173-9" href="#__codelineno-173-9"></a><span class="nv">bar0_address_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>
<a id="__codelineno-173-10" name="__codelineno-173-10" href="#__codelineno-173-10"></a><span class="nv">vf_bar0_address_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>
<a id="__codelineno-173-11" name="__codelineno-173-11" href="#__codelineno-173-11"></a>
<a id="__codelineno-173-12" name="__codelineno-173-12" href="#__codelineno-173-12"></a><span class="o">[</span>pf1<span class="o">]</span>
<a id="__codelineno-173-13" name="__codelineno-173-13" href="#__codelineno-173-13"></a>
<a id="__codelineno-173-14" name="__codelineno-173-14" href="#__codelineno-173-14"></a><span class="o">[</span>pf2<span class="o">]</span>
<a id="__codelineno-173-15" name="__codelineno-173-15" href="#__codelineno-173-15"></a><span class="nv">bar0_address_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">18</span>
<a id="__codelineno-173-16" name="__codelineno-173-16" href="#__codelineno-173-16"></a>
<a id="__codelineno-173-17" name="__codelineno-173-17" href="#__codelineno-173-17"></a><span class="o">[</span>pf3<span class="o">]</span>
<a id="__codelineno-173-18" name="__codelineno-173-18" href="#__codelineno-173-18"></a>
<a id="__codelineno-173-19" name="__codelineno-173-19" href="#__codelineno-173-19"></a><span class="o">[</span>pf4<span class="o">]</span>
<a id="__codelineno-173-20" name="__codelineno-173-20" href="#__codelineno-173-20"></a>
<a id="__codelineno-173-21" name="__codelineno-173-21" href="#__codelineno-173-21"></a><span class="o">[</span>pf5<span class="o">]</span>
<a id="__codelineno-173-22" name="__codelineno-173-22" href="#__codelineno-173-22"></a><span class="nv">num_vfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
</code></pre></div>
</li>
<li>
<p>Edit the top level OFSS file to use the new PCIe OFSS file <code>pcie_pf_vf_mod.ofss</code>. In this example, we will edit the n6001 top level OFSS file <code>$OFS_ROOTDIR/tools/ofss_config/n6001.ofss</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-174-1" name="__codelineno-174-1" href="#__codelineno-174-1"></a><span class="o">[</span>include<span class="o">]</span>
<a id="__codelineno-174-2" name="__codelineno-174-2" href="#__codelineno-174-2"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/n6001_base.ofss
<a id="__codelineno-174-3" name="__codelineno-174-3" href="#__codelineno-174-3"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/pcie/pcie_pfvf_mod.ofss
<a id="__codelineno-174-4" name="__codelineno-174-4" href="#__codelineno-174-4"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/iopll/iopll.ofss
<a id="__codelineno-174-5" name="__codelineno-174-5" href="#__codelineno-174-5"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/memory/memory.ofss
</code></pre></div>
</li>
<li>
<p>Compile the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. In this example we are targeting the n6001 board.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-175-1" name="__codelineno-175-1" href="#__codelineno-175-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-175-2" name="__codelineno-175-2" href="#__codelineno-175-2"></a>
<a id="__codelineno-175-3" name="__codelineno-175-3" href="#__codelineno-175-3"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001<span class="w"> </span>work_n6001_pfvf_mod
</code></pre></div>
</li>
<li>
<p>Copy the resulting <code>.bin</code> user 1 image to your deployment environmenment.</p>
</li>
<li>
<p>Switch to your deployment environment.</p>
</li>
<li>
<p>Program the <code>.bin</code> image to the n6001 FPGA. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#531-walkthrough-program-the-fpga-via-rsu">Program the FPGA via <abbr title="Remote System Update, A Remote System Update operation sends an instruction to the Intel FPGA PAC D5005 device that triggers a power cycle of the card only, forcing reconfiguration.">RSU</abbr></a> Section for step-by-step programming instructions.</p>
</li>
<li>
<p>Verify the number of VFs on the newly added PF8. In this example, we defined 2 VFs on PF5 in Step 5.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-176-1" name="__codelineno-176-1" href="#__codelineno-176-1"></a>sudo<span class="w"> </span>lspci<span class="w"> </span>-vvv<span class="w"> </span>-s<span class="w"> </span><span class="m">98</span>:00.5<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>VF
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-177-1" name="__codelineno-177-1" href="#__codelineno-177-1"></a>Initial<span class="w"> </span>VFs:<span class="w"> </span><span class="m">2</span>,<span class="w"> </span>Total<span class="w"> </span>VFs:<span class="w"> </span><span class="m">2</span>,<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>VFs:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>Function<span class="w"> </span>Dependency<span class="w"> </span>Link:<span class="w"> </span><span class="m">05</span>
<a id="__codelineno-177-2" name="__codelineno-177-2" href="#__codelineno-177-2"></a>VF<span class="w"> </span>offset:<span class="w"> </span><span class="m">4</span>,<span class="w"> </span>stride:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>Device<span class="w"> </span>ID:<span class="w"> </span>bccf
<a id="__codelineno-177-3" name="__codelineno-177-3" href="#__codelineno-177-3"></a>VF<span class="w"> </span>Migration:<span class="w"> </span>offset:<span class="w"> </span><span class="m">00000000</span>,<span class="w"> </span>BIR:<span class="w"> </span><span class="m">0</span>
</code></pre></div>
</li>
<li>
<p>Verify communication with the newly added PF5. New PF/VF are seamlessly connected to their own CSR stub, which can be read at DFH Offset 0x0. You can bind to the function and perform <code>opae.io peek</code> commands to read from the stub CSR. Similarly, perform <code>opae.io poke</code> commands to write into the stub CSRs. Use this mechanism to verify that the new PF/VF Mux configuration allows to write and read back values from the stub CSRs. </p>
</li>
</ol>
<p>The GUID for every new PF/VF CSR stub is the same.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-178-1" name="__codelineno-178-1" href="#__codelineno-178-1"></a>* NULL_GUID_L           = 64&#39;haa31f54a3e403501
<a id="__codelineno-178-2" name="__codelineno-178-2" href="#__codelineno-178-2"></a>* NULL_GUID_H           = 64&#39;h3e7b60a0df2d4850
</code></pre></div>
<p>1. Initialize the driver on PF5</p>
<div class="highlight"><pre><span></span><code>```bash
sudo opae.io init -d 98:00.5
```
</code></pre></div>
<p>2. Read the GUID for the PF5 CSR stub.</p>
<div class="highlight"><pre><span></span><code>```bash
sudo opae.io -d 98:00.5 -r 0 peek 0x8
sudo opae.io -d 98:00.5 -r 0 peek 0x10
```

Example output:

```bash
0xaa31f54a3e403501
0x3e7b60a0df2d4850
```
</code></pre></div>
<h4 id="444-pcie-sub-system-configuration-using-ip-presets"><strong>4.4.4 PCIe Sub-System configuration Using IP Presets</strong><a class="headerlink" href="#444-pcie-sub-system-configuration-using-ip-presets" title="Permanent link">&para;</a></h4>
<p>The general flow for using IP Presets to modify he PCIe Sub-system is as follows:</p>
<ol>
<li>[OPTIONAL] Create a work directory using OFSS files if you wish to use OFSS configuration settings as a starting point.</li>
<li>Open the PCIe-SS IP and make desired modifications.</li>
<li>Create an IP Presets file.</li>
<li>Create an PCIe OFSS file that uses the IP Presets file.</li>
<li>Build the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> with the PCIe OFSS file from Step 4.</li>
</ol>
<h5 id="4441-walkthrough-modify-pcie-sub-system-and-pfvf-mux-configuration-using-ip-presets"><strong>4.4.4.1 Walkthrough: Modify PCIe Sub-System and PF/VF MUX Configuration Using IP Presets</strong><a class="headerlink" href="#4441-walkthrough-modify-pcie-sub-system-and-pfvf-mux-configuration-using-ip-presets" title="Permanent link">&para;</a></h5>
<p>Perform the following steps to use an IP preset file to configure the PCIe Sub-system and PF/VF MUX. In this example, we will change the Revision ID on PF0. While this modification can be done with the OFSS flow, this walkthrough is intended to show the procedure for making any PCIe configuration change using IP presets. This walkthrough targets the n6001, but similar steps can be applied to the n6000.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment to build the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<ul>
<li>This walkthrough requires an <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach deployment environment to test the design. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/">Getting Started Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach FPGAs (Intel® FPGA SmartNIC N6001-PL/N6000-PL)</a> for instructions on setting up a deployment environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>[OPTIONAL] Run the <code>setup</code> stage of the build script using your desired OFSS configration to create a working directory for the target board. In this example we will target the n6001.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-182-1" name="__codelineno-182-1" href="#__codelineno-182-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>--stage<span class="w"> </span>setup<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001<span class="w"> </span>work_n6001
</code></pre></div>
</li>
<li>
<p>Open the PCIe-SS in the work directory using Quartus Parameter Editor. If you performed Step 3, open the PCIe-SS IP from the work directory; otherwise, open the PCIe-SS IP from the source files.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-183-1" name="__codelineno-183-1" href="#__codelineno-183-1"></a>qsys-edit<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/work_n6001/ipss/pcie/qip/pcie_ss.ip
</code></pre></div>
</li>
<li>
<p>Modify the settings as desired. In this example we are changing the <strong>Device ID</strong> to <code>0xbccf</code> and the <strong>Revision ID</strong> to <code>0x2</code>. In the <strong>IP Parameter Editor</strong>, scroll down and expand the <strong>PCIe Interfaces Ports Settings -&gt; Port 0 -&gt; PCIe0 Device Identification Registers -&gt; PCIe0 PF0 IDs</strong> tab and make these changes.</p>
<p><a class="glightbox" href="../images/pcie_ss_mod.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="pcie_ss_mod" src="../images/pcie_ss_mod.png" /></a></p>
</li>
<li>
<p>Once you are satisfied with your modifcations, create a new IP Preset file.</p>
<ol>
<li>
<p>click <strong>New...</strong> in the <strong>Presets</strong> window.</p>
<p><a class="glightbox" href="../images/pcie_ss_mod_preset_new.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/pcie_ss_mod_preset_new.png" /></a></p>
</li>
<li>
<p>In the <strong>New Preset</strong> window, set a unique <strong>Name</strong> for the preset; for example, <code>n6001-rev2</code>.</p>
<p><a class="glightbox" href="../images/pcie_ss_mod_new_preset.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/pcie_ss_mod_new_preset.png" /></a></p>
</li>
<li>
<p>Click the <strong>...</strong> button to set the save location for the IP Preset file to <code>$OFS_ROOTDIR/ipss/pcie/presets</code>. Set the <strong>File Name</strong> to match the name selected in Step 9. Click <strong>OK</strong>.</p>
<p><a class="glightbox" href="../images/pcie_ss_mod_preset_save_as.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/pcie_ss_mod_preset_save_as.png" /></a></p>
</li>
<li>
<p>In the <strong>New Preset</strong> window, click <strong>Save</strong>. Click <strong>No</strong> when prompted to add the file to the IP search path.</p>
<p><a class="glightbox" href="../images/preset_ip_path_no.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/preset_ip_path_no.png" /></a></p>
</li>
</ol>
</li>
<li>
<p>Close <strong>IP Parameter Editor</strong> without saving or generating HDL.</p>
</li>
<li>
<p>Create a new PCIe OFSS file in the <code>$OFS_ROOTDIR/tools/ofss_config/pcie</code> directory. For example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-184-1" name="__codelineno-184-1" href="#__codelineno-184-1"></a>touch<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/tools/ofss_config/pcie/pcie_host_mod_preset.ofss
</code></pre></div>
<p>Insert the following into the OFSS file to specify the IP Preset file created in Step 6. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-185-1" name="__codelineno-185-1" href="#__codelineno-185-1"></a>[ip]
<a id="__codelineno-185-2" name="__codelineno-185-2" href="#__codelineno-185-2"></a>type = pcie
<a id="__codelineno-185-3" name="__codelineno-185-3" href="#__codelineno-185-3"></a>
<a id="__codelineno-185-4" name="__codelineno-185-4" href="#__codelineno-185-4"></a>[settings]
<a id="__codelineno-185-5" name="__codelineno-185-5" href="#__codelineno-185-5"></a>output_name = pcie_ss
<a id="__codelineno-185-6" name="__codelineno-185-6" href="#__codelineno-185-6"></a>preset = n6001-rev2
</code></pre></div>
</li>
<li>
<p>Edit the <code>$OFS_ROOTDIR/tools/ofss_config/n6001.ofss</code> file to call new OFSS file created in Step 10.</p>
<p><code>[include]
 "$OFS_ROOTDIR"/tools/ofss_config/n6001_base.ofss
 "$OFS_ROOTDIR"/tools/ofss_config/pcie/pcie_host_mod_preset.ofss
 "$OFS_ROOTDIR"/tools/ofss_config/iopll/iopll.ofss
 "$OFS_ROOTDIR"/tools/ofss_config/memory/memory.ofss</code></p>
</li>
<li>
<p>Compile the design with the modified n6001.ofss file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-186-1" name="__codelineno-186-1" href="#__codelineno-186-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-186-2" name="__codelineno-186-2" href="#__codelineno-186-2"></a>
<a id="__codelineno-186-3" name="__codelineno-186-3" href="#__codelineno-186-3"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss,tools/ofss_config/hssi/hssi_8x25.ofss<span class="w"> </span>n6001<span class="w"> </span>work_n6001_pcie_mod
</code></pre></div>
</li>
<li>
<p>Copy the resulting <code>$OFS_ROOTDIR/work_n6001_pcie_mod/syn/board/n6001/syn_top/output_files/ofs_top_hps.sof</code> image to your deployment environmenment for <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> programming, or copy a <code>bin</code> file (e.g. <code>ofs_top_page1_unsigned_user1.bin</code>) for <abbr title="Remote System Update, A Remote System Update operation sends an instruction to the Intel FPGA PAC D5005 device that triggers a power cycle of the card only, forcing reconfiguration.">RSU</abbr> programming.</p>
<blockquote>
<p><strong>Note:</strong> OPAE FPGA management commands require recognition of the FPGA PCIe Device ID for control.  If there is a problem between OPAE management recognition of FPGA PCIe values, then control of the card will be lost.  For this reason, you are strongly encouraged to program the FPGA via <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> to load the test FPGA image.  If there is a problem with the SOF image working with your host software that is updated for the new PCIe settings, then you can load a known good SOF file to recover.  Once you sure that both the software and FPGA work properly, you can load the FPGA into FPGA flash using the OPAE command <code>fpgasupdate</code>.</p>
</blockquote>
</li>
<li>
<p>Switch to your deployment environment.</p>
</li>
<li>
<p>Program the image to the n6001 FPGA. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#52-walkthrough-program-the-fpga-via-jtag">Program the FPGA via <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr></a> Section for step-by-step <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> programming instructions, or the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#531-walkthrough-program-the-fpga-via-rsu">Program the FPGA via <abbr title="Remote System Update, A Remote System Update operation sends an instruction to the Intel FPGA PAC D5005 device that triggers a power cycle of the card only, forcing reconfiguration.">RSU</abbr></a> Section for step-by-step <abbr title="Remote System Update, A Remote System Update operation sends an instruction to the Intel FPGA PAC D5005 device that triggers a power cycle of the card only, forcing reconfiguration.">RSU</abbr> programming instructions.</p>
</li>
<li>
<p>Use <code>lspci</code> to verify that the PCIe changes have been implemented.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-187-1" name="__codelineno-187-1" href="#__codelineno-187-1"></a>lspci<span class="w"> </span>-nvmms<span class="w"> </span><span class="m">98</span>:00.0
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-188-1" name="__codelineno-188-1" href="#__codelineno-188-1"></a>Slot:<span class="w">   </span><span class="m">98</span>:00.0
<a id="__codelineno-188-2" name="__codelineno-188-2" href="#__codelineno-188-2"></a>Class:<span class="w">  </span><span class="m">1200</span>
<a id="__codelineno-188-3" name="__codelineno-188-3" href="#__codelineno-188-3"></a>Vendor:<span class="w"> </span><span class="m">8086</span>
<a id="__codelineno-188-4" name="__codelineno-188-4" href="#__codelineno-188-4"></a>Device:<span class="w"> </span>bcce
<a id="__codelineno-188-5" name="__codelineno-188-5" href="#__codelineno-188-5"></a>SVendor:<span class="w">        </span><span class="m">8086</span>
<a id="__codelineno-188-6" name="__codelineno-188-6" href="#__codelineno-188-6"></a>SDevice:<span class="w">        </span><span class="m">1771</span>
<a id="__codelineno-188-7" name="__codelineno-188-7" href="#__codelineno-188-7"></a>PhySlot:<span class="w">        </span><span class="m">1</span>-1
<a id="__codelineno-188-8" name="__codelineno-188-8" href="#__codelineno-188-8"></a>Rev:<span class="w">    </span><span class="m">02</span>
<a id="__codelineno-188-9" name="__codelineno-188-9" href="#__codelineno-188-9"></a>NUMANode:<span class="w">       </span><span class="m">1</span>
<a id="__codelineno-188-10" name="__codelineno-188-10" href="#__codelineno-188-10"></a>IOMMUGroup:<span class="w">     </span><span class="m">8</span>
</code></pre></div>
</li>
</ol>
<h3 id="45-minimal-fim"><strong>4.5 Minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong><a class="headerlink" href="#45-minimal-fim" title="Permanent link">&para;</a></h3>
<p>In a minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>, the exercisers and Ethernet subsystem are removed from the design, and the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> area is expanded to make use of the available area previously used by the removed components. This minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> is useful for HDL applications.</p>
<p>There are two types of provided minimal FIMs:</p>
<ul>
<li>2PF: this minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> has two physical functions, with the APF/BPF on PF0, and the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region on PF1.<p><a class="glightbox" href="../images/minimal_fim_2pf_block_diagram.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/minimal_fim_2pf_block_diagram.png" /></a></p>
</li>
</ul>
<ul>
<li>1PF/1VF: This minmal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> has a single physical function, with the APF/BPF on PF0, and the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region on PF0-VF0.<p><a class="glightbox" href="../images/minimal_fim_1pf_1vf_block_diagram.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/minimal_fim_1pf_1vf_block_diagram.png" /></a></p>
</li>
</ul>
<p>The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> source repository contains OFSS file that can be used to build the two different types of minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<ul>
<li><code>$OFS_ROOTDIR/tools/ofss_config/n6001_2pf.ofss</code></li>
<li><code>$OFS_ROOTDIR/tools/ofss_config/n6001_1pf_1vf.ofss</code></li>
</ul>
<h4 id="451-walkthrough-create-a-minimal-fim"><strong>4.5.1 Walkthrough: Create a Minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong><a class="headerlink" href="#451-walkthrough-create-a-minimal-fim" title="Permanent link">&para;</a></h4>
<p>Perform the following steps to create a Minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. A minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> is one that has the host exercisers and ethernet subsystem removed. This frees up resources that can be used.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<ul>
<li>This walkthrough requires an <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach deployment environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/">Getting Started Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach FPGAs (Intel® FPGA SmartNIC N6001-PL/N6000-PL)</a> for instructions on setting up a deployment environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>[N6001 ONLY] The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repo provides a <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> assignments TCL file which optimizes the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region for the minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. Copy the minimal <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> assignments TCL file into the <code>pr_assignments.tcl</code> file location for use in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> build process.</p>
<ol>
<li>
<p>Rename the current <code>pr_assignments.tcl</code> file to <code>pr_assignments_base.tcl</code> for future use</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-189-1" name="__codelineno-189-1" href="#__codelineno-189-1"></a>mv<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/setup/pr_assignments.tcl<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/setup/pr_assignments_base.tcl
</code></pre></div>
</li>
<li>
<p>Copy the <code>pr_assignments_slim.tcl</code> file to <code>pr_assignments.tcl</code> to be used in the current build</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-190-1" name="__codelineno-190-1" href="#__codelineno-190-1"></a>cp<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/setup/pr_assignments_slim.tcl<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/setup/pr_assignments.tcl
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Compile the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> with Null HEs compile option, the No HSSI compile option, and the desired configuration OFSS file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-191-1" name="__codelineno-191-1" href="#__codelineno-191-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
</code></pre></div>
<ul>
<li>
<p>For 2PF Minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-192-1" name="__codelineno-192-1" href="#__codelineno-192-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001_2pf.ofss<span class="w"> </span>n6001:null_he_lb,null_he_hssi,null_he_mem,null_he_mem_tg,no_hssi<span class="w"> </span>work_n6001_minimal_fim
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>For 1PF/1VF Minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-193-1" name="__codelineno-193-1" href="#__codelineno-193-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001_1pf_1vf.ofss<span class="w"> </span>n6001:null_he_lb,null_he_hssi,null_he_mem,null_he_mem_tg,no_hssi<span class="w"> </span>work_n6001_minimal_fim
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>Review the <code>$OFS_ROOTDIR/work_n6001_minimal_fim/syn/board/n6001/syn_top/output_files/ofs_top.fit.rpt</code> utilization report to see the utilization statistics for the Minimal fim. Refer to <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/appendix-a-resource-utilization-tables">Appendix A: Resource Utilization Tables</a> <em>Table A-4</em> for the expected utilization for this Minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
</li>
<li>
<p>Copy the resulting <code>$OFS_ROOTDIR/work_n6001_minimal_fim/syn/board/n6001/syn_top/output_files/ofs_top.sof</code> image to your deployment environmenment.</p>
</li>
<li>
<p>Switch to your deployment environment, if different than your development environment.</p>
</li>
<li>
<p>Program the <code>.bin</code> image to the n6001 FPGA. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#531-walkthrough-program-the-fpga-via-rsu">Program the FPGA via <abbr title="Remote System Update, A Remote System Update operation sends an instruction to the Intel FPGA PAC D5005 device that triggers a power cycle of the card only, forcing reconfiguration.">RSU</abbr></a> Section for step-by-step programming instructions.</p>
</li>
<li>
<p>Verify the minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design on the board.</p>
<ul>
<li>
<p>For 2PF Minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>:</p>
<ol>
<li>Use <code>opae.io ls</code> to verify that there are two PFs</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-194-1" name="__codelineno-194-1" href="#__codelineno-194-1"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>ls
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-195-1" name="__codelineno-195-1" href="#__codelineno-195-1"></a><span class="o">[</span><span class="m">0000</span>:98:00.1<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086:0xbcce<span class="w"> </span>0x8086:0x1771<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>Acceleration<span class="w"> </span>Development<span class="w"> </span>Platform<span class="w"> </span>N6001<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
<a id="__codelineno-195-2" name="__codelineno-195-2" href="#__codelineno-195-2"></a><span class="o">[</span><span class="m">0000</span>:98:00.0<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086:0xbcce<span class="w"> </span>0x8086:0x1771<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>Acceleration<span class="w"> </span>Development<span class="w"> </span>Platform<span class="w"> </span>N6001<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
</code></pre></div>
<ol>
<li>
<p>Use <code>fpgainfo port</code> to verify the ports.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-196-1" name="__codelineno-196-1" href="#__codelineno-196-1"></a>sudo<span class="w"> </span>fpgainfo<span class="w"> </span>port
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-197-1" name="__codelineno-197-1" href="#__codelineno-197-1"></a>//******<span class="w"> </span>PORT<span class="w"> </span>******//
<a id="__codelineno-197-2" name="__codelineno-197-2" href="#__codelineno-197-2"></a>Interface<span class="w">                        </span>:<span class="w"> </span>DFL
<a id="__codelineno-197-3" name="__codelineno-197-3" href="#__codelineno-197-3"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xEE00000
<a id="__codelineno-197-4" name="__codelineno-197-4" href="#__codelineno-197-4"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.0
<a id="__codelineno-197-5" name="__codelineno-197-5" href="#__codelineno-197-5"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-197-6" name="__codelineno-197-6" href="#__codelineno-197-6"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-197-7" name="__codelineno-197-7" href="#__codelineno-197-7"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-197-8" name="__codelineno-197-8" href="#__codelineno-197-8"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-197-9" name="__codelineno-197-9" href="#__codelineno-197-9"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x00
<a id="__codelineno-197-10" name="__codelineno-197-10" href="#__codelineno-197-10"></a>//******<span class="w"> </span>PORT<span class="w"> </span>******//
<a id="__codelineno-197-11" name="__codelineno-197-11" href="#__codelineno-197-11"></a>Interface<span class="w">                        </span>:<span class="w"> </span>UIO
<a id="__codelineno-197-12" name="__codelineno-197-12" href="#__codelineno-197-12"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xED00000
<a id="__codelineno-197-13" name="__codelineno-197-13" href="#__codelineno-197-13"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.0
<a id="__codelineno-197-14" name="__codelineno-197-14" href="#__codelineno-197-14"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-197-15" name="__codelineno-197-15" href="#__codelineno-197-15"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-197-16" name="__codelineno-197-16" href="#__codelineno-197-16"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-197-17" name="__codelineno-197-17" href="#__codelineno-197-17"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-197-18" name="__codelineno-197-18" href="#__codelineno-197-18"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x01
<a id="__codelineno-197-19" name="__codelineno-197-19" href="#__codelineno-197-19"></a>Accelerator<span class="w"> </span>GUID<span class="w">                 </span>:<span class="w"> </span><span class="m">00000000</span>-0000-0000-0000-000000000000
</code></pre></div>
</li>
<li>
<p>Bind the <abbr title="Virtual Function Input/Output, An IOMMU/device agnostic framework for exposing direct device access to userspace.">VFIO</abbr> driver on PF1.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-198-1" name="__codelineno-198-1" href="#__codelineno-198-1"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span><span class="m">98</span>:00.1
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-199-1" name="__codelineno-199-1" href="#__codelineno-199-1"></a>Unbinding<span class="w"> </span><span class="o">(</span>0x8086,0xbcce<span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">0000</span>:98:00.1<span class="w"> </span>from<span class="w"> </span>dfl-pci
<a id="__codelineno-199-2" name="__codelineno-199-2" href="#__codelineno-199-2"></a>Binding<span class="w"> </span><span class="o">(</span>0x8086,0xbcce<span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">0000</span>:98:00.1<span class="w"> </span>to<span class="w"> </span>vfio-pci
<a id="__codelineno-199-3" name="__codelineno-199-3" href="#__codelineno-199-3"></a>iommu<span class="w"> </span>group<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">(</span>0x8086,0xbcce<span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">0000</span>:98:00.1<span class="w"> </span>is<span class="w"> </span><span class="m">15</span>
</code></pre></div>
</li>
<li>
<p>Use <code>fpgainfo port</code> to verify the ports. There should now be a port entry for PF1. The <strong>Accelerator GUID</strong> for PF1 should be as shown below, which is the GUID for the HE-MEM.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-200-1" name="__codelineno-200-1" href="#__codelineno-200-1"></a><span class="w">  </span>//******<span class="w"> </span>PORT<span class="w"> </span>******//
<a id="__codelineno-200-2" name="__codelineno-200-2" href="#__codelineno-200-2"></a><span class="w">  </span>Interface<span class="w">                        </span>:<span class="w"> </span>DFL
<a id="__codelineno-200-3" name="__codelineno-200-3" href="#__codelineno-200-3"></a><span class="w">  </span>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xEE00000
<a id="__codelineno-200-4" name="__codelineno-200-4" href="#__codelineno-200-4"></a><span class="w">  </span>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.0
<a id="__codelineno-200-5" name="__codelineno-200-5" href="#__codelineno-200-5"></a><span class="w">  </span>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-200-6" name="__codelineno-200-6" href="#__codelineno-200-6"></a><span class="w">  </span>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-200-7" name="__codelineno-200-7" href="#__codelineno-200-7"></a><span class="w">  </span>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-200-8" name="__codelineno-200-8" href="#__codelineno-200-8"></a><span class="w">  </span>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-200-9" name="__codelineno-200-9" href="#__codelineno-200-9"></a><span class="w">  </span>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x00
<a id="__codelineno-200-10" name="__codelineno-200-10" href="#__codelineno-200-10"></a><span class="w">  </span>//******<span class="w"> </span>PORT<span class="w"> </span>******//
<a id="__codelineno-200-11" name="__codelineno-200-11" href="#__codelineno-200-11"></a><span class="w">  </span>Interface<span class="w">                        </span>:<span class="w"> </span>VFIO
<a id="__codelineno-200-12" name="__codelineno-200-12" href="#__codelineno-200-12"></a><span class="w">  </span>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x2098000000000000
<a id="__codelineno-200-13" name="__codelineno-200-13" href="#__codelineno-200-13"></a><span class="w">  </span>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.1
<a id="__codelineno-200-14" name="__codelineno-200-14" href="#__codelineno-200-14"></a><span class="w">  </span>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-200-15" name="__codelineno-200-15" href="#__codelineno-200-15"></a><span class="w">  </span>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-200-16" name="__codelineno-200-16" href="#__codelineno-200-16"></a><span class="w">  </span>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-200-17" name="__codelineno-200-17" href="#__codelineno-200-17"></a><span class="w">  </span>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-200-18" name="__codelineno-200-18" href="#__codelineno-200-18"></a><span class="w">  </span>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x01
<a id="__codelineno-200-19" name="__codelineno-200-19" href="#__codelineno-200-19"></a><span class="w">  </span>Accelerator<span class="w"> </span>GUID<span class="w">                 </span>:<span class="w"> </span>8568ab4e-6ba5-4616-bb65-2a578330a8eb
<a id="__codelineno-200-20" name="__codelineno-200-20" href="#__codelineno-200-20"></a><span class="w">  </span>//******<span class="w"> </span>PORT<span class="w"> </span>******//
<a id="__codelineno-200-21" name="__codelineno-200-21" href="#__codelineno-200-21"></a><span class="w">  </span>Interface<span class="w">                        </span>:<span class="w"> </span>UIO
<a id="__codelineno-200-22" name="__codelineno-200-22" href="#__codelineno-200-22"></a><span class="w">  </span>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xED00000
<a id="__codelineno-200-23" name="__codelineno-200-23" href="#__codelineno-200-23"></a><span class="w">  </span>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.0
<a id="__codelineno-200-24" name="__codelineno-200-24" href="#__codelineno-200-24"></a><span class="w">  </span>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-200-25" name="__codelineno-200-25" href="#__codelineno-200-25"></a><span class="w">  </span>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-200-26" name="__codelineno-200-26" href="#__codelineno-200-26"></a><span class="w">  </span>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-200-27" name="__codelineno-200-27" href="#__codelineno-200-27"></a><span class="w">  </span>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-200-28" name="__codelineno-200-28" href="#__codelineno-200-28"></a><span class="w">  </span>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x01
<a id="__codelineno-200-29" name="__codelineno-200-29" href="#__codelineno-200-29"></a><span class="w">  </span>Accelerator<span class="w"> </span>GUID<span class="w">                 </span>:<span class="w"> </span><span class="m">00000000</span>-0000-0000-0000-000000000000
</code></pre></div>
</li>
</ol>
</li>
</ul>
<ul>
<li>
<p>For 1PF/1VF Minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>:</p>
<ol>
<li>Use <code>opae.io ls</code> to verify that there is one PF.</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-201-1" name="__codelineno-201-1" href="#__codelineno-201-1"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>ls
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-202-1" name="__codelineno-202-1" href="#__codelineno-202-1"></a><span class="o">[</span><span class="m">0000</span>:98:00.0<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086:0xbcce<span class="w"> </span>0x8086:0x1771<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>Acceleration<span class="w"> </span>Development<span class="w"> </span>Platform<span class="w"> </span>N6001<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
</code></pre></div>
<ol>
<li>
<p>Use <code>lspci</code> to verify that there is 1 VF on PF0.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-203-1" name="__codelineno-203-1" href="#__codelineno-203-1"></a>sudo<span class="w"> </span>lspci<span class="w"> </span>-vvv<span class="w"> </span>-s<span class="w"> </span><span class="m">98</span>:00.0<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>VF
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-204-1" name="__codelineno-204-1" href="#__codelineno-204-1"></a>Initial<span class="w"> </span>VFs:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>Total<span class="w"> </span>VFs:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>VFs:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>Function<span class="w"> </span>Dependency<span class="w"> </span>Link:<span class="w"> </span><span class="m">00</span>
<a id="__codelineno-204-2" name="__codelineno-204-2" href="#__codelineno-204-2"></a>VF<span class="w"> </span>offset:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>stride:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>Device<span class="w"> </span>ID:<span class="w"> </span>bcce
<a id="__codelineno-204-3" name="__codelineno-204-3" href="#__codelineno-204-3"></a>VF<span class="w"> </span>Migration:<span class="w"> </span>offset:<span class="w"> </span><span class="m">00000000</span>,<span class="w"> </span>BIR:<span class="w"> </span><span class="m">0</span>
</code></pre></div>
</li>
<li>
<p>Use <code>fpgainfo port</code> to verify the ports.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-205-1" name="__codelineno-205-1" href="#__codelineno-205-1"></a>sudo<span class="w"> </span>fpgainfo<span class="w"> </span>port
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-206-1" name="__codelineno-206-1" href="#__codelineno-206-1"></a>//******<span class="w"> </span>PORT<span class="w"> </span>******//
<a id="__codelineno-206-2" name="__codelineno-206-2" href="#__codelineno-206-2"></a>Interface<span class="w">                        </span>:<span class="w"> </span>DFL
<a id="__codelineno-206-3" name="__codelineno-206-3" href="#__codelineno-206-3"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xEE00000
<a id="__codelineno-206-4" name="__codelineno-206-4" href="#__codelineno-206-4"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.0
<a id="__codelineno-206-5" name="__codelineno-206-5" href="#__codelineno-206-5"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-206-6" name="__codelineno-206-6" href="#__codelineno-206-6"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-206-7" name="__codelineno-206-7" href="#__codelineno-206-7"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-206-8" name="__codelineno-206-8" href="#__codelineno-206-8"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-206-9" name="__codelineno-206-9" href="#__codelineno-206-9"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x00
<a id="__codelineno-206-10" name="__codelineno-206-10" href="#__codelineno-206-10"></a>//******<span class="w"> </span>PORT<span class="w"> </span>******//
<a id="__codelineno-206-11" name="__codelineno-206-11" href="#__codelineno-206-11"></a>Interface<span class="w">                        </span>:<span class="w"> </span>UIO
<a id="__codelineno-206-12" name="__codelineno-206-12" href="#__codelineno-206-12"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xED00000
<a id="__codelineno-206-13" name="__codelineno-206-13" href="#__codelineno-206-13"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.0
<a id="__codelineno-206-14" name="__codelineno-206-14" href="#__codelineno-206-14"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-206-15" name="__codelineno-206-15" href="#__codelineno-206-15"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-206-16" name="__codelineno-206-16" href="#__codelineno-206-16"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-206-17" name="__codelineno-206-17" href="#__codelineno-206-17"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-206-18" name="__codelineno-206-18" href="#__codelineno-206-18"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x01
<a id="__codelineno-206-19" name="__codelineno-206-19" href="#__codelineno-206-19"></a>Accelerator<span class="w"> </span>GUID<span class="w">                 </span>:<span class="w"> </span><span class="m">00000000</span>-0000-0000-0000-000000000000
</code></pre></div>
</li>
<li>
<p>Initialize one virtual function</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-207-1" name="__codelineno-207-1" href="#__codelineno-207-1"></a>sudo<span class="w"> </span>pci_device<span class="w"> </span><span class="m">0000</span>:98:00.0<span class="w"> </span>vf<span class="w"> </span><span class="m">1</span>
</code></pre></div>
</li>
<li>
<p>Use <code>opae.io ls</code> to verify the VF has been initialized.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-208-1" name="__codelineno-208-1" href="#__codelineno-208-1"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>ls
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-209-1" name="__codelineno-209-1" href="#__codelineno-209-1"></a><span class="o">[</span><span class="m">0000</span>:98:00.0<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086:0xbcce<span class="w"> </span>0x8086:0x1771<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>Acceleration<span class="w"> </span>Development<span class="w"> </span>Platform<span class="w"> </span>N6001<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
<a id="__codelineno-209-2" name="__codelineno-209-2" href="#__codelineno-209-2"></a><span class="o">[</span><span class="m">0000</span>:98:00.1<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086:0xbccf<span class="w"> </span>0x8086:0x1771<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>Acceleration<span class="w"> </span>Development<span class="w"> </span>Platform<span class="w"> </span>N6001<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
</code></pre></div>
</li>
<li>
<p>Bind the <abbr title="Virtual Function Input/Output, An IOMMU/device agnostic framework for exposing direct device access to userspace.">VFIO</abbr> driver on VF0</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-210-1" name="__codelineno-210-1" href="#__codelineno-210-1"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:98:00.1
</code></pre></div>
</li>
<li>
<p>Use <code>fpgainfo port</code> to verify the ports. There should now be a port entry for VF0. The <strong>Accelerator GUID</strong> for VF0 should be as shown below, which is the GUID for the HE-MEM.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-211-1" name="__codelineno-211-1" href="#__codelineno-211-1"></a>sudo<span class="w"> </span>fpgainfo<span class="w"> </span>port
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-212-1" name="__codelineno-212-1" href="#__codelineno-212-1"></a>//******<span class="w"> </span>PORT<span class="w"> </span>******//
<a id="__codelineno-212-2" name="__codelineno-212-2" href="#__codelineno-212-2"></a>Interface<span class="w">                        </span>:<span class="w"> </span>DFL
<a id="__codelineno-212-3" name="__codelineno-212-3" href="#__codelineno-212-3"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xEE00000
<a id="__codelineno-212-4" name="__codelineno-212-4" href="#__codelineno-212-4"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.0
<a id="__codelineno-212-5" name="__codelineno-212-5" href="#__codelineno-212-5"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-212-6" name="__codelineno-212-6" href="#__codelineno-212-6"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-212-7" name="__codelineno-212-7" href="#__codelineno-212-7"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-212-8" name="__codelineno-212-8" href="#__codelineno-212-8"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-212-9" name="__codelineno-212-9" href="#__codelineno-212-9"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x00
<a id="__codelineno-212-10" name="__codelineno-212-10" href="#__codelineno-212-10"></a>//******<span class="w"> </span>PORT<span class="w"> </span>******//
<a id="__codelineno-212-11" name="__codelineno-212-11" href="#__codelineno-212-11"></a>Interface<span class="w">                        </span>:<span class="w"> </span>VFIO
<a id="__codelineno-212-12" name="__codelineno-212-12" href="#__codelineno-212-12"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x2098000000000000
<a id="__codelineno-212-13" name="__codelineno-212-13" href="#__codelineno-212-13"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.1
<a id="__codelineno-212-14" name="__codelineno-212-14" href="#__codelineno-212-14"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-212-15" name="__codelineno-212-15" href="#__codelineno-212-15"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCF
<a id="__codelineno-212-16" name="__codelineno-212-16" href="#__codelineno-212-16"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-212-17" name="__codelineno-212-17" href="#__codelineno-212-17"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-212-18" name="__codelineno-212-18" href="#__codelineno-212-18"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x01
<a id="__codelineno-212-19" name="__codelineno-212-19" href="#__codelineno-212-19"></a>Accelerator<span class="w"> </span>GUID<span class="w">                 </span>:<span class="w"> </span>8568ab4e-6ba5-4616-bb65-2a578330a8eb
<a id="__codelineno-212-20" name="__codelineno-212-20" href="#__codelineno-212-20"></a>//******<span class="w"> </span>PORT<span class="w"> </span>******//
<a id="__codelineno-212-21" name="__codelineno-212-21" href="#__codelineno-212-21"></a>Interface<span class="w">                        </span>:<span class="w"> </span>UIO
<a id="__codelineno-212-22" name="__codelineno-212-22" href="#__codelineno-212-22"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xED00000
<a id="__codelineno-212-23" name="__codelineno-212-23" href="#__codelineno-212-23"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.0
<a id="__codelineno-212-24" name="__codelineno-212-24" href="#__codelineno-212-24"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-212-25" name="__codelineno-212-25" href="#__codelineno-212-25"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-212-26" name="__codelineno-212-26" href="#__codelineno-212-26"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-212-27" name="__codelineno-212-27" href="#__codelineno-212-27"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-212-28" name="__codelineno-212-28" href="#__codelineno-212-28"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x01
<a id="__codelineno-212-29" name="__codelineno-212-29" href="#__codelineno-212-29"></a>Accelerator<span class="w"> </span>GUID<span class="w">                 </span>:<span class="w"> </span><span class="m">00000000</span>-0000-0000-0000-000000000000
</code></pre></div>
</li>
</ol>
</li>
</ul>
</li>
</ol>
<h3 id="46-migrate-to-a-different-agilex-device-number"><strong>4.6 Migrate to a Different Agilex Device Number</strong><a class="headerlink" href="#46-migrate-to-a-different-agilex-device-number" title="Permanent link">&para;</a></h3>
<p>The following instructions enable a user to change the device part number of the Intel® FPGA SmartNIC N6001-PL. Please be aware that this release works with Agilex® 7 FPGA devices that have P tile for PCIe and E tile for Ethernet.  Other tiles will take further work.</p>
<p>You may wish to change the device part number for the following reasons</p>
<ol>
<li>Migrate to same device package but with a different density</li>
<li>Migrate to a different package and with a different or same density</li>
</ol>
<p>The default device for the Intel® FPGA SmartNIC N6001-PL is AGFB014R24A2E2V</p>
<h4 id="461-walkthrough-migrate-to-a-different-agilex-device-number"><strong>4.6.1 Walkthrough: Migrate to a Different Agilex Device Number</strong><a class="headerlink" href="#461-walkthrough-migrate-to-a-different-agilex-device-number" title="Permanent link">&para;</a></h4>
<p>Perform the following steps to migrate your design to target a different Agilex device using the OFSS build flow. In this example we will change the device from the default <code>AGFB014R24A2E2V</code> to a new device <code>AGFB022R25A2E2V</code>. This walkthrough will target the n6001, but similar steps can be used for the n6000.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Modify the <code>part</code> field in the <code>$OFS_ROOTDIR/tools/ofss_config/n6001_base.ofss</code> file to use <code>AGFB022R25A2E2V</code>. This is only necessary if you are using the OFSS flow.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-213-1" name="__codelineno-213-1" href="#__codelineno-213-1"></a><span class="o">[</span>ip<span class="o">]</span>
<a id="__codelineno-213-2" name="__codelineno-213-2" href="#__codelineno-213-2"></a><span class="nb">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ofs
<a id="__codelineno-213-3" name="__codelineno-213-3" href="#__codelineno-213-3"></a>
<a id="__codelineno-213-4" name="__codelineno-213-4" href="#__codelineno-213-4"></a><span class="o">[</span>settings<span class="o">]</span>
<a id="__codelineno-213-5" name="__codelineno-213-5" href="#__codelineno-213-5"></a><span class="nv">platform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>n6001
<a id="__codelineno-213-6" name="__codelineno-213-6" href="#__codelineno-213-6"></a><span class="nv">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>agilex
<a id="__codelineno-213-7" name="__codelineno-213-7" href="#__codelineno-213-7"></a><span class="nv">fim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>base_x16
<a id="__codelineno-213-8" name="__codelineno-213-8" href="#__codelineno-213-8"></a><span class="nv">part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>AGFB022R25A2E2V
<a id="__codelineno-213-9" name="__codelineno-213-9" href="#__codelineno-213-9"></a><span class="nv">device_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6001</span>
</code></pre></div>
</li>
<li>
<p>Modify the <code>DEVICE</code> field in the <code>$OFS_ROOTDIR/syn/board/n6001/syn_top/ofs_top.qsf</code> file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-214-1" name="__codelineno-214-1" href="#__codelineno-214-1"></a><span class="c1">############################################################################################</span>
<a id="__codelineno-214-2" name="__codelineno-214-2" href="#__codelineno-214-2"></a><span class="c1"># FPGA Device</span>
<a id="__codelineno-214-3" name="__codelineno-214-3" href="#__codelineno-214-3"></a><span class="c1">############################################################################################</span>
<a id="__codelineno-214-4" name="__codelineno-214-4" href="#__codelineno-214-4"></a>
<a id="__codelineno-214-5" name="__codelineno-214-5" href="#__codelineno-214-5"></a>set_global_assignment<span class="w"> </span>-name<span class="w"> </span>FAMILY<span class="w"> </span>Agilex
<a id="__codelineno-214-6" name="__codelineno-214-6" href="#__codelineno-214-6"></a>set_global_assignment<span class="w"> </span>-name<span class="w"> </span>DEVICE<span class="w"> </span>AGFB022R25A2E2V
</code></pre></div>
</li>
<li>
<p>Modify the <code>DEVICE</code> field in the <code>$OFS_ROOTDIR/syn/board/n6001/syn_top/ofs_pr_afu.qsf</code> file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-215-1" name="__codelineno-215-1" href="#__codelineno-215-1"></a><span class="c1">############################################################################################</span>
<a id="__codelineno-215-2" name="__codelineno-215-2" href="#__codelineno-215-2"></a><span class="c1"># FPGA Device</span>
<a id="__codelineno-215-3" name="__codelineno-215-3" href="#__codelineno-215-3"></a><span class="c1">############################################################################################</span>
<a id="__codelineno-215-4" name="__codelineno-215-4" href="#__codelineno-215-4"></a>
<a id="__codelineno-215-5" name="__codelineno-215-5" href="#__codelineno-215-5"></a>set_global_assignment<span class="w"> </span>-name<span class="w"> </span>FAMILY<span class="w"> </span>Agilex
<a id="__codelineno-215-6" name="__codelineno-215-6" href="#__codelineno-215-6"></a>set_global_assignment<span class="w"> </span>-name<span class="w"> </span>DEVICE<span class="w"> </span>AGFB022R25A2E2V
</code></pre></div>
</li>
<li>
<p>Modify the <code>DEVICE</code> field in te <code>$OFS_ROOTDIR/ipss/pmci/pmci_ss.qsf</code> file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-216-1" name="__codelineno-216-1" href="#__codelineno-216-1"></a>set_global_assignment<span class="w"> </span>-name<span class="w"> </span>DEVICE<span class="w"> </span>AGFB022R25A2E2V
</code></pre></div>
</li>
<li>
<p>If you are changing to a device with a different package, you must change the pin assignments in the location files. If you would like Quartus to attempt to pin out the design automatically, you may remove all pin assignments instead. Typically you will be required to set certain pins manually in order to guide Quartus for a successful compile (e.g. transceiver reference clocks). In this example we will start by commenting out all of the pin constraints in the following files and attempt to let Quartus pin out the design as much as possibe:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-217-1" name="__codelineno-217-1" href="#__codelineno-217-1"></a><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/setup/emif_loc.tcl
<a id="__codelineno-217-2" name="__codelineno-217-2" href="#__codelineno-217-2"></a><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/setup/hps_loc.tcl
<a id="__codelineno-217-3" name="__codelineno-217-3" href="#__codelineno-217-3"></a><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/setup/pmci_loc.tcl
<a id="__codelineno-217-4" name="__codelineno-217-4" href="#__codelineno-217-4"></a><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/setup/top_loc.tcl
</code></pre></div>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-218-1" name="__codelineno-218-1" href="#__codelineno-218-1"></a><span class="c1">#set_location_assignment PIN_CU26 -to hssi_rec_clk[0]</span>
</code></pre></div>
</li>
<li>
<p>Identify the pins you wish to assign prior to compiling. In this example, we will re-pin some of the reference clocks to help guide the fitter. Refer to the <a href="https://www.intel.com/content/www/us/en/support/programmable/support-resources/devices/lit-dp.html">Pin-Out Files for Intel FPGAs</a> for the pin list of your device. In this example, the <em>Migration Re-Pin Mapping</em> table below shows the pins we will re-pin in the constraints files.</p>
<p><em>Table: Migration Re-Pin Mapping</em></p>
<table>
<thead>
<tr>
<th>Pin Name</th>
<th><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Signal Name</th>
<th>AGF 014 R24A Pin #</th>
<th>AGF 022 R25A Pin #</th>
</tr>
</thead>
<tbody>
<tr>
<td>REFCLK_GXER9A_CH0p</td>
<td><code>cr3_cpri_reflclk_clk[0]</code></td>
<td>PIN_AT13</td>
<td>PIN_CE18</td>
</tr>
<tr>
<td>REFCLK_GXER9A_CH0n</td>
<td><code>"cr3_cpri_reflclk_clk[0](n)"</code></td>
<td>PIN_AP13</td>
<td>PIN_CA18</td>
</tr>
<tr>
<td>REFCLK_GXER9A_CH1p</td>
<td><code>cr3_cpri_refclk_clk[1]</code></td>
<td>PIN_AR14</td>
<td>PIN_CC19</td>
</tr>
<tr>
<td>REFCLK_GXER9A_CH1n</td>
<td><code>"cr3_cpri_refclk_clk[1](n)"</code></td>
<td>PIN_AN14</td>
<td>PIN_BW19</td>
</tr>
<tr>
<td>REFCLK_GXER9A_CH2p</td>
<td><code>cr3_cpri_refclk_clk[2]</code></td>
<td>PIN_AJ12</td>
<td>PIN_BL17</td>
</tr>
<tr>
<td>REFCLK_GXER9A_CH2n</td>
<td><code>"cr3_cpri_refclk_clk[2](n)"</code></td>
<td>PIN_AH11</td>
<td>PIN_BJ15</td>
</tr>
<tr>
<td>REFCLK_GXER9A_CH3p</td>
<td><code>qsfp_ref_clk</code></td>
<td>PIN_AK13</td>
<td>PIN_BN18</td>
</tr>
<tr>
<td>REFCLK_GXER9A_CH3n</td>
<td><code>"qsfp_ref_clk(n)"</code></td>
<td>PIN_AH13</td>
<td>PIN_BJ18</td>
</tr>
<tr>
<td>REFCLK_GXER9A_CH4p</td>
<td><code>cr3_cpri_reflclk_clk_184_32m</code></td>
<td>PIN_AJ14</td>
<td>PIN_BL19</td>
</tr>
<tr>
<td>REFCLK_GXER9A_CH4n</td>
<td><code>"cr3_cpri_reflclk_clk_184_32m(n)"</code></td>
<td>PIN_AL14</td>
<td>PIN_BR19</td>
</tr>
<tr>
<td>REFCLK_GXER9A_CH5p</td>
<td><code>cr3_cpri_reflclk_clk_153_6m</code></td>
<td>PIN_AR16</td>
<td>PIN_CC21</td>
</tr>
<tr>
<td>REFCLK_GXER9A_CH5n</td>
<td><code>"cr3_cpri_reflclk_clk_153_6m(n)"</code></td>
<td>PIN_AN16</td>
<td>PIN_BW21</td>
</tr>
<tr>
<td>REFCLK_GXPL10A_CH0n</td>
<td><code>"PCIE_REFCLK0(n)"</code></td>
<td>PIN_AH49</td>
<td>PIN_DD56</td>
</tr>
<tr>
<td>REFCLK_GXPL10A_CH0p</td>
<td><code>PCIE_REFCLK0</code></td>
<td>PIN_AJ48</td>
<td>PIN_DF57</td>
</tr>
<tr>
<td>REFCLK_GXPL10A_CH2n</td>
<td><code>"PCIE_REFCLK1(n)"</code></td>
<td>PIN_AD49</td>
<td>PIN_CT56</td>
</tr>
<tr>
<td>REFCLK_GXPL10A_CH2p</td>
<td><code>PCIE_REFCLK1</code></td>
<td>PIN_AE48</td>
<td>PIN_CV57</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Re-pin the reference clocks defined in <code>$OFS_ROOTDIR/syn/board/n6001/setup/top_loc.tcl</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-219-1" name="__codelineno-219-1" href="#__codelineno-219-1"></a>set_location_assignment<span class="w"> </span>PIN_BN18<span class="w"> </span>-to<span class="w"> </span>qsfp_ref_clk
<a id="__codelineno-219-2" name="__codelineno-219-2" href="#__codelineno-219-2"></a>set_location_assignment<span class="w"> </span>PIN_BJ18<span class="w"> </span>-to<span class="w"> </span><span class="s2">&quot;qsfp_ref_clk(n)&quot;</span>
<a id="__codelineno-219-3" name="__codelineno-219-3" href="#__codelineno-219-3"></a>set_location_assignment<span class="w"> </span>PIN_CC19<span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">1</span><span class="o">]</span>
<a id="__codelineno-219-4" name="__codelineno-219-4" href="#__codelineno-219-4"></a>set_location_assignment<span class="w"> </span>PIN_BW19<span class="w"> </span>-to<span class="w"> </span><span class="s2">&quot;cr3_cpri_refclk_clk[1](n)&quot;</span>
<a id="__codelineno-219-5" name="__codelineno-219-5" href="#__codelineno-219-5"></a>set_location_assignment<span class="w"> </span>PIN_BL17<span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">2</span><span class="o">]</span>
<a id="__codelineno-219-6" name="__codelineno-219-6" href="#__codelineno-219-6"></a>set_location_assignment<span class="w"> </span>PIN_BJ15<span class="w"> </span>-to<span class="w"> </span><span class="s2">&quot;cr3_cpri_refclk_clk[2](n)&quot;</span>
<a id="__codelineno-219-7" name="__codelineno-219-7" href="#__codelineno-219-7"></a>set_location_assignment<span class="w"> </span>PIN_CE18<span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk<span class="o">[</span><span class="m">0</span><span class="o">]</span>
<a id="__codelineno-219-8" name="__codelineno-219-8" href="#__codelineno-219-8"></a>set_location_assignment<span class="w"> </span>PIN_CA18<span class="w"> </span>-to<span class="w"> </span><span class="s2">&quot;cr3_cpri_reflclk_clk[0](n)&quot;</span>
<a id="__codelineno-219-9" name="__codelineno-219-9" href="#__codelineno-219-9"></a>set_location_assignment<span class="w"> </span>PIN_BL19<span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_184_32m
<a id="__codelineno-219-10" name="__codelineno-219-10" href="#__codelineno-219-10"></a>set_location_assignment<span class="w"> </span>PIN_BR19<span class="w"> </span>-to<span class="w"> </span><span class="s2">&quot;cr3_cpri_reflclk_clk_184_32m(n)&quot;</span>
<a id="__codelineno-219-11" name="__codelineno-219-11" href="#__codelineno-219-11"></a>set_location_assignment<span class="w"> </span>PIN_CC21<span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_153_6m
<a id="__codelineno-219-12" name="__codelineno-219-12" href="#__codelineno-219-12"></a>set_location_assignment<span class="w"> </span>PIN_BW21<span class="w"> </span>-to<span class="w"> </span><span class="s2">&quot;cr3_cpri_reflclk_clk_153_6m(n)&quot;</span>
<a id="__codelineno-219-13" name="__codelineno-219-13" href="#__codelineno-219-13"></a>
<a id="__codelineno-219-14" name="__codelineno-219-14" href="#__codelineno-219-14"></a>set_location_assignment<span class="w"> </span>PIN_DD56<span class="w"> </span>-to<span class="w"> </span><span class="s2">&quot;PCIE_REFCLK0(n)&quot;</span>
<a id="__codelineno-219-15" name="__codelineno-219-15" href="#__codelineno-219-15"></a>set_location_assignment<span class="w"> </span>PIN_DF57<span class="w"> </span>-to<span class="w"> </span>PCIE_REFCLK0
<a id="__codelineno-219-16" name="__codelineno-219-16" href="#__codelineno-219-16"></a>set_location_assignment<span class="w"> </span>PIN_CT56<span class="w"> </span>-to<span class="w"> </span><span class="s2">&quot;PCIE_REFCLK1(n)&quot;</span>
<a id="__codelineno-219-17" name="__codelineno-219-17" href="#__codelineno-219-17"></a>set_location_assignment<span class="w"> </span>PIN_CV57<span class="w"> </span>-to<span class="w"> </span>PCIE_REFCLK1
</code></pre></div>
</li>
<li>
<p>Un-comment the instance assignemnts for the transceiver reference clocks defined in <code>$OFS_ROOTDIR/syn/board/n6001/setup/top_loc.tcl</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-220-1" name="__codelineno-220-1" href="#__codelineno-220-1"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>IO_STANDARD<span class="w"> </span><span class="s2">&quot;DIFFERENTIAL LVPECL&quot;</span><span class="w"> </span>-to<span class="w"> </span>qsfp_ref_clk
<a id="__codelineno-220-2" name="__codelineno-220-2" href="#__codelineno-220-2"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_enable_termination=enable_term&quot;</span><span class="w"> </span>-to<span class="w"> </span>qsfp_ref_clk
<a id="__codelineno-220-3" name="__codelineno-220-3" href="#__codelineno-220-3"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_enable_3p3v=disable_3p3v_tol&quot;</span><span class="w"> </span>-to<span class="w"> </span>qsfp_ref_clk
<a id="__codelineno-220-4" name="__codelineno-220-4" href="#__codelineno-220-4"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_disable_hysteresis=enable_hyst&quot;</span><span class="w"> </span>-to<span class="w"> </span>qsfp_ref_clk
<a id="__codelineno-220-5" name="__codelineno-220-5" href="#__codelineno-220-5"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_input_freq=156250000&quot;</span><span class="w"> </span>-to<span class="w"> </span>qsfp_ref_clk
<a id="__codelineno-220-6" name="__codelineno-220-6" href="#__codelineno-220-6"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_powerdown_mode=false&quot;</span><span class="w"> </span>-to<span class="w"> </span>qsfp_ref_clk
<a id="__codelineno-220-7" name="__codelineno-220-7" href="#__codelineno-220-7"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_use_as_bti_clock=TRUE&quot;</span><span class="w"> </span>-to<span class="w"> </span>qsfp_ref_clk
<a id="__codelineno-220-8" name="__codelineno-220-8" href="#__codelineno-220-8"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>IO_STANDARD<span class="w"> </span><span class="s2">&quot;DIFFERENTIAL LVPECL&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">1</span><span class="o">]</span>
<a id="__codelineno-220-9" name="__codelineno-220-9" href="#__codelineno-220-9"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_enable_termination=enable_term&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">1</span><span class="o">]</span>
<a id="__codelineno-220-10" name="__codelineno-220-10" href="#__codelineno-220-10"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_enable_3p3v=disable_3p3v_tol&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">1</span><span class="o">]</span>
<a id="__codelineno-220-11" name="__codelineno-220-11" href="#__codelineno-220-11"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_disable_hysteresis=enable_hyst&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">1</span><span class="o">]</span>
<a id="__codelineno-220-12" name="__codelineno-220-12" href="#__codelineno-220-12"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_input_freq=184320000&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">1</span><span class="o">]</span>
<a id="__codelineno-220-13" name="__codelineno-220-13" href="#__codelineno-220-13"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_powerdown_mode=false&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">1</span><span class="o">]</span>
<a id="__codelineno-220-14" name="__codelineno-220-14" href="#__codelineno-220-14"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_use_as_bti_clock=FALSE&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">1</span><span class="o">]</span>
<a id="__codelineno-220-15" name="__codelineno-220-15" href="#__codelineno-220-15"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>IO_STANDARD<span class="w"> </span><span class="s2">&quot;DIFFERENTIAL LVPECL&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">2</span><span class="o">]</span>
<a id="__codelineno-220-16" name="__codelineno-220-16" href="#__codelineno-220-16"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_enable_termination=enable_term&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">2</span><span class="o">]</span>
<a id="__codelineno-220-17" name="__codelineno-220-17" href="#__codelineno-220-17"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_enable_3p3v=disable_3p3v_tol&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">2</span><span class="o">]</span>
<a id="__codelineno-220-18" name="__codelineno-220-18" href="#__codelineno-220-18"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_disable_hysteresis=enable_hyst&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">2</span><span class="o">]</span>
<a id="__codelineno-220-19" name="__codelineno-220-19" href="#__codelineno-220-19"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_input_freq=153600000&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">2</span><span class="o">]</span>
<a id="__codelineno-220-20" name="__codelineno-220-20" href="#__codelineno-220-20"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_powerdown_mode=false&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">2</span><span class="o">]</span>
<a id="__codelineno-220-21" name="__codelineno-220-21" href="#__codelineno-220-21"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_use_as_bti_clock=FALSE&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_refclk_clk<span class="o">[</span><span class="m">2</span><span class="o">]</span>
<a id="__codelineno-220-22" name="__codelineno-220-22" href="#__codelineno-220-22"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>IO_STANDARD<span class="w"> </span><span class="s2">&quot;DIFFERENTIAL LVPECL&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk<span class="o">[</span><span class="m">0</span><span class="o">]</span>
<a id="__codelineno-220-23" name="__codelineno-220-23" href="#__codelineno-220-23"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_enable_termination=enable_term&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk<span class="o">[</span><span class="m">0</span><span class="o">]</span>
<a id="__codelineno-220-24" name="__codelineno-220-24" href="#__codelineno-220-24"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_enable_3p3v=disable_3p3v_tol&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk<span class="o">[</span><span class="m">0</span><span class="o">]</span>
<a id="__codelineno-220-25" name="__codelineno-220-25" href="#__codelineno-220-25"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_disable_hysteresis=enable_hyst&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk<span class="o">[</span><span class="m">0</span><span class="o">]</span>
<a id="__codelineno-220-26" name="__codelineno-220-26" href="#__codelineno-220-26"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_input_freq=245760000&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk<span class="o">[</span><span class="m">0</span><span class="o">]</span>
<a id="__codelineno-220-27" name="__codelineno-220-27" href="#__codelineno-220-27"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_powerdown_mode=false&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk<span class="o">[</span><span class="m">0</span><span class="o">]</span>
<a id="__codelineno-220-28" name="__codelineno-220-28" href="#__codelineno-220-28"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_use_as_bti_clock=FALSE&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk<span class="o">[</span><span class="m">0</span><span class="o">]</span>
<a id="__codelineno-220-29" name="__codelineno-220-29" href="#__codelineno-220-29"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>IO_STANDARD<span class="w"> </span><span class="s2">&quot;DIFFERENTIAL LVPECL&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_184_32m
<a id="__codelineno-220-30" name="__codelineno-220-30" href="#__codelineno-220-30"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_enable_termination=enable_term&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_184_32m
<a id="__codelineno-220-31" name="__codelineno-220-31" href="#__codelineno-220-31"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_enable_3p3v=enable_3p3v_tol&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_184_32m
<a id="__codelineno-220-32" name="__codelineno-220-32" href="#__codelineno-220-32"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_disable_hysteresis=enable_hyst&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_184_32m
<a id="__codelineno-220-33" name="__codelineno-220-33" href="#__codelineno-220-33"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_input_freq=184320000&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_184_32m
<a id="__codelineno-220-34" name="__codelineno-220-34" href="#__codelineno-220-34"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_powerdown_mode=false&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_184_32m
<a id="__codelineno-220-35" name="__codelineno-220-35" href="#__codelineno-220-35"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_use_as_bti_clock=FALSE&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_184_32m
<a id="__codelineno-220-36" name="__codelineno-220-36" href="#__codelineno-220-36"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>IO_STANDARD<span class="w"> </span><span class="s2">&quot;DIFFERENTIAL LVPECL&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_153_6m
<a id="__codelineno-220-37" name="__codelineno-220-37" href="#__codelineno-220-37"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_enable_termination=enable_term&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_153_6m
<a id="__codelineno-220-38" name="__codelineno-220-38" href="#__codelineno-220-38"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_enable_3p3v=enable_3p3v_tol&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_153_6m
<a id="__codelineno-220-39" name="__codelineno-220-39" href="#__codelineno-220-39"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_disable_hysteresis=enable_hyst&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_153_6m
<a id="__codelineno-220-40" name="__codelineno-220-40" href="#__codelineno-220-40"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_input_freq=153600000&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_153_6m
<a id="__codelineno-220-41" name="__codelineno-220-41" href="#__codelineno-220-41"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_powerdown_mode=false&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_153_6m
<a id="__codelineno-220-42" name="__codelineno-220-42" href="#__codelineno-220-42"></a>set_instance_assignment<span class="w"> </span>-name<span class="w"> </span>HSSI_PARAMETER<span class="w"> </span><span class="s2">&quot;refclk_divider_use_as_bti_clock=FALSE&quot;</span><span class="w"> </span>-to<span class="w"> </span>cr3_cpri_reflclk_clk_153_6m
</code></pre></div>
</li>
<li>
<p>Compile a flat design. It is recommended to compile a flat design first before incorporating a <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region in the design. This reduces design complexity while you determine the correct pinout for your design.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-221-1" name="__codelineno-221-1" href="#__codelineno-221-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-221-2" name="__codelineno-221-2" href="#__codelineno-221-2"></a>
<a id="__codelineno-221-3" name="__codelineno-221-3" href="#__codelineno-221-3"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001:flat<span class="w"> </span>work_n6001_migrate_device_ofss
</code></pre></div>
</li>
<li>
<p>The compile should succeed. If the compile fails with errors relating to the pinout, review the error messages and modify the pinout.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-222-1" name="__codelineno-222-1" href="#__codelineno-222-1"></a>***********************************
<a id="__codelineno-222-2" name="__codelineno-222-2" href="#__codelineno-222-2"></a>***
<a id="__codelineno-222-3" name="__codelineno-222-3" href="#__codelineno-222-3"></a>***<span class="w">        </span>OFS_PROJECT:<span class="w"> </span>n6001
<a id="__codelineno-222-4" name="__codelineno-222-4" href="#__codelineno-222-4"></a>***<span class="w">        </span>OFS_BOARD:<span class="w"> </span>n6001
<a id="__codelineno-222-5" name="__codelineno-222-5" href="#__codelineno-222-5"></a>***<span class="w">        </span>Q_PROJECT:<span class="w">  </span>ofs_top
<a id="__codelineno-222-6" name="__codelineno-222-6" href="#__codelineno-222-6"></a>***<span class="w">        </span>Q_REVISION:<span class="w"> </span>ofs_top
<a id="__codelineno-222-7" name="__codelineno-222-7" href="#__codelineno-222-7"></a>***<span class="w">        </span>SEED:<span class="w"> </span><span class="m">3</span>
<a id="__codelineno-222-8" name="__codelineno-222-8" href="#__codelineno-222-8"></a>***<span class="w">        </span>Build<span class="w"> </span>Complete
<a id="__codelineno-222-9" name="__codelineno-222-9" href="#__codelineno-222-9"></a>***<span class="w">        </span>Timing<span class="w"> </span>Passed!
<a id="__codelineno-222-10" name="__codelineno-222-10" href="#__codelineno-222-10"></a>***
<a id="__codelineno-222-11" name="__codelineno-222-11" href="#__codelineno-222-11"></a>***********************************
</code></pre></div>
</li>
<li>
<p>After a successful compile, to preserve pin assignemnts you must hard code the new pin asigments back to the constraints files.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-223-1" name="__codelineno-223-1" href="#__codelineno-223-1"></a><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/setup/emif_loc.tcl
<a id="__codelineno-223-2" name="__codelineno-223-2" href="#__codelineno-223-2"></a><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/setup/hps_loc.tcl
<a id="__codelineno-223-3" name="__codelineno-223-3" href="#__codelineno-223-3"></a><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/setup/pmci_loc.tcl
<a id="__codelineno-223-4" name="__codelineno-223-4" href="#__codelineno-223-4"></a><span class="nv">$OFS_ROOTDIR</span>/syn/board/n6001/setup/top_loc.tcl
</code></pre></div>
</li>
</ol>
<h3 id="47-modify-the-memory-sub-system"><strong>4.7 Modify the Memory Sub-System</strong><a class="headerlink" href="#47-modify-the-memory-sub-system" title="Permanent link">&para;</a></h3>
<p><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> allows modifications on the Memory Sub-System in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. This section provides an example walkthrough for modifiying the Memory-SS.</p>
<h4 id="471-walkthrough-modify-the-memory-sub-system-using-ip-presets-with-ofss"><strong>4.7.1 Walkthrough: Modify the Memory Sub-System Using IP Presets With OFSS</strong><a class="headerlink" href="#471-walkthrough-modify-the-memory-sub-system-using-ip-presets-with-ofss" title="Permanent link">&para;</a></h4>
<p>This walkthrough will go through the flow of modifying the Memory-SS in the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. In this example, we will enable ECC on memory channels 0-3. Note that routes for the ECC pins on Channels 0 and 1 are not physiclly present on standard n6001/n6000 board hardware; the purpose of this walkthrough is only to show an example of how to make modifications to the IP. This walkthrough targets the n6001 board, but similar steps can be used for the n6000.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Open the Memory Subsystem <code>mem_ss.ip</code> in IP Parameter Editor</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-224-1" name="__codelineno-224-1" href="#__codelineno-224-1"></a>qsys-edit<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ipss/mem/qip/mem_ss/mem_ss.ip
</code></pre></div>
</li>
<li>
<p>The Memory Subsystem IP will open in IP Parameter Editor. Click <strong>Dive Into Packaged Subsystem</strong>.</p>
<p><a class="glightbox" href="../images/mem_ss_dive_into_packaged_ss.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/mem_ss_dive_into_packaged_ss.png" /></a></p>
</li>
<li>
<p>The Platform Designer mem_ss view opens. All of the EMIFs are shown in the <strong>Filter</strong> window.</p>
<p><a class="glightbox" href="../images/mem_ss_pd_view.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/mem_ss_pd_view.png" /></a></p>
</li>
<li>
<p>Click each EMIF 0 through 3 and perform the following actions.</p>
<ol>
<li>
<p>In the <strong>Parameters</strong> window, click the <strong>Memory</strong> tab and change the <strong>DQ width</strong> to <code>40</code>.</p>
<p><a class="glightbox" href="../images/mem_ss_pd_memory_tab.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/mem_ss_pd_memory_tab.png" /></a></p>
</li>
<li>
<p>In the <strong>Parameters</strong> window, click the <strong>Controller</strong> tab.</p>
<p><a class="glightbox" href="../images/mem_ss_pd_controller_tab.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/mem_ss_pd_controller_tab.png" /></a></p>
</li>
<li>
<p>Scroll down and check the box for <code>Enable Error Detection and Correction Logic with ECC</code>. </p>
<p><a class="glightbox" href="../images/mem_ss_pd_controller_ecc.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/mem_ss_pd_controller_ecc.png" /></a></p>
</li>
</ol>
</li>
<li>
<p>Once Step 6 has been done for each EMIF 0-3, click <strong>File -&gt; Save</strong>. Close the Platform Designer window.</p>
</li>
<li>
<p>In the IP Parameter Editor <strong>Presets</strong> window, click <strong>New</strong> to create an IP Presets file.</p>
<p><a class="glightbox" href="../images/mem_ss_preset_new.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/mem_ss_preset_new.png" /></a></p>
</li>
<li>
<p>In the <strong>New Preset</strong> window, set the <strong>Name</strong> for the preset. In this case we will name it <code>n6001-ecc</code>.</p>
<p><a class="glightbox" href="../images/mem_ss_preset_name.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="mem_ss_preset_name" src="../images/mem_ss_preset_name.png" /></a></p>
</li>
<li>
<p>Click the <strong>...</strong> button to select the location for the <strong>Preset file</strong>.</p>
</li>
<li>
<p>In the <strong>Save As</strong> window, change the save location to <code>$OFS_ROOTDIR/ipss/mem/qip/presets</code> and change the <strong>File Name</strong> to <code>n6001-ecc.qprs</code>. Click <strong>OK</strong>.</p>
<p><a class="glightbox" href="../images/mem_ss_preset_save_as.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="mem_ss_preset_save_as" src="../images/mem_ss_preset_save_as.png" /></a></p>
</li>
<li>
<p>Click <strong>Save</strong> in the <strong>New Preset</strong> window. Click <strong>No</strong> when prompted to add the file to the IP search path.</p>
<p><a class="glightbox" href="../images/ip_preset_search_path.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/ip_preset_search_path.png" /></a></p>
</li>
<li>
<p>Close the <strong>IP Parameter Editor</strong>. You do not need to generate or save the IP.</p>
</li>
<li>
<p>Edit the <code>$OFS_ROOTDIR/syn/board/n6001/setup/emif_loc.tcl</code> file to add pin assignments for the new signals supporting ECC on Channels 0-3. Note that routes for the ECC pins on Channels 0 and 1 are not physiclly present on a standard n6001 board.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-225-1" name="__codelineno-225-1" href="#__codelineno-225-1"></a><span class="c1"># CH0 DQS4 (ECC)</span>
<a id="__codelineno-225-2" name="__codelineno-225-2" href="#__codelineno-225-2"></a>set_location_assignment<span class="w"> </span>PIN_CG48<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">0</span><span class="o">]</span>.dbi_n<span class="o">[</span><span class="m">4</span><span class="o">]</span>
<a id="__codelineno-225-3" name="__codelineno-225-3" href="#__codelineno-225-3"></a>set_location_assignment<span class="w"> </span>PIN_CF47<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">0</span><span class="o">]</span>.dqs_n<span class="o">[</span><span class="m">4</span><span class="o">]</span>
<a id="__codelineno-225-4" name="__codelineno-225-4" href="#__codelineno-225-4"></a>set_location_assignment<span class="w"> </span>PIN_CH47<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">0</span><span class="o">]</span>.dqs<span class="o">[</span><span class="m">4</span><span class="o">]</span>
<a id="__codelineno-225-5" name="__codelineno-225-5" href="#__codelineno-225-5"></a>set_location_assignment<span class="w"> </span>PIN_CE50<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">0</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">32</span><span class="o">]</span>
<a id="__codelineno-225-6" name="__codelineno-225-6" href="#__codelineno-225-6"></a>set_location_assignment<span class="w"> </span>PIN_CG50<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">0</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">33</span><span class="o">]</span>
<a id="__codelineno-225-7" name="__codelineno-225-7" href="#__codelineno-225-7"></a>set_location_assignment<span class="w"> </span>PIN_CF49<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">0</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">34</span><span class="o">]</span>
<a id="__codelineno-225-8" name="__codelineno-225-8" href="#__codelineno-225-8"></a>set_location_assignment<span class="w"> </span>PIN_CH49<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">0</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">35</span><span class="o">]</span>
<a id="__codelineno-225-9" name="__codelineno-225-9" href="#__codelineno-225-9"></a>set_location_assignment<span class="w"> </span>PIN_CE46<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">0</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">36</span><span class="o">]</span>
<a id="__codelineno-225-10" name="__codelineno-225-10" href="#__codelineno-225-10"></a>set_location_assignment<span class="w"> </span>PIN_CG46<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">0</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">37</span><span class="o">]</span>
<a id="__codelineno-225-11" name="__codelineno-225-11" href="#__codelineno-225-11"></a>set_location_assignment<span class="w"> </span>PIN_CF45<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">0</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">38</span><span class="o">]</span>
<a id="__codelineno-225-12" name="__codelineno-225-12" href="#__codelineno-225-12"></a>set_location_assignment<span class="w"> </span>PIN_CH45<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">0</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">39</span><span class="o">]</span>
<a id="__codelineno-225-13" name="__codelineno-225-13" href="#__codelineno-225-13"></a>
<a id="__codelineno-225-14" name="__codelineno-225-14" href="#__codelineno-225-14"></a><span class="c1"># CH1 DQS4 (ECC)</span>
<a id="__codelineno-225-15" name="__codelineno-225-15" href="#__codelineno-225-15"></a>set_location_assignment<span class="w"> </span>PIN_DC34<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">1</span><span class="o">]</span>.dbi_n<span class="o">[</span><span class="m">4</span><span class="o">]</span>
<a id="__codelineno-225-16" name="__codelineno-225-16" href="#__codelineno-225-16"></a>set_location_assignment<span class="w"> </span>PIN_CY33<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">1</span><span class="o">]</span>.dqs_n<span class="o">[</span><span class="m">4</span><span class="o">]</span>
<a id="__codelineno-225-17" name="__codelineno-225-17" href="#__codelineno-225-17"></a>set_location_assignment<span class="w"> </span>PIN_DB33<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">1</span><span class="o">]</span>.dqs<span class="o">[</span><span class="m">4</span><span class="o">]</span>
<a id="__codelineno-225-18" name="__codelineno-225-18" href="#__codelineno-225-18"></a>set_location_assignment<span class="w"> </span>PIN_DA36<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">1</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">32</span><span class="o">]</span>
<a id="__codelineno-225-19" name="__codelineno-225-19" href="#__codelineno-225-19"></a>set_location_assignment<span class="w"> </span>PIN_DC36<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">1</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">33</span><span class="o">]</span>
<a id="__codelineno-225-20" name="__codelineno-225-20" href="#__codelineno-225-20"></a>set_location_assignment<span class="w"> </span>PIN_CY35<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">1</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">34</span><span class="o">]</span>
<a id="__codelineno-225-21" name="__codelineno-225-21" href="#__codelineno-225-21"></a>set_location_assignment<span class="w"> </span>PIN_DB35<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">1</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">35</span><span class="o">]</span>
<a id="__codelineno-225-22" name="__codelineno-225-22" href="#__codelineno-225-22"></a>set_location_assignment<span class="w"> </span>PIN_DA32<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">1</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">36</span><span class="o">]</span>
<a id="__codelineno-225-23" name="__codelineno-225-23" href="#__codelineno-225-23"></a>set_location_assignment<span class="w"> </span>PIN_DC32<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">1</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">37</span><span class="o">]</span>
<a id="__codelineno-225-24" name="__codelineno-225-24" href="#__codelineno-225-24"></a>set_location_assignment<span class="w"> </span>PIN_CY31<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">1</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">38</span><span class="o">]</span>
<a id="__codelineno-225-25" name="__codelineno-225-25" href="#__codelineno-225-25"></a>set_location_assignment<span class="w"> </span>PIN_DB31<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">1</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">39</span><span class="o">]</span>
<a id="__codelineno-225-26" name="__codelineno-225-26" href="#__codelineno-225-26"></a>
<a id="__codelineno-225-27" name="__codelineno-225-27" href="#__codelineno-225-27"></a>
<a id="__codelineno-225-28" name="__codelineno-225-28" href="#__codelineno-225-28"></a><span class="c1"># CH2 DQS4 (ECC)</span>
<a id="__codelineno-225-29" name="__codelineno-225-29" href="#__codelineno-225-29"></a>set_location_assignment<span class="w"> </span>PIN_G36<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">2</span><span class="o">]</span>.dbi_n<span class="o">[</span><span class="m">4</span><span class="o">]</span>
<a id="__codelineno-225-30" name="__codelineno-225-30" href="#__codelineno-225-30"></a>set_location_assignment<span class="w"> </span>PIN_H35<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">2</span><span class="o">]</span>.dqs_n<span class="o">[</span><span class="m">4</span><span class="o">]</span>
<a id="__codelineno-225-31" name="__codelineno-225-31" href="#__codelineno-225-31"></a>set_location_assignment<span class="w"> </span>PIN_F35<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">2</span><span class="o">]</span>.dqs<span class="o">[</span><span class="m">4</span><span class="o">]</span>
<a id="__codelineno-225-32" name="__codelineno-225-32" href="#__codelineno-225-32"></a>set_location_assignment<span class="w"> </span>PIN_G38<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">2</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">32</span><span class="o">]</span>
<a id="__codelineno-225-33" name="__codelineno-225-33" href="#__codelineno-225-33"></a>set_location_assignment<span class="w"> </span>PIN_J38<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">2</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">33</span><span class="o">]</span>
<a id="__codelineno-225-34" name="__codelineno-225-34" href="#__codelineno-225-34"></a>set_location_assignment<span class="w"> </span>PIN_H33<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">2</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">34</span><span class="o">]</span>
<a id="__codelineno-225-35" name="__codelineno-225-35" href="#__codelineno-225-35"></a>set_location_assignment<span class="w"> </span>PIN_J34<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">2</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">35</span><span class="o">]</span>
<a id="__codelineno-225-36" name="__codelineno-225-36" href="#__codelineno-225-36"></a>set_location_assignment<span class="w"> </span>PIN_F33<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">2</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">36</span><span class="o">]</span>
<a id="__codelineno-225-37" name="__codelineno-225-37" href="#__codelineno-225-37"></a>set_location_assignment<span class="w"> </span>PIN_H37<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">2</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">37</span><span class="o">]</span>
<a id="__codelineno-225-38" name="__codelineno-225-38" href="#__codelineno-225-38"></a>set_location_assignment<span class="w"> </span>PIN_F37<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">2</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">38</span><span class="o">]</span>
<a id="__codelineno-225-39" name="__codelineno-225-39" href="#__codelineno-225-39"></a>set_location_assignment<span class="w"> </span>PIN_G34<span class="w">  </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">2</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">39</span><span class="o">]</span>
<a id="__codelineno-225-40" name="__codelineno-225-40" href="#__codelineno-225-40"></a>
<a id="__codelineno-225-41" name="__codelineno-225-41" href="#__codelineno-225-41"></a><span class="c1"># CH3 DQS4 (ECC)</span>
<a id="__codelineno-225-42" name="__codelineno-225-42" href="#__codelineno-225-42"></a>set_location_assignment<span class="w"> </span>PIN_L50<span class="w"> </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">3</span><span class="o">]</span>.dbi_n<span class="o">[</span><span class="m">4</span><span class="o">]</span>
<a id="__codelineno-225-43" name="__codelineno-225-43" href="#__codelineno-225-43"></a>set_location_assignment<span class="w"> </span>PIN_P49<span class="w"> </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">3</span><span class="o">]</span>.dqs_n<span class="o">[</span><span class="m">4</span><span class="o">]</span>
<a id="__codelineno-225-44" name="__codelineno-225-44" href="#__codelineno-225-44"></a>set_location_assignment<span class="w"> </span>PIN_M49<span class="w"> </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">3</span><span class="o">]</span>.dqs<span class="o">[</span><span class="m">4</span><span class="o">]</span>
<a id="__codelineno-225-45" name="__codelineno-225-45" href="#__codelineno-225-45"></a>set_location_assignment<span class="w"> </span>PIN_M51<span class="w"> </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">3</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">32</span><span class="o">]</span>
<a id="__codelineno-225-46" name="__codelineno-225-46" href="#__codelineno-225-46"></a>set_location_assignment<span class="w"> </span>PIN_N48<span class="w"> </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">3</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">33</span><span class="o">]</span>
<a id="__codelineno-225-47" name="__codelineno-225-47" href="#__codelineno-225-47"></a>set_location_assignment<span class="w"> </span>PIN_M47<span class="w"> </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">3</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">34</span><span class="o">]</span>
<a id="__codelineno-225-48" name="__codelineno-225-48" href="#__codelineno-225-48"></a>set_location_assignment<span class="w"> </span>PIN_L48<span class="w"> </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">3</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">35</span><span class="o">]</span>
<a id="__codelineno-225-49" name="__codelineno-225-49" href="#__codelineno-225-49"></a>set_location_assignment<span class="w"> </span>PIN_P47<span class="w"> </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">3</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">36</span><span class="o">]</span>
<a id="__codelineno-225-50" name="__codelineno-225-50" href="#__codelineno-225-50"></a>set_location_assignment<span class="w"> </span>PIN_P51<span class="w"> </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">3</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">37</span><span class="o">]</span>
<a id="__codelineno-225-51" name="__codelineno-225-51" href="#__codelineno-225-51"></a>set_location_assignment<span class="w"> </span>PIN_N52<span class="w"> </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">3</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">38</span><span class="o">]</span>
<a id="__codelineno-225-52" name="__codelineno-225-52" href="#__codelineno-225-52"></a>set_location_assignment<span class="w"> </span>PIN_L52<span class="w"> </span>-to<span class="w"> </span>ddr4_mem<span class="o">[</span><span class="m">3</span><span class="o">]</span>.dq<span class="o">[</span><span class="m">39</span><span class="o">]</span>
</code></pre></div>
</li>
<li>
<p>Edit the <code>$OFS_ROOTDIR/tools/ofss_config/memory/memory.ofss</code> file to use the <code>n6001-ecc</code> preset that was generated previously.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-226-1" name="__codelineno-226-1" href="#__codelineno-226-1"></a><span class="o">[</span>ip<span class="o">]</span>
<a id="__codelineno-226-2" name="__codelineno-226-2" href="#__codelineno-226-2"></a><span class="nb">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>memory
<a id="__codelineno-226-3" name="__codelineno-226-3" href="#__codelineno-226-3"></a>
<a id="__codelineno-226-4" name="__codelineno-226-4" href="#__codelineno-226-4"></a><span class="o">[</span>settings<span class="o">]</span>
<a id="__codelineno-226-5" name="__codelineno-226-5" href="#__codelineno-226-5"></a><span class="nv">output_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>mem_ss_fm
<a id="__codelineno-226-6" name="__codelineno-226-6" href="#__codelineno-226-6"></a><span class="nv">preset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>n6001-ecc
</code></pre></div>
</li>
<li>
<p>Compile the design with the <code>n6001.ofss</code> file, which will use the modified <code>memory.ofss</code> file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-227-1" name="__codelineno-227-1" href="#__codelineno-227-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss,tools/ofss_config/hssi/hssi_8x25.ofss<span class="w"> </span>n6001<span class="w"> </span>work_n6001_mem_ecc_preset
</code></pre></div>
</li>
</ol>
<h4 id="472-walkthrough-add-or-remove-the-memory-sub-system"><strong>4.7.2 Walkthrough: Add or remove the Memory Sub-System</strong><a class="headerlink" href="#472-walkthrough-add-or-remove-the-memory-sub-system" title="Permanent link">&para;</a></h4>
<p>The Memory Sub-System can be added or removed to the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design using the <code>INCLUDE_DDR4</code> macro defined in the <code>ofs_top.qsf</code> file. The Memory-SS is enabled by default in the n6001, and is disabled by default in the n6000.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Edit the <code>ofs_top.qsf</code> file to either enable or disable the <code>INCLUDE_DDR4</code> macro. Comment out this macro assignemnt if you wish to remove the Memory-SS.</p>
<blockquote>
<p><strong>Note:</strong> The default Memory-SS has connections to the HPS. When enabling the Memory-SS, you must either ensure that the <code>INCLUDE_HPS</code> and <code>INCLUDE_UART</code> macros are also enabled, or you must remove the connections from the Memory-SS to the HPS. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#491-walkthrough-remove-the-hps">Remove the HPS</a> section for step-by-step instructions on removing the HPS from the design.</p>
</blockquote>
</li>
<li>
<p>Compile the design. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#225-walkthrough-compile-ofs-fim">Compile <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a> section for step-by-step instructions.</p>
</li>
</ol>
<h3 id="48-modify-the-ethernet-sub-system"><strong>4.8 Modify the Ethernet Sub-System</strong><a class="headerlink" href="#48-modify-the-ethernet-sub-system" title="Permanent link">&para;</a></h3>
<p>This section describes the flows for modifying the Ethernet Sub-System. There are three flows you may use to make modifications.</p>
<ul>
<li>Modify the Ethernet Sub-System with OFSS supported changes only. These modifications are supported natively by the build script, and are made at run-time of the build script. This flow is useful for users who only need to leverage natively supported HSSI OFSS settings.</li>
<li>Modify the Ethernet Sub-System with OFSS supported changes, then make additional custom modifications not covered by OFSS. These modifications will be captured in a presets file which can be used in future compiles. This flow is useful for users who whish to leverage pre-made HSSI OFSS settings, but make additional modifications not natively supported by HSSI OFSS.</li>
<li>Modify the Ethernet Sub-System without HSSI OFSS. These modification will be made directly in the source files.</li>
</ul>
<h4 id="481-walkthrough-modify-the-ethernet-sub-system-channels-with-pre-made-hssi-ofss"><strong>4.8.1 Walkthrough: Modify the Ethernet Sub-System Channels With Pre-Made HSSI OFSS</strong><a class="headerlink" href="#481-walkthrough-modify-the-ethernet-sub-system-channels-with-pre-made-hssi-ofss" title="Permanent link">&para;</a></h4>
<p>This walkthrough describes how to use OFSS to configure the Ethernet-SS. Refer to section <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#2126-hssi-ip-ofss-file">HSSI IP OFSS File</a> for detailed information about modifications supported by Ethernet-SS OFSS files. This walkthrough is useful for users who only need to leverage the pre-made, natively supported HSSI OFSS settings.</p>
<p>Pre-Requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Edit the <code>$OFS_ROTDIR/tools/ofss_config/&lt;TARGET_BOARD&gt;.ofss</code> file to use the desired Ethernet-SS OFSS configuration. The pre-provided OFSS configurations are as follows:</p>
<ul>
<li>
<p>N6001</p>
<ul>
<li>
<p>To select the 2x4x25GbE configuration, include the following line</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-228-1" name="__codelineno-228-1" href="#__codelineno-228-1"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/hssi/hssi_8x25.ofss
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>To select the 2x4x10GbE configuration, include the following line</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-229-1" name="__codelineno-229-1" href="#__codelineno-229-1"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/hssi/hssi_8x10.ofss
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>To select the 2x1x100GbE configuration, include the following line</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-230-1" name="__codelineno-230-1" href="#__codelineno-230-1"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/hssi/hssi_2x100.ofss
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<ul>
<li>
<p>To select the 4x1x100GbE configuration, include the following line</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-231-1" name="__codelineno-231-1" href="#__codelineno-231-1"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/hssi/hssi_4x100.ofss
</code></pre></div>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Compile the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> using the target board OFSS file.</p>
<ul>
<li>
<p>N6001</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-232-1" name="__codelineno-232-1" href="#__codelineno-232-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-232-2" name="__codelineno-232-2" href="#__codelineno-232-2"></a>
<a id="__codelineno-232-3" name="__codelineno-232-3" href="#__codelineno-232-3"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001<span class="w"> </span>work_n6001
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>N6000</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-233-1" name="__codelineno-233-1" href="#__codelineno-233-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-233-2" name="__codelineno-233-2" href="#__codelineno-233-2"></a>
<a id="__codelineno-233-3" name="__codelineno-233-3" href="#__codelineno-233-3"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6000.ofss<span class="w"> </span>n6000<span class="w"> </span>work_n6000
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>The resulting <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> will contain the Ethernet-SS configuration specified in Step 3. The Ethernet-SS IP in the resulting work directory shows the parameter settings that are used.</p>
</li>
</ol>
<h4 id="482-walkthrough-add-channels-to-the-ethernet-sub-system-channels-with-custom-hssi-ofss"><strong>4.8.2 Walkthrough: Add Channels to the Ethernet Sub-System Channels With Custom HSSI OFSS</strong><a class="headerlink" href="#482-walkthrough-add-channels-to-the-ethernet-sub-system-channels-with-custom-hssi-ofss" title="Permanent link">&para;</a></h4>
<p>This walkthrough describes how to create an use a custom OFSS file to add channels to the Ethernet-SS and compile a design with a 3x4x10GbE Ethernet-SS configuration. This walkthrough is useful for users who wish to leverage the natively supported HSSI OFSS settings.</p>
<blockquote>
<p><strong>Note:</strong> The n6000 uses 16 channels in the HSSI-SS by default: 8 to the QSFPs, and 8 to the E810 device. Thus, this walkthrough applies only to the n6001.</p>
</blockquote>
<p>Pre-Requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Create a new HSSI OFSS file <code>$OFS_ROOTDIR/tools/ofss_config/hssi/hssi_12x10.ofss</code> with the following contents.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-234-1" name="__codelineno-234-1" href="#__codelineno-234-1"></a><span class="o">[</span>ip<span class="o">]</span>
<a id="__codelineno-234-2" name="__codelineno-234-2" href="#__codelineno-234-2"></a><span class="nb">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>hssi
<a id="__codelineno-234-3" name="__codelineno-234-3" href="#__codelineno-234-3"></a>
<a id="__codelineno-234-4" name="__codelineno-234-4" href="#__codelineno-234-4"></a><span class="o">[</span>settings<span class="o">]</span>
<a id="__codelineno-234-5" name="__codelineno-234-5" href="#__codelineno-234-5"></a><span class="nv">output_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>hssi_ss
<a id="__codelineno-234-6" name="__codelineno-234-6" href="#__codelineno-234-6"></a><span class="nv">num_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span>
<a id="__codelineno-234-7" name="__codelineno-234-7" href="#__codelineno-234-7"></a><span class="nv">data_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>10GbE
</code></pre></div>
</li>
<li>
<p>Edit the <code>$OFS_ROOTDIR/tools/ofss_config/n6001.ofss</code> file to use the new HSSI OFSS file generated in Step 3.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-235-1" name="__codelineno-235-1" href="#__codelineno-235-1"></a><span class="o">[</span>include<span class="o">]</span>
<a id="__codelineno-235-2" name="__codelineno-235-2" href="#__codelineno-235-2"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/n6001_base.ofss
<a id="__codelineno-235-3" name="__codelineno-235-3" href="#__codelineno-235-3"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/pcie/pcie_host.ofss
<a id="__codelineno-235-4" name="__codelineno-235-4" href="#__codelineno-235-4"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/iopll/iopll.ofss
<a id="__codelineno-235-5" name="__codelineno-235-5" href="#__codelineno-235-5"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/memory/memory.ofss
<a id="__codelineno-235-6" name="__codelineno-235-6" href="#__codelineno-235-6"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/hssi/hssi_12x10.ofss
</code></pre></div>
</li>
<li>
<p>Identify the which channels will be added. You may use the <a href="https://www.intel.com/content/www/us/en/content-details/652292/intel-e-tile-channel-placement-tool.html?wapkw=e-tile%20channel%20placement%20tool&amp;DocID=652292">E-Tile Channel Placement Tool</a> to aid in your design. In this example we will add the 4 new 10GbE channels to Channels 8-11.</p>
<p><a class="glightbox" href="../images/etile_channel_placement_tool.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="etile_channel_placement_tool" src="../images/etile_channel_placement_tool.png" /></a></p>
</li>
<li>
<p>Based on your channel selection, identify which pins will be used. Refer to the <a href="https://www.intel.com/content/www/us/en/support/programmable/support-resources/devices/lit-dp.html">Pin-Out Files for Intel FPGAs</a> determine the required pins for your device. In this example we are targeting the AGFB014R24A2E2V device. Set the pin assignments in the <code>$OFS_ROOTDIR/syn/board/n6001/setup/top_loc.tcl</code> file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-236-1" name="__codelineno-236-1" href="#__codelineno-236-1"></a>set_location_assignment<span class="w"> </span>PIN_AV7<span class="w">  </span>-to<span class="w"> </span>qsfp_serial<span class="o">[</span><span class="m">2</span><span class="o">]</span>.rx_p<span class="o">[</span><span class="m">0</span><span class="o">]</span>
<a id="__codelineno-236-2" name="__codelineno-236-2" href="#__codelineno-236-2"></a>set_location_assignment<span class="w"> </span>PIN_AW10<span class="w"> </span>-to<span class="w"> </span>qsfp_serial<span class="o">[</span><span class="m">2</span><span class="o">]</span>.rx_p<span class="o">[</span><span class="m">1</span><span class="o">]</span>
<a id="__codelineno-236-3" name="__codelineno-236-3" href="#__codelineno-236-3"></a>set_location_assignment<span class="w"> </span>PIN_BB7<span class="w">  </span>-to<span class="w"> </span>qsfp_serial<span class="o">[</span><span class="m">2</span><span class="o">]</span>.rx_p<span class="o">[</span><span class="m">2</span><span class="o">]</span>
<a id="__codelineno-236-4" name="__codelineno-236-4" href="#__codelineno-236-4"></a>set_location_assignment<span class="w"> </span>PIN_BC10<span class="w"> </span>-to<span class="w"> </span>qsfp_serial<span class="o">[</span><span class="m">2</span><span class="o">]</span>.rx_p<span class="o">[</span><span class="m">3</span><span class="o">]</span>
<a id="__codelineno-236-5" name="__codelineno-236-5" href="#__codelineno-236-5"></a>
<a id="__codelineno-236-6" name="__codelineno-236-6" href="#__codelineno-236-6"></a>set_location_assignment<span class="w"> </span>PIN_AV1<span class="w"> </span>-to<span class="w"> </span>qsfp_serial<span class="o">[</span><span class="m">2</span><span class="o">]</span>.tx_p<span class="o">[</span><span class="m">0</span><span class="o">]</span>
<a id="__codelineno-236-7" name="__codelineno-236-7" href="#__codelineno-236-7"></a>set_location_assignment<span class="w"> </span>PIN_AW4<span class="w"> </span>-to<span class="w"> </span>qsfp_serial<span class="o">[</span><span class="m">2</span><span class="o">]</span>.tx_p<span class="o">[</span><span class="m">1</span><span class="o">]</span>
<a id="__codelineno-236-8" name="__codelineno-236-8" href="#__codelineno-236-8"></a>set_location_assignment<span class="w"> </span>PIN_BB1<span class="w"> </span>-to<span class="w"> </span>qsfp_serial<span class="o">[</span><span class="m">2</span><span class="o">]</span>.tx_p<span class="o">[</span><span class="m">2</span><span class="o">]</span>
<a id="__codelineno-236-9" name="__codelineno-236-9" href="#__codelineno-236-9"></a>set_location_assignment<span class="w"> </span>PIN_BC4<span class="w"> </span>-to<span class="w"> </span>qsfp_serial<span class="o">[</span><span class="m">2</span><span class="o">]</span>.tx_p<span class="o">[</span><span class="m">3</span><span class="o">]</span>
</code></pre></div>
</li>
<li>
<p>Change the number of QSFP ports from <code>2</code> to <code>3</code> in the <code>$OFS_ROOTDIR/ofs-common/src/fpga_family/agilex/hssi_ss/inc/ofs_fim_eth_plat_if_pkg.sv</code> file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-237-1" name="__codelineno-237-1" href="#__codelineno-237-1"></a><span class="k">localparam</span><span class="w"> </span><span class="n">NUM_QSFP_PORTS_USED</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">3</span><span class="p">;</span><span class="w"> </span><span class="c1">// Number of QSFP cages on board used by target hssi configuration</span>
</code></pre></div>
</li>
<li>
<p>Edit <code>$OFS_ROOTDIR/ofs-common/src/fpga_family/agilex/hssi_ss/hssi_wrapper.sv</code> so that the QSFP LED signals use <code>NUM_QSFP_PORTS_USED</code> defined in the previous step.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-238-1" name="__codelineno-238-1" href="#__codelineno-238-1"></a><span class="c1">// Speed and activity LEDS</span>
<a id="__codelineno-238-2" name="__codelineno-238-2" href="#__codelineno-238-2"></a><span class="k">output</span><span class="w"> </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">NUM_QSFP_PORTS_USED</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">     </span><span class="n">o_qsfp_speed_green</span><span class="p">,</span><span class="w">       </span><span class="c1">// Link up in Nx25G or 2x56G or 1x100G speed</span>
<a id="__codelineno-238-3" name="__codelineno-238-3" href="#__codelineno-238-3"></a><span class="k">output</span><span class="w"> </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">NUM_QSFP_PORTS_USED</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">     </span><span class="n">o_qsfp_speed_yellow</span><span class="p">,</span><span class="w">      </span><span class="c1">// Link up in Nx10G speed</span>
<a id="__codelineno-238-4" name="__codelineno-238-4" href="#__codelineno-238-4"></a><span class="k">output</span><span class="w"> </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">NUM_QSFP_PORTS_USED</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">     </span><span class="n">o_qsfp_activity_green</span><span class="p">,</span><span class="w">    </span><span class="c1">// Link up and activity seen</span>
<a id="__codelineno-238-5" name="__codelineno-238-5" href="#__codelineno-238-5"></a><span class="k">output</span><span class="w"> </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">NUM_QSFP_PORTS_USED</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">     </span><span class="n">o_qsfp_activity_red</span><span class="w">       </span><span class="c1">// LOS, TX Fault etc</span>
</code></pre></div>
</li>
<li>
<p>Compile the design. It is recommended to compile a flat design first before incorporating a <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region in the design. This reduces design complexity while you determine the correct pinout for your design.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-239-1" name="__codelineno-239-1" href="#__codelineno-239-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-239-2" name="__codelineno-239-2" href="#__codelineno-239-2"></a>
<a id="__codelineno-239-3" name="__codelineno-239-3" href="#__codelineno-239-3"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001:flat<span class="w"> </span>work_n6001_12x10
</code></pre></div>
</li>
</ol>
<h4 id="483-walkthrough-modify-the-ethernet-sub-system-with-pre-made-hssi-ofss-plus-additional-modifications"><strong>4.8.3 Walkthrough: Modify the Ethernet Sub-System With Pre-Made HSSI OFSS Plus Additional Modifications</strong><a class="headerlink" href="#483-walkthrough-modify-the-ethernet-sub-system-with-pre-made-hssi-ofss-plus-additional-modifications" title="Permanent link">&para;</a></h4>
<p>This walkthrough describes how to use OFSS to first modify the Ethernet-SS, then make additional modifications on top. Refer to section <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#2126-hssi-ip-ofss-file">HSSI IP OFSS File</a> for detailed information about modifications supported by Ethernet-SS OFSS files. This flow is useful for users who whish to leverage pre-made OFSS settings, but make additional modifications not natively supported by OFSS. This walkthorugh targets the n6001, however, similiar steps can be performed on the n6000.</p>
<p>Pre-Requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Edit the <code>$OFS_ROTDIR/tools/ofss_config/n6001.ofss</code> file to use the desired Ethernet-SS OFSS configuration starting point.</p>
<ul>
<li>
<p>To select 2x4x25GbE configuration, add the following line</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-240-1" name="__codelineno-240-1" href="#__codelineno-240-1"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/hssi/hssi_8x25.ofss
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>To select 2x4x10GbE configuration, add the following line</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-241-1" name="__codelineno-241-1" href="#__codelineno-241-1"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/hssi/hssi_8x10.ofss
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>To select 2x1x100GbE configuration, add the following line</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-242-1" name="__codelineno-242-1" href="#__codelineno-242-1"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/hssi/hssi_2x100.ofss
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>Run the <code>setup</code> stage of the build script with the OFSS file to create a work directory which contains the Ethernet-SS IP configuration specified in Step 3.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-243-1" name="__codelineno-243-1" href="#__codelineno-243-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-243-2" name="__codelineno-243-2" href="#__codelineno-243-2"></a>
<a id="__codelineno-243-3" name="__codelineno-243-3" href="#__codelineno-243-3"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>--stage<span class="w"> </span>setup<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001<span class="w"> </span>work_n6001
</code></pre></div>
</li>
<li>
<p>Open the Ethernet-SS IP in Quartus Parameter Editor. The IP settings will match te configuration of the OFSS file defined in Step 3. Make any additional modifications in the Parameter Editor.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-244-1" name="__codelineno-244-1" href="#__codelineno-244-1"></a>qsys-edit<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/work_n6001/ipss/hssi/qip/hssi_ss/hssi_ss.ip
</code></pre></div>
</li>
<li>
<p>Once you are satisfied with your changes, click the <strong>New...</strong> button in the <strong>Presets</strong> pane of IP Parameter Editor.</p>
<p><a class="glightbox" href="../images/hssi_presets_new.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="hssi_presets_new" src="../images/hssi_presets_new.png" /></a></p>
</li>
<li>
<p>In the <strong>New Preset</strong> window, create a unique <strong>Name</strong>. In this example the name is <code>n6001-hssi-presets</code>.</p>
<p><a class="glightbox" href="../images/hssi_preset_name.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="hssi_preset_name" src="../images/hssi_preset_name.png" /></a></p>
</li>
<li>
<p>Click the <strong>...</strong> button to select where to save the preset file. Give it a name, and save it to <code>$OFS_ROOTDIR/ipss/hssi/qip/hssi_ss/presets</code></p>
<p><a class="glightbox" href="../images/hssi_presets_save.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="hssi_presets_save" src="../images/hssi_presets_save.png" /></a></p>
</li>
<li>
<p>Click <strong>Save</strong> in the <strong>New Preset</strong> window. Click <strong>No</strong> when prompted to add the file to the IP search path.</p>
</li>
<li>
<p>Close out of all Quartus GUIs. You do not need to save or compile the IP.</p>
</li>
<li>
<p>Create a new HSSI OFSS file in the <code>$OFS_ROOTDIR/tools/ofss_config/hssi</code> directory named <code>hssi_preset_n6001.ofss</code> with the following contents. Note that the <code>num_channels</code> and <code>data_rate</code> settings will be overwritten by the contents of the preset file. The <code>preset</code> setting must match the name you selected in Step 7.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-245-1" name="__codelineno-245-1" href="#__codelineno-245-1"></a><span class="o">[</span>ip<span class="o">]</span>
<a id="__codelineno-245-2" name="__codelineno-245-2" href="#__codelineno-245-2"></a><span class="nb">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>hssi
<a id="__codelineno-245-3" name="__codelineno-245-3" href="#__codelineno-245-3"></a>
<a id="__codelineno-245-4" name="__codelineno-245-4" href="#__codelineno-245-4"></a><span class="o">[</span>settings<span class="o">]</span>
<a id="__codelineno-245-5" name="__codelineno-245-5" href="#__codelineno-245-5"></a><span class="nv">output_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>hssi_ss
<a id="__codelineno-245-6" name="__codelineno-245-6" href="#__codelineno-245-6"></a><span class="nv">num_channels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span>
<a id="__codelineno-245-7" name="__codelineno-245-7" href="#__codelineno-245-7"></a><span class="nv">data_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>25GbE
<a id="__codelineno-245-8" name="__codelineno-245-8" href="#__codelineno-245-8"></a><span class="nv">preset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>n6001-hssi-presets
</code></pre></div>
</li>
<li>
<p>Edit the <code>$OFS_ROOTDIR/tools/ofss_config/n6001.ofss</code> file to use the new HSSI OFSS file created in Step 10.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-246-1" name="__codelineno-246-1" href="#__codelineno-246-1"></a><span class="o">[</span>include<span class="o">]</span>
<a id="__codelineno-246-2" name="__codelineno-246-2" href="#__codelineno-246-2"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/n6001_base.ofss
<a id="__codelineno-246-3" name="__codelineno-246-3" href="#__codelineno-246-3"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/pcie/pcie_host.ofss
<a id="__codelineno-246-4" name="__codelineno-246-4" href="#__codelineno-246-4"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/iopll/iopll.ofss
<a id="__codelineno-246-5" name="__codelineno-246-5" href="#__codelineno-246-5"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/memory/memory.ofss
<a id="__codelineno-246-6" name="__codelineno-246-6" href="#__codelineno-246-6"></a><span class="s2">&quot;</span><span class="nv">$OFS_ROOTDIR</span><span class="s2">&quot;</span>/tools/ofss_config/hssi/hssi_preset_n6001.ofss
</code></pre></div>
</li>
<li>
<p>Compile the design using the n6001 OFSS file. It is recommended to compile a flat design first before incorporating a <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region in the design. This reduces design complexity while you modify the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-247-1" name="__codelineno-247-1" href="#__codelineno-247-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001:flat<span class="w"> </span>work_n6001_hssi_preset
</code></pre></div>
</li>
<li>
<p>The resulting <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> will contain the Ethernet-SS configuration specified by the presets file. The Ethernet-SS IP in the resulting work directory shows the parameter settings that are used.</p>
</li>
</ol>
<h4 id="484-walkthrough-modify-the-ethernet-sub-system-without-hssi-ofss"><strong>4.8.4 Walkthrough: Modify the Ethernet Sub-System Without HSSI OFSS</strong><a class="headerlink" href="#484-walkthrough-modify-the-ethernet-sub-system-without-hssi-ofss" title="Permanent link">&para;</a></h4>
<p>This walkthrough describes how to modify the Ethernet-SS wihout using OFSS. This flow will edit the Ethernet-SS IP source directly. This walkthrough is useful for users who wish to make all Ethernet-SS modifications manually, without leveraging HSSI OFSS.</p>
<p>Pre-Requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Open the Ethernet-SS IP in Quartus Parameter Editor. Make your modifications in the Parameter Editor.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-248-1" name="__codelineno-248-1" href="#__codelineno-248-1"></a>qsys-edit<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ipss/hssi/qip/hssi_ss/hssi_ss.ip
</code></pre></div>
</li>
<li>
<p>Once you are satisfied with your changes, click the <strong>Generate HDL</strong>. Save the design if prompted.</p>
</li>
<li>
<p>Compile the design.</p>
<ul>
<li>
<p>If you are not using any other OFSS files in your compilation flow, use the following command to compile. It is recommended to compile a flat design before incorporating a <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region in the design. This reduces design complexity while you modify the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-249-1" name="__codelineno-249-1" href="#__codelineno-249-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>n6001:flat<span class="w"> </span>work_n6001
</code></pre></div>
</li>
</ul>
<ul>
<li>If you are using OFSS files for other IP in the design, ensure that the top level OFSS file (e.g. <code>$OFS_ROOTDIR/tools/ofss_config/n6001.ofss</code>) does not specify an HSSI OFSS file. Then use the following command to compile. It is recommended to compile a flat design first before incorporating a <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region in the design. This reduces design complexity while you modify the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-250-1" name="__codelineno-250-1" href="#__codelineno-250-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss<span class="w"> </span>n6001:flat<span class="w"> </span>work_n6001
</code></pre></div>
</li>
<li>
<p>The resulting <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> will contain the Ethernet-SS configuration contained in the <code>hssi_ss.ip</code> source file.</p>
</li>
</ol>
<h3 id="49-modifying-the-hps"><strong>4.9 Modifying the HPS</strong><a class="headerlink" href="#49-modifying-the-hps" title="Permanent link">&para;</a></h3>
<p>This section describes ways to modify the HPS.</p>
<h4 id="491-walkthrough-remove-the-hps"><strong>4.9.1 Walkthrough: Remove the HPS</strong><a class="headerlink" href="#491-walkthrough-remove-the-hps" title="Permanent link">&para;</a></h4>
<p>Perform the following steps to remove the HPS from the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design.</p>
<blockquote>
<p><strong>Note:</strong> The n6000 default <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> has the HPS and Memory-SS disabled by default. This walkthrough targets the n6001.</p>
</blockquote>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Create a Memory Sub-system IP presets file with the connection to the HPS removed.</p>
<ol>
<li>
<p>Open the the Memory Sub-System IP</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-251-1" name="__codelineno-251-1" href="#__codelineno-251-1"></a>qsys-edit<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ipss/mem/qip/mem_ss/mem_ss.ip
</code></pre></div>
</li>
<li>
<p>In the IP Parameter Editor window that opens, remove the entries corresponding to the HPS (row #4) in the <strong>Memory Interfaces</strong> and <strong>Application Interfaces</strong> sections. To do this, click the row to be removed, then click the minus (<code>-</code>) button.</p>
<p><a class="glightbox" href="../images/remove_hps_mem_ss.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/remove_hps_mem_ss.png" /></a></p>
</li>
<li>
<p>In the <strong>Presets</strong> pane, click <strong>New...</strong> to create a new IP presets file.</p>
<p><a class="glightbox" href="../images/remove_hps_mem_ss_new_preset.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/remove_hps_mem_ss_new_preset.png" /></a></p>
</li>
<li>
<p>In the <strong>New Preset</strong> window, create a unique preset name. For example, <code>n6001-mem-no-hps</code>.</p>
<p><a class="glightbox" href="../images/remove_hps_mem_ss_new_preset_window.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/remove_hps_mem_ss_new_preset_window.png" /></a></p>
</li>
<li>
<p>Click the <strong>...</strong> button to select the save location of the IP presets file. In the <strong>Save As</strong> window, set the <strong>Look In</strong> field to the memory IP presets directory <code>$OFS_ROOTDIR/ipss/mem/qip/presets</code>. Set the <strong>File Name</strong> field to match the name selected in Step 4. Click <strong>OK</strong>.</p>
<p><a class="glightbox" href="../images/remove_hps_mem_ss_save_as.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/remove_hps_mem_ss_save_as.png" /></a></p>
</li>
<li>
<p>Click <strong>Save</strong> in the <strong>New Preset</strong> window. Click <strong>No</strong> when prompted to add the file to the IP search path.</p>
<p><a class="glightbox" href="../images/remove_hps_mem_ss_ip_path.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/remove_hps_mem_ss_ip_path.png" /></a></p>
</li>
<li>
<p>Close <strong>IP Parameter Editor</strong> without saving or generating HDL.</p>
</li>
</ol>
</li>
<li>
<p>Edit the Memory OFSS file <code>$OFS_ROOTDIR/tools/ofss_config/memory/memory.ofss</code> to use the IP presets file generated in Step 4.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-252-1" name="__codelineno-252-1" href="#__codelineno-252-1"></a>[ip]
<a id="__codelineno-252-2" name="__codelineno-252-2" href="#__codelineno-252-2"></a>type = memory
<a id="__codelineno-252-3" name="__codelineno-252-3" href="#__codelineno-252-3"></a>
<a id="__codelineno-252-4" name="__codelineno-252-4" href="#__codelineno-252-4"></a>[settings]
<a id="__codelineno-252-5" name="__codelineno-252-5" href="#__codelineno-252-5"></a>output_name = mem_ss
<a id="__codelineno-252-6" name="__codelineno-252-6" href="#__codelineno-252-6"></a>preset = n6001-mem-no-hps
</code></pre></div>
</li>
<li>
<p>Edit <code>$OFS_ROOTDIR/syn/board/n6001/syn_top/ofs_top.qsf</code> to comment out the <code>INCLUDE_HPS</code> and <code>INCLUDE_UART</code> macro definitions.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-253-1" name="__codelineno-253-1" href="#__codelineno-253-1"></a>#set_global_assignment -name VERILOG_MACRO &quot;INCLUDE_HPS&quot;
<a id="__codelineno-253-2" name="__codelineno-253-2" href="#__codelineno-253-2"></a>#set_global_assignment -name VERILOG_MACRO &quot;INCLUDE_UART&quot;
</code></pre></div>
</li>
<li>
<p>Build the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-254-1" name="__codelineno-254-1" href="#__codelineno-254-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6001.ofss,tools/ofss_config/hssi/hssi_8x25.ofss<span class="w"> </span>n6001<span class="w"> </span>work_n6001_no_hps
</code></pre></div>
</li>
</ol>
<h4 id="491-walkthrough-add-the-hps"><strong>4.9.1 Walkthrough: Add the HPS</strong><a class="headerlink" href="#491-walkthrough-add-the-hps" title="Permanent link">&para;</a></h4>
<blockquote>
<p><strong>Note:</strong> The n6001 default <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> has the HPS and Memory-SS enabled by default. This walkthrough targets the n6000.</p>
</blockquote>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires a development environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#134-walkthrough-set-up-development-environment">Set Up Development Environment</a> Section for instructions on setting up a development environment.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> PCIe Attach <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository (or use an existing cloned repository). Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1321-walkthrough-clone-fim-repository">Clone <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Repository</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Set development environment variables. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#1331-walkthrough-set-development-environment-variables">Set Development Environment Variables</a> section for step-by-step instructions.</p>
</li>
<li>
<p>Edit <code>$OFS_ROOTDIR/syn/board/n6000/syn_top/ofs_top.qsf</code> to un-comment the <code>INCLUDE_DDR4</code>, <code>INCLUDE_HPS</code>, and <code>INCLUDE_UART</code> macro definitions.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-255-1" name="__codelineno-255-1" href="#__codelineno-255-1"></a>set_global_assignment -name VERILOG_MACRO &quot;INCLUDE_DDR4&quot;
<a id="__codelineno-255-2" name="__codelineno-255-2" href="#__codelineno-255-2"></a>
<a id="__codelineno-255-3" name="__codelineno-255-3" href="#__codelineno-255-3"></a>set_global_assignment -name VERILOG_MACRO &quot;INCLUDE_HPS&quot;
<a id="__codelineno-255-4" name="__codelineno-255-4" href="#__codelineno-255-4"></a>set_global_assignment -name VERILOG_MACRO &quot;INCLUDE_UART&quot;
</code></pre></div>
</li>
<li>
<p>Build the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-256-1" name="__codelineno-256-1" href="#__codelineno-256-1"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>--ofss<span class="w"> </span>tools/ofss_config/n6000.ofss<span class="w"> </span>n6000<span class="w"> </span>work_n6000_w_hps
</code></pre></div>
</li>
</ol>
<h2 id="5-fpga-configuration"><strong>5. FPGA Configuration</strong><a class="headerlink" href="#5-fpga-configuration" title="Permanent link">&para;</a></h2>
<p>Configuring the Agilex FPGA on the n6001 can be done by Remote System Update (<abbr title="Remote System Update, A Remote System Update operation sends an instruction to the Intel FPGA PAC D5005 device that triggers a power cycle of the card only, forcing reconfiguration.">RSU</abbr>) using OPAE commands, or by programming a <code>SOF</code> image to the FPGA via <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> using Quartus Programer.</p>
<p>Programming via <abbr title="Remote System Update, A Remote System Update operation sends an instruction to the Intel FPGA PAC D5005 device that triggers a power cycle of the card only, forcing reconfiguration.">RSU</abbr> will program the flash device on the board for non-volatile image updates. Programming via <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> will configure the FPGA for volatile image updates.</p>
<h4 id="51-walkthrough-set-up-jtag"><strong>5.1 Walkthrough: Set up <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr></strong><a class="headerlink" href="#51-walkthrough-set-up-jtag" title="Permanent link">&para;</a></h4>
<p>Perform the following steps to set up a <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> connection to the Intel® FPGA SmartNIC N6001-PL.</p>
<p>Pre-requisites:</p>
<ul>
<li>This walkthrough requires an <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach deployment environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/">Getting Started Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach FPGAs (Intel® FPGA SmartNIC N6001-PL/N6000-PL)</a> for instructions on setting up a deployment environment.</li>
</ul>
<ul>
<li>This walkthrough requires a workstation with Quartus Prime Pro Version 23.4 tools installed, specifically the <code>jtagconfig</code> tool.</li>
</ul>
<ul>
<li>This walkthrough requires an <a href="https://www.intel.com/content/www/us/en/products/sku/215664/intel-fpga-download-cable-ii/specifications.html">Intel FPGA Download Cable II</a>.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Set the board switches to dynamically select either the Agilex® 7 FPGA or MAX® 10 device on the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> chain.</p>
<ol>
<li>Set SW1.1=ON as shown in the next image. The switches are located at the back of the Intel® FPGA SmartNIC N6001-PL.</li>
</ol>
<p><a class="glightbox" href="../images/n6000_sw2_position_0_for_agilex_jtag.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/n6000_sw2_position_0_for_agilex_jtag.png" /></a></p>
</li>
<li>
<p>The Intel® FPGA SmartNIC N6001-PL has a 10 pin <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> header on the top side of the board. Connect an Intel® FPGA Download II Cable to the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> header of the Intel® FPGA SmartNIC N6001-PL as shown in picture below. This picture shows the Intel® FPGA SmartNIC N6001-PL card installed in the middle bay, top slot of a SuperMicro® SYS-220HE-FTNR server where the lower slot does not have card installed allowing the Intel® Download II cables to pass through removed the slot access. </p>
<p><a class="glightbox" href="../images/n6000_jtag_connection.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/n6000_jtag_connection.png" /></a></p>
<blockquote>
<p><strong>Note:</strong> If using the Intel FGPA download Cable on Linux, add the udev rule as described in <a href="https://www.intel.com/content/www/us/en/support/programmable/support-resources/download/dri-usb-b-lnx.html">Intel FPGA Download Cable Driver for Linux</a>.</p>
</blockquote>
</li>
<li>
<p>Set the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> chain to select the Agilex® 7 FPGA as the target by writing to the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> enable register in the <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> (Register <code>0x378</code>). This is done via PMCI registers <code>0x2040C</code> and <code>0x20400</code>.</p>
<blockquote>
<p><strong>Note:</strong> The commands below are targeted to a board with PCIe B:D.F of 98:00.0. Use the correct PCIe B:D.F of your card.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><a id="__codelineno-257-1" name="__codelineno-257-1" href="#__codelineno-257-1"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:98:00.0<span class="w"> </span><span class="nv">$USER</span>
<a id="__codelineno-257-2" name="__codelineno-257-2" href="#__codelineno-257-2"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:98:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x2040c<span class="w"> </span>0x100000000
<a id="__codelineno-257-3" name="__codelineno-257-3" href="#__codelineno-257-3"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:98:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x20400<span class="w"> </span>0x37800000002
<a id="__codelineno-257-4" name="__codelineno-257-4" href="#__codelineno-257-4"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>release<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:98:00.0
</code></pre></div>
<blockquote>
<p><strong>Note:</strong> To later re-direct the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> back to the MAX 10 device, execute the following commands.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><a id="__codelineno-258-1" name="__codelineno-258-1" href="#__codelineno-258-1"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span><span class="nv">$USER</span>
<a id="__codelineno-258-2" name="__codelineno-258-2" href="#__codelineno-258-2"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x2040c<span class="w"> </span>0x000000000
<a id="__codelineno-258-3" name="__codelineno-258-3" href="#__codelineno-258-3"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x20400<span class="w"> </span>0x37800000002
<a id="__codelineno-258-4" name="__codelineno-258-4" href="#__codelineno-258-4"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>release<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0
</code></pre></div>
<p>Optionally, rather than dynamically commanding Agilex® 7 FPGA/MAX10 selection with the PMCI register settings, you can fix the selection with the following switch settings shown in the table below:</p>
<table>
<thead>
<tr>
<th>SW1.1</th>
<th>SW2</th>
<th><abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> Target</th>
</tr>
</thead>
<tbody>
<tr>
<td>OFF</td>
<td>OFF</td>
<td>Agilex® 7 FPGA</td>
</tr>
<tr>
<td>OFF</td>
<td>ON</td>
<td>MAX® 10 FPGA</td>
</tr>
<tr>
<td>ON</td>
<td>X</td>
<td>Agilex® 7 FPGA if <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> register <code>0x378=0x1</code></td>
</tr>
<tr>
<td>ON</td>
<td>X</td>
<td>MAX® 10 FPGA if <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> register <code>0x378=0x0</code></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Use the <code>jtagconfig</code> tool to check that the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> chain contains the AGFB014R24A2E2V device.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-259-1" name="__codelineno-259-1" href="#__codelineno-259-1"></a>&lt;QUARTUS_INSTALL_DIR&gt;/23.4/quartus/bin/jtagconfig
</code></pre></div>
</li>
</ol>
<h4 id="52-walkthrough-program-the-fpga-via-jtag"><strong>5.2 Walkthrough: Program the FPGA via <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr></strong><a class="headerlink" href="#52-walkthrough-program-the-fpga-via-jtag" title="Permanent link">&para;</a></h4>
<p>This walkthrough describes the steps to program the Agilex FPGA on the Intel® FPGA SmartNIC N6001-PL with a <code>SOF</code> image via <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr>.</p>
<p>Pre-Requisites:</p>
<ul>
<li>This walkthrough requires an <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach deployment environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/">Getting Started Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach FPGAs (Intel® FPGA SmartNIC N6001-PL/N6000-PL)</a> for instructions on setting up a deployment environment.</li>
</ul>
<ul>
<li>This walkthrough requires a <code>SOF</code> image which will be programmed to the Agilex FPGA. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#225-walkthrough-compile-ofs-fim">Compile <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a> Section for step-by-step instructions for generating a <code>SOF</code> image.</li>
</ul>
<ul>
<li>This walkthrough requires a <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> connection to the n6001. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#51-walkthrough-set-up-jtag">Set up <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr></a> section for step-by-step instructions.</li>
</ul>
<ul>
<li>This walkthrough requires a Full Quartus Installation or Standalone Quartus Prime Programmer &amp; Tools running on the machine where the Intel® FPGA SmartNIC N6001-PL is connected via <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr>.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Start in your deployment environment.</p>
</li>
<li>
<p>If the card is already programmed with an <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> enabled design, determine the PCIe B:D.F of the card using OPAE command <code>fpgainfo fme</code>. In this example, the PCIe B:D.F is <code>B1:00.0</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-260-1" name="__codelineno-260-1" href="#__codelineno-260-1"></a>fpgainfo<span class="w"> </span>fme
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-261-1" name="__codelineno-261-1" href="#__codelineno-261-1"></a>Intel<span class="w"> </span>Acceleration<span class="w"> </span>Development<span class="w"> </span>Platform<span class="w"> </span>N6001
<a id="__codelineno-261-2" name="__codelineno-261-2" href="#__codelineno-261-2"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller<span class="w"> </span>NIOS<span class="w"> </span>FW<span class="w"> </span>version:<span class="w"> </span><span class="m">3</span>.15.0
<a id="__codelineno-261-3" name="__codelineno-261-3" href="#__codelineno-261-3"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller<span class="w"> </span>Build<span class="w"> </span>version:<span class="w"> </span><span class="m">3</span>.15.0
<a id="__codelineno-261-4" name="__codelineno-261-4" href="#__codelineno-261-4"></a>PBA:<span class="w"> </span>B#FB2CG1@AGF14-A0P2
<a id="__codelineno-261-5" name="__codelineno-261-5" href="#__codelineno-261-5"></a>MMID:<span class="w"> </span><span class="m">217000</span>
<a id="__codelineno-261-6" name="__codelineno-261-6" href="#__codelineno-261-6"></a>SN:<span class="w"> </span>Q171211700050
<a id="__codelineno-261-7" name="__codelineno-261-7" href="#__codelineno-261-7"></a>//******<span class="w"> </span>FME<span class="w"> </span>******//
<a id="__codelineno-261-8" name="__codelineno-261-8" href="#__codelineno-261-8"></a>Interface<span class="w">                        </span>:<span class="w"> </span>DFL
<a id="__codelineno-261-9" name="__codelineno-261-9" href="#__codelineno-261-9"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xEF00000
<a id="__codelineno-261-10" name="__codelineno-261-10" href="#__codelineno-261-10"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.0
<a id="__codelineno-261-11" name="__codelineno-261-11" href="#__codelineno-261-11"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-261-12" name="__codelineno-261-12" href="#__codelineno-261-12"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-261-13" name="__codelineno-261-13" href="#__codelineno-261-13"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-261-14" name="__codelineno-261-14" href="#__codelineno-261-14"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-261-15" name="__codelineno-261-15" href="#__codelineno-261-15"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x00
<a id="__codelineno-261-16" name="__codelineno-261-16" href="#__codelineno-261-16"></a>Ports<span class="w"> </span>Num<span class="w">                        </span>:<span class="w"> </span><span class="m">01</span>
<a id="__codelineno-261-17" name="__codelineno-261-17" href="#__codelineno-261-17"></a>Bitstream<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span><span class="m">360571653789875893</span>
<a id="__codelineno-261-18" name="__codelineno-261-18" href="#__codelineno-261-18"></a>Bitstream<span class="w"> </span>Version<span class="w">                </span>:<span class="w"> </span><span class="m">5</span>.0.1
<a id="__codelineno-261-19" name="__codelineno-261-19" href="#__codelineno-261-19"></a>Pr<span class="w"> </span>Interface<span class="w"> </span>Id<span class="w">                  </span>:<span class="w"> </span>5d4500ed-e5e5-5521-8865-e47f0c517fac
<a id="__codelineno-261-20" name="__codelineno-261-20" href="#__codelineno-261-20"></a>Boot<span class="w"> </span>Page<span class="w">                        </span>:<span class="w"> </span>user1
<a id="__codelineno-261-21" name="__codelineno-261-21" href="#__codelineno-261-21"></a>Factory<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">               </span>:<span class="w"> </span>9035190d637c383453173deb5de25fdd
<a id="__codelineno-261-22" name="__codelineno-261-22" href="#__codelineno-261-22"></a>User1<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">                 </span>:<span class="w"> </span>893e691edfccfd0aecb1c332ad69551b
<a id="__codelineno-261-23" name="__codelineno-261-23" href="#__codelineno-261-23"></a>User2<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">                 </span>:<span class="w"> </span>8cd2ae8073e194525bcd682f50935fc7
</code></pre></div>
</li>
<li>
<p>Remove the card from PCIe prior to programming. This will disable <abbr title="Advanced Error Reporting, The PCIe AER driver is the extended PCI Express error reporting capability providing more robust error reporting.">AER</abbr> for the PCIe root port to prevent a surprise link-down event during programming.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-262-1" name="__codelineno-262-1" href="#__codelineno-262-1"></a>sudo<span class="w"> </span>pci_device<span class="w"> </span>b1:00.0<span class="w"> </span>unplug
</code></pre></div>
</li>
<li>
<p>Switch to the machine with <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> connection to the n6001, if different than your deployment machine.</p>
</li>
<li>
<p>Open the Quartus programmer GUI</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-263-1" name="__codelineno-263-1" href="#__codelineno-263-1"></a>quartus_pgmw
</code></pre></div>
<p><a class="glightbox" href="../images/quartus_pgmw.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="quartus_pgmw" src="../images/quartus_pgmw.png" /></a></p>
</li>
<li>
<p>Click <strong>Hardware Setup</strong> to open the Hardware Setup dialog window.</p>
<ol>
<li>
<p>In the <strong>Currently selected hardware</strong> field select the n6001.</p>
</li>
<li>
<p>In the <strong>Hardware frequency</strong> field enter <code>16000000</code> Hz</p>
<p><a class="glightbox" href="../images/stp_hardware_setup.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="quartus_pgmw_hardware_setup" src="../images/stp_hardware_setup.png" /></a></p>
</li>
<li>
<p>Click <strong>Close</strong></p>
</li>
</ol>
</li>
<li>
<p>In the <strong>Quartus Prime Programmer</strong> window, click <strong>Auto Detect</strong>.</p>
</li>
<li>
<p>If prompted, select the AGFB014R24A2E2V device. The <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> chain should show the divice.</p>
<p><a class="glightbox" href="../images/stp_autodetect_agilex.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="quartus_pgmw_device_chain" src="../images/stp_autodetect_agilex.png" /></a></p>
</li>
<li>
<p>Right click the AGFB014R24A2E2V row and selct <strong>Change File</strong>.</p>
<p><a class="glightbox" href="../images/stp_change_file_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="quartus_pgmw_change_file" src="../images/stp_change_file_hello_fim.png" /></a></p>
</li>
<li>
<p>In the <strong>Select New Programming File</strong> window that opens, select the <code>.sof</code> image you wish to program and click <strong>Open</strong>.</p>
</li>
<li>
<p>Check the <strong>Program/Configure</strong> box for the AGFB014R24A2E2V row, then click <strong>Start</strong>. Wait for the <strong>Progress</strong> bar to show <code>100% (Success)</code>.</p>
</li>
<li>
<p>Close the Quartus Programmer GUI. You can answer 'No' if a dialog pops up asking to save the <strong>'Chain.cdf'</strong> file</p>
</li>
<li>
<p>Switch to the deployment environment, if different than the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> connected machine.</p>
</li>
<li>
<p>Replug the board PCIe</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-264-1" name="__codelineno-264-1" href="#__codelineno-264-1"></a>sudo<span class="w"> </span>pci_device<span class="w"> </span>b1:00.0<span class="w"> </span>plug
</code></pre></div>
</li>
<li>
<p>Run <code>fpgainfo fme</code> to verify communication with the board, and to check the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> Interface ID.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-265-1" name="__codelineno-265-1" href="#__codelineno-265-1"></a>Intel<span class="w"> </span>Acceleration<span class="w"> </span>Development<span class="w"> </span>Platform<span class="w"> </span>N6001
<a id="__codelineno-265-2" name="__codelineno-265-2" href="#__codelineno-265-2"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller<span class="w"> </span>NIOS<span class="w"> </span>FW<span class="w"> </span>version:<span class="w"> </span><span class="m">3</span>.15.0
<a id="__codelineno-265-3" name="__codelineno-265-3" href="#__codelineno-265-3"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller<span class="w"> </span>Build<span class="w"> </span>version:<span class="w"> </span><span class="m">3</span>.15.0
<a id="__codelineno-265-4" name="__codelineno-265-4" href="#__codelineno-265-4"></a>PBA:<span class="w"> </span>B#FB2CG1@AGF14-A0P2
<a id="__codelineno-265-5" name="__codelineno-265-5" href="#__codelineno-265-5"></a>MMID:<span class="w"> </span><span class="m">217000</span>
<a id="__codelineno-265-6" name="__codelineno-265-6" href="#__codelineno-265-6"></a>SN:<span class="w"> </span>Q171211700050
<a id="__codelineno-265-7" name="__codelineno-265-7" href="#__codelineno-265-7"></a>//******<span class="w"> </span>FME<span class="w"> </span>******//
<a id="__codelineno-265-8" name="__codelineno-265-8" href="#__codelineno-265-8"></a>Interface<span class="w">                        </span>:<span class="w"> </span>DFL
<a id="__codelineno-265-9" name="__codelineno-265-9" href="#__codelineno-265-9"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xEF00000
<a id="__codelineno-265-10" name="__codelineno-265-10" href="#__codelineno-265-10"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.0
<a id="__codelineno-265-11" name="__codelineno-265-11" href="#__codelineno-265-11"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-265-12" name="__codelineno-265-12" href="#__codelineno-265-12"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-265-13" name="__codelineno-265-13" href="#__codelineno-265-13"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-265-14" name="__codelineno-265-14" href="#__codelineno-265-14"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-265-15" name="__codelineno-265-15" href="#__codelineno-265-15"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x00
<a id="__codelineno-265-16" name="__codelineno-265-16" href="#__codelineno-265-16"></a>Ports<span class="w"> </span>Num<span class="w">                        </span>:<span class="w"> </span><span class="m">01</span>
<a id="__codelineno-265-17" name="__codelineno-265-17" href="#__codelineno-265-17"></a>Bitstream<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span><span class="m">360571653789875893</span>
<a id="__codelineno-265-18" name="__codelineno-265-18" href="#__codelineno-265-18"></a>Bitstream<span class="w"> </span>Version<span class="w">                </span>:<span class="w"> </span><span class="m">5</span>.0.1
<a id="__codelineno-265-19" name="__codelineno-265-19" href="#__codelineno-265-19"></a>Pr<span class="w"> </span>Interface<span class="w"> </span>Id<span class="w">                  </span>:<span class="w"> </span>5d4500ed-e5e5-5521-8865-e47f0c517fac
<a id="__codelineno-265-20" name="__codelineno-265-20" href="#__codelineno-265-20"></a>Boot<span class="w"> </span>Page<span class="w">                        </span>:<span class="w"> </span>user1
<a id="__codelineno-265-21" name="__codelineno-265-21" href="#__codelineno-265-21"></a>Factory<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">               </span>:<span class="w"> </span>9035190d637c383453173deb5de25fdd
<a id="__codelineno-265-22" name="__codelineno-265-22" href="#__codelineno-265-22"></a>User1<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">                 </span>:<span class="w"> </span>893e691edfccfd0aecb1c332ad69551b
<a id="__codelineno-265-23" name="__codelineno-265-23" href="#__codelineno-265-23"></a>User2<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">                 </span>:<span class="w"> </span>8cd2ae8073e194525bcd682f50935fc7
</code></pre></div>
</li>
</ol>
<h4 id="53-remote-system-update"><strong>5.3 Remote System Update</strong><a class="headerlink" href="#53-remote-system-update" title="Permanent link">&para;</a></h4>
<p>The OPAE <code>fpgasupdate</code> tool can be used to update the Intel Max10 Board Management Controller (<abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr>) image and firmware (FW), root entry hash, and FPGA Static Region (SR) and user image (<abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr>). The <code>fpgasupdate</code> tool only accepts images that have been formatted using PACsign. If a root entry hash has been programmed onto the board, then you must also sign the image using the correct keys. Refer to the <a href="https://github.com/otcshare/ofs-bmc/blob/main/docs/user_guides/security/">Security User Guide: Intel Open FPGA Stack</a> for information on created signed images and on programming and managing the root entry hash.  </p>
<p>The Intel® FPGA SmartNIC N6001-PL ships with a factory, user1, and user2 programmed image for both the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> FW and RTL on all cards. The platform ships with a single <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> image that can be programmed into either user1 or user2, depending in the image selected.</p>
<h5 id="531-walkthrough-program-the-fpga-via-rsu"><strong>5.3.1 Walkthrough: Program the FPGA via <abbr title="Remote System Update, A Remote System Update operation sends an instruction to the Intel FPGA PAC D5005 device that triggers a power cycle of the card only, forcing reconfiguration.">RSU</abbr></strong><a class="headerlink" href="#531-walkthrough-program-the-fpga-via-rsu" title="Permanent link">&para;</a></h5>
<p>This walkthrough describes the steps to program the Agilex FPGA on the Intel® FPGA SmartNIC N6001-PL with a <code>BIN</code> image via <abbr title="Remote System Update, A Remote System Update operation sends an instruction to the Intel FPGA PAC D5005 device that triggers a power cycle of the card only, forcing reconfiguration.">RSU</abbr>.</p>
<p>Pre-Requisites:</p>
<ul>
<li>This walkthrough requires an <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Agilex PCIe Attach deployment environment. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/">Getting Started Guide: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Agilex® 7 PCIe Attach FPGAs (Intel® FPGA SmartNIC N6001-PL/N6000-PL)</a> for instructions on setting up a deployment environment.</li>
</ul>
<ul>
<li>This walkthrough requires a <code>BIN</code> image which will be programmed to the Agilex FPGA. Refer to the <a href="https://ofs.github.io/ofs-2024.1-1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#225-walkthrough-compile-ofs-fim">Compile <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></a> Section for step-by-step instructions for generating a <code>BIN</code> image. The image used for programming must be formatted with PACsign before programming. This is done automatically by the build script.</li>
</ul>
<p>Steps:</p>
<ol>
<li>
<p>Start in your deployment environment.</p>
</li>
<li>
<p>Determine the PCIe B:D.F of the card using OPAE command <code>fpgainfo fme</code>. In this example, the PCIe B:D.F is <code>B1:00.0</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-266-1" name="__codelineno-266-1" href="#__codelineno-266-1"></a>fpgainfo<span class="w"> </span>fme
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-267-1" name="__codelineno-267-1" href="#__codelineno-267-1"></a>Intel<span class="w"> </span>Acceleration<span class="w"> </span>Development<span class="w"> </span>Platform<span class="w"> </span>N6001
<a id="__codelineno-267-2" name="__codelineno-267-2" href="#__codelineno-267-2"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller<span class="w"> </span>NIOS<span class="w"> </span>FW<span class="w"> </span>version:<span class="w"> </span><span class="m">3</span>.15.0
<a id="__codelineno-267-3" name="__codelineno-267-3" href="#__codelineno-267-3"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller<span class="w"> </span>Build<span class="w"> </span>version:<span class="w"> </span><span class="m">3</span>.15.0
<a id="__codelineno-267-4" name="__codelineno-267-4" href="#__codelineno-267-4"></a>PBA:<span class="w"> </span>B#FB2CG1@AGF14-A0P2
<a id="__codelineno-267-5" name="__codelineno-267-5" href="#__codelineno-267-5"></a>MMID:<span class="w"> </span><span class="m">217000</span>
<a id="__codelineno-267-6" name="__codelineno-267-6" href="#__codelineno-267-6"></a>SN:<span class="w"> </span>Q171211700050
<a id="__codelineno-267-7" name="__codelineno-267-7" href="#__codelineno-267-7"></a>//******<span class="w"> </span>FME<span class="w"> </span>******//
<a id="__codelineno-267-8" name="__codelineno-267-8" href="#__codelineno-267-8"></a>Interface<span class="w">                        </span>:<span class="w"> </span>DFL
<a id="__codelineno-267-9" name="__codelineno-267-9" href="#__codelineno-267-9"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xEF00000
<a id="__codelineno-267-10" name="__codelineno-267-10" href="#__codelineno-267-10"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.0
<a id="__codelineno-267-11" name="__codelineno-267-11" href="#__codelineno-267-11"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-267-12" name="__codelineno-267-12" href="#__codelineno-267-12"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-267-13" name="__codelineno-267-13" href="#__codelineno-267-13"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-267-14" name="__codelineno-267-14" href="#__codelineno-267-14"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-267-15" name="__codelineno-267-15" href="#__codelineno-267-15"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x00
<a id="__codelineno-267-16" name="__codelineno-267-16" href="#__codelineno-267-16"></a>Ports<span class="w"> </span>Num<span class="w">                        </span>:<span class="w"> </span><span class="m">01</span>
<a id="__codelineno-267-17" name="__codelineno-267-17" href="#__codelineno-267-17"></a>Bitstream<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span><span class="m">360571653789875893</span>
<a id="__codelineno-267-18" name="__codelineno-267-18" href="#__codelineno-267-18"></a>Bitstream<span class="w"> </span>Version<span class="w">                </span>:<span class="w"> </span><span class="m">5</span>.0.1
<a id="__codelineno-267-19" name="__codelineno-267-19" href="#__codelineno-267-19"></a>Pr<span class="w"> </span>Interface<span class="w"> </span>Id<span class="w">                  </span>:<span class="w"> </span>5d4500ed-e5e5-5521-8865-e47f0c517fac
<a id="__codelineno-267-20" name="__codelineno-267-20" href="#__codelineno-267-20"></a>Boot<span class="w"> </span>Page<span class="w">                        </span>:<span class="w"> </span>user1
<a id="__codelineno-267-21" name="__codelineno-267-21" href="#__codelineno-267-21"></a>Factory<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">               </span>:<span class="w"> </span>9035190d637c383453173deb5de25fdd
<a id="__codelineno-267-22" name="__codelineno-267-22" href="#__codelineno-267-22"></a>User1<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">                 </span>:<span class="w"> </span>893e691edfccfd0aecb1c332ad69551b
<a id="__codelineno-267-23" name="__codelineno-267-23" href="#__codelineno-267-23"></a>User2<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">                 </span>:<span class="w"> </span>8cd2ae8073e194525bcd682f50935fc7
</code></pre></div>
</li>
<li>
<p>Use the OPAE <code>fpgasupdate</code> command to program a PACsign signed image to flash. The flash slot which will be programmed is determined by the PACsign header.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-268-1" name="__codelineno-268-1" href="#__codelineno-268-1"></a>sudo<span class="w"> </span>fpgasupdate<span class="w"> </span>&lt;IMAGE&gt;<span class="w"> </span>&lt;PCIe<span class="w"> </span>B:D.F&gt;
</code></pre></div>
<ul>
<li>
<p>Example: update User Image 1 in flash</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-269-1" name="__codelineno-269-1" href="#__codelineno-269-1"></a>sudo<span class="w"> </span>fpgasupdate<span class="w"> </span>ofs_top_page1_unsigned_user1.bin<span class="w"> </span><span class="m">98</span>:00.0
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>Example: update User Image 2 in flash</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-270-1" name="__codelineno-270-1" href="#__codelineno-270-1"></a>sudo<span class="w"> </span>fpgasupdate<span class="w"> </span>ofs_top_page2_unsigned_user2.bin<span class="w"> </span><span class="m">98</span>:00.0
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>Example: update Factory Image in flash</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-271-1" name="__codelineno-271-1" href="#__codelineno-271-1"></a>sudo<span class="w"> </span>fpgasupdate<span class="w"> </span>ofs_top_page0_unsigned_factory.bin<span class="w"> </span><span class="m">98</span>:00.0
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>Use the OPAE <code>rsu</code> command to reconfigure the FPGA with the new image. You may select which image to configure from (User 1, User 2, Factory).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-272-1" name="__codelineno-272-1" href="#__codelineno-272-1"></a>sudo<span class="w"> </span>rsu<span class="w"> </span>fpga<span class="w"> </span>--page<span class="w"> </span>&lt;PAGE&gt;<span class="w"> </span>&lt;PCIe<span class="w"> </span>B:D.F&gt;
</code></pre></div>
<ul>
<li>
<p>Example: configure FPGA with User 1 Image</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-273-1" name="__codelineno-273-1" href="#__codelineno-273-1"></a>sudo<span class="w"> </span>rsu<span class="w"> </span>fpga<span class="w"> </span>--page<span class="w"> </span>user1<span class="w"> </span><span class="m">98</span>:00.0
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>Example: configure FPGA with User 2 Image</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-274-1" name="__codelineno-274-1" href="#__codelineno-274-1"></a>sudo<span class="w"> </span>rsu<span class="w"> </span>fpga<span class="w"> </span>--page<span class="w"> </span>user2<span class="w"> </span><span class="m">98</span>:00.0
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>Example: configure FPGA with Factory Image</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-275-1" name="__codelineno-275-1" href="#__codelineno-275-1"></a>sudo<span class="w"> </span>rsu<span class="w"> </span>fpga<span class="w"> </span>--page<span class="w"> </span>factory<span class="w"> </span><span class="m">98</span>:00.0
</code></pre></div>
</li>
</ul>
</li>
</ol>
<h2 id="appendix"><strong>Appendix</strong><a class="headerlink" href="#appendix" title="Permanent link">&para;</a></h2>
<h3 id="appendix-a-resource-utilization-tables"><strong>Appendix A: Resource Utilization Tables</strong><a class="headerlink" href="#appendix-a-resource-utilization-tables" title="Permanent link">&para;</a></h3>
<p><strong>Table A-1</strong> Default Out-of-Tree <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Resource Utilization</p>
<table>
<thead>
<tr>
<th>Compilation Hierarchy Node</th>
<th>ALMs needed</th>
<th>ALM Utilization %</th>
<th>M20Ks</th>
<th>M20K Utilization %</th>
</tr>
</thead>
<tbody>
<tr>
<td>top</td>
<td>181,018.30</td>
<td>37.15</td>
<td>784</td>
<td>11.03</td>
</tr>
<tr>
<td>afu_top</td>
<td>104,994.20</td>
<td>21.55</td>
<td>287</td>
<td>4.04</td>
</tr>
<tr>
<td>pcie_wrapper</td>
<td>36,565.00</td>
<td>7.51</td>
<td>195</td>
<td>2.74</td>
</tr>
<tr>
<td>hssi_wrapper</td>
<td>20,132.10</td>
<td>4.13</td>
<td>173</td>
<td>2.43</td>
</tr>
<tr>
<td>mem_ss_top</td>
<td>9,092.80</td>
<td>1.87</td>
<td>76</td>
<td>1.07</td>
</tr>
<tr>
<td>pmci_wrapper</td>
<td>4,269.30</td>
<td>0.88</td>
<td>26</td>
<td>0.37</td>
</tr>
<tr>
<td>alt_sld_fab_0</td>
<td>2,726.90</td>
<td>0.56</td>
<td>13</td>
<td>0.18</td>
</tr>
<tr>
<td>bpf</td>
<td>1,364.60</td>
<td>0.28</td>
<td>0</td>
<td>0.00</td>
</tr>
<tr>
<td>qsfp_top</td>
<td>620.10</td>
<td>0.13</td>
<td>4</td>
<td>0.06</td>
</tr>
<tr>
<td>fme_top</td>
<td>615.30</td>
<td>0.13</td>
<td>6</td>
<td>0.08</td>
</tr>
<tr>
<td>qsfp_top</td>
<td>614.00</td>
<td>0.13</td>
<td>4</td>
<td>0.06</td>
</tr>
<tr>
<td>rst_ctrl</td>
<td>17.90</td>
<td>0.00</td>
<td>0</td>
<td>0.00</td>
</tr>
<tr>
<td>sys_pll</td>
<td>0.50</td>
<td>0.00</td>
<td>0</td>
<td>0.00</td>
</tr>
<tr>
<td>hps_ss</td>
<td>0.00</td>
<td>0.00</td>
<td>0</td>
<td>0.00</td>
</tr>
</tbody>
</table>
<p><strong>Table A-2</strong> Minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Resource Utilization</p>
<table>
<thead>
<tr>
<th>Compilation Hierarchy Node</th>
<th>ALMs needed</th>
<th>ALM Utilization %</th>
<th>M20Ks</th>
<th>M20K Utilization %</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>103192.5</td>
<td>21.18</td>
<td>410</td>
<td>5.77</td>
</tr>
<tr>
<td>afu_top</td>
<td>45848.7</td>
<td>9.41</td>
<td>150</td>
<td>2.11</td>
</tr>
<tr>
<td>auto_fab_0</td>
<td>1770.1</td>
<td>0.36</td>
<td>9</td>
<td>0.13</td>
</tr>
<tr>
<td>bpf</td>
<td>1265.8</td>
<td>0.26</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr>
<td>fme_top</td>
<td>662.4</td>
<td>0.14</td>
<td>6</td>
<td>0.08</td>
</tr>
<tr>
<td>hps_ss</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr>
<td>hssi_dummy_csr</td>
<td>675.5</td>
<td>0.14</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr>
<td>mem_ss_top</td>
<td>8723.9</td>
<td>1.79</td>
<td>60</td>
<td>0.84</td>
</tr>
<tr>
<td>pcie_wrapper</td>
<td>38361.7</td>
<td>7.87</td>
<td>159</td>
<td>2.24</td>
</tr>
<tr>
<td>pmci_wrapper</td>
<td>4509.9</td>
<td>0.93</td>
<td>26</td>
<td>0.37</td>
</tr>
<tr>
<td>qsfp0_dummy_csr</td>
<td>672.2</td>
<td>0.14</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr>
<td>qsfp1_dummy_csr</td>
<td>681.7</td>
<td>0.14</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr>
<td>rst_ctrl</td>
<td>18.0</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
</tr>
<tr>
<td>sys_pll</td>
<td>0.5</td>
<td>0.0</td>
<td>0</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<h3 id="appendix-b-glossary"><strong>Appendix B: Glossary</strong><a class="headerlink" href="#appendix-b-glossary" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th align="center">Term</th>
<th align="center">Abbreviation</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Advanced Error Reporting</td>
<td align="center"><abbr title="Advanced Error Reporting, The PCIe AER driver is the extended PCI Express error reporting capability providing more robust error reporting.">AER</abbr></td>
<td>The PCIe <abbr title="Advanced Error Reporting, The PCIe AER driver is the extended PCI Express error reporting capability providing more robust error reporting.">AER</abbr> driver is the extended PCI Express error reporting capability providing more robust error reporting. <a href="https://docs.kernel.org/PCI/pcieaer-howto.html?highlight=aer">(link)</a></td>
</tr>
<tr>
<td align="center">Accelerator Functional Unit</td>
<td align="center"><abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr></td>
<td>Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> region is the part of the design where an <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> may reside. This <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> may or may not be a partial reconfiguration region.</td>
</tr>
<tr>
<td align="center">Basic Building Block</td>
<td align="center"><abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr></td>
<td>Features within an <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>'s <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> and host interface requires. All BBBs must have a (globally unique identifier) GUID.</td>
</tr>
<tr>
<td align="center">Best Known Configuration</td>
<td align="center"><abbr title="Best Known Configuration, The exact hardware configuration Intel has optimized and validated the solution against.">BKC</abbr></td>
<td>The software and hardware configuration Intel uses to verify the solution.</td>
</tr>
<tr>
<td align="center">Board Management Controller</td>
<td align="center"><abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr></td>
<td>Supports features such as board power managment, flash management, configuration management, and board telemetry monitoring and protection. The majority of the <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> logic is in a separate component, such as an Intel® Max® 10 or Intel Cyclone® 10 device; a small portion of the <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> known as the PMCI resides in the main Agilex FPGA.</td>
</tr>
<tr>
<td align="center">Configuration and Status Register</td>
<td align="center">CSR</td>
<td>The generic name for a register space which is accessed in order to interface with the module it resides in (e.g. <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>, <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr>, various sub-systems and modules).</td>
</tr>
<tr>
<td align="center">Data Parallel C++</td>
<td align="center">DPC++</td>
<td>DPC++ is Intel’s implementation of the SYCL standard. It supports additional attributes and language extensions which ensure DCP++ (SYCL) is efficiently implanted on Intel hardware.</td>
</tr>
<tr>
<td align="center">Device Feature List</td>
<td align="center"><abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr></td>
<td>The <abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr>, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the <abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr> driver to automatically load the drivers required for a given FPGA configuration. This concept is the foundation for the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> software framework. <a href="https://docs.kernel.org/fpga/dfl.html">(link)</a></td>
</tr>
<tr>
<td align="center">FPGA Interface Manager</td>
<td align="center"><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></td>
<td>Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> resides in the static region of the FPGA and contains the FPGA Management Engine (<abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr>) and I/O ring.</td>
</tr>
<tr>
<td align="center">FPGA Management Engine</td>
<td align="center"><abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr></td>
<td>Performs reconfiguration and other FPGA management functions. Each FPGA device only has one <abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr> which is accessed through PF0.</td>
</tr>
<tr>
<td align="center">Host Exerciser Module</td>
<td align="center"><abbr title="Host Exerciser Module, Host exercisers are used to exercise and characterize the various host-FPGA interactions, including Memory Mapped Input/Output (MMIO), data transfer from host to FPGA, PR, host to FPGA memory, etc.">HEM</abbr></td>
<td>Host exercisers are used to exercise and characterize the various host-FPGA interactions, including Memory Mapped Input/Output (<abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr>), data transfer from host to FPGA, <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr>, host to FPGA memory, etc.</td>
</tr>
<tr>
<td align="center">Input/Output Control</td>
<td align="center"><abbr title="Input/Output Control, System calls used to manipulate underlying device parameters of special files.">IOCTL</abbr></td>
<td>System calls used to manipulate underlying device parameters of special files.</td>
</tr>
<tr>
<td align="center">Intel Virtualization Technology for Directed I/O</td>
<td align="center"><abbr title="Intel Virtualization Technology for Directed I/O, Extension of the VT-x and VT-I processor virtualization technologies which adds new support for I/O device virtualization.">Intel VT-d</abbr></td>
<td>Extension of the VT-x and VT-I processor virtualization technologies which adds new support for I/O device virtualization.</td>
</tr>
<tr>
<td align="center">Joint Test Action Group</td>
<td align="center"><abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr></td>
<td>Refers to the IEEE 1149.1 <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> standard; Another FPGA configuration methodology.</td>
</tr>
<tr>
<td align="center">Memory Mapped Input/Output</td>
<td align="center"><abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr></td>
<td>The memory space users may map and access both control registers and system memory buffers with accelerators.</td>
</tr>
<tr>
<td align="center">oneAPI Accelerator Support Package</td>
<td align="center">oneAPI-asp</td>
<td>A collection of hardware and software components that enable oneAPI kernel to communicate with oneAPI runtime and <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> shell components. oneAPI ASP hardware components and oneAPI kernel form the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> region of a oneAPI system in <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>.</td>
</tr>
<tr>
<td align="center">Open FPGA Stack</td>
<td align="center"><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr></td>
<td><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> is a software and hardware infrastructure providing an efficient approach to develop a custom FPGA-based platform or workload using an Intel, 3<sup>rd</sup> party, or custom board.</td>
</tr>
<tr>
<td align="center">Open Programmable Acceleration Engine Software Development Kit</td>
<td align="center"><abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr></td>
<td>The <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> is a software framework for managing and accessing programmable accelerators (FPGAs). It consists of a collection of libraries and tools to facilitate the development of software applications and accelerators. The <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> resides exclusively in user-space.</td>
</tr>
<tr>
<td align="center">Platform Interface Manager</td>
<td align="center"><abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr></td>
<td>An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> developers can use to handle clock crossing, response sorting, buffering and different protocols.</td>
</tr>
<tr>
<td align="center">Platform Management Controller Interface</td>
<td align="center">PMCI</td>
<td>The portion of the <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> that resides in the Agilex FPGA and allows the FPGA to communicate with the primary <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> component on the board.</td>
</tr>
<tr>
<td align="center">Partial Reconfiguration</td>
<td align="center"><abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr></td>
<td>The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. For <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> designs, the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region is referred to as the pr_slot.</td>
</tr>
<tr>
<td align="center">Port</td>
<td align="center">N/A</td>
<td>When used in the context of the fpgainfo port command it represents the interfaces between the static FPGA fabric and the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region containing the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>.</td>
</tr>
<tr>
<td align="center">Remote System Update</td>
<td align="center"><abbr title="Remote System Update, A Remote System Update operation sends an instruction to the Intel FPGA PAC D5005 device that triggers a power cycle of the card only, forcing reconfiguration.">RSU</abbr></td>
<td>The process by which the host can remotely update images stored in flash through PCIe. This is done with the OPAE software command "fpgasupdate".</td>
</tr>
<tr>
<td align="center">Secure Device Manager</td>
<td align="center">SDM</td>
<td>The SDM is the point of entry to the FPGA for <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> commands and interfaces, as well as for device configuration data (from flash, SD card, or through PCI Express* hard IP).</td>
</tr>
<tr>
<td align="center">Static Region</td>
<td align="center">SR</td>
<td>The portion of the FPGA design that cannot be dynamically reconfigured during run-time.</td>
</tr>
<tr>
<td align="center">Single-Root Input-Output Virtualization</td>
<td align="center"><abbr title="Single-Root Input-Output Virtualization, Allows the isolation of PCI Express resources for manageability and performance.">SR-IOV</abbr></td>
<td>Allows the isolation of PCI Express resources for manageability and performance.</td>
</tr>
<tr>
<td align="center">SYCL</td>
<td align="center">SYCL</td>
<td>SYCL (pronounced "sickle") is a royalty-free, cross-platform abstraction layer that enables code for heterogeneous and offload processors to be written using modern ISO C++ (at least C++ 17). It provides several features that make it well-suited for programming heterogeneous systems, allowing the same code to be used for CPUs, GPUs, FPGAs or any other hardware accelerator. SYCL was developed by the Khronos Group, a non-profit organization that develops open standards (including OpenCL) for graphics, compute, vision, and multimedia. SYCL is being used by a growing number of developers in a variety of industries, including automotive, aerospace, and consumer electronics.</td>
</tr>
<tr>
<td align="center">Test Bench</td>
<td align="center"><abbr title="Testbench, Testbench or Verification Environment is used to check the functional correctness of the Design Under Test (DUT) by generating and driving a predefined input sequence to a design, capturing the design output and comparing with-respect-to expected output.">TB</abbr></td>
<td>Testbench or Verification Environment is used to check the functional correctness of the Design Under Test (DUT) by generating and driving a predefined input sequence to a design, capturing the design output and comparing with-respect-to expected output.</td>
</tr>
<tr>
<td align="center">Universal Verification Methodology</td>
<td align="center"><abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr></td>
<td>A modular, reusable, and scalable testbench structure via an API framework.  In the context of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>, the <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> enviroment provides a system level simulation environment for your design.</td>
</tr>
<tr>
<td align="center">Virtual Function Input/Output</td>
<td align="center"><abbr title="Virtual Function Input/Output, An IOMMU/device agnostic framework for exposing direct device access to userspace.">VFIO</abbr></td>
<td>An Input-Output Memory Management Unit (IOMMU)/device agnostic framework for exposing direct device access to userspace. (link)</td>
</tr>
</tbody>
</table>
<h2 id="notices-disclaimers">Notices &amp; Disclaimers<a class="headerlink" href="#notices-disclaimers" title="Permanent link">&para;</a></h2>
<p>Intel<sup>&reg;</sup> technologies may require enabled hardware, software or service activation.
No product or component can be absolutely secure. 
Performance varies by use, configuration and other factors.
Your costs and results may vary. 
You may not use or facilitate the use of this document in connection with any infringement or other legal analysis concerning Intel products described herein. You agree to grant Intel a non-exclusive, royalty-free license to any patent claim thereafter drafted which includes subject matter disclosed herein.
No license (express or implied, by estoppel or otherwise) to any intellectual property rights is granted by this document, with the sole exception that you may publish an unmodified copy. You may create software implementations based on this document and in compliance with the foregoing that are intended to execute on the Intel product(s) referenced in this document. No rights are granted to create modifications or derivatives of this document.
The products described may contain design defects or errors known as errata which may cause the product to deviate from published specifications.  Current characterized errata are available on request.
Intel disclaims all express and implied warranties, including without limitation, the implied warranties of merchantability, fitness for a particular purpose, and non-infringement, as well as any warranty arising from course of performance, course of dealing, or usage in trade.
You are responsible for safety of the overall system, including compliance with applicable safety-related requirements or standards. 
<sup>&copy;</sup> Intel Corporation.  Intel, the Intel logo, and other Intel marks are trademarks of Intel Corporation or its subsidiaries.  Other names and brands may be claimed as the property of others. </p>
<p>OpenCL and the OpenCL logo are trademarks of Apple Inc. used by permission of the Khronos Group™. </p>
<!-- include ./docs/hw/common/doc_modules/links.md -->
<!-- include ./docs/hw/n6001/doc_modules/links.md -->
<!-- include ./docs/hw/doc_modules/links.md -->





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.indexes", "search.suggest", "search.highlight", "content.code.copy", "navigation.indexes", "toc.follow"], "search": "../../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "ofs-2023.1", "provider": "mike"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.fac441b0.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>