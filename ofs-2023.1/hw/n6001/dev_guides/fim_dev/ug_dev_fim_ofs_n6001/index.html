
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../../reference_manuals/ofs_fim/mnl_fim_ofs_n6001/">
      
      
        <link rel="next" href="../../afu_dev/ug_dev_afu_ofs_n6001/">
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.9">
    
    
      
        <title>FPGA Interface Manager Developer Guide - OFS</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.85bb2934.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#fpga-interface-manager-developer-guide-for-intel-agilex-pcie-attach-open-fpga-stack" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="OFS" class="md-header__button md-logo" aria-label="OFS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OFS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              FPGA Interface Manager Developer Guide
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ofs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ofs
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../d5005/user_guides/ug_eval_ofs_d5005/ug_eval_script_ofs_d5005/" class="md-tabs__link">
        Stratix 10 PCIe Attach OFS
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../user_guides/ug_eval_ofs_n6001/ug_eval_script_ofs_n6001/" class="md-tabs__link md-tabs__link--active">
        Agilex PCIe Attach OFS
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../f2000x/user_guides/ug_eval_ofs/ug_eval_script_ofs_f2000x/" class="md-tabs__link">
        Agilex SoC Attach OFS
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../common/user_guides/oneapi_asp/ug_oneapi_asp/" class="md-tabs__link">
        oneAPI
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../sw/fpga_api/quick_start/readme/" class="md-tabs__link">
        OFS Software
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="OFS" class="md-nav__button md-logo" aria-label="OFS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    OFS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ofs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ofs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Stratix 10 PCIe Attach OFS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Stratix 10 PCIe Attach OFS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/user_guides/ug_eval_ofs_d5005/ug_eval_script_ofs_d5005/" class="md-nav__link">
        Quick Start Evaluation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/user_guides/ug_qs_ofs_d5005/ug_qs_ofs_d5005/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/reference_manuals/ofs_fim/mnl_fim_ofs_d5005/" class="md-nav__link">
        FPGA Interface Manager Technical Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/dev_guides/fim_dev/ug_dev_fim_ofs_d5005/" class="md-nav__link">
        FPGA Interface Manager Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/dev_guides/afu_dev/ug_dev_afu_d5005/" class="md-nav__link">
        AFU Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../d5005/user_guides/ug_sim_ofs_d5005/ug_sim_ofs_d5005/" class="md-nav__link">
        Simulation User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_docker/ug_docker/" class="md-nav__link">
        Docker User guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_kvm/ug_kvm/" class="md-nav__link">
        KVM User guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Agilex PCIe Attach OFS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Agilex PCIe Attach OFS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_eval_ofs_n6001/ug_eval_script_ofs_n6001/" class="md-nav__link">
        Quick Start Evaluation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference_manuals/ofs_fim/mnl_fim_ofs_n6001/" class="md-nav__link">
        FPGA Interface Manager Technical Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          FPGA Interface Manager Developer Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        FPGA Interface Manager Developer Guide
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    1. Introduction
  </a>
  
    <nav class="md-nav" aria-label="1. Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-about-this-document" class="md-nav__link">
    1.1. About This Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#111-glossary" class="md-nav__link">
    1.1.1. Glossary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-release-capabilities" class="md-nav__link">
    1.2. Release Capabilities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-prerequisites" class="md-nav__link">
    1.3. Prerequisites
  </a>
  
    <nav class="md-nav" aria-label="1.3. Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131-tutorial-prerequisites" class="md-nav__link">
    1.3.1. Tutorial Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132-base-knowledge-and-skills-prerequisites" class="md-nav__link">
    1.3.2. Base Knowledge and Skills Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#133-development-environment" class="md-nav__link">
    1.3.3. Development Environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-top-level-description" class="md-nav__link">
    2. Top Level Description
  </a>
  
    <nav class="md-nav" aria-label="2. Top Level Description">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-top-level-fpga" class="md-nav__link">
    2.1. Top Level FPGA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-fim-fpga-resource-usage" class="md-nav__link">
    2.2. FIM FPGA Resource Usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-description-of-sub-systems" class="md-nav__link">
    3. Description of Sub-Systems
  </a>
  
    <nav class="md-nav" aria-label="3. Description of Sub-Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-host-control-and-data-flow" class="md-nav__link">
    3.1. Host Control and Data Flow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-high-level-development-flow" class="md-nav__link">
    4. High Level Development Flow
  </a>
  
    <nav class="md-nav" aria-label="4. High Level Development Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-installation-of-ofs" class="md-nav__link">
    4.1. Installation of OFS
  </a>
  
    <nav class="md-nav" aria-label="4.1. Installation of OFS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#411-clone-the-ofs-git-repo" class="md-nav__link">
    4.1.1. Clone the OFS Git Repo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-directory-structure-of-ofs" class="md-nav__link">
    4.2. Directory Structure of OFS
  </a>
  
    <nav class="md-nav" aria-label="4.2. Directory Structure of OFS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#421-install-quartus-patches" class="md-nav__link">
    4.2.1. Install Quartus Patches
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-compiling-the-ofs-fim" class="md-nav__link">
    4.3. Compiling the OFS FIM
  </a>
  
    <nav class="md-nav" aria-label="4.3. Compiling the OFS FIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#431-setting-up-required-environment-variables" class="md-nav__link">
    4.3.1. Setting Up Required Environment Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#432-compiling-the-intel-fpga-smartnic-n6001-pl-fim" class="md-nav__link">
    4.3.2. Compiling the Intel® FPGA SmartNIC N6001-PL FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#433-create-a-relocatable-pr-directory-tree" class="md-nav__link">
    4.3.3. Create a Relocatable PR Directory Tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#434-flat-build" class="md-nav__link">
    4.3.4. Flat Build
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-unit-level-simulation" class="md-nav__link">
    4.4. Unit Level Simulation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-creating-a-custom-fim" class="md-nav__link">
    5. Creating a Custom FIM
  </a>
  
    <nav class="md-nav" aria-label="5. Creating a Custom FIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-creating-the-hello-fim-example" class="md-nav__link">
    5.1. Creating the Hello FIM example
  </a>
  
    <nav class="md-nav" aria-label="5.1. Creating the Hello FIM example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#511-board-peripheral-fabric-bpf" class="md-nav__link">
    5.1.1. Board Peripheral Fabric (BPF)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#512-mmio-region" class="md-nav__link">
    5.1.2. MMIO Region
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#513-hello-fim-csr" class="md-nav__link">
    5.1.3. Hello FIM CSR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#514-list-of-all-files-to-edit" class="md-nav__link">
    5.1.4. List of all files to edit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#515-setup-enviroment-variables" class="md-nav__link">
    5.1.5. Setup Enviroment Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#516-file-modification" class="md-nav__link">
    5.1.6. File Modification
  </a>
  
    <nav class="md-nav" aria-label="5.1.6. File Modification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#517-modify-bpf-manually-in-platform-designer" class="md-nav__link">
    5.1.7. Modify BPF manually in Platform Designer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#518-unit-level-simulation-of-hello-fim-design" class="md-nav__link">
    5.1.8. Unit Level Simulation of Hello FIM Design
  </a>
  
    <nav class="md-nav" aria-label="5.1.8. Unit Level Simulation of Hello FIM Design">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5181-unit-level-simulation-file-modification" class="md-nav__link">
    5.1.8.1. Unit Level Simulation File Modification
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#519-unit-level-test-of-the-hellofim" class="md-nav__link">
    5.1.9. Unit Level test of the HelloFIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5110-uvm-verfication-of-the-hellofim" class="md-nav__link">
    5.1.10. UVM Verfication of the HelloFIM
  </a>
  
    <nav class="md-nav" aria-label="5.1.10. UVM Verfication of the HelloFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5192-run-uvm-dfh-walker-simulation" class="md-nav__link">
    5.1.9.2. Run UVM DFH Walker Simulation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5193-run-uvm-mmio-simulation" class="md-nav__link">
    5.1.9.3. Run UVM MMIO Simulation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5110-compile-the-intel-fpga-smartnic-n6001-pl-design-with-hello-fim" class="md-nav__link">
    5.1.10 Compile the Intel® FPGA SmartNIC N6001-PL Design with Hello FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5111-program-the-intel-fpga-smartnic-n6001-pl-with-the-hello_fim" class="md-nav__link">
    5.1.11 Program the Intel® FPGA SmartNIC N6001-PL with the hello_fim
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5112-verify-the-hello-fim-on-the-intel-fpga-smartnic-n6001-pl-using-opaeio-tool" class="md-nav__link">
    5.1.12 Verify the Hello FIM on the Intel® FPGA SmartNIC N6001-PL Using opae.io Tool
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-debugging-the-fim-with-signal-tap" class="md-nav__link">
    5.2. Debugging the FIM with Signal Tap
  </a>
  
    <nav class="md-nav" aria-label="5.2. Debugging the FIM with Signal Tap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#521-adding-signal-tap-to-the-hello-fim-example" class="md-nav__link">
    5.2.1. Adding Signal Tap to the Hello FIM example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#522-downloading-ofs_top_hpssof-into-the-fpga-using-jtag" class="md-nav__link">
    5.2.2 Downloading ofs_top_hps.sof into the FPGA using JTAG
  </a>
  
    <nav class="md-nav" aria-label="5.2.2 Downloading ofs_top_hps.sof into the FPGA using JTAG">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5221-connecting-to-intel-download-cable-ii" class="md-nav__link">
    5.2.2.1 Connecting to Intel Download Cable II
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5222-programming-the-fpga-image-using-jtag" class="md-nav__link">
    5.2.2.2 Programming the FPGA Image using JTAG
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#523-signal-tap-trace-acquisition-of-hello-fim-signals" class="md-nav__link">
    5.2.3. Signal Tap trace acquisition of Hello FIM signals
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-compiling-the-fim-in-preparation-for-designing-your-afu" class="md-nav__link">
    6. Compiling the FIM in preparation for designing your AFU
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-how-to-resize-the-partial-reconfiguration-region" class="md-nav__link">
    7. How to resize the Partial Reconfiguration region
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-how-to-modify-the-memory-subsystem" class="md-nav__link">
    8. How to modify the Memory Subsystem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-how-to-compile-the-fim-with-no-hssi-for-the-intel-fpga-smartnic-n6001-pl" class="md-nav__link">
    9. How to compile the FIM with no hssi for the Intel® FPGA SmartNIC N6001-PL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-how-to-change-the-pcie-device-id-and-vendor-id" class="md-nav__link">
    10. How to change the PCIe device ID and Vendor ID
  </a>
  
    <nav class="md-nav" aria-label="10. How to change the PCIe device ID and Vendor ID">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-changing-the-pcie-subsystem-device-id-and-vendor-id" class="md-nav__link">
    10.1. Changing the PCIe Subsystem Device ID and Vendor ID
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-migrating-intel-fpga-smartnic-n6001-pl-to-a-different-device-part-number" class="md-nav__link">
    11. Migrating Intel® FPGA SmartNIC N6001-PL to a different device part number
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-how-to-change-e-tile-ethernet-subsystem-from-8-x-25-gbe-to-8-x-10-gbe" class="md-nav__link">
    12. How to change E-Tile Ethernet Subsystem from 8 X 25 GbE to 8 X 10 GbE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-how-to-change-e-tile-ethernet-subsystem-from-8-x-25-gbe-to-2-x-100-gbe" class="md-nav__link">
    13. How to change E-Tile Ethernet Subsystem from 8 X 25 GbE to 2 X 100 GbE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#14-how-to-add-more-transceiver-channels-to-an-existing-fim-design" class="md-nav__link">
    14. How to add more Transceiver channels to an existing FIM design
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#15-how-to-modify-the-pfvf-mux-configuration" class="md-nav__link">
    15. How to modify the PF/VF MUX configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#16-how-to-create-a-minimal-fim" class="md-nav__link">
    16. How to Create a Minimal FIM
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#17-single-event-upset-reporting" class="md-nav__link">
    17. Single Event Upset Reporting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#18-adding-fim-image-info" class="md-nav__link">
    18. Adding FIM Image Info
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notices-disclaimers" class="md-nav__link">
    Notices &amp; Disclaimers
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../afu_dev/ug_dev_afu_ofs_n6001/" class="md-nav__link">
        AFU Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hps_dev/hps_developer_ug/" class="md-nav__link">
        HPS Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_sim_ofs_n6001/ug_sim_ofs_n6001/" class="md-nav__link">
        Simulation User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_docker/ug_docker/" class="md-nav__link">
        Docker User guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_kvm/ug_kvm/" class="md-nav__link">
        KVM User guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Agilex SoC Attach OFS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Agilex SoC Attach OFS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/user_guides/ug_eval_ofs/ug_eval_script_ofs_f2000x/" class="md-nav__link">
        Quick Start Evaluation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/user_guides/ug_qs_ofs_f2000x/ug_qs_ofs_f2000x/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/reference_manuals/ofs_fim/mnl_fim_ofs/" class="md-nav__link">
        FPGA Interface Manager Technical Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/dev_guides/fim_dev/ug_dev_fim_ofs/" class="md-nav__link">
        FPGA Interface Manager Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/dev_guides/afu_dev/ug_dev_afu_ofs_f2000x/" class="md-nav__link">
        AFU Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/user_guides/ug_sim_ofs/ug_sim_ofs/" class="md-nav__link">
        Simulation User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_docker/ug_docker/" class="md-nav__link">
        Docker User guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_kvm/ug_kvm/" class="md-nav__link">
        KVM User guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          oneAPI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          oneAPI
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/oneapi_asp/ug_oneapi_asp/" class="md-nav__link">
        oneAPI ASP Getting Started User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/reference_manual/oneapi_asp/oneapi_asp_ref_mnl/" class="md-nav__link">
        oneAPI Accelerator Support Package(ASP) Reference Manual
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          OFS Software
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          OFS Software
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
          OPAE USER GUIDES
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_1">
          <span class="md-nav__icon md-icon"></span>
          OPAE USER GUIDES
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_api/quick_start/readme/" class="md-nav__link">
        Quick Start Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/install_guide/installation_guide/" class="md-nav__link">
        OPAE Installation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_api/prog_guide/readme/" class="md-nav__link">
        OPAE C API Programming Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/pyopae/python_bindings/" class="md-nav__link">
        OPAE Python Bindings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_api/plug_guide/readme/" class="md-nav__link">
        OPAE Plugin Developers Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/reference_manual/ofs_sw/mnl_sw_ofs/" class="md-nav__link">
        Software Reference Manual
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
          OPAE LIBRARIES
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          OPAE LIBRARIES
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_api/fpga_api/" class="md-nav__link">
        OPAE C API Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_api/fpga_cxx_api/" class="md-nav__link">
        OPAE C++ Core API Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_api/fpga_python_api/" class="md-nav__link">
        OPAE Python API Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_api/plug_guide/readme/" class="md-nav__link">
        OPAE Plugin Developers Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
          OPAE LINUX KERNEL DRIVERS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          OPAE LINUX KERNEL DRIVERS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/drv_arch/drv_arch/" class="md-nav__link">
        Open Programmable Accelerator Engine (OPAE) Linux Device Driver Architecture
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../../sw/fpga_tools/fpgadiag/">OPAE FPGA TOOLS</a>
          
            <label for="__nav_6_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_4">
          <span class="md-nav__icon md-icon"></span>
          OPAE FPGA TOOLS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/fpgaconf/fpgaconf/" class="md-nav__link">
        fpgaconf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/fpgainfo/fpgainfo/" class="md-nav__link">
        fpgainfo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/fpgasupdate/fpgasupdate/" class="md-nav__link">
        fpgasupdate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/mmlink/mmlink/" class="md-nav__link">
        mmlink
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/packager/packager/" class="md-nav__link">
        packager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/userclk/userclk/" class="md-nav__link">
        userclk
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/hssi/hssi/" class="md-nav__link">
        hssi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/pci_device/pci_device/" class="md-nav__link">
        pci_device
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/opae.io/opae.io/" class="md-nav__link">
        opae.io
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/rsu/rsu/" class="md-nav__link">
        rsu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/host_exerciser/host_exerciser/" class="md-nav__link">
        host_exerciser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/hssi_ethernet/hssistats/" class="md-nav__link">
        HSSI ethernet statistics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/hssi_ethernet/hssimac/" class="md-nav__link">
        HSSI ethernet mac
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/hssi_ethernet/hssiloopback/" class="md-nav__link">
        HSSI ethernet loopback
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/mem_tg/mem_tg/" class="md-nav__link">
        mem_tg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/vabtool/vabtool/" class="md-nav__link">
        vabtool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/opaevfio/opaevfio/" class="md-nav__link">
        opaevfio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/ofs.uio/ofs.uio/" class="md-nav__link">
        ofs.uio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/opaeuio/opaeuio/" class="md-nav__link">
        opaeuio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/fpgad/fpgad/" class="md-nav__link">
        fpgad
      </a>
    </li>
  

            
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    1. Introduction
  </a>
  
    <nav class="md-nav" aria-label="1. Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-about-this-document" class="md-nav__link">
    1.1. About This Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#111-glossary" class="md-nav__link">
    1.1.1. Glossary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-release-capabilities" class="md-nav__link">
    1.2. Release Capabilities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-prerequisites" class="md-nav__link">
    1.3. Prerequisites
  </a>
  
    <nav class="md-nav" aria-label="1.3. Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131-tutorial-prerequisites" class="md-nav__link">
    1.3.1. Tutorial Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132-base-knowledge-and-skills-prerequisites" class="md-nav__link">
    1.3.2. Base Knowledge and Skills Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#133-development-environment" class="md-nav__link">
    1.3.3. Development Environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-top-level-description" class="md-nav__link">
    2. Top Level Description
  </a>
  
    <nav class="md-nav" aria-label="2. Top Level Description">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-top-level-fpga" class="md-nav__link">
    2.1. Top Level FPGA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-fim-fpga-resource-usage" class="md-nav__link">
    2.2. FIM FPGA Resource Usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-description-of-sub-systems" class="md-nav__link">
    3. Description of Sub-Systems
  </a>
  
    <nav class="md-nav" aria-label="3. Description of Sub-Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-host-control-and-data-flow" class="md-nav__link">
    3.1. Host Control and Data Flow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-high-level-development-flow" class="md-nav__link">
    4. High Level Development Flow
  </a>
  
    <nav class="md-nav" aria-label="4. High Level Development Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-installation-of-ofs" class="md-nav__link">
    4.1. Installation of OFS
  </a>
  
    <nav class="md-nav" aria-label="4.1. Installation of OFS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#411-clone-the-ofs-git-repo" class="md-nav__link">
    4.1.1. Clone the OFS Git Repo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-directory-structure-of-ofs" class="md-nav__link">
    4.2. Directory Structure of OFS
  </a>
  
    <nav class="md-nav" aria-label="4.2. Directory Structure of OFS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#421-install-quartus-patches" class="md-nav__link">
    4.2.1. Install Quartus Patches
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-compiling-the-ofs-fim" class="md-nav__link">
    4.3. Compiling the OFS FIM
  </a>
  
    <nav class="md-nav" aria-label="4.3. Compiling the OFS FIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#431-setting-up-required-environment-variables" class="md-nav__link">
    4.3.1. Setting Up Required Environment Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#432-compiling-the-intel-fpga-smartnic-n6001-pl-fim" class="md-nav__link">
    4.3.2. Compiling the Intel® FPGA SmartNIC N6001-PL FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#433-create-a-relocatable-pr-directory-tree" class="md-nav__link">
    4.3.3. Create a Relocatable PR Directory Tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#434-flat-build" class="md-nav__link">
    4.3.4. Flat Build
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-unit-level-simulation" class="md-nav__link">
    4.4. Unit Level Simulation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-creating-a-custom-fim" class="md-nav__link">
    5. Creating a Custom FIM
  </a>
  
    <nav class="md-nav" aria-label="5. Creating a Custom FIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-creating-the-hello-fim-example" class="md-nav__link">
    5.1. Creating the Hello FIM example
  </a>
  
    <nav class="md-nav" aria-label="5.1. Creating the Hello FIM example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#511-board-peripheral-fabric-bpf" class="md-nav__link">
    5.1.1. Board Peripheral Fabric (BPF)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#512-mmio-region" class="md-nav__link">
    5.1.2. MMIO Region
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#513-hello-fim-csr" class="md-nav__link">
    5.1.3. Hello FIM CSR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#514-list-of-all-files-to-edit" class="md-nav__link">
    5.1.4. List of all files to edit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#515-setup-enviroment-variables" class="md-nav__link">
    5.1.5. Setup Enviroment Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#516-file-modification" class="md-nav__link">
    5.1.6. File Modification
  </a>
  
    <nav class="md-nav" aria-label="5.1.6. File Modification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#517-modify-bpf-manually-in-platform-designer" class="md-nav__link">
    5.1.7. Modify BPF manually in Platform Designer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#518-unit-level-simulation-of-hello-fim-design" class="md-nav__link">
    5.1.8. Unit Level Simulation of Hello FIM Design
  </a>
  
    <nav class="md-nav" aria-label="5.1.8. Unit Level Simulation of Hello FIM Design">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5181-unit-level-simulation-file-modification" class="md-nav__link">
    5.1.8.1. Unit Level Simulation File Modification
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#519-unit-level-test-of-the-hellofim" class="md-nav__link">
    5.1.9. Unit Level test of the HelloFIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5110-uvm-verfication-of-the-hellofim" class="md-nav__link">
    5.1.10. UVM Verfication of the HelloFIM
  </a>
  
    <nav class="md-nav" aria-label="5.1.10. UVM Verfication of the HelloFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5192-run-uvm-dfh-walker-simulation" class="md-nav__link">
    5.1.9.2. Run UVM DFH Walker Simulation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5193-run-uvm-mmio-simulation" class="md-nav__link">
    5.1.9.3. Run UVM MMIO Simulation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5110-compile-the-intel-fpga-smartnic-n6001-pl-design-with-hello-fim" class="md-nav__link">
    5.1.10 Compile the Intel® FPGA SmartNIC N6001-PL Design with Hello FIM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5111-program-the-intel-fpga-smartnic-n6001-pl-with-the-hello_fim" class="md-nav__link">
    5.1.11 Program the Intel® FPGA SmartNIC N6001-PL with the hello_fim
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5112-verify-the-hello-fim-on-the-intel-fpga-smartnic-n6001-pl-using-opaeio-tool" class="md-nav__link">
    5.1.12 Verify the Hello FIM on the Intel® FPGA SmartNIC N6001-PL Using opae.io Tool
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-debugging-the-fim-with-signal-tap" class="md-nav__link">
    5.2. Debugging the FIM with Signal Tap
  </a>
  
    <nav class="md-nav" aria-label="5.2. Debugging the FIM with Signal Tap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#521-adding-signal-tap-to-the-hello-fim-example" class="md-nav__link">
    5.2.1. Adding Signal Tap to the Hello FIM example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#522-downloading-ofs_top_hpssof-into-the-fpga-using-jtag" class="md-nav__link">
    5.2.2 Downloading ofs_top_hps.sof into the FPGA using JTAG
  </a>
  
    <nav class="md-nav" aria-label="5.2.2 Downloading ofs_top_hps.sof into the FPGA using JTAG">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5221-connecting-to-intel-download-cable-ii" class="md-nav__link">
    5.2.2.1 Connecting to Intel Download Cable II
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5222-programming-the-fpga-image-using-jtag" class="md-nav__link">
    5.2.2.2 Programming the FPGA Image using JTAG
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#523-signal-tap-trace-acquisition-of-hello-fim-signals" class="md-nav__link">
    5.2.3. Signal Tap trace acquisition of Hello FIM signals
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-compiling-the-fim-in-preparation-for-designing-your-afu" class="md-nav__link">
    6. Compiling the FIM in preparation for designing your AFU
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-how-to-resize-the-partial-reconfiguration-region" class="md-nav__link">
    7. How to resize the Partial Reconfiguration region
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-how-to-modify-the-memory-subsystem" class="md-nav__link">
    8. How to modify the Memory Subsystem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-how-to-compile-the-fim-with-no-hssi-for-the-intel-fpga-smartnic-n6001-pl" class="md-nav__link">
    9. How to compile the FIM with no hssi for the Intel® FPGA SmartNIC N6001-PL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-how-to-change-the-pcie-device-id-and-vendor-id" class="md-nav__link">
    10. How to change the PCIe device ID and Vendor ID
  </a>
  
    <nav class="md-nav" aria-label="10. How to change the PCIe device ID and Vendor ID">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-changing-the-pcie-subsystem-device-id-and-vendor-id" class="md-nav__link">
    10.1. Changing the PCIe Subsystem Device ID and Vendor ID
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-migrating-intel-fpga-smartnic-n6001-pl-to-a-different-device-part-number" class="md-nav__link">
    11. Migrating Intel® FPGA SmartNIC N6001-PL to a different device part number
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-how-to-change-e-tile-ethernet-subsystem-from-8-x-25-gbe-to-8-x-10-gbe" class="md-nav__link">
    12. How to change E-Tile Ethernet Subsystem from 8 X 25 GbE to 8 X 10 GbE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-how-to-change-e-tile-ethernet-subsystem-from-8-x-25-gbe-to-2-x-100-gbe" class="md-nav__link">
    13. How to change E-Tile Ethernet Subsystem from 8 X 25 GbE to 2 X 100 GbE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#14-how-to-add-more-transceiver-channels-to-an-existing-fim-design" class="md-nav__link">
    14. How to add more Transceiver channels to an existing FIM design
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#15-how-to-modify-the-pfvf-mux-configuration" class="md-nav__link">
    15. How to modify the PF/VF MUX configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#16-how-to-create-a-minimal-fim" class="md-nav__link">
    16. How to Create a Minimal FIM
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#17-single-event-upset-reporting" class="md-nav__link">
    17. Single Event Upset Reporting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#18-adding-fim-image-info" class="md-nav__link">
    18. Adding FIM Image Info
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notices-disclaimers" class="md-nav__link">
    Notices &amp; Disclaimers
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="fpga-interface-manager-developer-guide-for-intel-agilex-pcie-attach-open-fpga-stack">FPGA Interface Manager Developer Guide for Intel Agilex PCIe Attach: Open FPGA Stack<a class="headerlink" href="#fpga-interface-manager-developer-guide-for-intel-agilex-pcie-attach-open-fpga-stack" title="Permanent link">&para;</a></h1>
<p>Last updated: <strong>May 07, 2024</strong> </p>
<h2 id="1-introduction"><strong>1. Introduction</strong><a class="headerlink" href="#1-introduction" title="Permanent link">&para;</a></h2>
<h3 id="11-about-this-document"><strong>1.1. About This Document</strong><a class="headerlink" href="#11-about-this-document" title="Permanent link">&para;</a></h3>
<p>Open FPGA Stack (<abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>) addresses the demand for FPGA acceleration boards and workloads by providing a powerful methodology for the rapid development of FPGA Acceleration systems.  This methodology addresses the challenges and responsibilities of the board, platform, and workload developers by providing a complete FPGA project consisting of RTL and simulation code, build scripts, and software.  This provided FPGA project can be rapidly customized to meet new market requirements.</p>
<p><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> separates the FPGA design into two areas: FPGA Interface Manager (<abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>) and workload (or Acceleration Function Unit) as shown in the figure below:</p>
<p><a class="glightbox" href="../images/FIM_top_intro.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/FIM_top_intro.png" /></a></p>
<p>As can be seen in this diagram, the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> FPGA structure has a natural separation into two distinct areas: </p>
<ul>
<li>FPGA Interface Manager (<abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> or sometimes called the "the shell") containing:<ul>
<li>FPGA external interfaces and IP cores (e.g. Ethernet, DDR-4, PCIe, etc)</li>
<li>PLLs/resets</li>
<li>FPGA - Board management infrastructure</li>
<li>Interface to Acceleration Function Unit (<abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>)</li>
</ul>
</li>
<li>Acceleration Function Unit ("the workload")<ul>
<li>Uses the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> interfaces to perform useful work inside the FPGA</li>
<li>Contains logic supporting partial reconfiguration</li>
<li>Remote Signal Tap core for remote debugging of workload</li>
</ul>
</li>
</ul>
<p>This document serves as a design guide for FPGA developers, system architects, and hardware developers using <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> as a starting point for the creation of an FPGA Interface Manager (<abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>) for a custom FPGA acceleration board.   </p>
<p>This guide is organized as follows: </p>
<ul>
<li>Introduction</li>
<li>Top Level Block Diagram description<ul>
<li>Control and data flow</li>
</ul>
</li>
<li>Description of Sub-systems<ul>
<li>Command/status registers (CSR) and software interface</li>
<li>Clocking, resets, and interfaces</li>
<li>E-Tile Ethernet Subsystem</li>
<li>Externally attached memory</li>
</ul>
</li>
<li>High-level development flow description<ul>
<li>Installation of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> RTL and development packages</li>
<li>Compiling <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></li>
<li>Simulation  </li>
</ul>
</li>
<li>Demonstration steps illustrating how to change areas of the design</li>
<li>Debugging</li>
</ul>
<p>This document uses the Intel® FPGA SmartNIC N6001-PL as the main example platform to illustrate key points and demonstrate how to extend the capabilities provided in <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>.  The demonstration steps serve as a tutorial for the development of your <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> knowledge.  </p>
<p>This document covers <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> architecture lightly. For more details on the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> architecture, please see <a href="https://ofs.github.io/ofs-2023.1/hw/n6001/reference_manuals/ofs_fim/mnl_fim_ofs_n6001/">Open FPGA Stack Technical Reference Manual for Intel Agilex FPGA PCIe Attach</a></p>
<h3 id="111-glossary"><strong>1.1.1. Glossary</strong><a class="headerlink" href="#111-glossary" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th align="center">Term</th>
<th align="center">Abbreviation</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Advanced Error Reporting</td>
<td align="center"><abbr title="Advanced Error Reporting, The PCIe AER driver is the extended PCI Express error reporting capability providing more robust error reporting.">AER</abbr></td>
<td>The PCIe <abbr title="Advanced Error Reporting, The PCIe AER driver is the extended PCI Express error reporting capability providing more robust error reporting.">AER</abbr> driver is the extended PCI Express error reporting capability providing more robust error reporting. <a href="https://docs.kernel.org/PCI/pcieaer-howto.html?highlight=aer">(link)</a></td>
</tr>
<tr>
<td align="center">Accelerator Functional Unit</td>
<td align="center"><abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr></td>
<td>Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> region is the part of the design where an <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> may reside. This <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> may or may not be a partial reconfiguration region.</td>
</tr>
<tr>
<td align="center">Basic Building Block</td>
<td align="center"><abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr></td>
<td>Features within an <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>'s <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> and host interface requires. All BBBs must have a (globally unique identifier) GUID.</td>
</tr>
<tr>
<td align="center">Best Known Configuration</td>
<td align="center"><abbr title="Best Known Configuration, The exact hardware configuration Intel has optimized and validated the solution against.">BKC</abbr></td>
<td>The software and hardware configuration Intel uses to verify the solution.</td>
</tr>
<tr>
<td align="center">Board Management Controller</td>
<td align="center"><abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr></td>
<td>Supports features such as board power managment, flash management, configuration management, and board telemetry monitoring and protection. The majority of the <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> logic is in a separate component, such as an Intel® Max® 10 or Intel Cyclone® 10 device; a small portion of the <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> known as the PMCI resides in the main Agilex FPGA.</td>
</tr>
<tr>
<td align="center">Configuration and Status Register</td>
<td align="center">CSR</td>
<td>The generic name for a register space which is accessed in order to interface with the module it resides in (e.g. <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>, <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr>, various sub-systems and modules).</td>
</tr>
<tr>
<td align="center">Data Parallel C++</td>
<td align="center">DPC++</td>
<td>DPC++ is Intel’s implementation of the SYCL standard. It supports additional attributes and language extensions which ensure DCP++ (SYCL) is efficiently implanted on Intel hardware.</td>
</tr>
<tr>
<td align="center">Device Feature List</td>
<td align="center"><abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr></td>
<td>The <abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr>, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the <abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr> driver to automatically load the drivers required for a given FPGA configuration. This concept is the foundation for the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> software framework. <a href="https://docs.kernel.org/fpga/dfl.html">(link)</a></td>
</tr>
<tr>
<td align="center">FPGA Interface Manager</td>
<td align="center"><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></td>
<td>Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> resides in the static region of the FPGA and contains the FPGA Management Engine (<abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr>) and I/O ring.</td>
</tr>
<tr>
<td align="center">FPGA Management Engine</td>
<td align="center"><abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr></td>
<td>Performs reconfiguration and other FPGA management functions. Each FPGA device only has one <abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr> which is accessed through PF0.</td>
</tr>
<tr>
<td align="center">Host Exerciser Module</td>
<td align="center"><abbr title="Host Exerciser Module, Host exercisers are used to exercise and characterize the various host-FPGA interactions, including Memory Mapped Input/Output (MMIO), data transfer from host to FPGA, PR, host to FPGA memory, etc.">HEM</abbr></td>
<td>Host exercisers are used to exercise and characterize the various host-FPGA interactions, including Memory Mapped Input/Output (<abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr>), data transfer from host to FPGA, <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr>, host to FPGA memory, etc.</td>
</tr>
<tr>
<td align="center">Input/Output Control</td>
<td align="center"><abbr title="Input/Output Control, System calls used to manipulate underlying device parameters of special files.">IOCTL</abbr></td>
<td>System calls used to manipulate underlying device parameters of special files.</td>
</tr>
<tr>
<td align="center">Intel Virtualization Technology for Directed I/O</td>
<td align="center"><abbr title="Intel Virtualization Technology for Directed I/O, Extension of the VT-x and VT-I processor virtualization technologies which adds new support for I/O device virtualization.">Intel VT-d</abbr></td>
<td>Extension of the VT-x and VT-I processor virtualization technologies which adds new support for I/O device virtualization.</td>
</tr>
<tr>
<td align="center">Joint Test Action Group</td>
<td align="center"><abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr></td>
<td>Refers to the IEEE 1149.1 <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> standard; Another FPGA configuration methodology.</td>
</tr>
<tr>
<td align="center">Memory Mapped Input/Output</td>
<td align="center"><abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr></td>
<td>The memory space users may map and access both control registers and system memory buffers with accelerators.</td>
</tr>
<tr>
<td align="center">oneAPI Accelerator Support Package</td>
<td align="center">oneAPI-asp</td>
<td>A collection of hardware and software components that enable oneAPI kernel to communicate with oneAPI runtime and <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> shell components. oneAPI ASP hardware components and oneAPI kernel form the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> region of a oneAPI system in <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>.</td>
</tr>
<tr>
<td align="center">Open FPGA Stack</td>
<td align="center"><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr></td>
<td><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> is a software and hardware infrastructure providing an efficient approach to develop a custom FPGA-based platform or workload using an Intel, 3<sup>rd</sup> party, or custom board.</td>
</tr>
<tr>
<td align="center">Open Programmable Acceleration Engine Software Development Kit</td>
<td align="center"><abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr></td>
<td>The <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> is a software framework for managing and accessing programmable accelerators (FPGAs). It consists of a collection of libraries and tools to facilitate the development of software applications and accelerators. The <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> resides exclusively in user-space.</td>
</tr>
<tr>
<td align="center">Platform Interface Manager</td>
<td align="center"><abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr></td>
<td>An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> developers can use to handle clock crossing, response sorting, buffering and different protocols.</td>
</tr>
<tr>
<td align="center">Platform Management Controller Interface</td>
<td align="center">PMCI</td>
<td>The portion of the <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> that resides in the Agilex FPGA and allows the FPGA to communicate with the primary <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> component on the board.</td>
</tr>
<tr>
<td align="center">Partial Reconfiguration</td>
<td align="center"><abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr></td>
<td>The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. For <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> designs, the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region is referred to as the pr_slot.</td>
</tr>
<tr>
<td align="center">Port</td>
<td align="center">N/A</td>
<td>When used in the context of the fpgainfo port command it represents the interfaces between the static FPGA fabric and the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region containing the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>.</td>
</tr>
<tr>
<td align="center">Remote System Update</td>
<td align="center"><abbr title="Remote System Update, A Remote System Update operation sends an instruction to the Intel FPGA PAC D5005 device that triggers a power cycle of the card only, forcing reconfiguration.">RSU</abbr></td>
<td>The process by which the host can remotely update images stored in flash through PCIe. This is done with the OPAE software command "fpgasupdate".</td>
</tr>
<tr>
<td align="center">Secure Device Manager</td>
<td align="center">SDM</td>
<td>The SDM is the point of entry to the FPGA for <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> commands and interfaces, as well as for device configuration data (from flash, SD card, or through PCI Express* hard IP).</td>
</tr>
<tr>
<td align="center">Static Region</td>
<td align="center">SR</td>
<td>The portion of the FPGA design that cannot be dynamically reconfigured during run-time.</td>
</tr>
<tr>
<td align="center">Single-Root Input-Output Virtualization</td>
<td align="center"><abbr title="Single-Root Input-Output Virtualization, Allows the isolation of PCI Express resources for manageability and performance.">SR-IOV</abbr></td>
<td>Allows the isolation of PCI Express resources for manageability and performance.</td>
</tr>
<tr>
<td align="center">SYCL</td>
<td align="center">SYCL</td>
<td>SYCL (pronounced "sickle") is a royalty-free, cross-platform abstraction layer that enables code for heterogeneous and offload processors to be written using modern ISO C++ (at least C++ 17). It provides several features that make it well-suited for programming heterogeneous systems, allowing the same code to be used for CPUs, GPUs, FPGAs or any other hardware accelerator. SYCL was developed by the Khronos Group, a non-profit organization that develops open standards (including OpenCL) for graphics, compute, vision, and multimedia. SYCL is being used by a growing number of developers in a variety of industries, including automotive, aerospace, and consumer electronics.</td>
</tr>
<tr>
<td align="center">Test Bench</td>
<td align="center"><abbr title="Testbench, Testbench or Verification Environment is used to check the functional correctness of the Design Under Test (DUT) by generating and driving a predefined input sequence to a design, capturing the design output and comparing with-respect-to expected output.">TB</abbr></td>
<td>Testbench or Verification Environment is used to check the functional correctness of the Design Under Test (DUT) by generating and driving a predefined input sequence to a design, capturing the design output and comparing with-respect-to expected output.</td>
</tr>
<tr>
<td align="center">Universal Verification Methodology</td>
<td align="center"><abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr></td>
<td>A modular, reusable, and scalable testbench structure via an API framework.  In the context of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>, the <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> enviroment provides a system level simulation environment for your design.</td>
</tr>
<tr>
<td align="center">Virtual Function Input/Output</td>
<td align="center"><abbr title="Virtual Function Input/Output, An IOMMU/device agnostic framework for exposing direct device access to userspace.">VFIO</abbr></td>
<td>An Input-Output Memory Management Unit (IOMMU)/device agnostic framework for exposing direct device access to userspace. (link)</td>
</tr>
</tbody>
</table>
<h2 id="12-release-capabilities"><strong>1.2. Release Capabilities</strong><a class="headerlink" href="#12-release-capabilities" title="Permanent link">&para;</a></h2>
<p>The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> BASE  Agilex supports the following features.</p>
<table>
<thead>
<tr>
<th></th>
<th><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></th>
</tr>
</thead>
<tbody>
<tr>
<td>Intel Platform</td>
<td>Intel® FPGA SmartNIC N6001-PL</td>
</tr>
<tr>
<td>PCIe Configuration</td>
<td>Gen4 x16</td>
</tr>
<tr>
<td><abbr title="Single-Root Input-Output Virtualization, Allows the isolation of PCI Express resources for manageability and performance.">SR-IOV</abbr> support</td>
<td>Yes - (5-PF, 4-VF)</td>
</tr>
<tr>
<td>AXI ST datapath</td>
<td>512b @ 400MHz</td>
</tr>
<tr>
<td>Transceiver Subsystem Configuration</td>
<td>2x4x25G</td>
</tr>
</tbody>
</table>
<p>The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> also integrates:</p>
<ul>
<li>Exercisers demonstrating PCIe, external memory, and E-Tile Ethernet Subsystem</li>
<li><abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr> CSR</li>
<li>Remote Signal Tap</li>
<li>Partial Reconfiguration</li>
</ul>
<p>The Host exercisers are provided for the quick evaluation of the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and can be leveraged for the verification of the platform's functionality and capabilities.  The host exercisers can be removed by the designer to release FPGA real estate to accommodate a new workload functions. To compile the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> without host exercisers go to [Compiling the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> in preparation for designing your <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>].</p>
<p><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> is extensible to meet the needs of a broad set of customer applications.  The general use cases listed below are examples where the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> base design is easily extended to build a custom <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>:</p>
<ol>
<li>Use OFSdesign example as-is<ul>
<li>Porting the code to another platform that is identical to OFSreference platform changing targeted FPGA device and pinout</li>
<li>Change I/O assignments without changing design</li>
</ul>
</li>
<li>Update the configuration of peripheral IP in OFSdesign example, not affecting <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> architecture<ul>
<li>External memory settings</li>
<li>E-Tile Ethernet Subsystem analog settings</li>
</ul>
</li>
<li>Remove/update peripheral feature in OFSdesign example, not affecting <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> architecture<ul>
<li>External memory speed/width change</li>
<li>Change 25G Ethernet to 10G or 100G Ethernet IP</li>
<li>Change number of VFs supported</li>
</ul>
</li>
<li>Add new features as an extension to OFSdesign example, not affecting the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> architecture<ul>
<li>Add/remove external memory interface to the design</li>
<li>Add/remove user clocks for the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr></li>
<li>Add/remove IP to the design with connection to the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr></li>
</ul>
</li>
</ol>
<h2 id="13-prerequisites"><strong>1.3. Prerequisites</strong><a class="headerlink" href="#13-prerequisites" title="Permanent link">&para;</a></h2>
<h3 id="131-tutorial-prerequisites"><strong>1.3.1. Tutorial Prerequisites</strong><a class="headerlink" href="#131-tutorial-prerequisites" title="Permanent link">&para;</a></h3>
<p>To run the FPGA compilation steps covered in this guide, requires the following:</p>
<ol>
<li>Workstation or server with a Quartus Prime Pro Version 23.1  installed on a Quartus supported Linux distribution.  See [Operating System Support].  The Linux distribution known to work with this version of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> is {{ env.N6001_HOST_OS_L }}. Note, Windows is not supported.</li>
<li>Compilation targeting Intel® Agilex® FPGA devices requires a minimum of 64 GB of RAM.</li>
<li>Simulation of lower level functionality (not chip level) is supported by Synopsys<sup>&reg;</sup> VCS and Mentor Graphics<sup>&reg;</sup> QuestaSim SystemVerilog simulators.</li>
<li>Simulation of chip level requires Synopsys<sup>&reg;</sup> VCS and VIP</li>
</ol>
<p>To test FPGA image files on hardware, this version of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> only targets Intel® FPGA SmartNIC N6001-PL. You may modify the build scripts and pin files to target different boards with Intel® Agilex® FPGA devices.</p>
<h3 id="132-base-knowledge-and-skills-prerequisites"><strong>1.3.2. Base Knowledge and Skills Prerequisites</strong><a class="headerlink" href="#132-base-knowledge-and-skills-prerequisites" title="Permanent link">&para;</a></h3>
<p>The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> is an advanced application of FPGA technology. This guide assumes you have the following FPGA logic design-related knowledge and skills:</p>
<ul>
<li>FPGA compilation flows using Intel<sup>&reg;</sup> Quartus<sup>&reg;</sup> Prime Pro Edition.</li>
<li>Static Timing closure, including familiarity with the Timing Analyzer tool in Intel<sup>&reg;</sup> Quartus<sup>&reg;</sup> Prime Pro Edition, applying timing constraints, Synopsys* Design Constraints (.sdc) language and Tcl scripting, and design methods to close on timing critical paths.</li>
<li>RTL (System Verilog) and codingOFS hardware GitHub site practices to create synthesized logic.</li>
<li>RTL simulation tools.</li>
<li>Intel<sup>&reg;</sup> Quartus<sup>&reg;</sup> Prime Pro Edition Signal Tap Logic Analyzer tool software.</li>
</ul>
<h3 id="133-development-environment"><strong>1.3.3. Development Environment</strong><a class="headerlink" href="#133-development-environment" title="Permanent link">&para;</a></h3>
<p>To run the tutorial steps in this guide requires this development environment:</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>FPGA Platform</td>
<td><a href="https://cdrdv2.intel.com/v1/dl/getContent/723837?explicitVersion=true">Intel® FPGA SmartNIC N6001-PL</a>, <a href="https://github.com/OFS/ofs-n6001/releases/tag/ofs-2023.1-1">release notes</a></td>
</tr>
<tr>
<td><abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr></td>
<td><a href="https://github.com/OFS/opae-sdk/releases/tag/2.5.0-3">2.5.0-3</a></td>
</tr>
<tr>
<td>Kernel Drivers</td>
<td><a href="https://github.com/OFS/linux-dfl/releases/tag/ofs-2023.1-6.1-1">ofs-2023.1-6.1-1</a></td>
</tr>
<tr>
<td>OneAPI-ASP</td>
<td><a href="https://github.com/OFS/oneapi-asp/releases/tag/ofs-2023.1-1">ofs-2023.1-1</a></td>
</tr>
<tr>
<td><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Source Code for Intel® FPGA SmartNIC N6001-PL</td>
<td><a href="https://github.com/OFS/ofs-n6001/releases/tag/ofs-2023.1-1">ofs-2023.1-1</a></td>
</tr>
<tr>
<td><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Platform <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> <abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr></td>
<td><a href="https://github.com/OFS/ofs-platform-afu-bbb/releases/tag/ofs-2023.1-1">ofs-2023.1-1</a></td>
</tr>
<tr>
<td>Intel Quartus Prime Pro Edition Design Software*</td>
<td><a href="https://www.intel.com/content/www/us/en/software-kit/776241/intel-quartus-prime-pro-edition-design-software-version-23-1-for-linux.html">Quartus Prime Pro Version 23.1 for Linux</a></td>
</tr>
<tr>
<td>Operating System</td>
<td><a href="https://access.redhat.com/downloads/content/479/ver=/rhel---8/8.6/x86_64/product-software">RedHat® Enterprise Linux® (RHEL) 8.6</a></td>
</tr>
</tbody>
</table>
<h2 id="2-top-level-description">2. Top Level Description<a class="headerlink" href="#2-top-level-description" title="Permanent link">&para;</a></h2>
<p>The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> targets operation in the Intel® FPGA SmartNIC N6001-PL, the block diagram is shown below.  </p>
<p><a class="glightbox" href="../images/N6000_Base_x16_BlockDia.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Agilex OFS Block Diagram" src="../images/N6000_Base_x16_BlockDia.png" /></a> </br></p>
<p>The Intel® FPGA SmartNIC N6001-PL FPGA I/O banking is shown below: </br></p>
<p><a class="glightbox" href="../images/N6000_Bank.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/N6000_Bank.png" /></a></p>
<p>The key Intel® FPGA SmartNIC N6001-PL FPGA interfaces are:</p>
<ul>
<li>Host interface <ul>
<li>PCIe Gen4 x 16</li>
</ul>
</li>
<li>Network interface<ul>
<li>2 - QSFP28/56 cages</li>
<li>Current <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> supports 8 x 25 GbE, other interfaces can be created  </li>
</ul>
</li>
<li>External Memory - DDR4 - 2400<ul>
<li>HPS - 1GB organized as 256 Mb x 32 with 256 Mb x 8 ECC</li>
<li>Channel 0, 1  -  4 GB organized as 1 Gb x 32</li>
<li>Channel 2, 3 - 4 GB organized as 1 Gb x 32 with 1 Gb x 8 ECC (ECC is not implemented this release) </li>
</ul>
</li>
<li>Board Management<ul>
<li>SPI interface</li>
<li>FPGA configuration</li>
</ul>
</li>
</ul>
<h3 id="21-top-level-fpga"><strong>2.1. Top Level FPGA</strong><a class="headerlink" href="#21-top-level-fpga" title="Permanent link">&para;</a></h3>
<p>The internal FPGA architecture is shown below:</p>
<p><a class="glightbox" href="../images/N6000_Base_x16_BlockDia.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/N6000_Base_x16_BlockDia.png" /></a></p>
<p>The following Platform Designer IP subsystems are used to implement the following:</p>
<ul>
<li>690604: PCIe Subsystem IP User Guide (Note: you must login to myIntel and request entitled access)</li>
<li>686148: Memory Subsystem IP User Guide (Note: you must login to myIntel and request entitled access)</li>
<li>773413: <a href="https://www.intel.com/content/www/us/en/docs/programmable/773413/23-1-22-5-0/ethernet-subsystem-intel-fpga-ip-overview.html">Ethernet Subsystem Intel FPGA IP</a></li>
</ul>
<p>Documentation on the above Platform Designer IP subsystems is available by request to your Intel support team.</p>
<p>To access these Intel FPGA IP Subsystem documents. Please go <a href="https://rdc.intel.com">here</a> and search for the previous ID numbers.</p>
<h3 id="22-fim-fpga-resource-usage"><strong>2.2. <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> FPGA Resource Usage</strong><a class="headerlink" href="#22-fim-fpga-resource-usage" title="Permanent link">&para;</a></h3>
<p>The provided design includes both required board management and control functions as well as optional interface exerciser logic that both creates transactions and validates operation.  These exerciser modules include:</p>
<ul>
<li>HE_MEM - this module creates external memory transactions to the DDR4 memory and then verifies the responses.</li>
<li>HE_MEM-TG -The Memory Traffic Generator (<strong>TG</strong>) <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> provides a way for users to characterize local memory channel bandwidth with a variety of traffic configuration features including request burst size, read/write interleave count, address offset, address strobe, and data pattern.</li>
<li>HE_HSSI - this module creates ethernet transactions to the E-Tile Ethernet Subsystem and then verifies the responses.
The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> uses a small portion of the available FPGA resources.  The table below shows resource usage for a base <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> built with 2 channels of external memory, a small <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> instantiated that has host CSR read/write, external memory test and Ethernet test functionality.</li>
</ul>
<blockquote>
<p><strong>Note:</strong> The host exerciser modules allow you to evaluate the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> in hardware and are removed when you begin development. </p>
</blockquote>
<p>The resource usage for a Base <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> :</p>
<table>
<thead>
<tr>
<th>Entity Name</th>
<th>ALMs needed</th>
<th>ALM Utilization %</th>
<th>M20Ks</th>
<th>M20K Utilization %</th>
</tr>
</thead>
<tbody>
<tr>
<td>top</td>
<td>181,018.30</td>
<td>37.15</td>
<td>784</td>
<td>11.03</td>
</tr>
<tr>
<td>afu_top</td>
<td>104,994.20</td>
<td>21.55</td>
<td>287</td>
<td>4.04</td>
</tr>
<tr>
<td>pcie_wrapper</td>
<td>36,565.00</td>
<td>7.51</td>
<td>195</td>
<td>2.74</td>
</tr>
<tr>
<td>hssi_wrapper</td>
<td>20,132.10</td>
<td>4.13</td>
<td>173</td>
<td>2.43</td>
</tr>
<tr>
<td>mem_ss_top</td>
<td>9,092.80</td>
<td>1.87</td>
<td>76</td>
<td>1.07</td>
</tr>
<tr>
<td>pmci_wrapper</td>
<td>4,269.30</td>
<td>0.88</td>
<td>26</td>
<td>0.37</td>
</tr>
<tr>
<td>alt_sld_fab_0</td>
<td>2,726.90</td>
<td>0.56</td>
<td>13</td>
<td>0.18</td>
</tr>
<tr>
<td>bpf</td>
<td>1,364.60</td>
<td>0.28</td>
<td>0</td>
<td>0.00</td>
</tr>
<tr>
<td>qsfp_top</td>
<td>620.10</td>
<td>0.13</td>
<td>4</td>
<td>0.06</td>
</tr>
<tr>
<td>fme_top</td>
<td>615.30</td>
<td>0.13</td>
<td>6</td>
<td>0.08</td>
</tr>
<tr>
<td>qsfp_top</td>
<td>614.00</td>
<td>0.13</td>
<td>4</td>
<td>0.06</td>
</tr>
<tr>
<td>rst_ctrl</td>
<td>17.90</td>
<td>0.00</td>
<td>0</td>
<td>0.00</td>
</tr>
<tr>
<td>sys_pll</td>
<td>0.50</td>
<td>0.00</td>
<td>0</td>
<td>0.00</td>
</tr>
<tr>
<td>hps_ss</td>
<td>0.00</td>
<td>0.00</td>
<td>0</td>
<td>0.00</td>
</tr>
</tbody>
</table>
<p>The resource usage for a Minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> :</p>
<table>
<thead>
<tr>
<th>Entity Name</th>
<th>ALMs needed</th>
<th>ALM Utilization %</th>
<th>M20Ks</th>
<th>M20K Utilization %</th>
</tr>
</thead>
<tbody>
<tr>
<td>top</td>
<td>91,564.60</td>
<td>18.79</td>
<td>422</td>
<td>5.94</td>
</tr>
<tr>
<td>pcie_wrapper</td>
<td>36,736.80</td>
<td>7.54</td>
<td>193</td>
<td>2.71</td>
</tr>
<tr>
<td>afu_top</td>
<td>35,113.70</td>
<td>7.21</td>
<td>112</td>
<td>1.58</td>
</tr>
<tr>
<td>mem_ss_top</td>
<td>9,429.30</td>
<td>1.94</td>
<td>76</td>
<td>1.07</td>
</tr>
<tr>
<td>pmci_wrapper</td>
<td>4,390.50</td>
<td>0.90</td>
<td>26</td>
<td>0.37</td>
</tr>
<tr>
<td>alt_sld_fab_0</td>
<td>1,771.20</td>
<td>0.36</td>
<td>9</td>
<td>0.13</td>
</tr>
<tr>
<td>bpf</td>
<td>1,349.20</td>
<td>0.28</td>
<td>0</td>
<td>0.00</td>
</tr>
<tr>
<td>dummy_csr</td>
<td>703.40</td>
<td>0.14</td>
<td>0</td>
<td>0.00</td>
</tr>
<tr>
<td>dummy_csr</td>
<td>701.00</td>
<td>0.14</td>
<td>0</td>
<td>0.00</td>
</tr>
<tr>
<td>dummy_csr</td>
<td>694.10</td>
<td>0.14</td>
<td>0</td>
<td>0.00</td>
</tr>
<tr>
<td>fme_top</td>
<td>657.20</td>
<td>0.13</td>
<td>6</td>
<td>0.08</td>
</tr>
<tr>
<td>rst_ctrl</td>
<td>16.50</td>
<td>0.00</td>
<td>0</td>
<td>0.00</td>
</tr>
<tr>
<td>sys_pll</td>
<td>0.50</td>
<td>0.00</td>
<td>0</td>
<td>0.00</td>
</tr>
<tr>
<td>hps_ss</td>
<td>0.00</td>
<td>0.00</td>
<td>0</td>
<td>0.00</td>
</tr>
</tbody>
</table>
<h2 id="3-description-of-sub-systems"><strong>3. Description of Sub-Systems</strong><a class="headerlink" href="#3-description-of-sub-systems" title="Permanent link">&para;</a></h2>
<h3 id="31-host-control-and-data-flow"><strong>3.1. Host Control and Data Flow</strong><a class="headerlink" href="#31-host-control-and-data-flow" title="Permanent link">&para;</a></h3>
<p>The host control and data flow is shown in the diagram below:</p>
<p><a class="glightbox" href="../images/data_flow.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/data_flow.png" /></a></p>
<p>The control and data paths are composed of the following:</p>
<ul>
<li>Host Interface Adapter (PCIe)</li>
<li>Low Performance Peripherals<ul>
<li>Slow speed peripherals (<abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr>, I2C, Smbus, etc)</li>
<li>Management peripherals (<abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr>)</li>
</ul>
</li>
</ul>
<ul>
<li>High Performance Peripherals<ul>
<li>Memory peripherals</li>
<li>Acceleration Function peripherals (eg. AFUs)</li>
<li>HPS Peripheral</li>
</ul>
</li>
</ul>
<ul>
<li>Fabrics<ul>
<li>Peripheral Fabric (multi drop)</li>
<li><abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Streaming fabric (point to point)</li>
</ul>
</li>
</ul>
<p>Peripherals are connected to one another using AXI in either:</p>
<ul>
<li>Via the peripheral fabric (AXI4-Lite, multi drop)</li>
<li>Via the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> streaming fabric (AXI-S, point to point)</li>
</ul>
<p>Peripherals are presented to software as:</p>
<ul>
<li><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> managed peripherals that implement DFH CSR structure.  </li>
<li>Native driver managed peripherals (i.e. Exposed via an independent PF, VF)</li>
</ul>
<p>The peripherals connected to the peripheral fabric are primarily Intel OPAE managed resources, whereas the peripherals connected to the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> are “primarily” managed by native OS drivers. The word “primarily” is used since the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> is not mandated to expose all its peripherals to Intel OPAE. </p>
<p><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> uses a defined set of CSRs to expose the functionality of the FPGA to the host software.  These registers are described in <a href="https://ofs.github.io/ofs-2023.1/hw/n6001/reference_manuals/ofs_fim/mnl_fim_ofs_n6001/#6-mmio-regions"><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> Regions</a></p>
<p>If you make changes to the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that affect the software operation, then <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> provides a mechanism to communicate that information to the proper software driver that works with your new hardware.  The <a href="https://github.com/OFS/linux-dfl/blob/fpga-ofs-dev/Documentation/fpga/dfl.rst#fpga-device-feature-list-dfl-framework-overview">FPGA Device Feature List (<abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr>) Framework Overview</a> is followed to provide compatibility with OPAE software.  Please see <a href="https://github.com/OFS/linux-dfl/blob/fpga-ofs-dev/Documentation/fpga/dfl.rst#fpga-device-feature-list-dfl-framework-overview">FPGA Device Feature List (<abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr>) Framework Overview</a> for a description of <abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr> operation from the driver perspective.</p>
<h2 id="4-high-level-development-flow"><strong>4. High Level Development Flow</strong><a class="headerlink" href="#4-high-level-development-flow" title="Permanent link">&para;</a></h2>
<p>The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> provides a framework of FPGA synthesizable code, simulation environment, and synthesis/simulation scripts.  <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> designers can take the provided code and scripts and modify existing code or add new code to meet your specific product requirements.</p>
<p><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> development for a new acceleration card consists of the following steps:</p>
<ol>
<li>Installation of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> and familiarization with scripts and source code </li>
<li>Development of high level block diagram with your specific functionality <ol>
<li>Determination of requirements and key performance metrics</li>
<li>Selection of IP cores</li>
<li>Selection of FPGA device</li>
<li>Software memory map</li>
</ol>
</li>
<li>Selection and implementation of <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Physical interfaces including: <ol>
<li>External clock sources and creation of internal PLL clocks</li>
<li>General I/O</li>
<li>Transceivers</li>
<li>External memories</li>
<li>FPGA programming methodology</li>
</ol>
</li>
<li>Device physical implementation <ol>
<li>FPGA device pin assignment</li>
<li>Inclusion of logic lock regions</li>
<li>Creation of timing constraints</li>
<li>Create Quartus <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> test project and validate: <ol>
<li>Placement</li>
<li>Timing constraints</li>
<li>Build script process</li>
<li>Review test <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> FPGA resource usage</li>
</ol>
</li>
</ol>
</li>
<li>Select <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> to <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> interfaces and development of <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr> </li>
<li><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design implementation <ol>
<li>RTL coding</li>
<li>IP instantiation</li>
<li>Development of test <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> to validate <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></li>
<li>Unit and device level simulation</li>
<li>Timing constraints and build scripts</li>
<li>Timing closure and build validation</li>
</ol>
</li>
<li>Creation of <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> documentation to support <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> development and synthesis </li>
<li>Software Device Feature discovery </li>
<li>Hardware/software integration, validation and debugging </li>
<li>High volume production preparation </li>
</ol>
<p>The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> developer works closely with the hardware design of the target board, software development and system validation.</p>
<h3 id="41-installation-of-ofs"><strong>4.1. Installation of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr></strong><a class="headerlink" href="#41-installation-of-ofs" title="Permanent link">&para;</a></h3>
<p>In this section you set up a development machine for compiling the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. These steps are separate from the setup for a deployment machine where the FPGA acceleration card is installed.  Typically, FPGA development and deployment work is performed on separate machines, however, both development and deployment can be performed on the same server if desired.  Please see the [Getting Started Guide: Open FPGA Stack] for instructions on installing software for deployment of your FPGA <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>, <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> and software application on a server.  </p>
<p>Building the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> requires the build machine to have at least 64 GB of RAM.  </p>
<p>The following is a summary of the steps to set up for <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> development:</p>
<ol>
<li>Install Quartus Prime Pro Version 23.1 Linux with Intel® Agilex® FPGA device support</li>
<li>Make sure support tools are installed and meet version requirements</li>
<li>Clone the <code>ofs-n6001</code> repository</li>
<li>Install required Quartus patches which are included in the cloned <code>ofs-n6001</code> repository</li>
<li>Review the files provided in the repo</li>
<li>Test installation by building the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></li>
</ol>
<p><strong>Intel Quartus Prime Pro Version 23.1</strong> is the currently verified version of Quartus used for building the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> images.  Porting to newer versions of Quartus may be performed by developers, however, you will need to verify operation.
The recommended Best Known Configuration (<abbr title="Best Known Configuration, The exact hardware configuration Intel has optimized and validated the solution against.">BKC</abbr>) for development of the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> is RedHat® Enterprise Linux® (RHEL) 8.6, which is the assumed operating system for this developer guide. </p>
<p>Prior to installing Quartus, perform the following steps to satisfy the required dependencies.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>gcc<span class="w"> </span>gcc-c++<span class="w"> </span>make<span class="w"> </span>cmake<span class="w"> </span>libuuid-devel<span class="w"> </span>rpm-build<span class="w"> </span>autoconf<span class="w"> </span>automake<span class="w"> </span>bison<span class="w"> </span>boost<span class="w"> </span>boost-devel<span class="w"> </span>libxml2<span class="w"> </span>libxml2-devel<span class="w"> </span>make<span class="w"> </span>ncurses<span class="w"> </span>grub2<span class="w"> </span>bc<span class="w"> </span>csh<span class="w"> </span>flex<span class="w"> </span>glibc-locale-source<span class="w"> </span>libnsl<span class="w"> </span>ncurses-compat-libs<span class="w"> </span>
</code></pre></div>
<p>Apply the following configurations.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>sudo<span class="w"> </span>localedef<span class="w"> </span>-f<span class="w"> </span>UTF-8<span class="w"> </span>-i<span class="w"> </span>en_US<span class="w"> </span>en_US.UTF-8<span class="w"> </span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>sudo<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/usr/lib64/libncurses.so.6<span class="w"> </span>/usr/lib64/libncurses.so.5<span class="w"> </span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>sudo<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/usr/bin/python3<span class="w"> </span>/usr/bin/python
</code></pre></div>
<ol>
<li>
<p>Download [Quartus Prime Pro Linux version].</p>
</li>
<li>
<p>After running the Quartus Prime Pro installer, set the PATH environment variable to make utilities <code>quartus</code>, <code>jtagconfig</code>, and <code>quartus_pgm</code> discoverable. Edit your bashrc file <code>~/.bashrc</code> to add the following line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>&lt;Quartus<span class="w"> </span>install<span class="w"> </span>directory&gt;/quartus/bin:<span class="nv">$PATH</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>&lt;Quartus<span class="w"> </span>install<span class="w"> </span>directory&gt;/qsys/bin:<span class="nv">$PATH</span>
</code></pre></div>
<p>For example, if the Quartus install directory is /home/intelFPGA_pro/23.1 then the new line is:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>export PATH=/home/intelFPGA_pro/23.1/quartus/bin:$PATH
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>export PATH=/home/intelFPGA_pro/23.1/qsys/bin:$PATH
</code></pre></div>
</li>
<li>
<p>Verify, Quartus is discoverable by opening a new shell:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>which quartus
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>/home/intelFPGA_pro/23.1/quartus/bin/quartus
</code></pre></div>
</li>
</ol>
<p>The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> provided Quartus build scripts require the following tools:</p>
<table>
<thead>
<tr>
<th>Item</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>Python</td>
<td>3.7.7</td>
</tr>
<tr>
<td>GCC</td>
<td>7.2.0</td>
</tr>
<tr>
<td>cmake</td>
<td>3.11.4</td>
</tr>
<tr>
<td>git with git-lfs</td>
<td>1.8.3.1</td>
</tr>
</tbody>
</table>
<p>To install the <code>Git Large File Storage (LFS)</code> extension execute the next commands</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>https://packagecloud.io/install/repositories/github/git-lfs/script.rpm.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>git-lfs
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>git<span class="w"> </span>lfs<span class="w"> </span>install
</code></pre></div>
<h4 id="411-clone-the-ofs-git-repo"><strong>4.1.1. Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Git Repo</strong><a class="headerlink" href="#411-clone-the-ofs-git-repo" title="Permanent link">&para;</a></h4>
<p>Retrieve the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> source code from the <a href="https://github.com/OFS/ofs-n6001">GitHub repository</a>. Create a new directory to use as a clean starting point to store the retrieved files.  The following is a short description of each repository, followed by the git commands for cloning.  The instructions section uses the HTTPS git method for cloning repositories.  Cloning the repo using the HTTPS method requires a personal access token.  Please see this blog post for background information the need for personal access token [Token authentication requirements for Git operations]. Please see [Creating a personal access token].  The classic personal access token has been verified to work properly. </p>
<p>Navigate to location for storage of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> source, create the top-level source directory and clone <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> repositories using the clone command listed below.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>mkdir<span class="w"> </span>IOFS_BUILD_ROOT
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nb">cd</span><span class="w"> </span>IOFS_BUILD_ROOT
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">IOFS_BUILD_ROOT</span><span class="o">=</span><span class="nv">$PWD</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>git<span class="w"> </span>clone<span class="w"> </span>--recurse-submodules<span class="w"> </span>https://github.com/OFS/ofs-n6001
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span>...<span class="w"> </span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">    </span>Cloning<span class="w"> </span>into<span class="w"> </span><span class="s1">&#39;ofs-n6001&#39;</span><span class="w"> </span>...
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">    </span>remote:<span class="w"> </span>Enumerating<span class="w"> </span>objects:<span class="w">  </span>....
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">    </span>...
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">    </span>...
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">    </span>Resolving<span class="w"> </span>deltas<span class="w">  </span>...,<span class="w"> </span><span class="k">done</span>.
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="nb">cd</span><span class="w"> </span>ofs-n6001
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>git<span class="w"> </span>checkout<span class="w"> </span>--recurse-submodules<span class="w"> </span>tags/ofs-2023.1-1
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="c1">#check if you have ofs-common</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>git<span class="w"> </span>submodule<span class="w"> </span>status
</code></pre></div>
<h3 id="42-directory-structure-of-ofs"><strong>4.2. Directory Structure of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr></strong><a class="headerlink" href="#42-directory-structure-of-ofs" title="Permanent link">&para;</a></h3>
<p>First verify the following directories and files are present in $IOFS_BUILD_ROOT/ofs-n6001 directory.  </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>ls<span class="w"> </span>-1
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>......
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>eval_scripts
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>ipss
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>license
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>LICENSE.txt
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>ofs-common
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>README.md
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>sim
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>src
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>syn
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>tools
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>verification
</code></pre></div>
<p>The directories are arranged as shown below:
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>find<span class="w"> </span>.<span class="w"> </span>-mindepth<span class="w"> </span><span class="m">1</span><span class="w"> </span>-maxdepth<span class="w"> </span><span class="m">2</span><span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-not<span class="w"> </span>-path<span class="w"> </span><span class="s1">&#39;*/\.*&#39;</span><span class="w"> </span>-print<span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/[^-][^\/]*\//--/g&#39;</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/--/|  /g&#39;</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/|-/|   /g&#39;</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="p">|</span><span class="w">  </span>eval_scripts
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="p">|</span><span class="w">  </span>ipss
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>hssi
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>mem
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>pcie
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>pmci
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>qsfp
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="p">|</span><span class="w">  </span>license
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="p">|</span><span class="w">  </span>ofs-common
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>scripts
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>src
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>tools
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>verification
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="p">|</span><span class="w">  </span>sim
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>bfm
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>common
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>scripts
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>unit_test
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="p">|</span><span class="w">  </span>src
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>afu_top
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>includes
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>pd_qsys
<a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>top
<a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a><span class="p">|</span><span class="w">  </span>syn
<a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>scripts
<a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>setup
<a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>syn_top
<a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="p">|</span><span class="w">  </span>tools
<a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>pfvf_config_tool
<a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a><span class="p">|</span><span class="w">  </span>verification
<a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>coverage
<a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>scripts
<a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>testbench
<a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>tests
<a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>unit_tb
<a id="__codelineno-9-38" name="__codelineno-9-38" href="#__codelineno-9-38"></a><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w">  </span>verifplan
</code></pre></div></p>
<h4 id="421-install-quartus-patches"><strong>4.2.1. Install Quartus Patches</strong><a class="headerlink" href="#421-install-quartus-patches" title="Permanent link">&para;</a></h4>
<p>The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> uses a UART IP core that requires a license in order to create programming files.  The patch for installing the license is located in $IOFS_BUILD_ROOT/ofs-n6001/license.  Please follow the steps below to install this license patch.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$IOFS_BUILD_ROOT</span>/ofs-n6001/license
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>sudo<span class="w"> </span>./quartus-0.0-0.02iofs-linux.run
</code></pre></div>
<p>Once patch install is complete, verify successful installation:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>quartus_sh<span class="w"> </span>--version
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>Quartus<span class="w"> </span>Prime<span class="w"> </span>Shell
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>Version<span class="w"> </span><span class="m">23</span>.1
</code></pre></div>
<h3 id="43-compiling-the-ofs-fim"><strong>4.3. Compiling the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong><a class="headerlink" href="#43-compiling-the-ofs-fim" title="Permanent link">&para;</a></h3>
<p>The following sections describe how to set up the environment and build the provided <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>. Follow these steps as a tutorial to learn the build flow.  You will use this environment and build scripts for the creation of your specialized <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<h4 id="431-setting-up-required-environment-variables"><strong>4.3.1. Setting Up Required Environment Variables</strong><a class="headerlink" href="#431-setting-up-required-environment-variables" title="Permanent link">&para;</a></h4>
<p>Perform the following steps to set the required environment variables. These environment variables must be set prior to simulation or compilation tasks so it is recommended that you create a script to set these variables.</p>
<ol>
<li>
<p>Navigate to the top level directory of the cloned <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repository.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="p">{ env.N60001_FIM_REPO </span><span class="si">}</span><span class="o">}</span>
</code></pre></div>
</li>
<li>
<p>Set project variables
  <div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Set OFS Root Directory - e.g. this is the top level directory of the cloned OFS FIM repository</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OFS_ROOTDIR</span><span class="o">=</span><span class="nv">$PWD</span>
</code></pre></div></p>
</li>
<li>
<p>Set variables based on your development environment
  <div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Set proxies if required for your server</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">http_proxy</span><span class="o">=</span>&lt;YOUR_HTTP_PROXY&gt;
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">https_proxy</span><span class="o">=</span>&lt;YOUR_HTTPS_PROXY&gt;
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">ftp_proxy</span><span class="o">=</span>&lt;YOUR_FTP_PROXY&gt;
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">socks_proxy</span><span class="o">=</span>&lt;YOUR_SOCKS_PROXY&gt;
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">no_proxy</span><span class="o">=</span>&lt;YOUR_NO_PROXY&gt;
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="c1"># Set Quartus license path</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="nb">export</span><span class="w"> </span><span class="nv">LM_LICENSE_FILE</span><span class="o">=</span>&lt;YOUR_LM_LICENSE_FILE&gt;
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="c1"># Set Synopsys License path (if using Synopsys for simulation)</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="nb">export</span><span class="w"> </span><span class="nv">DW_LICENSE_FILE</span><span class="o">=</span>&lt;YOUR_DW_LICENSE_FILE&gt;
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="nb">export</span><span class="w"> </span><span class="nv">SNPSLMD_LICENSE_FILE</span><span class="o">=</span>&lt;YOUR_SNPSLMD_LICENSE_FILE&gt;
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="c1"># Set Quartus Installation Directory - e.g. $QUARTUS_ROOTDIR/bin contains Quartus executables</span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_ROOTDIR</span><span class="o">=</span>&lt;YOUR_QUARTUS_INSTALLATION_DIRECTORY&gt;
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="c1"># Set the Tools Directory - e.g. $TOOLS_LOCATION contains the &#39;synopsys&#39; directory if you are using Synopsys. Refer to the $VCS_HOME variable for an example.</span>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TOOLS_LOCATION</span><span class="o">=</span>&lt;YOUR_TOOLS_LOCATION&gt;
</code></pre></div></p>
</li>
<li>
<p>Set generic environment variables</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Set Work directory </span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">WORKDIR</span><span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="c1"># Set Quartus Tools variables</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_HOME</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_INSTALL_DIR</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_ROOTDIR_OVERRIDE</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_VER_AC</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="nb">export</span><span class="w"> </span><span class="nv">IP_ROOTDIR</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/../ip
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="nb">export</span><span class="w"> </span><span class="nv">IMPORT_IP_ROOTDIR</span><span class="o">=</span><span class="nv">$IP_ROOTDIR</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QSYS_ROOTDIR</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/../qsys/bin
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="c1"># Set Verification Tools variables (if running simulations)</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="nb">export</span><span class="w"> </span><span class="nv">DESIGNWARE_HOME</span><span class="o">=</span><span class="nv">$TOOLS_LOCATION</span>/synopsys/vip_common/vip_Q-2020.03A
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="nb">export</span><span class="w"> </span><span class="nv">UVM_HOME</span><span class="o">=</span><span class="nv">$TOOLS_LOCATION</span>/synopsys/vcsmx/S-2021.09-SP1/linux64/rhel/etc/uvm
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="nb">export</span><span class="w"> </span><span class="nv">VCS_HOME</span><span class="o">=</span><span class="nv">$TOOLS_LOCATION</span>/synopsys/vcsmx/S-2021.09-SP1/linux64/rhel
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="nb">export</span><span class="w"> </span><span class="nv">MTI_HOME</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/../questa_fse
<a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="nb">export</span><span class="w"> </span><span class="nv">VERDIR</span><span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>/verification
<a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a><span class="nb">export</span><span class="w"> </span><span class="nv">VIPDIR</span><span class="o">=</span><span class="nv">$VERDIR</span>
<a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a>
<a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="c1"># Set OPAE variables</span>
<a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OPAE_SDK_REPO_BRANCH</span><span class="o">=</span><span class="si">${</span><span class="p">{ env.N60001_OPAE_BRANCH </span><span class="si">}</span><span class="o">}</span>
<a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a>
<a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="c1"># Set PATH to include compilation and simulation tools</span>
<a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$QUARTUS_HOME</span>/bin:<span class="nv">$QUARTUS_HOME</span>/../qsys/bin:<span class="nv">$QUARTUS_HOME</span>/sopc_builder/bin/:<span class="nv">$IOFS_BUILD_ROOT</span>/opae-sdk/install-opae-sdk/bin:<span class="nv">$MTI_HOME</span>/linux_x86_64/:<span class="nv">$MTI_HOME</span>/bin/:<span class="nv">$DESIGNWARE_HOME</span>/bin:<span class="nv">$VCS_HOME</span>/bin:<span class="nv">$PATH</span>
</code></pre></div>
</li>
</ol>
<h4 id="432-compiling-the-intel-fpga-smartnic-n6001-pl-fim"><strong>4.3.2. Compiling the Intel® FPGA SmartNIC N6001-PL <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong><a class="headerlink" href="#432-compiling-the-intel-fpga-smartnic-n6001-pl-fim" title="Permanent link">&para;</a></h4>
<p>The Intel® FPGA SmartNIC N6001-PL <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> is built with bash script <code>$OFS_ROOTDIR/ofs-common/scripts/common/syn/build_top.sh</code>.  There are several setup files that must be put in place before and during the compile - as a result, building the Intel® FPGA SmartNIC N6001-PL <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> from the Quartus GUI is not supported - you must use the the <code>build_top.sh</code> script for Intel® FPGA SmartNIC N6001-PL <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> compilation.</p>
<p>The usage of the compile build script is shown below:
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span><span class="o">[</span>-p<span class="o">]</span><span class="w"> </span>n6001<span class="w"> </span>work_dir<span class="w"> </span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="c1"># --Please see  $OFS_ROOTDIR/ofs-common/scripts/common/syn/README for detailed information on this script</span>
</code></pre></div></p>
<p>The <code>build_top.sh</code> script copies files from the files in ofs-n6001 to your specified work_dir, then the files in work_dir are used for the Quartus compile process.  In most cases, you will perform design work the <code>ipss</code>, <code>src</code>, <code>sim</code>, <code>syn</code> and <code>verification</code> directories and run the build_top.sh script to copy the source design files into work_dir for the Quartus build process.  </p>
<p>The build_top.sh script has the -k option which will do the build process on an existing work_dir without copying source files.  The -k option is useful when you want to add Signal Tap to a build.</p>
<p>The <code>build_top.sh</code> script has the following build options:</p>
<ul>
<li>A <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> (default build option) compile which creates a FPGA image with design partitions consisting of the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that is loaded into the static region of the FPGA and a default <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> that is loaded into dynamic region. The <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> image may be loaded into the dynamic region using partial reconfiguration.  </li>
<li>Flat compile which combines the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> into one FPGA image that is loaded into the entire FPGA device.  The Flat compile removes all floorplanning design partitions and partial reconfiguration control logic.  Removal of patitions can be useful for some designs and <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> development scenarios.</li>
</ul>
<p>The build_top.sh script has options for removing exercisers.  These options are described in [Compiling the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> in preparation for designing your <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>].</p>
<p>The <code>build_top.sh</code> script includes the -p option which creates a re-locatable design tree for use design flows where the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> development and <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> workload are separate design teams.  See [Create a Relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> Directory Tree] for more details.</p>
<p>The build scripts included with <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> are verified to run in a bash shell. Other shells have not been tested.   </p>
<p>In the next example, you will build the provided example design using the default build options with partial reconfiguation blocks, partial reconfigation region and all exercisers <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> blocks included.  </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1">#Build the provided base example design:</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>n6001<span class="w"> </span>work_n6001
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="c1">#    ... build takes ~3 hours to complete</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>Compile<span class="w"> </span>work<span class="w"> </span>directory:<span class="w">     </span>&lt;<span class="nv">$IOFS_BUILD_ROOT</span>&gt;/ofs-n6001/work_n6001/syn/syn_top
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>Compile<span class="w"> </span>artifact<span class="w"> </span>directory:<span class="w"> </span>&lt;<span class="nv">$IOFS_BUILD_ROOT</span>&gt;/ofs-n6001/work_n6001/syn/syn_top/output_files
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>***********************************
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>***
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>***<span class="w">        </span>OFS_PROJECT:<span class="w"> </span>n6001
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>***<span class="w">        </span>Q_PROJECT:<span class="w">  </span>ofs_top
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>***<span class="w">        </span>Q_REVISION:<span class="w"> </span>ofs_top
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>***<span class="w">        </span>SEED:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>***<span class="w">        </span>Build<span class="w"> </span>Complete
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>***<span class="w">        </span>Timing<span class="w"> </span>Passed!
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>***
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>***********************************
</code></pre></div>
<p>The build script copies the <code>ipss</code>, <code>ofs-common</code>, <code>sim</code>, <code>src</code>,<code>syn</code> and <code>tools</code> directories to the specified work directory and then these copied files are used in the Quartus compilation process.</p>
<p>Some key output files are described below:</p>
<p><strong><work_dir>/syn/syn_top</strong> == Quartus project (ofs_top.qpf) and other Quartus specific files
<strong><work_dir>/syn/syn_top/output_files</strong> == Directory with build reports and FPGA programming files.  The programming files are:</p>
<p>The build script will run PACSign (if installed) and create an unsigned FPGA programming files for both user1 and user2 locations of the Intel® FPGA SmartNIC N6001-PL FPGA flash.  Please note, if the Intel® FPGA SmartNIC N6001-PL has the root entry hash key loaded, then PACsign must be run to add the proper key to the FPGA binary file.</p>
<p>The following table provides a detailed description of the generated *.bin files.</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ofs_top[_hps].bin</td>
<td>This is an intermediate, raw binary file. This intermediate raw binary file is produced by taking the Quartus generated <em>.sof file, and converting it to *.pof using quartus_pfg, then converting the *.pof to *.hexout using quartus_cpf, and finally converting the *.hexout to *.bin using objcopy. Depending on whether the FPGA design contains an HPS block, a different file will be generated. <br /><br />**ofs_top.bin*</em> - Raw binary image of the FPGA generated if there is no HPS present in the design. <br /><strong>ofs_top_hps.bin</strong> - Raw binary image of the FPGA generated if there is an HPS present in the design.</td>
</tr>
<tr>
<td>ofs_top_page1.bin</td>
<td>This is the binary of the Factory Image and is the input to PACSign utility to generate <strong>ofs_top_page1_unsigned.bin</strong> binary image file. <br />This image will carry binary content for the HPS if it is included in the SOF image.</td>
</tr>
<tr>
<td>ofs_top_page0_factory.bin</td>
<td>This is an input file to PACSign to generate <strong>ofs_top_page0_unsigned_factory.bin</strong>.</td>
</tr>
<tr>
<td>ofs_top_page0_unsigned_factory.bin</td>
<td>This is the unsigned PACSign output generated for the Factory Image.</td>
</tr>
<tr>
<td>ofs_top_page1_user1.bin</td>
<td>This is an input file to PACSign to generate <strong>ofs_top_page1_unsigned_user1.bin</strong>. This file is created by taking the ofs_top_[hps].bin file and assigning the User1 or appending factory block information.</td>
</tr>
<tr>
<td>ofs_top_page1_unsigned_user1.bin</td>
<td>This is the unsigned FPGA binary image generated by the PACSign utility for the User1 Image. This file is used to load the FPGA flash User1 Image using the fpgasupdate tool.</td>
</tr>
<tr>
<td>ofs_top_page2_user2.bin</td>
<td>This is an input file to PACSign to generate <strong>ofs_top_page2_unsigned_user2.bin</strong>. This file is created by taking the ofs_top_[hps].bin file and assigning the User2 or appending factory block information.</td>
</tr>
<tr>
<td>ofs_top_page2_unsigned_user2.bin</td>
<td>This is the unsigned FPGA binary image generated by the PACSign utility for the User2 Image. This file is used to load the FPGA flash User2 Image using the fpgasupdate tool.</td>
</tr>
<tr>
<td>If your design contains an Intel® Agilex® FPGA Hard Processor System, then the build assembly process combines the FPGA ofs_top.sof programming file with /syn/n6001/common/setup/u-boot-spl-dtb.hex to produce:</td>
<td>ofs_top_hps.sof.</td>
</tr>
</tbody>
</table>
<blockquote>
<p>The <strong>build/output_files/timing_report</strong> Directory contains clocks report, failing paths and passing margin reports. </p>
</blockquote>
<h4 id="433-create-a-relocatable-pr-directory-tree"><strong>4.3.3. Create a Relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> Directory Tree</strong><a class="headerlink" href="#433-create-a-relocatable-pr-directory-tree" title="Permanent link">&para;</a></h4>
<p>If you are developing a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> to be used by another team developing <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> workload(s), scripts are provided that create a relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> directory tree. ODM and board developers will make use of this capability to enable a broad set of AFUs to be loaded on a board using <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr>.</p>
<p>You can create this relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> directory tree by either:</p>
<ul>
<li>Build <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> using ofs-common/scripts/common/syn/build_top.sh followed by running /ofs-common/scripts/common/syn/generate_pr_release.sh</li>
<li>Build <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> using ofs-common/scripts/common/syn/build_top.sh with optional -p switch included</li>
</ul>
<p>The generate_pr_release.sh has the following command structure:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>./ofs-common/scripts/common/syn/generate_pr_release.sh<span class="w"> </span>-t<span class="w"> </span>&lt;path<span class="w"> </span>to<span class="w"> </span>generated<span class="w"> </span>release<span class="w"> </span>tree&gt;<span class="w"> </span>*Board<span class="w"> </span>Build<span class="w"> </span>Target*<span class="w"> </span>&lt;work<span class="w"> </span>dir<span class="w"> </span>from<span class="w"> </span>build_top.sh&gt;
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="c1">#Where:</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="c1"># -t &lt;path to generated release tree&gt; = location for your relocatable PR directory tree</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="c1"># *Board Build Target* is the name of the board target/FIM e.g. n6001</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="c1"># &lt;work dir from build_top.sh&gt; </span>
</code></pre></div>
<p>Here is an example of running the generate_pr_release.sh script:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>./ofs-common/scripts/common/syn/generate_pr_release.sh<span class="w"> </span>-t<span class="w"> </span>work_n6001/build_tree<span class="w"> </span>n6001<span class="w">  </span>work_n6001
</code></pre></div>
<p>The resulting relocatable build tree has the following structure:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/work_n6001/build_tree
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>find<span class="w"> </span>.<span class="w"> </span>-mindepth<span class="w"> </span><span class="m">1</span><span class="w"> </span>-maxdepth<span class="w"> </span><span class="m">3</span><span class="w"> </span>-not<span class="w"> </span>-path<span class="w"> </span><span class="s1">&#39;*/\.*&#39;</span><span class="w"> </span>-print<span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/[^-][^\/]*\//--/g&#39;</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/--/├── /g&#39;</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/|-/│   ├── /g&#39;</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;$s/├──/└──/&#39;</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/│   ├── \([^ ]\)/│   ├── \1/&#39;</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/│   ├── │   ├──/│   │   ├──/&#39;</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>├──<span class="w"> </span>bin
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>├──<span class="w"> </span>├──<span class="w"> </span>afu_synth
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>├──<span class="w"> </span>├──<span class="w"> </span>qar_gen
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>├──<span class="w"> </span>├──<span class="w"> </span>update_pim
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>├──<span class="w"> </span>├──<span class="w"> </span>run.sh
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>├──<span class="w"> </span>├──<span class="w"> </span>build_env_config
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>├──<span class="w"> </span>README
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>├──<span class="w"> </span>hw
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>├──<span class="w"> </span>├──<span class="w"> </span>lib
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>├──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>build
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>├──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>fme-ifc-id.txt
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>├──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>platform
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>├──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>fme-platform-class.txt
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>├──<span class="w"> </span>├──<span class="w"> </span>blue_bits
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>├──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>ofs_top_hps.sof
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>├──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>ofs_top.sof
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>├──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>ofs_top_page0_unsigned_factory.bin
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>├──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>ofs_top_page1_unsigned_user1.bin
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>└──<span class="w"> </span>├──<span class="w"> </span>├──<span class="w"> </span>ofs_top_page2_unsigned_user2.bin
</code></pre></div>
<p>This build tree can be moved to a different location and used for <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> development of <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr>-able <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> to be used with this board.</p>
<h4 id="434-flat-build"><strong>4.3.4. Flat Build</strong><a class="headerlink" href="#434-flat-build" title="Permanent link">&para;</a></h4>
<p>To run the <code>build_top.sh</code> script for a flat compile, add the build setting <code>n6001:flat</code> as shown below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>n6001:flat<span class="w"> </span>work_n6001_flat
</code></pre></div>
<blockquote>
<p><strong>Note:</strong> The flat compile removes the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region and <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> IP.  You cannot use the -P <code>build_top.sh</code> option when using the <code>n6001:flat</code> compile setting.</p>
</blockquote>
<h3 id="44-unit-level-simulation"><strong>4.4. Unit Level Simulation</strong><a class="headerlink" href="#44-unit-level-simulation" title="Permanent link">&para;</a></h3>
<p>Unit level simulation of key components is provided. These simulations provide verification of the following areas:</p>
<ul>
<li>E-Tile Ethernet Subsystem</li>
<li>PCIe</li>
<li>External Memory</li>
<li>Core <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></li>
</ul>
<p>The Unit Level simulations work with Synopsys VCS and Mentor Graphics Questa sim simulators. Readme files are provided explaining how to run the simulation of each component.  To run a simulation of <code>dfh_walker</code> that simulates host access to the internal DFH registers, perform the following steps.</p>
<ol>
<li>
<p>Set the environment variables listed in section, <a href="https://ofs.github.io/ofs-2023.1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#431-setting-up-required-environment-variables">Setting Up Required Environment Variables</a>.</p>
</li>
<li>
<p>Generate the IP simulation files for all Unit level simulations.  Once the IP simulation files are generated, you can run all of the Unit Simulation tests.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ofs-common/scripts/common/sim
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="c1"># Run the script &quot;sh gen_sim_files.sh &lt;target&gt;&quot;</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>sh<span class="w"> </span>gen_sim_files.sh<span class="w"> </span>n6001
</code></pre></div>
</li>
<li>
<p>Launch the actual DFH Walker unite test.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/sim/unit_test/dfh_walker/
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="c1"># If simulator is not specified, then VCS simulator is used</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>sh<span class="w"> </span>run_sim.sh
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="c1"># For Questasim, use the following command:</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>sh<span class="w"> </span>run_sim.sh<span class="w"> </span><span class="nv">MSIM</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="c1"># For VCS-MX, use the following command:</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>sh<span class="w"> </span>run_sim.sh<span class="w"> </span><span class="nv">VCSMX</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>.
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>.
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a>.
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a>AFU<span class="w"> </span>is<span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span>reset<span class="w"> </span>...
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>********************************************
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="w"> </span>Running<span class="w"> </span>TEST<span class="o">(</span><span class="m">0</span><span class="o">)</span><span class="w"> </span>:<span class="w"> </span>test_dfh_walking
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a>********************************************
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00000000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a>
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x4000000010000000
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a>
<a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a>FME_DFH
<a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x0<span class="o">)</span>
<a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x4000000010000000<span class="o">)</span>
<a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a>
<a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00001000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a>
<a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000020000001
<a id="__codelineno-23-36" name="__codelineno-23-36" href="#__codelineno-23-36"></a>
<a id="__codelineno-23-37" name="__codelineno-23-37" href="#__codelineno-23-37"></a>THERM_MNGM_DFH
<a id="__codelineno-23-38" name="__codelineno-23-38" href="#__codelineno-23-38"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x1000<span class="o">)</span>
<a id="__codelineno-23-39" name="__codelineno-23-39" href="#__codelineno-23-39"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000020000001<span class="o">)</span>
<a id="__codelineno-23-40" name="__codelineno-23-40" href="#__codelineno-23-40"></a>
<a id="__codelineno-23-41" name="__codelineno-23-41" href="#__codelineno-23-41"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00003000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-42" name="__codelineno-23-42" href="#__codelineno-23-42"></a>
<a id="__codelineno-23-43" name="__codelineno-23-43" href="#__codelineno-23-43"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-44" name="__codelineno-23-44" href="#__codelineno-23-44"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-45" name="__codelineno-23-45" href="#__codelineno-23-45"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000010000007
<a id="__codelineno-23-46" name="__codelineno-23-46" href="#__codelineno-23-46"></a>
<a id="__codelineno-23-47" name="__codelineno-23-47" href="#__codelineno-23-47"></a>GLBL_PERF_DFH
<a id="__codelineno-23-48" name="__codelineno-23-48" href="#__codelineno-23-48"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x3000<span class="o">)</span>
<a id="__codelineno-23-49" name="__codelineno-23-49" href="#__codelineno-23-49"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000010000007<span class="o">)</span>
<a id="__codelineno-23-50" name="__codelineno-23-50" href="#__codelineno-23-50"></a>
<a id="__codelineno-23-51" name="__codelineno-23-51" href="#__codelineno-23-51"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00004000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-52" name="__codelineno-23-52" href="#__codelineno-23-52"></a>
<a id="__codelineno-23-53" name="__codelineno-23-53" href="#__codelineno-23-53"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-54" name="__codelineno-23-54" href="#__codelineno-23-54"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-55" name="__codelineno-23-55" href="#__codelineno-23-55"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x30000000e0001004
<a id="__codelineno-23-56" name="__codelineno-23-56" href="#__codelineno-23-56"></a>
<a id="__codelineno-23-57" name="__codelineno-23-57" href="#__codelineno-23-57"></a>GLBL_ERROR_DFH
<a id="__codelineno-23-58" name="__codelineno-23-58" href="#__codelineno-23-58"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x4000<span class="o">)</span>
<a id="__codelineno-23-59" name="__codelineno-23-59" href="#__codelineno-23-59"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x30000000e0001004<span class="o">)</span>
<a id="__codelineno-23-60" name="__codelineno-23-60" href="#__codelineno-23-60"></a>
<a id="__codelineno-23-61" name="__codelineno-23-61" href="#__codelineno-23-61"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00012000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-62" name="__codelineno-23-62" href="#__codelineno-23-62"></a>
<a id="__codelineno-23-63" name="__codelineno-23-63" href="#__codelineno-23-63"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-64" name="__codelineno-23-64" href="#__codelineno-23-64"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-65" name="__codelineno-23-65" href="#__codelineno-23-65"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000010000013
<a id="__codelineno-23-66" name="__codelineno-23-66" href="#__codelineno-23-66"></a>
<a id="__codelineno-23-67" name="__codelineno-23-67" href="#__codelineno-23-67"></a>QSFP0_DFH
<a id="__codelineno-23-68" name="__codelineno-23-68" href="#__codelineno-23-68"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x12000<span class="o">)</span>
<a id="__codelineno-23-69" name="__codelineno-23-69" href="#__codelineno-23-69"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000010000013<span class="o">)</span>
<a id="__codelineno-23-70" name="__codelineno-23-70" href="#__codelineno-23-70"></a>
<a id="__codelineno-23-71" name="__codelineno-23-71" href="#__codelineno-23-71"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00013000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-72" name="__codelineno-23-72" href="#__codelineno-23-72"></a>
<a id="__codelineno-23-73" name="__codelineno-23-73" href="#__codelineno-23-73"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-74" name="__codelineno-23-74" href="#__codelineno-23-74"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-75" name="__codelineno-23-75" href="#__codelineno-23-75"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x30000000d0000013
<a id="__codelineno-23-76" name="__codelineno-23-76" href="#__codelineno-23-76"></a>
<a id="__codelineno-23-77" name="__codelineno-23-77" href="#__codelineno-23-77"></a>QSFP1_DFH
<a id="__codelineno-23-78" name="__codelineno-23-78" href="#__codelineno-23-78"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x13000<span class="o">)</span>
<a id="__codelineno-23-79" name="__codelineno-23-79" href="#__codelineno-23-79"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x30000000d0000013<span class="o">)</span>
<a id="__codelineno-23-80" name="__codelineno-23-80" href="#__codelineno-23-80"></a>
<a id="__codelineno-23-81" name="__codelineno-23-81" href="#__codelineno-23-81"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00020000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-82" name="__codelineno-23-82" href="#__codelineno-23-82"></a>
<a id="__codelineno-23-83" name="__codelineno-23-83" href="#__codelineno-23-83"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-84" name="__codelineno-23-84" href="#__codelineno-23-84"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-85" name="__codelineno-23-85" href="#__codelineno-23-85"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000200001012
<a id="__codelineno-23-86" name="__codelineno-23-86" href="#__codelineno-23-86"></a>
<a id="__codelineno-23-87" name="__codelineno-23-87" href="#__codelineno-23-87"></a>PMCI_DFH
<a id="__codelineno-23-88" name="__codelineno-23-88" href="#__codelineno-23-88"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x20000<span class="o">)</span>
<a id="__codelineno-23-89" name="__codelineno-23-89" href="#__codelineno-23-89"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000200001012<span class="o">)</span>
<a id="__codelineno-23-90" name="__codelineno-23-90" href="#__codelineno-23-90"></a>
<a id="__codelineno-23-91" name="__codelineno-23-91" href="#__codelineno-23-91"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00040000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-92" name="__codelineno-23-92" href="#__codelineno-23-92"></a>
<a id="__codelineno-23-93" name="__codelineno-23-93" href="#__codelineno-23-93"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-94" name="__codelineno-23-94" href="#__codelineno-23-94"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-95" name="__codelineno-23-95" href="#__codelineno-23-95"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000200000014
<a id="__codelineno-23-96" name="__codelineno-23-96" href="#__codelineno-23-96"></a>
<a id="__codelineno-23-97" name="__codelineno-23-97" href="#__codelineno-23-97"></a>ST2MM_DFH
<a id="__codelineno-23-98" name="__codelineno-23-98" href="#__codelineno-23-98"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x40000<span class="o">)</span>
<a id="__codelineno-23-99" name="__codelineno-23-99" href="#__codelineno-23-99"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000200000014<span class="o">)</span>
<a id="__codelineno-23-100" name="__codelineno-23-100" href="#__codelineno-23-100"></a>
<a id="__codelineno-23-101" name="__codelineno-23-101" href="#__codelineno-23-101"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00060000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-102" name="__codelineno-23-102" href="#__codelineno-23-102"></a>
<a id="__codelineno-23-103" name="__codelineno-23-103" href="#__codelineno-23-103"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-104" name="__codelineno-23-104" href="#__codelineno-23-104"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-105" name="__codelineno-23-105" href="#__codelineno-23-105"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x300000001000100f
<a id="__codelineno-23-106" name="__codelineno-23-106" href="#__codelineno-23-106"></a>
<a id="__codelineno-23-107" name="__codelineno-23-107" href="#__codelineno-23-107"></a>HSSI_DFH
<a id="__codelineno-23-108" name="__codelineno-23-108" href="#__codelineno-23-108"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x60000<span class="o">)</span>
<a id="__codelineno-23-109" name="__codelineno-23-109" href="#__codelineno-23-109"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x300000001000100f<span class="o">)</span>
<a id="__codelineno-23-110" name="__codelineno-23-110" href="#__codelineno-23-110"></a>
<a id="__codelineno-23-111" name="__codelineno-23-111" href="#__codelineno-23-111"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00061000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-112" name="__codelineno-23-112" href="#__codelineno-23-112"></a>
<a id="__codelineno-23-113" name="__codelineno-23-113" href="#__codelineno-23-113"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-114" name="__codelineno-23-114" href="#__codelineno-23-114"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-115" name="__codelineno-23-115" href="#__codelineno-23-115"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000010000024
<a id="__codelineno-23-116" name="__codelineno-23-116" href="#__codelineno-23-116"></a>
<a id="__codelineno-23-117" name="__codelineno-23-117" href="#__codelineno-23-117"></a>VUART_DFH
<a id="__codelineno-23-118" name="__codelineno-23-118" href="#__codelineno-23-118"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x61000<span class="o">)</span>
<a id="__codelineno-23-119" name="__codelineno-23-119" href="#__codelineno-23-119"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000010000024<span class="o">)</span>
<a id="__codelineno-23-120" name="__codelineno-23-120" href="#__codelineno-23-120"></a>
<a id="__codelineno-23-121" name="__codelineno-23-121" href="#__codelineno-23-121"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00062000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-122" name="__codelineno-23-122" href="#__codelineno-23-122"></a>
<a id="__codelineno-23-123" name="__codelineno-23-123" href="#__codelineno-23-123"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-124" name="__codelineno-23-124" href="#__codelineno-23-124"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-125" name="__codelineno-23-125" href="#__codelineno-23-125"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x30000000e0001009
<a id="__codelineno-23-126" name="__codelineno-23-126" href="#__codelineno-23-126"></a>
<a id="__codelineno-23-127" name="__codelineno-23-127" href="#__codelineno-23-127"></a>EMIF_DFH
<a id="__codelineno-23-128" name="__codelineno-23-128" href="#__codelineno-23-128"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x62000<span class="o">)</span>
<a id="__codelineno-23-129" name="__codelineno-23-129" href="#__codelineno-23-129"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x30000000e0001009<span class="o">)</span>
<a id="__codelineno-23-130" name="__codelineno-23-130" href="#__codelineno-23-130"></a>
<a id="__codelineno-23-131" name="__codelineno-23-131" href="#__codelineno-23-131"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00070000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-132" name="__codelineno-23-132" href="#__codelineno-23-132"></a>
<a id="__codelineno-23-133" name="__codelineno-23-133" href="#__codelineno-23-133"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-134" name="__codelineno-23-134" href="#__codelineno-23-134"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-135" name="__codelineno-23-135" href="#__codelineno-23-135"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000010001005
<a id="__codelineno-23-136" name="__codelineno-23-136" href="#__codelineno-23-136"></a>
<a id="__codelineno-23-137" name="__codelineno-23-137" href="#__codelineno-23-137"></a>PG_PR_DFH
<a id="__codelineno-23-138" name="__codelineno-23-138" href="#__codelineno-23-138"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x70000<span class="o">)</span>
<a id="__codelineno-23-139" name="__codelineno-23-139" href="#__codelineno-23-139"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000010001005<span class="o">)</span>
<a id="__codelineno-23-140" name="__codelineno-23-140" href="#__codelineno-23-140"></a>
<a id="__codelineno-23-141" name="__codelineno-23-141" href="#__codelineno-23-141"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00071000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-142" name="__codelineno-23-142" href="#__codelineno-23-142"></a>
<a id="__codelineno-23-143" name="__codelineno-23-143" href="#__codelineno-23-143"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-144" name="__codelineno-23-144" href="#__codelineno-23-144"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-145" name="__codelineno-23-145" href="#__codelineno-23-145"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x4000000010001001
<a id="__codelineno-23-146" name="__codelineno-23-146" href="#__codelineno-23-146"></a>
<a id="__codelineno-23-147" name="__codelineno-23-147" href="#__codelineno-23-147"></a>PG_PORT_DFH
<a id="__codelineno-23-148" name="__codelineno-23-148" href="#__codelineno-23-148"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x71000<span class="o">)</span>
<a id="__codelineno-23-149" name="__codelineno-23-149" href="#__codelineno-23-149"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x4000000010001001<span class="o">)</span>
<a id="__codelineno-23-150" name="__codelineno-23-150" href="#__codelineno-23-150"></a>
<a id="__codelineno-23-151" name="__codelineno-23-151" href="#__codelineno-23-151"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00072000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-152" name="__codelineno-23-152" href="#__codelineno-23-152"></a>
<a id="__codelineno-23-153" name="__codelineno-23-153" href="#__codelineno-23-153"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-154" name="__codelineno-23-154" href="#__codelineno-23-154"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-155" name="__codelineno-23-155" href="#__codelineno-23-155"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000010001014
<a id="__codelineno-23-156" name="__codelineno-23-156" href="#__codelineno-23-156"></a>
<a id="__codelineno-23-157" name="__codelineno-23-157" href="#__codelineno-23-157"></a>PG_USER_CLK_DFH
<a id="__codelineno-23-158" name="__codelineno-23-158" href="#__codelineno-23-158"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x72000<span class="o">)</span>
<a id="__codelineno-23-159" name="__codelineno-23-159" href="#__codelineno-23-159"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000010001014<span class="o">)</span>
<a id="__codelineno-23-160" name="__codelineno-23-160" href="#__codelineno-23-160"></a>
<a id="__codelineno-23-161" name="__codelineno-23-161" href="#__codelineno-23-161"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00073000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-162" name="__codelineno-23-162" href="#__codelineno-23-162"></a>
<a id="__codelineno-23-163" name="__codelineno-23-163" href="#__codelineno-23-163"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-164" name="__codelineno-23-164" href="#__codelineno-23-164"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-165" name="__codelineno-23-165" href="#__codelineno-23-165"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x30000000d0002013
<a id="__codelineno-23-166" name="__codelineno-23-166" href="#__codelineno-23-166"></a>
<a id="__codelineno-23-167" name="__codelineno-23-167" href="#__codelineno-23-167"></a>PG_REMOTE_STP_DFH
<a id="__codelineno-23-168" name="__codelineno-23-168" href="#__codelineno-23-168"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x73000<span class="o">)</span>
<a id="__codelineno-23-169" name="__codelineno-23-169" href="#__codelineno-23-169"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x30000000d0002013<span class="o">)</span>
<a id="__codelineno-23-170" name="__codelineno-23-170" href="#__codelineno-23-170"></a>
<a id="__codelineno-23-171" name="__codelineno-23-171" href="#__codelineno-23-171"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00080000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-23-172" name="__codelineno-23-172" href="#__codelineno-23-172"></a>
<a id="__codelineno-23-173" name="__codelineno-23-173" href="#__codelineno-23-173"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-23-174" name="__codelineno-23-174" href="#__codelineno-23-174"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-23-175" name="__codelineno-23-175" href="#__codelineno-23-175"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000010000002010
<a id="__codelineno-23-176" name="__codelineno-23-176" href="#__codelineno-23-176"></a>
<a id="__codelineno-23-177" name="__codelineno-23-177" href="#__codelineno-23-177"></a>AFU_ERR_DFH
<a id="__codelineno-23-178" name="__codelineno-23-178" href="#__codelineno-23-178"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x80000<span class="o">)</span>
<a id="__codelineno-23-179" name="__codelineno-23-179" href="#__codelineno-23-179"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000010000002010<span class="o">)</span>
<a id="__codelineno-23-180" name="__codelineno-23-180" href="#__codelineno-23-180"></a>
<a id="__codelineno-23-181" name="__codelineno-23-181" href="#__codelineno-23-181"></a>
<a id="__codelineno-23-182" name="__codelineno-23-182" href="#__codelineno-23-182"></a>Test<span class="w"> </span>status:<span class="w"> </span>OK
<a id="__codelineno-23-183" name="__codelineno-23-183" href="#__codelineno-23-183"></a>
<a id="__codelineno-23-184" name="__codelineno-23-184" href="#__codelineno-23-184"></a>********************
<a id="__codelineno-23-185" name="__codelineno-23-185" href="#__codelineno-23-185"></a><span class="w">  </span>Test<span class="w"> </span>summary
<a id="__codelineno-23-186" name="__codelineno-23-186" href="#__codelineno-23-186"></a>********************
<a id="__codelineno-23-187" name="__codelineno-23-187" href="#__codelineno-23-187"></a><span class="w">   </span>test_dfh_walking<span class="w"> </span><span class="o">(</span><span class="nv">id</span><span class="o">=</span><span class="m">0</span><span class="o">)</span><span class="w"> </span>-<span class="w"> </span>pass
<a id="__codelineno-23-188" name="__codelineno-23-188" href="#__codelineno-23-188"></a>Test<span class="w"> </span>passed!
<a id="__codelineno-23-189" name="__codelineno-23-189" href="#__codelineno-23-189"></a>Assertion<span class="w"> </span>count:<span class="w"> </span><span class="m">0</span>
</code></pre></div>
</li>
</ol>
<p>The simulation transcript is displayed while the simulation runs.  The transcript is saved in $OFS_ROOTDIR/sim/unit_test/dfh_walker/sim_vcs/transcript for review after the simulation completes.  The simulation waveform database is saved as vcdplus.vpd for post simulation review. You are encouraged to run the additional simulation examples to learn about each key area of the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> shell.</p>
<h2 id="5-creating-a-custom-fim"><strong>5. Creating a Custom <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong><a class="headerlink" href="#5-creating-a-custom-fim" title="Permanent link">&para;</a></h2>
<p>The remaining sections of this guide describe how to perform customizations of areas of the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.  In each section, it is assumed that:</p>
<ol>
<li>You have a clean, unmodified clone of the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> repo.  See [Clone the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Git Repo].</li>
<li>After cloning, you set environment variables.  See <a href="https://ofs.github.io/ofs-2023.1/hw/n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/#431-setting-up-required-environment-variables">Setting Up Required Environment Variables</a>.</li>
</ol>
<h3 id="51-creating-the-hello-fim-example"><strong>5.1. Creating the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> example</strong><a class="headerlink" href="#51-creating-the-hello-fim-example" title="Permanent link">&para;</a></h3>
<p>If you intend to add a new module to the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> area, then you will need to inform the host software of the new module. The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> exposes its functionalities to host software through a set of CSR registers that are mapped to an <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> region (Memory Mapped IO). This set of CSR registers and their operation is described in <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> Regions.
See <a href="https://github.com/OFS/linux-dfl/blob/fpga-ofs-dev/Documentation/fpga/dfl.rst#fpga-device-feature-list-dfl-framework-overview">FPGA Device Feature List (<abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr>) Framework Overview</a> for a description of the software process to read and process the linked list of Device Feature Header (DFH) CSRs within a FPGA.</p>
<p>This example adds a simple DFH register and 64bit scratchpad register connected to the Board Peripheral Fabric (BPF). You can use this example as the basis for adding a new feature to your <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. </p>
<p>Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> register can be verified by Unit Level simulation, Universal Verification Methodology (<abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr>) simulation, and running in hardware on the Intel® FPGA SmartNIC N6001-PL card. </p>
<h4 id="511-board-peripheral-fabric-bpf"><strong>5.1.1. Board Peripheral Fabric (BPF)</strong><a class="headerlink" href="#511-board-peripheral-fabric-bpf" title="Permanent link">&para;</a></h4>
<p>Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> is connected to Board Peripheral Fabric (BPF). BPF is an interconnect generated by Platform Designer.</p>
<p><a class="glightbox" href="../images/hello_fim_bpf.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/hello_fim_bpf.png" /></a></p>
<p>You can create/Modify/generate the BPF manually in Platform Designer or more conveniently by executing an auxiliary script. Both methods will be described shortly.</p>
<h4 id="512-mmio-region"><strong>5.1.2. <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> Region</strong><a class="headerlink" href="#512-mmio-region" title="Permanent link">&para;</a></h4>
<p>This section shows the base addresses of all modules. </p>
<table>
<thead>
<tr>
<th align="left">Offset</th>
<th align="left">Feature CSR set</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">0x00000</td>
<td align="left"><abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr> <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr></td>
</tr>
<tr>
<td align="left">0x10000</td>
<td align="left">PCIe Interface</td>
</tr>
<tr>
<td align="left">0x12000</td>
<td align="left">QSFP Controller 0</td>
</tr>
<tr>
<td align="left">0x13000</td>
<td align="left">QSFP Controller 1</td>
</tr>
<tr>
<td align="left">0x14000</td>
<td align="left">E-Tile Ethernet  Interface</td>
</tr>
<tr>
<td align="left">0x15000</td>
<td align="left">EMIF</td>
</tr>
<tr>
<td align="left"><strong>0x16000</strong></td>
<td align="left"><strong>Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong></td>
</tr>
<tr>
<td align="left">0x20000</td>
<td align="left">PMCI Controller</td>
</tr>
<tr>
<td align="left">0x40000</td>
<td align="left">ST2MM (Streaming to Memory-Mapped)</td>
</tr>
<tr>
<td align="left">0x60000</td>
<td align="left">VUART</td>
</tr>
<tr>
<td align="left">0x70000</td>
<td align="left"><abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> Control &amp; Status (Port Gasket)</td>
</tr>
<tr>
<td align="left">0x71000</td>
<td align="left">Port CSRs (Port Gasket)</td>
</tr>
<tr>
<td align="left">0x72000</td>
<td align="left">User Clock (Port Gasket)</td>
</tr>
<tr>
<td align="left">0x74000</td>
<td align="left">Remote SignalTap (Port Gasket)</td>
</tr>
<tr>
<td align="left">0x80000</td>
<td align="left"><abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Errors (<abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Interface Handler)</td>
</tr>
</tbody>
</table>
<h4 id="513-hello-fim-csr"><strong>5.1.3. Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> CSR</strong><a class="headerlink" href="#513-hello-fim-csr" title="Permanent link">&para;</a></h4>
<p>Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> CSR consists of three registers below. The DFH and Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> ID registers are read-only. The Scratchpad register supports read and write accesses.</p>
<table>
<thead>
<tr>
<th align="left">Offset</th>
<th align="left">Attribute</th>
<th align="left">Description</th>
<th align="left">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">0x016000</td>
<td align="left">RO</td>
<td align="left">DFH(Device Feature Headers) register</td>
<td align="left">0x30000000c0000100</td>
</tr>
<tr>
<td align="left">0x016030</td>
<td align="left">RW</td>
<td align="left">Scrachpad register</td>
<td align="left">0x0</td>
</tr>
<tr>
<td align="left">0x016038</td>
<td align="left">RO</td>
<td align="left">Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> ID register</td>
<td align="left">0x6626070150000034</td>
</tr>
</tbody>
</table>
<h4 id="514-list-of-all-files-to-edit"><strong>5.1.4. List of all files to edit</strong><a class="headerlink" href="#514-list-of-all-files-to-edit" title="Permanent link">&para;</a></h4>
<p>A list below shows all files in $OFS_ROOTDIR that will be modified or created. The build_top.sh script copies files from $OFS_ROOTDIR into the target work directory and then the copied files are used in the Quartus build process.</p>
<table>
<thead>
<tr>
<th align="left">Category</th>
<th align="left">Status</th>
<th align="left">Path</th>
<th align="left">File</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Design Files</td>
<td align="left">Modify</td>
<td align="left">syn/syn_top</td>
<td align="left">ofs_top.qsf</td>
<td align="left">Quartus setting file</td>
</tr>
<tr>
<td align="left">Source</td>
<td align="left">Modify</td>
<td align="left">src/top</td>
<td align="left">top.sv</td>
<td align="left">Top RTL</td>
</tr>
<tr>
<td align="left">Platform Designer</td>
<td align="left">Modify</td>
<td align="left">src/pd_qsys/fabric</td>
<td align="left">bpf.txt</td>
<td align="left"><abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr> region define file</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">Modify</td>
<td align="left">src/pd_qsys/fabric</td>
<td align="left">bpf.qsys</td>
<td align="left">BPF Qsys file</td>
</tr>
<tr>
<td align="left">Simulation</td>
<td align="left">Modify</td>
<td align="left">sim/scripts</td>
<td align="left">rtl_pcie.f</td>
<td align="left">Define RTL files for simulation</td>
</tr>
<tr>
<td align="left">Verification</td>
<td align="left">Modify</td>
<td align="left">verification/tests/sequences</td>
<td align="left">mmio_seq.svh</td>
<td align="left"><abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> testbench</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">Modify</td>
<td align="left">verification/tests/sequences</td>
<td align="left">dfh_walking_seq.svh</td>
<td align="left">DFH Walking testbench</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">Modify</td>
<td align="left">verification/scripts</td>
<td align="left">Makefile_VCS.mk</td>
<td align="left">Makefile for VCS</td>
</tr>
</tbody>
</table>
<h4 id="515-setup-enviroment-variables"><strong>5.1.5. Setup Enviroment Variables</strong><a class="headerlink" href="#515-setup-enviroment-variables" title="Permanent link">&para;</a></h4>
<p>To compile and simulate this design, tools and environment must be set up as previously described for the compilation of the Intel® FPGA SmartNIC N6001-PL <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<h4 id="516-file-modification"><strong>5.1.6. File Modification</strong><a class="headerlink" href="#516-file-modification" title="Permanent link">&para;</a></h4>
<p>This section describes the steps to add the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module to the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. The steps in this simple example are the basis for modifying the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> for more complex functions.</p>
<ol>
<li>
<p>syn/syn_top/ofs_top.qsf</p>
<ol>
<li>
<p>Define the <code>INCLUDE_HELLO_FIM</code> Verilog macro to the <code>Verilog Macros</code> section. This will enable instantiation of the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module. If this is not set, a dummy register will be instantiation instead.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c1">######################################################</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="c1"># Verilog Macros</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="c1">######################################################</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>.....
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>set_global_assignment<span class="w"> </span>-name<span class="w"> </span>VERILOG_MACRO<span class="w"> </span><span class="s2">&quot;INCLUDE_HELLO_FIM&quot;</span><span class="w">     </span><span class="c1"># Includes Hello FIM</span>
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>syn/syn_top/ofs_top_sources.tcl</p>
<ol>
<li>
<p>Add <code>hello_fim_design_files.tcl</code> to the list of subsystems in the Design Files section.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c">############################################</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="c"># Design Files</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="c">############################################</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="nv">...</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="c"># Subsystems</span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="nv">...</span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>SOURCE_TCL_SCRIPT_FILE<span class="w"> </span>..<span class="o">/</span>setup<span class="o">/</span>hello_fim_design_files.tcl
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>syn/setup/hello_fim_design_files.tcl</p>
<ol>
<li>
<p>Create <code>hello_fim_design_files.tcl</code> with the following contents:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c"># Copyright 2023 Intel Corporation.</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="c">#</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="c"># THIS SOFTWARE MAY CONTAIN PREPRODUCTION CODE AND IS PROVIDED BY THE</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="c"># COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="c"># WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="c"># MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="c"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="c"># LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="c"># CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="c"># SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="c"># BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="c"># WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE</span>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="c"># OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,</span>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a><span class="c"># EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="c">#</span>
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a><span class="c"># Hello FIM Files</span>
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a><span class="c">#--------------------</span>
<a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>SYSTEMVERILOG_FILE<span class="w"> </span><span class="nv">$::env</span><span class="k">(</span><span class="nv">BUILD_ROOT_REL</span><span class="k">)</span><span class="o">/</span>src<span class="o">/</span>hello_fim<span class="o">/</span>hello_fim_com.sv
<a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>SYSTEMVERILOG_FILE<span class="w"> </span><span class="nv">$::env</span><span class="k">(</span><span class="nv">BUILD_ROOT_REL</span><span class="k">)</span><span class="o">/</span>src<span class="o">/</span>hello_fim<span class="o">/</span>hello_fim_top.sv
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>src/pd_qsys/fabric/fabric_design_files.tcl</p>
<ol>
<li>
<p>Add <code>bpf_hello_fim_slv.ip</code> to the list of files in the BPF section.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c">#--------------------</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="c"># BPF</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="c">#--------------------</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="nv">...</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>IP_FILE<span class="w"> </span>..<span class="o">/</span>ip_lib<span class="o">/</span>src<span class="o">/</span>pd_qsys<span class="o">/</span>fabric<span class="o">/</span>ip<span class="o">/</span>bpf<span class="o">/</span>bpf_hello_fim_slv.ip
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>src/top/top.sv</p>
<ol>
<li>
<p>Add <code>bpf_hello_fim_slv_if</code> to AXI4-Lite Interfaces:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>//<span class="w"> </span>AXI4-lite<span class="w"> </span>interfaces
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>ofs_fim_axi_lite_if<span class="w"> </span><span class="c1">#(.AWADDR_WIDTH(12), .ARADDR_WIDTH(12)) bpf_hello_fim_slv_if();</span>
</code></pre></div>
</li>
<li>
<p>Modify the value of <code>NEXT_DFH_OFFSET</code> of <code>mem_ss_top</code> from <code>24'h6B000</code> to <code>24'h1000</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="c1">//*******************************</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="c1">// Memory Subsystem</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="c1">//*******************************</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="no">`ifdef</span><span class="w"> </span><span class="n">INCLUDE_DDR4</span>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="w">   </span><span class="n">mem_ss_top</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="w">      </span><span class="p">.</span><span class="n">FEAT_ID</span><span class="w">          </span><span class="p">(</span><span class="mh">12&#39;h009</span><span class="p">),</span>
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="w">      </span><span class="p">.</span><span class="n">FEAT_VER</span><span class="w">         </span><span class="p">(</span><span class="mh">4&#39;h1</span><span class="p">),</span>
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="w">      </span><span class="p">.</span><span class="n">NEXT_DFH_OFFSET</span><span class="w">  </span><span class="p">(</span><span class="mh">24&#39;h1000</span><span class="p">),</span>
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="w">      </span><span class="p">.</span><span class="n">END_OF_LIST</span><span class="w">      </span><span class="p">(</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">)</span>
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="w">   </span><span class="p">)</span><span class="w"> </span><span class="n">mem_ss_top</span><span class="w"> </span><span class="p">(</span>
</code></pre></div>
</li>
<li>
<p>Modify the value of <code>NEXT_DFH_OFFSET</code> of the Memory Subsystem <code>dummy_csr</code> from <code>24'h6B000</code> to <code>24'h1000</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1">// Placeholder logic if no mem_ss</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="n">dummy_csr</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_ID</span><span class="w">          </span><span class="p">(</span><span class="mh">12&#39;h009</span><span class="p">),</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_VER</span><span class="w">         </span><span class="p">(</span><span class="mh">4&#39;h1</span><span class="p">),</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="w">   </span><span class="p">.</span><span class="n">NEXT_DFH_OFFSET</span><span class="w">  </span><span class="p">(</span><span class="mh">24&#39;h1000</span><span class="p">),</span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="w">   </span><span class="p">.</span><span class="n">END_OF_LIST</span><span class="w">      </span><span class="p">(</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">)</span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="p">)</span><span class="w"> </span><span class="n">emif_dummy_csr</span><span class="w"> </span><span class="p">(</span>
</code></pre></div>
</li>
<li>
<p>Add Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> instance and dummy CSR after the Memory Subsystem. Set the <code>NEXT_DFH_OFFSET</code> to <code>24'h6A000</code> for both</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1">//*******************************</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="c1">// Hello FIM Subsystem</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="c1">//*******************************</span>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="no">`ifdef</span><span class="w"> </span><span class="n">INCLUDE_HELLO_FIM</span>
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="n">hello_fim_top</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="w">   </span><span class="p">.</span><span class="n">ADDR_WIDTH</span><span class="w">       </span><span class="p">(</span><span class="mh">12</span><span class="p">),</span>
<a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="w">   </span><span class="p">.</span><span class="n">DATA_WIDTH</span><span class="w">       </span><span class="p">(</span><span class="mh">64</span><span class="p">),</span>
<a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_ID</span><span class="w">          </span><span class="p">(</span><span class="mh">12&#39;h100</span><span class="p">),</span>
<a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_VER</span><span class="w">         </span><span class="p">(</span><span class="mh">4&#39;h0</span><span class="p">),</span>
<a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a><span class="w">   </span><span class="p">.</span><span class="n">NEXT_DFH_OFFSET</span><span class="w">  </span><span class="p">(</span><span class="mh">24&#39;h6A000</span><span class="p">),</span>
<a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a><span class="w">   </span><span class="p">.</span><span class="n">END_OF_LIST</span><span class="w">      </span><span class="p">(</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">)</span>
<a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a><span class="p">)</span><span class="w"> </span><span class="n">hello_fim_top_inst</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a><span class="w">    </span><span class="p">.</span><span class="n">clk</span><span class="w"> </span><span class="p">(</span><span class="n">clk_csr</span><span class="p">),</span>
<a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a><span class="w">    </span><span class="p">.</span><span class="n">reset</span><span class="p">(</span><span class="o">~</span><span class="n">rst_n_csr</span><span class="p">),</span>
<a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a><span class="w">    </span><span class="p">.</span><span class="n">csr_lite_if</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">)</span><span class="w">         </span>
<a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a><span class="p">);</span>
<a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a><span class="no">`else</span>
<a id="__codelineno-31-19" name="__codelineno-31-19" href="#__codelineno-31-19"></a><span class="n">dummy_csr</span><span class="w"> </span><span class="p">#(</span><span class="w">   </span>
<a id="__codelineno-31-20" name="__codelineno-31-20" href="#__codelineno-31-20"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_ID</span><span class="w">          </span><span class="p">(</span><span class="mh">12&#39;h100</span><span class="p">),</span>
<a id="__codelineno-31-21" name="__codelineno-31-21" href="#__codelineno-31-21"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_VER</span><span class="w">         </span><span class="p">(</span><span class="mh">4&#39;h0</span><span class="p">),</span>
<a id="__codelineno-31-22" name="__codelineno-31-22" href="#__codelineno-31-22"></a><span class="w">   </span><span class="p">.</span><span class="n">NEXT_DFH_OFFSET</span><span class="w">  </span><span class="p">(</span><span class="mh">24&#39;h6A000</span><span class="p">),</span>
<a id="__codelineno-31-23" name="__codelineno-31-23" href="#__codelineno-31-23"></a><span class="w">   </span><span class="p">.</span><span class="n">END_OF_LIST</span><span class="w">      </span><span class="p">(</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">)</span>
<a id="__codelineno-31-24" name="__codelineno-31-24" href="#__codelineno-31-24"></a><span class="p">)</span><span class="w"> </span><span class="n">hello_fim_dummy</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-31-25" name="__codelineno-31-25" href="#__codelineno-31-25"></a><span class="w">   </span><span class="p">.</span><span class="n">clk</span><span class="w">         </span><span class="p">(</span><span class="n">clk_csr</span><span class="p">),</span>
<a id="__codelineno-31-26" name="__codelineno-31-26" href="#__codelineno-31-26"></a><span class="w">   </span><span class="p">.</span><span class="n">rst_n</span><span class="w">       </span><span class="p">(</span><span class="n">rst_n_csr</span><span class="p">),</span>
<a id="__codelineno-31-27" name="__codelineno-31-27" href="#__codelineno-31-27"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_lite_if</span><span class="w"> </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">)</span>
<a id="__codelineno-31-28" name="__codelineno-31-28" href="#__codelineno-31-28"></a><span class="p">);</span>
<a id="__codelineno-31-29" name="__codelineno-31-29" href="#__codelineno-31-29"></a>
<a id="__codelineno-31-30" name="__codelineno-31-30" href="#__codelineno-31-30"></a><span class="no">`endif</span><span class="w"> </span>
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>/src/top/top.sv</p>
<ol>
<li>
<p>Add `bpf_hello_fim_slv_if to the interface descriptions</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="p">...</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="p">...</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="n">ofs_fim_axi_lite_if</span><span class="p">.</span><span class="n">master</span><span class="w"> </span><span class="n">bpf_hello_fim_slv_if</span>
</code></pre></div>
</li>
<li>
<p>Add <code>bpf_hello_fim_slv_if</code> to the module</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="k">module</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="p">...</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="p">);</span>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="c1">//*******************************</span>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="c1">// BPF</span>
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="c1">//*******************************</span>
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="w">   </span><span class="n">bpf</span><span class="w"> </span>
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="w">   </span><span class="n">bpf</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a><span class="w">            </span><span class="p">.</span><span class="n">clk_clk</span><span class="w">              </span><span class="p">(</span><span class="n">clk_csr</span><span class="w">                   </span><span class="p">),</span>
<a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a><span class="w">            </span><span class="p">.</span><span class="n">rst_n_reset_n</span><span class="w">        </span><span class="p">(</span><span class="n">rst_n_csr</span><span class="w">                 </span><span class="p">),</span>
<a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a><span class="w"> </span><span class="p">.....</span>
<a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a><span class="w"> </span><span class="p">.....</span>
<a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a>
<a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_awaddr</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">awaddr</span><span class="w">     </span><span class="p">),</span>
<a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_awprot</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">awprot</span><span class="w">     </span><span class="p">),</span>
<a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_awvalid</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">awvalid</span><span class="w">    </span><span class="p">),</span>
<a id="__codelineno-33-18" name="__codelineno-33-18" href="#__codelineno-33-18"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_awready</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">awready</span><span class="w">    </span><span class="p">),</span>
<a id="__codelineno-33-19" name="__codelineno-33-19" href="#__codelineno-33-19"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_wdata</span><span class="w">     </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">wdata</span><span class="w">      </span><span class="p">),</span>
<a id="__codelineno-33-20" name="__codelineno-33-20" href="#__codelineno-33-20"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_wstrb</span><span class="w">     </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">wstrb</span><span class="w">      </span><span class="p">),</span>
<a id="__codelineno-33-21" name="__codelineno-33-21" href="#__codelineno-33-21"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_wvalid</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">wvalid</span><span class="w">     </span><span class="p">),</span>
<a id="__codelineno-33-22" name="__codelineno-33-22" href="#__codelineno-33-22"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_wready</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">wready</span><span class="w">     </span><span class="p">),</span>
<a id="__codelineno-33-23" name="__codelineno-33-23" href="#__codelineno-33-23"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_bresp</span><span class="w">     </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">bresp</span><span class="w">      </span><span class="p">),</span>
<a id="__codelineno-33-24" name="__codelineno-33-24" href="#__codelineno-33-24"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_bvalid</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">bvalid</span><span class="w">     </span><span class="p">),</span>
<a id="__codelineno-33-25" name="__codelineno-33-25" href="#__codelineno-33-25"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_bready</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">bready</span><span class="w">     </span><span class="p">),</span>
<a id="__codelineno-33-26" name="__codelineno-33-26" href="#__codelineno-33-26"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_araddr</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">araddr</span><span class="w">     </span><span class="p">),</span>
<a id="__codelineno-33-27" name="__codelineno-33-27" href="#__codelineno-33-27"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_arprot</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">arprot</span><span class="w">     </span><span class="p">),</span>
<a id="__codelineno-33-28" name="__codelineno-33-28" href="#__codelineno-33-28"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_arvalid</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">arvalid</span><span class="w">    </span><span class="p">),</span>
<a id="__codelineno-33-29" name="__codelineno-33-29" href="#__codelineno-33-29"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_arready</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">arready</span><span class="w">    </span><span class="p">),</span>
<a id="__codelineno-33-30" name="__codelineno-33-30" href="#__codelineno-33-30"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_rdata</span><span class="w">     </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">rdata</span><span class="w">      </span><span class="p">),</span>
<a id="__codelineno-33-31" name="__codelineno-33-31" href="#__codelineno-33-31"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_rresp</span><span class="w">     </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">rresp</span><span class="w">      </span><span class="p">),</span>
<a id="__codelineno-33-32" name="__codelineno-33-32" href="#__codelineno-33-32"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_rvalid</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">rvalid</span><span class="w">     </span><span class="p">),</span>
<a id="__codelineno-33-33" name="__codelineno-33-33" href="#__codelineno-33-33"></a><span class="w">            </span><span class="p">.</span><span class="n">bpf_hello_fim_slv_rready</span><span class="w">    </span><span class="p">(</span><span class="n">bpf_hello_fim_slv_if</span><span class="p">.</span><span class="n">rready</span><span class="w">     </span><span class="p">),</span>
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>src/hello_fim</p>
<ol>
<li>
<p>Create <code>src/hello_fim</code> directory</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>mkdir<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/src/hello_fim
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>src/hello_fim/hello_fim_top.sv</p>
<ol>
<li>
<p>Create <code>hello_fim_top.sv</code> with the following contents:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c1">// ***************************************************************************</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="c1">//                               INTEL CONFIDENTIAL</span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="c1">//</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="c1">//        Copyright (C) 2023 Intel Corporation All Rights Reserved.</span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="c1">//</span>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="c1">// The source code contained or described herein and all  documents related to</span>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="c1">// the  source  code  (&quot;Material&quot;)  are  owned  by  Intel  Corporation  or its</span>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="c1">// suppliers  or  licensors.    Title  to  the  Material  remains  with  Intel</span>
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="c1">// Corporation or  its suppliers  and licensors.  The Material  contains trade</span>
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a><span class="c1">// secrets  and  proprietary  and  confidential  information  of  Intel or its</span>
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a><span class="c1">// suppliers and licensors.  The Material is protected  by worldwide copyright</span>
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a><span class="c1">// and trade secret laws and treaty provisions. No part of the Material may be</span>
<a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a><span class="c1">// used,   copied,   reproduced,   modified,   published,   uploaded,  posted,</span>
<a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a><span class="c1">// transmitted,  distributed,  or  disclosed  in any way without Intel&#39;s prior</span>
<a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a><span class="c1">// express written permission.</span>
<a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a><span class="c1">//</span>
<a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a><span class="c1">// No license under any patent,  copyright, trade secret or other intellectual</span>
<a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a><span class="c1">// property  right  is  granted  to  or  conferred  upon  you by disclosure or</span>
<a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a><span class="c1">// delivery  of  the  Materials, either expressly, by implication, inducement,</span>
<a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a><span class="c1">// estoppel or otherwise.  Any license under such intellectual property rights</span>
<a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a><span class="c1">// must be express and approved by Intel in writing.</span>
<a id="__codelineno-35-22" name="__codelineno-35-22" href="#__codelineno-35-22"></a><span class="c1">//</span>
<a id="__codelineno-35-23" name="__codelineno-35-23" href="#__codelineno-35-23"></a><span class="c1">// You will not, and will not allow any third party to modify, adapt, enhance, </span>
<a id="__codelineno-35-24" name="__codelineno-35-24" href="#__codelineno-35-24"></a><span class="c1">// disassemble, decompile, reverse engineer, change or create derivative works </span>
<a id="__codelineno-35-25" name="__codelineno-35-25" href="#__codelineno-35-25"></a><span class="c1">// from the Software except and only to the extent as specifically required by </span>
<a id="__codelineno-35-26" name="__codelineno-35-26" href="#__codelineno-35-26"></a><span class="c1">// mandatory applicable laws or any applicable third party license terms </span>
<a id="__codelineno-35-27" name="__codelineno-35-27" href="#__codelineno-35-27"></a><span class="c1">// accompanying the Software.</span>
<a id="__codelineno-35-28" name="__codelineno-35-28" href="#__codelineno-35-28"></a><span class="c1">//</span>
<a id="__codelineno-35-29" name="__codelineno-35-29" href="#__codelineno-35-29"></a><span class="c1">// -----------------------------------------------------------------------------</span>
<a id="__codelineno-35-30" name="__codelineno-35-30" href="#__codelineno-35-30"></a><span class="c1">// Engineer     : </span>
<a id="__codelineno-35-31" name="__codelineno-35-31" href="#__codelineno-35-31"></a><span class="c1">// Create Date  : Nov 2021</span>
<a id="__codelineno-35-32" name="__codelineno-35-32" href="#__codelineno-35-32"></a><span class="c1">// Module Name  : hello_fim_top.sv</span>
<a id="__codelineno-35-33" name="__codelineno-35-33" href="#__codelineno-35-33"></a><span class="c1">// Project      : IOFS</span>
<a id="__codelineno-35-34" name="__codelineno-35-34" href="#__codelineno-35-34"></a><span class="c1">// -----------------------------------------------------------------------------</span>
<a id="__codelineno-35-35" name="__codelineno-35-35" href="#__codelineno-35-35"></a><span class="c1">//</span>
<a id="__codelineno-35-36" name="__codelineno-35-36" href="#__codelineno-35-36"></a><span class="c1">// Description: </span>
<a id="__codelineno-35-37" name="__codelineno-35-37" href="#__codelineno-35-37"></a><span class="c1">// This is a simple module that implements DFH registers and </span>
<a id="__codelineno-35-38" name="__codelineno-35-38" href="#__codelineno-35-38"></a><span class="c1">// AVMM address decoding logic.</span>
<a id="__codelineno-35-39" name="__codelineno-35-39" href="#__codelineno-35-39"></a>
<a id="__codelineno-35-40" name="__codelineno-35-40" href="#__codelineno-35-40"></a>
<a id="__codelineno-35-41" name="__codelineno-35-41" href="#__codelineno-35-41"></a><span class="k">module</span><span class="w"> </span><span class="n">hello_fim_top</span><span class="w">  </span><span class="p">#(</span>
<a id="__codelineno-35-42" name="__codelineno-35-42" href="#__codelineno-35-42"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="n">ADDR_WIDTH</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">12</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-35-43" name="__codelineno-35-43" href="#__codelineno-35-43"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="n">DATA_WIDTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-35-44" name="__codelineno-35-44" href="#__codelineno-35-44"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">11</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">FEAT_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">12&#39;h001</span><span class="p">,</span>
<a id="__codelineno-35-45" name="__codelineno-35-45" href="#__codelineno-35-45"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">FEAT_VER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">4&#39;h1</span><span class="p">,</span>
<a id="__codelineno-35-46" name="__codelineno-35-46" href="#__codelineno-35-46"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">23</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">NEXT_DFH_OFFSET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">24&#39;h1000</span><span class="p">,</span>
<a id="__codelineno-35-47" name="__codelineno-35-47" href="#__codelineno-35-47"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="n">END_OF_LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span>
<a id="__codelineno-35-48" name="__codelineno-35-48" href="#__codelineno-35-48"></a><span class="p">)(</span>
<a id="__codelineno-35-49" name="__codelineno-35-49" href="#__codelineno-35-49"></a><span class="w">   </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w">    </span><span class="n">clk</span><span class="p">,</span>
<a id="__codelineno-35-50" name="__codelineno-35-50" href="#__codelineno-35-50"></a><span class="w">   </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w">    </span><span class="n">reset</span><span class="p">,</span>
<a id="__codelineno-35-51" name="__codelineno-35-51" href="#__codelineno-35-51"></a><span class="c1">// -----------------------------------------------------------</span>
<a id="__codelineno-35-52" name="__codelineno-35-52" href="#__codelineno-35-52"></a><span class="c1">//  AXI4LITE Interface</span>
<a id="__codelineno-35-53" name="__codelineno-35-53" href="#__codelineno-35-53"></a><span class="c1">// -----------------------------------------------------------</span>
<a id="__codelineno-35-54" name="__codelineno-35-54" href="#__codelineno-35-54"></a><span class="w">   </span><span class="n">ofs_fim_axi_lite_if</span><span class="p">.</span><span class="n">slave</span><span class="w">   </span><span class="n">csr_lite_if</span>
<a id="__codelineno-35-55" name="__codelineno-35-55" href="#__codelineno-35-55"></a><span class="p">);</span>
<a id="__codelineno-35-56" name="__codelineno-35-56" href="#__codelineno-35-56"></a>
<a id="__codelineno-35-57" name="__codelineno-35-57" href="#__codelineno-35-57"></a><span class="kn">import</span> <span class="nn">ofs_fim_cfg_pkg::*</span><span class="p">;</span>
<a id="__codelineno-35-58" name="__codelineno-35-58" href="#__codelineno-35-58"></a><span class="kn">import</span> <span class="nn">ofs_csr_pkg::*</span><span class="p">;</span>
<a id="__codelineno-35-59" name="__codelineno-35-59" href="#__codelineno-35-59"></a>
<a id="__codelineno-35-60" name="__codelineno-35-60" href="#__codelineno-35-60"></a><span class="c1">//-------------------------------------</span>
<a id="__codelineno-35-61" name="__codelineno-35-61" href="#__codelineno-35-61"></a><span class="c1">// Signals</span>
<a id="__codelineno-35-62" name="__codelineno-35-62" href="#__codelineno-35-62"></a><span class="c1">//-------------------------------------</span>
<a id="__codelineno-35-63" name="__codelineno-35-63" href="#__codelineno-35-63"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">ADDR_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_waddr</span><span class="p">;</span>
<a id="__codelineno-35-64" name="__codelineno-35-64" href="#__codelineno-35-64"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">DATA_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_wdata</span><span class="p">;</span>
<a id="__codelineno-35-65" name="__codelineno-35-65" href="#__codelineno-35-65"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">DATA_WIDTH</span><span class="o">/</span><span class="mh">8</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">            </span><span class="n">csr_wstrb</span><span class="p">;</span>
<a id="__codelineno-35-66" name="__codelineno-35-66" href="#__codelineno-35-66"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_write</span><span class="p">;</span>
<a id="__codelineno-35-67" name="__codelineno-35-67" href="#__codelineno-35-67"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_slv_wready</span><span class="p">;</span>
<a id="__codelineno-35-68" name="__codelineno-35-68" href="#__codelineno-35-68"></a><span class="w">   </span><span class="n">csr_access_type_t</span><span class="w">                   </span><span class="n">csr_write_type</span><span class="p">;</span>
<a id="__codelineno-35-69" name="__codelineno-35-69" href="#__codelineno-35-69"></a>
<a id="__codelineno-35-70" name="__codelineno-35-70" href="#__codelineno-35-70"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">ADDR_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_raddr</span><span class="p">;</span>
<a id="__codelineno-35-71" name="__codelineno-35-71" href="#__codelineno-35-71"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_read</span><span class="p">;</span>
<a id="__codelineno-35-72" name="__codelineno-35-72" href="#__codelineno-35-72"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_read_32b</span><span class="p">;</span>
<a id="__codelineno-35-73" name="__codelineno-35-73" href="#__codelineno-35-73"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">DATA_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_readdata</span><span class="p">;</span>
<a id="__codelineno-35-74" name="__codelineno-35-74" href="#__codelineno-35-74"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_readdata_valid</span><span class="p">;</span>
<a id="__codelineno-35-75" name="__codelineno-35-75" href="#__codelineno-35-75"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">ADDR_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_addr</span><span class="p">;</span>
<a id="__codelineno-35-76" name="__codelineno-35-76" href="#__codelineno-35-76"></a>
<a id="__codelineno-35-77" name="__codelineno-35-77" href="#__codelineno-35-77"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">                        </span><span class="n">com_csr_writedata</span><span class="p">;</span>
<a id="__codelineno-35-78" name="__codelineno-35-78" href="#__codelineno-35-78"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">com_csr_read</span><span class="p">;</span>
<a id="__codelineno-35-79" name="__codelineno-35-79" href="#__codelineno-35-79"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">com_csr_write</span><span class="p">;</span>
<a id="__codelineno-35-80" name="__codelineno-35-80" href="#__codelineno-35-80"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">                        </span><span class="n">com_csr_readdata</span><span class="p">;</span>
<a id="__codelineno-35-81" name="__codelineno-35-81" href="#__codelineno-35-81"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">com_csr_readdatavalid</span><span class="p">;</span>
<a id="__codelineno-35-82" name="__codelineno-35-82" href="#__codelineno-35-82"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">                         </span><span class="n">com_csr_address</span><span class="p">;</span>
<a id="__codelineno-35-83" name="__codelineno-35-83" href="#__codelineno-35-83"></a>
<a id="__codelineno-35-84" name="__codelineno-35-84" href="#__codelineno-35-84"></a><span class="c1">// AXI-M CSR interfaces</span>
<a id="__codelineno-35-85" name="__codelineno-35-85" href="#__codelineno-35-85"></a><span class="n">ofs_fim_axi_mmio_if</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-35-86" name="__codelineno-35-86" href="#__codelineno-35-86"></a><span class="w">   </span><span class="p">.</span><span class="n">AWID_WIDTH</span><span class="w">   </span><span class="p">(</span><span class="n">ofs_fim_cfg_pkg</span><span class="o">::</span><span class="n">MMIO_TID_WIDTH</span><span class="p">),</span>
<a id="__codelineno-35-87" name="__codelineno-35-87" href="#__codelineno-35-87"></a><span class="w">   </span><span class="p">.</span><span class="n">AWADDR_WIDTH</span><span class="w"> </span><span class="p">(</span><span class="n">ADDR_WIDTH</span><span class="p">),</span>
<a id="__codelineno-35-88" name="__codelineno-35-88" href="#__codelineno-35-88"></a><span class="w">   </span><span class="p">.</span><span class="n">WDATA_WIDTH</span><span class="w">  </span><span class="p">(</span><span class="n">ofs_fim_cfg_pkg</span><span class="o">::</span><span class="n">MMIO_DATA_WIDTH</span><span class="p">),</span>
<a id="__codelineno-35-89" name="__codelineno-35-89" href="#__codelineno-35-89"></a><span class="w">   </span><span class="p">.</span><span class="n">ARID_WIDTH</span><span class="w">   </span><span class="p">(</span><span class="n">ofs_fim_cfg_pkg</span><span class="o">::</span><span class="n">MMIO_TID_WIDTH</span><span class="p">),</span>
<a id="__codelineno-35-90" name="__codelineno-35-90" href="#__codelineno-35-90"></a><span class="w">   </span><span class="p">.</span><span class="n">ARADDR_WIDTH</span><span class="w"> </span><span class="p">(</span><span class="n">ADDR_WIDTH</span><span class="p">),</span>
<a id="__codelineno-35-91" name="__codelineno-35-91" href="#__codelineno-35-91"></a><span class="w">   </span><span class="p">.</span><span class="n">RDATA_WIDTH</span><span class="w">  </span><span class="p">(</span><span class="n">ofs_fim_cfg_pkg</span><span class="o">::</span><span class="n">MMIO_DATA_WIDTH</span><span class="p">)</span>
<a id="__codelineno-35-92" name="__codelineno-35-92" href="#__codelineno-35-92"></a><span class="p">)</span><span class="w"> </span><span class="n">csr_if</span><span class="p">();</span>
<a id="__codelineno-35-93" name="__codelineno-35-93" href="#__codelineno-35-93"></a>
<a id="__codelineno-35-94" name="__codelineno-35-94" href="#__codelineno-35-94"></a><span class="c1">// AXI4-lite to AXI-M adapter</span>
<a id="__codelineno-35-95" name="__codelineno-35-95" href="#__codelineno-35-95"></a><span class="n">axi_lite2mmio</span><span class="w"> </span><span class="n">axi_lite2mmio</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-35-96" name="__codelineno-35-96" href="#__codelineno-35-96"></a><span class="w">   </span><span class="p">.</span><span class="n">clk</span><span class="w">       </span><span class="p">(</span><span class="n">clk</span><span class="p">),</span>
<a id="__codelineno-35-97" name="__codelineno-35-97" href="#__codelineno-35-97"></a><span class="w">   </span><span class="p">.</span><span class="n">rst_n</span><span class="w">     </span><span class="p">(</span><span class="o">~</span><span class="n">reset</span><span class="p">),</span>
<a id="__codelineno-35-98" name="__codelineno-35-98" href="#__codelineno-35-98"></a><span class="w">   </span><span class="p">.</span><span class="n">lite_if</span><span class="w">   </span><span class="p">(</span><span class="n">csr_lite_if</span><span class="p">),</span>
<a id="__codelineno-35-99" name="__codelineno-35-99" href="#__codelineno-35-99"></a><span class="w">   </span><span class="p">.</span><span class="n">mmio_if</span><span class="w">   </span><span class="p">(</span><span class="n">csr_if</span><span class="p">)</span>
<a id="__codelineno-35-100" name="__codelineno-35-100" href="#__codelineno-35-100"></a><span class="p">);</span>
<a id="__codelineno-35-101" name="__codelineno-35-101" href="#__codelineno-35-101"></a>
<a id="__codelineno-35-102" name="__codelineno-35-102" href="#__codelineno-35-102"></a><span class="c1">//---------------------------------</span>
<a id="__codelineno-35-103" name="__codelineno-35-103" href="#__codelineno-35-103"></a><span class="c1">// Map AXI write/read request to CSR write/read,</span>
<a id="__codelineno-35-104" name="__codelineno-35-104" href="#__codelineno-35-104"></a><span class="c1">// and send the write/read response back</span>
<a id="__codelineno-35-105" name="__codelineno-35-105" href="#__codelineno-35-105"></a><span class="c1">//---------------------------------</span>
<a id="__codelineno-35-106" name="__codelineno-35-106" href="#__codelineno-35-106"></a><span class="n">ofs_fim_axi_csr_slave</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-35-107" name="__codelineno-35-107" href="#__codelineno-35-107"></a><span class="w">   </span><span class="p">.</span><span class="n">ADDR_WIDTH</span><span class="w"> </span><span class="p">(</span><span class="n">ADDR_WIDTH</span><span class="p">),</span>
<a id="__codelineno-35-108" name="__codelineno-35-108" href="#__codelineno-35-108"></a><span class="w">   </span><span class="p">.</span><span class="n">USE_SLV_READY</span><span class="w"> </span><span class="p">(</span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">)</span>
<a id="__codelineno-35-109" name="__codelineno-35-109" href="#__codelineno-35-109"></a>
<a id="__codelineno-35-110" name="__codelineno-35-110" href="#__codelineno-35-110"></a><span class="w">   </span><span class="p">)</span><span class="w"> </span><span class="n">csr_slave</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-35-111" name="__codelineno-35-111" href="#__codelineno-35-111"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_if</span><span class="w">             </span><span class="p">(</span><span class="n">csr_if</span><span class="p">),</span>
<a id="__codelineno-35-112" name="__codelineno-35-112" href="#__codelineno-35-112"></a>
<a id="__codelineno-35-113" name="__codelineno-35-113" href="#__codelineno-35-113"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_write</span><span class="w">          </span><span class="p">(</span><span class="n">csr_write</span><span class="p">),</span>
<a id="__codelineno-35-114" name="__codelineno-35-114" href="#__codelineno-35-114"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_waddr</span><span class="w">          </span><span class="p">(</span><span class="n">csr_waddr</span><span class="p">),</span>
<a id="__codelineno-35-115" name="__codelineno-35-115" href="#__codelineno-35-115"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_write_type</span><span class="w">     </span><span class="p">(</span><span class="n">csr_write_type</span><span class="p">),</span>
<a id="__codelineno-35-116" name="__codelineno-35-116" href="#__codelineno-35-116"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_wdata</span><span class="w">          </span><span class="p">(</span><span class="n">csr_wdata</span><span class="p">),</span>
<a id="__codelineno-35-117" name="__codelineno-35-117" href="#__codelineno-35-117"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_wstrb</span><span class="w">          </span><span class="p">(</span><span class="n">csr_wstrb</span><span class="p">),</span>
<a id="__codelineno-35-118" name="__codelineno-35-118" href="#__codelineno-35-118"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_slv_wready</span><span class="w">     </span><span class="p">(</span><span class="n">csr_slv_wready</span><span class="p">),</span>
<a id="__codelineno-35-119" name="__codelineno-35-119" href="#__codelineno-35-119"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_read</span><span class="w">           </span><span class="p">(</span><span class="n">csr_read</span><span class="p">),</span>
<a id="__codelineno-35-120" name="__codelineno-35-120" href="#__codelineno-35-120"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_raddr</span><span class="w">          </span><span class="p">(</span><span class="n">csr_raddr</span><span class="p">),</span>
<a id="__codelineno-35-121" name="__codelineno-35-121" href="#__codelineno-35-121"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_read_32b</span><span class="w">       </span><span class="p">(</span><span class="n">csr_read_32b</span><span class="p">),</span>
<a id="__codelineno-35-122" name="__codelineno-35-122" href="#__codelineno-35-122"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_readdata</span><span class="w">       </span><span class="p">(</span><span class="n">csr_readdata</span><span class="p">),</span>
<a id="__codelineno-35-123" name="__codelineno-35-123" href="#__codelineno-35-123"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_readdata_valid</span><span class="w"> </span><span class="p">(</span><span class="n">csr_readdata_valid</span><span class="p">)</span>
<a id="__codelineno-35-124" name="__codelineno-35-124" href="#__codelineno-35-124"></a><span class="p">);</span>
<a id="__codelineno-35-125" name="__codelineno-35-125" href="#__codelineno-35-125"></a>
<a id="__codelineno-35-126" name="__codelineno-35-126" href="#__codelineno-35-126"></a><span class="c1">// Address mapping</span>
<a id="__codelineno-35-127" name="__codelineno-35-127" href="#__codelineno-35-127"></a><span class="k">assign</span><span class="w"> </span><span class="n">csr_addr</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="n">csr_write</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">csr_waddr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">csr_raddr</span><span class="p">;</span>
<a id="__codelineno-35-128" name="__codelineno-35-128" href="#__codelineno-35-128"></a><span class="k">assign</span><span class="w"> </span><span class="n">com_csr_address</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">csr_addr</span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span><span class="w">  </span><span class="c1">// byte address</span>
<a id="__codelineno-35-129" name="__codelineno-35-129" href="#__codelineno-35-129"></a><span class="k">assign</span><span class="w"> </span><span class="n">csr_slv_wready</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="w"> </span><span class="p">;</span>
<a id="__codelineno-35-130" name="__codelineno-35-130" href="#__codelineno-35-130"></a><span class="c1">// Write data mapping</span>
<a id="__codelineno-35-131" name="__codelineno-35-131" href="#__codelineno-35-131"></a><span class="k">assign</span><span class="w"> </span><span class="n">com_csr_writedata</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">csr_wdata</span><span class="p">;</span>
<a id="__codelineno-35-132" name="__codelineno-35-132" href="#__codelineno-35-132"></a>
<a id="__codelineno-35-133" name="__codelineno-35-133" href="#__codelineno-35-133"></a><span class="c1">// Read-Write mapping</span>
<a id="__codelineno-35-134" name="__codelineno-35-134" href="#__codelineno-35-134"></a><span class="k">always_comb</span>
<a id="__codelineno-35-135" name="__codelineno-35-135" href="#__codelineno-35-135"></a><span class="k">begin</span>
<a id="__codelineno-35-136" name="__codelineno-35-136" href="#__codelineno-35-136"></a><span class="w">   </span><span class="n">com_csr_read</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-35-137" name="__codelineno-35-137" href="#__codelineno-35-137"></a><span class="w">   </span><span class="n">com_csr_write</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-35-138" name="__codelineno-35-138" href="#__codelineno-35-138"></a><span class="w">   </span><span class="k">casez</span><span class="w"> </span><span class="p">(</span><span class="n">csr_addr</span><span class="p">[</span><span class="mh">11</span><span class="o">:</span><span class="mh">6</span><span class="p">])</span>
<a id="__codelineno-35-139" name="__codelineno-35-139" href="#__codelineno-35-139"></a><span class="w">      </span><span class="mh">6&#39;h00</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span><span class="c1">// Common CSR</span>
<a id="__codelineno-35-140" name="__codelineno-35-140" href="#__codelineno-35-140"></a><span class="w">         </span><span class="n">com_csr_read</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">csr_read</span><span class="p">;</span>
<a id="__codelineno-35-141" name="__codelineno-35-141" href="#__codelineno-35-141"></a><span class="w">         </span><span class="n">com_csr_write</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">csr_write</span><span class="p">;</span>
<a id="__codelineno-35-142" name="__codelineno-35-142" href="#__codelineno-35-142"></a><span class="w">      </span><span class="k">end</span><span class="w">   </span>
<a id="__codelineno-35-143" name="__codelineno-35-143" href="#__codelineno-35-143"></a><span class="w">      </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-35-144" name="__codelineno-35-144" href="#__codelineno-35-144"></a><span class="w">         </span><span class="n">com_csr_read</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-35-145" name="__codelineno-35-145" href="#__codelineno-35-145"></a><span class="w">         </span><span class="n">com_csr_write</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-35-146" name="__codelineno-35-146" href="#__codelineno-35-146"></a><span class="w">      </span><span class="k">end</span>
<a id="__codelineno-35-147" name="__codelineno-35-147" href="#__codelineno-35-147"></a><span class="w">   </span><span class="k">endcase</span>
<a id="__codelineno-35-148" name="__codelineno-35-148" href="#__codelineno-35-148"></a><span class="k">end</span>
<a id="__codelineno-35-149" name="__codelineno-35-149" href="#__codelineno-35-149"></a>
<a id="__codelineno-35-150" name="__codelineno-35-150" href="#__codelineno-35-150"></a><span class="c1">// Read data mapping</span>
<a id="__codelineno-35-151" name="__codelineno-35-151" href="#__codelineno-35-151"></a><span class="k">always_comb</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-35-152" name="__codelineno-35-152" href="#__codelineno-35-152"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">com_csr_readdatavalid</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-35-153" name="__codelineno-35-153" href="#__codelineno-35-153"></a><span class="w">      </span><span class="n">csr_readdata</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">com_csr_readdata</span><span class="p">;</span>
<a id="__codelineno-35-154" name="__codelineno-35-154" href="#__codelineno-35-154"></a><span class="w">      </span><span class="n">csr_readdata_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
<a id="__codelineno-35-155" name="__codelineno-35-155" href="#__codelineno-35-155"></a><span class="w">   </span><span class="k">end</span>
<a id="__codelineno-35-156" name="__codelineno-35-156" href="#__codelineno-35-156"></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-35-157" name="__codelineno-35-157" href="#__codelineno-35-157"></a><span class="w">      </span><span class="n">csr_readdata</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="m">&#39;0</span><span class="p">;</span>
<a id="__codelineno-35-158" name="__codelineno-35-158" href="#__codelineno-35-158"></a><span class="w">      </span><span class="n">csr_readdata_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-35-159" name="__codelineno-35-159" href="#__codelineno-35-159"></a><span class="w">   </span><span class="k">end</span>
<a id="__codelineno-35-160" name="__codelineno-35-160" href="#__codelineno-35-160"></a><span class="k">end</span>
<a id="__codelineno-35-161" name="__codelineno-35-161" href="#__codelineno-35-161"></a>
<a id="__codelineno-35-162" name="__codelineno-35-162" href="#__codelineno-35-162"></a><span class="n">hello_fim_com</span><span class="w">  </span><span class="p">#(</span>
<a id="__codelineno-35-163" name="__codelineno-35-163" href="#__codelineno-35-163"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_ID</span><span class="w">          </span><span class="p">(</span><span class="n">FEAT_ID</span><span class="p">),</span>
<a id="__codelineno-35-164" name="__codelineno-35-164" href="#__codelineno-35-164"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_VER</span><span class="w">         </span><span class="p">(</span><span class="n">FEAT_VER</span><span class="p">),</span>
<a id="__codelineno-35-165" name="__codelineno-35-165" href="#__codelineno-35-165"></a><span class="w">   </span><span class="p">.</span><span class="n">NEXT_DFH_OFFSET</span><span class="w">  </span><span class="p">(</span><span class="n">NEXT_DFH_OFFSET</span><span class="p">),</span>
<a id="__codelineno-35-166" name="__codelineno-35-166" href="#__codelineno-35-166"></a><span class="w">   </span><span class="p">.</span><span class="n">END_OF_LIST</span><span class="w">      </span><span class="p">(</span><span class="n">END_OF_LIST</span><span class="p">)</span>
<a id="__codelineno-35-167" name="__codelineno-35-167" href="#__codelineno-35-167"></a><span class="p">)</span><span class="w"> </span><span class="n">hello_fim_com_inst</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-35-168" name="__codelineno-35-168" href="#__codelineno-35-168"></a><span class="w">   </span><span class="p">.</span><span class="n">clk</span><span class="w">                   </span><span class="p">(</span><span class="n">clk</span><span class="w">                     </span><span class="p">),</span>
<a id="__codelineno-35-169" name="__codelineno-35-169" href="#__codelineno-35-169"></a><span class="w">   </span><span class="p">.</span><span class="n">reset</span><span class="w">                 </span><span class="p">(</span><span class="n">reset</span><span class="w">                   </span><span class="p">),</span>
<a id="__codelineno-35-170" name="__codelineno-35-170" href="#__codelineno-35-170"></a><span class="w">   </span><span class="p">.</span><span class="n">writedata</span><span class="w">             </span><span class="p">(</span><span class="n">com_csr_writedata</span><span class="w">       </span><span class="p">),</span>
<a id="__codelineno-35-171" name="__codelineno-35-171" href="#__codelineno-35-171"></a><span class="w">   </span><span class="p">.</span><span class="n">read</span><span class="w">                  </span><span class="p">(</span><span class="n">com_csr_read</span><span class="w">            </span><span class="p">),</span>
<a id="__codelineno-35-172" name="__codelineno-35-172" href="#__codelineno-35-172"></a><span class="w">   </span><span class="p">.</span><span class="n">write</span><span class="w">                 </span><span class="p">(</span><span class="n">com_csr_write</span><span class="w">           </span><span class="p">),</span>
<a id="__codelineno-35-173" name="__codelineno-35-173" href="#__codelineno-35-173"></a><span class="w">   </span><span class="p">.</span><span class="n">byteenable</span><span class="w">            </span><span class="p">(</span><span class="mh">4&#39;hF</span><span class="w">                    </span><span class="p">),</span>
<a id="__codelineno-35-174" name="__codelineno-35-174" href="#__codelineno-35-174"></a><span class="w">   </span><span class="p">.</span><span class="n">readdata</span><span class="w">              </span><span class="p">(</span><span class="n">com_csr_readdata</span><span class="w">        </span><span class="p">),</span>
<a id="__codelineno-35-175" name="__codelineno-35-175" href="#__codelineno-35-175"></a><span class="w">   </span><span class="p">.</span><span class="n">readdatavalid</span><span class="w">         </span><span class="p">(</span><span class="n">com_csr_readdatavalid</span><span class="w">   </span><span class="p">),</span>
<a id="__codelineno-35-176" name="__codelineno-35-176" href="#__codelineno-35-176"></a><span class="w">   </span><span class="p">.</span><span class="n">address</span><span class="w">               </span><span class="p">(</span><span class="n">com_csr_address</span><span class="w">         </span><span class="p">)</span>
<a id="__codelineno-35-177" name="__codelineno-35-177" href="#__codelineno-35-177"></a><span class="w">   </span><span class="p">);</span>
<a id="__codelineno-35-178" name="__codelineno-35-178" href="#__codelineno-35-178"></a><span class="k">endmodule</span>
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>src/hello_fim/hello_fim_com.sv</p>
<ol>
<li>
<p>Create <code>hello_fim_com.sv</code> with the following contents:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="k">module</span><span class="w"> </span><span class="n">hello_fim_com</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">11</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">FEAT_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">12&#39;h001</span><span class="p">,</span>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">FEAT_VER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">4&#39;h1</span><span class="p">,</span>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">23</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">NEXT_DFH_OFFSET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">24&#39;h1000</span><span class="p">,</span>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="n">END_OF_LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span>
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="w"> </span><span class="p">)(</span>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="n">clk</span><span class="p">,</span>
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="n">reset</span><span class="p">,</span>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">writedata</span><span class="p">,</span>
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="n">read</span><span class="p">,</span>
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="n">write</span><span class="p">,</span>
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">byteenable</span><span class="p">,</span>
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">readdata</span><span class="p">,</span>
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="n">readdatavalid</span><span class="p">,</span>
<a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">address</span>
<a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a><span class="w"> </span><span class="p">);</span>
<a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a>
<a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a><span class="w"> </span><span class="kt">wire</span><span class="w"> </span><span class="n">reset_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">reset</span><span class="p">;</span><span class="w"> </span>
<a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">rdata_comb</span><span class="p">;</span>
<a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">scratch_reg</span><span class="p">;</span>
<a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a>
<a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a><span class="w"> </span><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">negedge</span><span class="w"> </span><span class="n">reset_n</span><span class="w"> </span><span class="p">,</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span><span class="w">  </span>
<a id="__codelineno-36-23" name="__codelineno-36-23" href="#__codelineno-36-23"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">reset_n</span><span class="p">)</span><span class="w"> </span><span class="n">readdata</span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">readdata</span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">rdata_comb</span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
<a id="__codelineno-36-24" name="__codelineno-36-24" href="#__codelineno-36-24"></a>
<a id="__codelineno-36-25" name="__codelineno-36-25" href="#__codelineno-36-25"></a><span class="w"> </span><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">negedge</span><span class="w"> </span><span class="n">reset_n</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span>
<a id="__codelineno-36-26" name="__codelineno-36-26" href="#__codelineno-36-26"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">reset_n</span><span class="p">)</span><span class="w"> </span><span class="n">readdatavalid</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">readdatavalid</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">read</span><span class="p">;</span>
<a id="__codelineno-36-27" name="__codelineno-36-27" href="#__codelineno-36-27"></a>
<a id="__codelineno-36-28" name="__codelineno-36-28" href="#__codelineno-36-28"></a><span class="w"> </span><span class="kt">wire</span><span class="w"> </span><span class="n">wr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">write</span><span class="p">;</span>
<a id="__codelineno-36-29" name="__codelineno-36-29" href="#__codelineno-36-29"></a><span class="w"> </span><span class="kt">wire</span><span class="w"> </span><span class="n">re</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read</span><span class="p">;</span>
<a id="__codelineno-36-30" name="__codelineno-36-30" href="#__codelineno-36-30"></a><span class="w"> </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
<a id="__codelineno-36-31" name="__codelineno-36-31" href="#__codelineno-36-31"></a><span class="w"> </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">din</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">writedata</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
<a id="__codelineno-36-32" name="__codelineno-36-32" href="#__codelineno-36-32"></a><span class="w"> </span><span class="kt">wire</span><span class="w"> </span><span class="n">wr_scratch_reg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wr</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">addr</span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="o">==</span><span class="w"> </span><span class="mh">6&#39;h30</span><span class="p">)</span><span class="o">?</span><span class="w"> </span><span class="n">byteenable</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="o">:</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-36-33" name="__codelineno-36-33" href="#__codelineno-36-33"></a>
<a id="__codelineno-36-34" name="__codelineno-36-34" href="#__codelineno-36-34"></a><span class="w"> </span><span class="c1">// 64 bit scratch register</span>
<a id="__codelineno-36-35" name="__codelineno-36-35" href="#__codelineno-36-35"></a><span class="w"> </span><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="w"> </span><span class="k">negedge</span><span class="w">  </span><span class="n">reset_n</span><span class="p">,</span><span class="w">  </span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span>
<a id="__codelineno-36-36" name="__codelineno-36-36" href="#__codelineno-36-36"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">reset_n</span><span class="p">)</span><span class="w">  </span><span class="k">begin</span>
<a id="__codelineno-36-37" name="__codelineno-36-37" href="#__codelineno-36-37"></a><span class="w">       </span><span class="n">scratch_reg</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="p">;</span>
<a id="__codelineno-36-38" name="__codelineno-36-38" href="#__codelineno-36-38"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-36-39" name="__codelineno-36-39" href="#__codelineno-36-39"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-36-40" name="__codelineno-36-40" href="#__codelineno-36-40"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wr_scratch_reg</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span>
<a id="__codelineno-36-41" name="__codelineno-36-41" href="#__codelineno-36-41"></a><span class="w">       </span><span class="n">scratch_reg</span><span class="w"> </span><span class="o">&lt;=</span><span class="w">  </span><span class="n">din</span><span class="p">;</span><span class="w">  </span>
<a id="__codelineno-36-42" name="__codelineno-36-42" href="#__codelineno-36-42"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-36-43" name="__codelineno-36-43" href="#__codelineno-36-43"></a><span class="w"> </span><span class="k">end</span>
<a id="__codelineno-36-44" name="__codelineno-36-44" href="#__codelineno-36-44"></a>
<a id="__codelineno-36-45" name="__codelineno-36-45" href="#__codelineno-36-45"></a><span class="w"> </span><span class="k">always</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a id="__codelineno-36-46" name="__codelineno-36-46" href="#__codelineno-36-46"></a><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-36-47" name="__codelineno-36-47" href="#__codelineno-36-47"></a><span class="w"> </span><span class="n">rdata_comb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h0000000000000000</span><span class="p">;</span>
<a id="__codelineno-36-48" name="__codelineno-36-48" href="#__codelineno-36-48"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">re</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-36-49" name="__codelineno-36-49" href="#__codelineno-36-49"></a><span class="w">       </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="w">  </span>
<a id="__codelineno-36-50" name="__codelineno-36-50" href="#__codelineno-36-50"></a><span class="w">         </span><span class="mh">6&#39;h00</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-36-51" name="__codelineno-36-51" href="#__codelineno-36-51"></a><span class="w">                 </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">11</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">FEAT_ID</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_feature_id  is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-36-52" name="__codelineno-36-52" href="#__codelineno-36-52"></a><span class="w">                 </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">12</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FEAT_VER</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_feature_rev    is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-36-53" name="__codelineno-36-53" href="#__codelineno-36-53"></a><span class="w">                 </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NEXT_DFH_OFFSET</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_dfh_ofst is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-36-54" name="__codelineno-36-54" href="#__codelineno-36-54"></a><span class="w">                 </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">40</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">END_OF_LIST</span><span class="w"> </span><span class="p">;</span><span class="w">        </span><span class="c1">//dfh_end_of_list</span>
<a id="__codelineno-36-55" name="__codelineno-36-55" href="#__codelineno-36-55"></a><span class="w">                 </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">59</span><span class="o">:</span><span class="mh">40</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">20&#39;h00000</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_rsvd1     is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-36-56" name="__codelineno-36-56" href="#__codelineno-36-56"></a><span class="w">                 </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">60</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">4&#39;h3</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_feat_type  is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-36-57" name="__codelineno-36-57" href="#__codelineno-36-57"></a><span class="w">         </span><span class="k">end</span>
<a id="__codelineno-36-58" name="__codelineno-36-58" href="#__codelineno-36-58"></a><span class="w">         </span><span class="mh">6&#39;h30</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-36-59" name="__codelineno-36-59" href="#__codelineno-36-59"></a><span class="w">                 </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">scratch_reg</span><span class="p">;</span><span class="w"> </span>
<a id="__codelineno-36-60" name="__codelineno-36-60" href="#__codelineno-36-60"></a><span class="w">         </span><span class="k">end</span>
<a id="__codelineno-36-61" name="__codelineno-36-61" href="#__codelineno-36-61"></a><span class="w">         </span><span class="mh">6&#39;h38</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-36-62" name="__codelineno-36-62" href="#__codelineno-36-62"></a><span class="w">                 </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h6626</span><span class="n">_0701_5000_0034</span><span class="p">;</span>
<a id="__codelineno-36-63" name="__codelineno-36-63" href="#__codelineno-36-63"></a><span class="w">         </span><span class="k">end</span>
<a id="__codelineno-36-64" name="__codelineno-36-64" href="#__codelineno-36-64"></a><span class="w">         </span><span class="k">default</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-36-65" name="__codelineno-36-65" href="#__codelineno-36-65"></a><span class="w">                 </span><span class="n">rdata_comb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h0000000000000000</span><span class="p">;</span>
<a id="__codelineno-36-66" name="__codelineno-36-66" href="#__codelineno-36-66"></a><span class="w">         </span><span class="k">end</span>
<a id="__codelineno-36-67" name="__codelineno-36-67" href="#__codelineno-36-67"></a><span class="w">       </span><span class="k">endcase</span>
<a id="__codelineno-36-68" name="__codelineno-36-68" href="#__codelineno-36-68"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-36-69" name="__codelineno-36-69" href="#__codelineno-36-69"></a><span class="w"> </span><span class="k">end</span>
<a id="__codelineno-36-70" name="__codelineno-36-70" href="#__codelineno-36-70"></a>
<a id="__codelineno-36-71" name="__codelineno-36-71" href="#__codelineno-36-71"></a><span class="w"> </span><span class="k">endmodule</span>
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>src/pd_qsys/fabric/bpf.txt</p>
<ol>
<li>
<p>Add <code>hello_fim</code> as a slave in the BPF, and enable as a master for it.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a># NAME   TYPE      BASEADDRESS    ADDRESS_WIDTH    SLAVES
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>apf         mst     n/a             21             fme,pcie,hssi,qsfp0,qsfp1,emif,pmci,hello_fim
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>...
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>hello_fim   slv     0x16000         12             n/a
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Execute the helper script to re-generate the BPF design files. Alternatively, this can be done manually as described in Section 5.1.7.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/src/pd_qsys/fabric/
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>sh<span class="w"> </span>gen_fabrics.sh
</code></pre></div>
</li>
<li>
<p>After the shell script finishes, you can find the generated <code>bpf_hello_fim_slv.ip</code> file in <code>src/pd_qsys/fabric/ip/bpf/</code>. This is the ip variant of the axi4lite shim that bridges the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module with the BPF. The updated <code>bpf.qsys</code> file is located in <code>src/pd_qsys/fabric</code>. You can view the updated bpf file in Platform designer as follows.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/src/pd_qsys/fabric
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>qsys-edit<span class="w"> </span>bpf.qsys<span class="w"> </span>--quartus-project<span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>/syn/syn_top/ofs_top.qpf
</code></pre></div>
</li>
</ol>
<h5 id="517-modify-bpf-manually-in-platform-designer"><strong>5.1.7. Modify BPF manually in Platform Designer</strong><a class="headerlink" href="#517-modify-bpf-manually-in-platform-designer" title="Permanent link">&para;</a></h5>
<p>The following steps show how to manually add in Platform Designer the new axi4lite port for the HelloFIM module. These steps can be performed automatically using te <code>gen_fabrics.sh</code> helper script.</p>
<ol>
<li>
<p>Launch Platform Designer to edit <code>bpf.qsys</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/src/pd_qsys/fabric
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>qsys-edit<span class="w"> </span>bpf.qsys<span class="w"> </span>--quartus-project<span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>/syn/syn_top/ofs_top.qpf
</code></pre></div>
</li>
<li>
<p>Double click axi4lite_shim in the Project Window to add a new port.</p>
<p><a class="glightbox" href="../images/pd_0.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/pd_0.png" /></a></p>
</li>
<li>
<p>In the dialog box that appears, set 12 to AW as address width, set "bpf_hello_fim_slv" as HDL entry name, and click "Finish". </p>
</li>
</ol>
<p><a class="glightbox" href="../images/pd_1.PNG" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/pd_1.PNG" /></a></p>
<ol>
<li>
<p>Connect the new module as follows:</p>
<ol>
<li>
<p>Modify the export label to "<strong>bpf_hello_fim_slv</strong>".</p>
</li>
<li>
<p>Set the Start Address to "<strong>0x0001_6000</strong>". </p>
</li>
<li>
<p>Connect the input <strong>clock</strong> port to the <strong>out_clk</strong> port of the <strong>bpf_clock_bridge</strong> component.</p>
</li>
<li>
<p>Connect the input <strong>reset</strong> port to the <strong>out_reset</strong> port of the <strong>bpf_reset_bridge</strong> component.</p>
</li>
<li>
<p>Connect the input <strong>altera_axi4lite_slave</strong> port to the <strong>altera_axi4lite_master</strong> output port of both <strong>bpf_pmci_mst</strong> and <strong>bpf_apf_mst</strong> components.</p>
</li>
</ol>
</li>
<li>
<p>Click "Generate HDL...".</p>
</li>
<li>
<p>In the Generation dialog that appears Modify the simulation settings as below, and click "Generate".</p>
<p><a class="glightbox" href="../images/pd_3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/pd_3.png" /></a></p>
</li>
<li>
<p>After generation, close Platform Designer.</p>
</li>
</ol>
<h4 id="518-unit-level-simulation-of-hello-fim-design"><strong>5.1.8. Unit Level Simulation of Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Design</strong><a class="headerlink" href="#518-unit-level-simulation-of-hello-fim-design" title="Permanent link">&para;</a></h4>
<p>The following section describes the file modifications that need to be made to perform unit level simulations of the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design, followed by instructions for running the unit level simulations simulations.</p>
<h5 id="5181-unit-level-simulation-file-modification"><strong>5.1.8.1. Unit Level Simulation File Modification</strong><a class="headerlink" href="#5181-unit-level-simulation-file-modification" title="Permanent link">&para;</a></h5>
<p>Perform the following steps to modify the Unit Level simulation files to support the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design.</p>
<ol>
<li>
<p>$OFS_ROOTDIR/sim/unit_test/dfh_walker/test_csr_defs.sv</p>
<ol>
<li>
<p>Add a <code>HELLO_FIM_IDX</code> entry to the <code>t_dfh_idx</code> enumeration:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="w">   </span><span class="n">FME_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="w">   </span><span class="n">THERM_MNGM_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">   </span><span class="n">GLBL_PERF_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="w">   </span><span class="n">GLBL_ERROR_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="w">   </span><span class="n">QSFP0_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="w">   </span><span class="n">QSFP1_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a><span class="w">   </span><span class="n">HSSI_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a><span class="w">   </span><span class="n">EMIF_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a><span class="w">   </span><span class="n">HELLO_FIM_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a><span class="w">   </span><span class="n">PMCI_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a><span class="w">   </span><span class="n">ST2MM_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a><span class="w">   </span><span class="n">PG_PR_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a><span class="w">   </span><span class="n">PG_PORT_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a><span class="w">   </span><span class="n">PG_USER_CLK_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a><span class="w">   </span><span class="n">PG_REMOTE_STP_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-17" name="__codelineno-41-17" href="#__codelineno-41-17"></a><span class="w">   </span><span class="n">AFU_ERR_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-41-18" name="__codelineno-41-18" href="#__codelineno-41-18"></a><span class="w">   </span><span class="n">MAX_DFH_IDX</span>
<a id="__codelineno-41-19" name="__codelineno-41-19" href="#__codelineno-41-19"></a><span class="p">}</span><span class="w"> </span><span class="n">t_dfh_idx</span><span class="p">;</span>
</code></pre></div>
</li>
<li>
<p>Add an entry for <code>HELLO_FIM_IDX</code> into the <code>get_dfh_names()</code> function:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="k">function</span><span class="w"> </span><span class="k">automatic</span><span class="w"> </span><span class="n">dfh_name</span><span class="p">[</span><span class="n">MAX_DFH_IDX</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">get_dfh_names</span><span class="p">();</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="w">   </span><span class="n">dfh_name</span><span class="p">[</span><span class="n">MAX_DFH_IDX</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">dfh_names</span><span class="p">;</span>
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">FME_DFH_IDX</span><span class="p">]</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;FME_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">THERM_MNGM_DFH_IDX</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;THERM_MNGM_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">GLBL_PERF_DFH_IDX</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;GLBL_PERF_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">GLBL_ERROR_DFH_IDX</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;GLBL_ERROR_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">QSFP0_DFH_IDX</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;QSFP0_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">QSFP1_DFH_IDX</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;QSFP1_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">HSSI_DFH_IDX</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;HSSI_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">EMIF_DFH_IDX</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;EMIF_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">HELLO_FIM_DFH_IDX</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;HELLO_FIM_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">PMCI_DFH_IDX</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;PMCI_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">ST2MM_DFH_IDX</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ST2MM_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">PG_PR_DFH_IDX</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;PG_PR_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">PG_PORT_DFH_IDX</span><span class="p">]</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;PG_PORT_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">PG_USER_CLK_DFH_IDX</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;PG_USER_CLK_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">PG_REMOTE_STP_DFH_IDX</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;PG_REMOTE_STP_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a><span class="w">   </span><span class="n">dfh_names</span><span class="p">[</span><span class="n">AFU_ERR_DFH_IDX</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AFU_ERR_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-42-20" name="__codelineno-42-20" href="#__codelineno-42-20"></a>
<a id="__codelineno-42-21" name="__codelineno-42-21" href="#__codelineno-42-21"></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">dfh_names</span><span class="p">;</span>
<a id="__codelineno-42-22" name="__codelineno-42-22" href="#__codelineno-42-22"></a><span class="k">endfunction</span>
</code></pre></div>
</li>
<li>
<p>Modify the expected DFH value of the EMIF and from <code>64'h3_00000_06B000_1009</code> to <code>64'h3_00000_001000_1009</code> and add the expected value for <code>HELLO_FIM</code> as <code>64'h3_00000_06A000_0100</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="k">function</span><span class="w"> </span><span class="k">automatic</span><span class="w"> </span><span class="p">[</span><span class="n">MAX_DFH_IDX</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">][</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">get_dfh_values</span><span class="p">();</span>
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="w">   </span><span class="kt">logic</span><span class="p">[</span><span class="n">MAX_DFH_IDX</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">][</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">dfh_values</span><span class="p">;</span>
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>
<a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">FME_DFH_IDX</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h4000</span><span class="n">_0000_1000_0000</span><span class="p">;</span>
<a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">THERM_MNGM_DFH_IDX</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_002000_0001</span><span class="p">;</span>
<a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">GLBL_PERF_DFH_IDX</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_001000_0007</span><span class="p">;</span>
<a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">GLBL_ERROR_DFH_IDX</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_00e000_1004</span><span class="p">;</span>
<a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">QSFP0_DFH_IDX</span><span class="p">]</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_001000_0013</span><span class="p">;</span>
<a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">QSFP1_DFH_IDX</span><span class="p">]</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_001000_0013</span><span class="p">;</span>
<a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">HSSI_DFH_IDX</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_001000_100f</span><span class="p">;</span>
<a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">EMIF_DFH_IDX</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_001000_1009</span><span class="p">;</span>
<a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">HELLO_FIM_DFH_IDX</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_06A000_0100</span><span class="p">;</span>
<a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">PMCI_DFH_IDX</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_080000_1012</span><span class="p">;</span>
<a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">ST2MM_DFH_IDX</span><span class="p">]</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_030000_0014</span><span class="p">;</span>
<a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">PG_PR_DFH_IDX</span><span class="p">]</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_001000_1005</span><span class="p">;</span>
<a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">PG_PORT_DFH_IDX</span><span class="p">]</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h4</span><span class="n">_00000_001000_1001</span><span class="p">;</span>
<a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">PG_USER_CLK_DFH_IDX</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_001000_1014</span><span class="p">;</span>
<a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">PG_REMOTE_STP_DFH_IDX</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_00d000_2013</span><span class="p">;</span>
<a id="__codelineno-43-19" name="__codelineno-43-19" href="#__codelineno-43-19"></a><span class="w">   </span><span class="n">dfh_values</span><span class="p">[</span><span class="n">AFU_ERR_DFH_IDX</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00001_000000_2010</span><span class="p">;</span>
<a id="__codelineno-43-20" name="__codelineno-43-20" href="#__codelineno-43-20"></a>
<a id="__codelineno-43-21" name="__codelineno-43-21" href="#__codelineno-43-21"></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">dfh_values</span><span class="p">;</span>
<a id="__codelineno-43-22" name="__codelineno-43-22" href="#__codelineno-43-22"></a><span class="k">endfunction</span>
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Regenerate the simulation files</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ofs-common/scripts/common/sim
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>sh<span class="w"> </span>gen_sim_files.sh<span class="w"> </span>n6001
</code></pre></div>
</li>
</ol>
<h4 id="519-unit-level-test-of-the-hellofim"><strong>5.1.9. Unit Level test of the HelloFIM</strong><a class="headerlink" href="#519-unit-level-test-of-the-hellofim" title="Permanent link">&para;</a></h4>
<p>To quickly check whether the BPF can successfully communicate with the HelloFIM, execute the <strong>test_dfh_walking</strong> Unit Level Simulation. Go to <strong>sim/unit_test/dfh_walker</strong> and execute the <strong>run_sim.sh</strong> script as follows.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/sim/unit_test/dfh_walker
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>sh<span class="w"> </span>run_sim.sh<span class="w"> </span>
</code></pre></div>
<p>Check the output for the presence of the <code>HELLO_FiM</code> module at address <code>0x16000</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>********************************************
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>Running<span class="w"> </span>TEST<span class="o">(</span><span class="m">0</span><span class="o">)</span><span class="w"> </span>:<span class="w"> </span>test_dfh_walking
<a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>********************************************
<a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>
<a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>...
<a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>
<a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00016000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a>
<a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000010001009
<a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a>
<a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a>EMIF_DFH
<a id="__codelineno-46-14" name="__codelineno-46-14" href="#__codelineno-46-14"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x15000<span class="o">)</span>
<a id="__codelineno-46-15" name="__codelineno-46-15" href="#__codelineno-46-15"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000010001009<span class="o">)</span>
<a id="__codelineno-46-16" name="__codelineno-46-16" href="#__codelineno-46-16"></a>
<a id="__codelineno-46-17" name="__codelineno-46-17" href="#__codelineno-46-17"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00016000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-46-18" name="__codelineno-46-18" href="#__codelineno-46-18"></a>
<a id="__codelineno-46-19" name="__codelineno-46-19" href="#__codelineno-46-19"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-46-20" name="__codelineno-46-20" href="#__codelineno-46-20"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-46-21" name="__codelineno-46-21" href="#__codelineno-46-21"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x30000006a0000100
<a id="__codelineno-46-22" name="__codelineno-46-22" href="#__codelineno-46-22"></a>
<a id="__codelineno-46-23" name="__codelineno-46-23" href="#__codelineno-46-23"></a>HELLO_FIM_DFH
<a id="__codelineno-46-24" name="__codelineno-46-24" href="#__codelineno-46-24"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x16000<span class="o">)</span>
<a id="__codelineno-46-25" name="__codelineno-46-25" href="#__codelineno-46-25"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x30000006a0000100<span class="o">)</span>
<a id="__codelineno-46-26" name="__codelineno-46-26" href="#__codelineno-46-26"></a>
<a id="__codelineno-46-27" name="__codelineno-46-27" href="#__codelineno-46-27"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00080000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-46-28" name="__codelineno-46-28" href="#__codelineno-46-28"></a>
<a id="__codelineno-46-29" name="__codelineno-46-29" href="#__codelineno-46-29"></a><span class="w">   </span>**<span class="w"> </span>Sending<span class="w"> </span>TLP<span class="w"> </span>packets<span class="w"> </span>**
<a id="__codelineno-46-30" name="__codelineno-46-30" href="#__codelineno-46-30"></a><span class="w">   </span>**<span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>ack<span class="w"> </span>**
<a id="__codelineno-46-31" name="__codelineno-46-31" href="#__codelineno-46-31"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000800001012
<a id="__codelineno-46-32" name="__codelineno-46-32" href="#__codelineno-46-32"></a>
<a id="__codelineno-46-33" name="__codelineno-46-33" href="#__codelineno-46-33"></a>PMCI_DFH
<a id="__codelineno-46-34" name="__codelineno-46-34" href="#__codelineno-46-34"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x80000<span class="o">)</span>
<a id="__codelineno-46-35" name="__codelineno-46-35" href="#__codelineno-46-35"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000800001012<span class="o">)</span>
<a id="__codelineno-46-36" name="__codelineno-46-36" href="#__codelineno-46-36"></a>
<a id="__codelineno-46-37" name="__codelineno-46-37" href="#__codelineno-46-37"></a>...
<a id="__codelineno-46-38" name="__codelineno-46-38" href="#__codelineno-46-38"></a>
<a id="__codelineno-46-39" name="__codelineno-46-39" href="#__codelineno-46-39"></a>Test<span class="w"> </span>status:<span class="w"> </span>OK
<a id="__codelineno-46-40" name="__codelineno-46-40" href="#__codelineno-46-40"></a>
<a id="__codelineno-46-41" name="__codelineno-46-41" href="#__codelineno-46-41"></a>********************
<a id="__codelineno-46-42" name="__codelineno-46-42" href="#__codelineno-46-42"></a>Test<span class="w"> </span>summary
<a id="__codelineno-46-43" name="__codelineno-46-43" href="#__codelineno-46-43"></a>********************
<a id="__codelineno-46-44" name="__codelineno-46-44" href="#__codelineno-46-44"></a><span class="w">   </span>test_dfh_walking<span class="w"> </span><span class="o">(</span><span class="nv">id</span><span class="o">=</span><span class="m">0</span><span class="o">)</span><span class="w"> </span>-<span class="w"> </span>pass
<a id="__codelineno-46-45" name="__codelineno-46-45" href="#__codelineno-46-45"></a>Test<span class="w"> </span>passed!
<a id="__codelineno-46-46" name="__codelineno-46-46" href="#__codelineno-46-46"></a>Assertion<span class="w"> </span>count:<span class="w"> </span><span class="m">0</span>
</code></pre></div>
<h4 id="5110-uvm-verfication-of-the-hellofim"><strong>5.1.10. <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> Verfication of the HelloFIM</strong><a class="headerlink" href="#5110-uvm-verfication-of-the-hellofim" title="Permanent link">&para;</a></h4>
<p>Perform the following steps to modify the <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> simulation files to support the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design.</p>
<ol>
<li>
<p>$OFS_ROOTDIR/verification/tests/sequences/dfh_walking_seq.svh</p>
<ol>
<li>
<p>Modify the <code>dfh_offset_array</code> to insert the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="n">dfh_offset_array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="p">[</span><span class="mh">16</span><span class="p">];</span>
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tb_cfg0</span><span class="p">.</span><span class="n">PF0_BAR0</span><span class="p">;</span><span class="w">                    </span><span class="c1">// FME_DFH                0x8000_0000</span>
<a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">   </span><span class="c1">// THERM_MNGM_DFH         0x8000_1000</span>
<a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_2000</span><span class="p">;</span><span class="w">   </span><span class="c1">// GLBL_PERF_DFH          0x8000_3000</span>
<a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">   </span><span class="c1">// GLBL_ERROR_DFH         0x8000_4000</span>
<a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_E000</span><span class="p">;</span><span class="w">   </span><span class="c1">// QSFP0_DFH              0x8001_2000</span>
<a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">   </span><span class="c1">// QSFP1_DFH              0x8001_3000</span>
<a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">5</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">   </span><span class="c1">// HSSI_DFH               0x8001_4000</span>
<a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">7</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">6</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">   </span><span class="c1">// EMIF_DFH               0x8001_5000</span>
<a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">7</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">   </span><span class="c1">// HELLO_FIM_DFH          0x8001_6000</span>
<a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">9</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">8</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h6</span><span class="n">_a000</span><span class="p">;</span><span class="w">   </span><span class="c1">// PMCI_DFH               0x8008_0000</span>
<a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">9</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h8</span><span class="n">_0000</span><span class="p">;</span><span class="w">  </span><span class="c1">// ST2MM_DFH              0x8010_0000</span>
<a id="__codelineno-47-13" name="__codelineno-47-13" href="#__codelineno-47-13"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">11</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">10</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_0000</span><span class="p">;</span><span class="w">  </span><span class="c1">// PG_PR_DFH_IDX          0x8013_0000</span>
<a id="__codelineno-47-14" name="__codelineno-47-14" href="#__codelineno-47-14"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">12</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">11</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">  </span><span class="c1">// PG_PORT_DFH_IDX        0x8013_1000</span>
<a id="__codelineno-47-15" name="__codelineno-47-15" href="#__codelineno-47-15"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">13</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">12</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">  </span><span class="c1">// PG_USER_CLK_DFH_IDX    0x8013_2000</span>
<a id="__codelineno-47-16" name="__codelineno-47-16" href="#__codelineno-47-16"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">14</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">13</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_1000</span><span class="p">;</span><span class="w">  </span><span class="c1">// PG_REMOTE_STP_DFH_IDX  0x8013_3000</span>
<a id="__codelineno-47-17" name="__codelineno-47-17" href="#__codelineno-47-17"></a><span class="n">dfh_offset_array</span><span class="p">[</span><span class="w"> </span><span class="mh">15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dfh_offset_array</span><span class="p">[</span><span class="mh">14</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="n">_D000</span><span class="p">;</span><span class="w">  </span><span class="c1">// PG_AFU_ERR_DFH_IDX     0x8014_0000</span>
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>$OFS_ROOTDIR/verification/tests/sequences/mmio_seq.svh</p>
<ol>
<li>
<p>Add test code related to the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. This code will verify the scratchpad register at 0x16030 and read only the register at 0x16038.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="c1">// HELLO_FIM_Scratchpad 64 bit access</span>
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="no">`uvm_info</span><span class="p">(</span><span class="n">get_name</span><span class="p">(),</span><span class="w"> </span><span class="n">$psprintf</span><span class="p">(</span><span class="s">&quot;////Accessing PF0 HELLO_FIM_Scratchpad Register %0h+&#39;h16030////&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">tb_cfg0</span><span class="p">.</span><span class="n">PF0_BAR0</span><span class="p">),</span><span class="w"> </span><span class="n">UVM_LOW</span><span class="p">)</span>
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>
<a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a><span class="n">assert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">randomize</span><span class="p">(</span><span class="n">wdata</span><span class="p">));</span>
<a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tb_cfg0</span><span class="p">.</span><span class="n">PF0_BAR0</span><span class="o">+</span><span class="mh">&#39;h1</span><span class="n">_6000</span><span class="o">+</span><span class="mh">&#39;h30</span><span class="p">;</span>
<a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>
<a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a><span class="n">mmio_write64</span><span class="p">(.</span><span class="n">addr_</span><span class="p">(</span><span class="n">addr</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">data_</span><span class="p">(</span><span class="n">wdata</span><span class="p">));</span>
<a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a><span class="n">mmio_read64</span><span class="w"> </span><span class="p">(.</span><span class="n">addr_</span><span class="p">(</span><span class="n">addr</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">data_</span><span class="p">(</span><span class="n">rdata</span><span class="p">));</span>
<a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a>
<a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a><span class="k">if</span><span class="p">(</span><span class="n">wdata</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="n">rdata</span><span class="p">)</span>
<a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a><span class="w">    </span><span class="no">`uvm_error</span><span class="p">(</span><span class="n">get_name</span><span class="p">(),</span><span class="w"> </span><span class="n">$psprintf</span><span class="p">(</span><span class="s">&quot;Data mismatch 64! Addr = %0h, Exp = %0h, Act = %0h&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="n">wdata</span><span class="p">,</span><span class="w"> </span><span class="n">rdata</span><span class="p">))</span>
<a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a><span class="k">else</span>
<a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a><span class="w">    </span><span class="no">`uvm_info</span><span class="p">(</span><span class="n">get_name</span><span class="p">(),</span><span class="w"> </span><span class="n">$psprintf</span><span class="p">(</span><span class="s">&quot;Data match 64! addr = %0h, data = %0h&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="n">rdata</span><span class="p">),</span><span class="w"> </span><span class="n">UVM_LOW</span><span class="p">)</span>
<a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a>
<a id="__codelineno-48-15" name="__codelineno-48-15" href="#__codelineno-48-15"></a><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tb_cfg0</span><span class="p">.</span><span class="n">PF0_BAR0</span><span class="o">+</span><span class="mh">&#39;h1</span><span class="n">_6000</span><span class="o">+</span><span class="mh">&#39;h38</span><span class="p">;</span>
<a id="__codelineno-48-16" name="__codelineno-48-16" href="#__codelineno-48-16"></a><span class="n">wdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h6626</span><span class="n">_0701_5000_0034</span><span class="p">;</span>
<a id="__codelineno-48-17" name="__codelineno-48-17" href="#__codelineno-48-17"></a><span class="n">mmio_read64</span><span class="w"> </span><span class="p">(.</span><span class="n">addr_</span><span class="p">(</span><span class="n">addr</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">data_</span><span class="p">(</span><span class="n">rdata</span><span class="p">));</span>
<a id="__codelineno-48-18" name="__codelineno-48-18" href="#__codelineno-48-18"></a><span class="k">if</span><span class="p">(</span><span class="n">wdata</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="n">rdata</span><span class="p">)</span>
<a id="__codelineno-48-19" name="__codelineno-48-19" href="#__codelineno-48-19"></a><span class="w">    </span><span class="no">`uvm_error</span><span class="p">(</span><span class="n">get_name</span><span class="p">(),</span><span class="w"> </span><span class="n">$psprintf</span><span class="p">(</span><span class="s">&quot;Data mismatch 64! Addr = %0h, Exp = %0h, Act = %0h&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="n">wdata</span><span class="p">,</span><span class="w"> </span><span class="n">rdata</span><span class="p">))</span>
<a id="__codelineno-48-20" name="__codelineno-48-20" href="#__codelineno-48-20"></a><span class="k">else</span>
<a id="__codelineno-48-21" name="__codelineno-48-21" href="#__codelineno-48-21"></a><span class="w">    </span><span class="no">`uvm_info</span><span class="p">(</span><span class="n">get_name</span><span class="p">(),</span><span class="w"> </span><span class="n">$psprintf</span><span class="p">(</span><span class="s">&quot;Data match 64! addr = %0h, data = %0h&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="n">rdata</span><span class="p">),</span><span class="w"> </span><span class="n">UVM_LOW</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Note: uvm_info and uvm_error statements will put a message into log file.</p>
</blockquote>
</li>
</ol>
</li>
<li>
<p>$OFS_ROOTDIR/verification/scripts/Makefile_VCS.mk</p>
<ol>
<li>
<p>Add <code>INCLUDE_HELLO_FIM</code> define option to enable Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> on <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="nv">VLOG_OPT</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span>+define+INCLUDE_HELLO_FIM
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Re-generate the <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> files</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$VERDIR</span>/scripts
</code></pre></div>
<ol>
<li>
<p>Clean the output of previous builds</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>clean
</code></pre></div>
</li>
<li>
<p>Compile the IP files</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>cmplib_adp
</code></pre></div>
</li>
<li>
<p>Build the RTL and Test Benches</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>build_adp<span class="w"> </span><span class="nv">DUMP</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>
</code></pre></div>
</li>
</ol>
</li>
</ol>
<h5 id="5192-run-uvm-dfh-walker-simulation"><strong>5.1.9.2. Run <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> DFH Walker Simulation</strong><a class="headerlink" href="#5192-run-uvm-dfh-walker-simulation" title="Permanent link">&para;</a></h5>
<p>Perform the following steps to run the <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> DFH Walker Simulation.</p>
<ol>
<li>
<p>Run the DFH Walker simulation</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$VERDIR</span>/scripts
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>run<span class="w"> </span><span class="nv">TESTNAME</span><span class="o">=</span>dfh_walking_test<span class="w"> </span><span class="nv">DUMP</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
</li>
<li>
<p>The output logs are stored in the $VERDIR/sim/dfh_walking_test directory. The main files to note are described in Table 5-3:</p>
<p><strong>Table 5-3</strong> <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> Output Logs</p>
<table>
<thead>
<tr>
<th>File Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>runsim.log</td>
<td>A log file of <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr></td>
</tr>
<tr>
<td>trans.log</td>
<td>A log file of transactions on PCIe bus</td>
</tr>
<tr>
<td>inter.vpd</td>
<td>A waveform for VCS</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Run the following command to quickly verify- that the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module was successfully accessed. In the example below, the message <code>DFH offset Match! Exp = 80016000 Act = 80016000</code> shows that the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module was successfully accessed.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$VERDIR</span>/sim/dfh_walking_test
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>cat<span class="w"> </span>runsim.log<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;DFH offset&quot;</span>
</code></pre></div>
<p>Expected output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">111950000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80000000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80000000</span>
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">112586000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80001000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80001000</span>
<a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">113222000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80003000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80003000</span>
<a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">113858000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80004000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80004000</span>
<a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">114494000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80012000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80012000</span>
<a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">115147000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80013000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80013000</span>
<a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">115801000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80014000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80014000</span>
<a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">116628000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80015000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80015000</span>
<a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">117283000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80016000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80016000</span>
<a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">117928000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80080000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80080000</span>
<a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">118594000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80100000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80100000</span>
<a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">119248000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80130000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80130000</span>
<a id="__codelineno-56-13" name="__codelineno-56-13" href="#__codelineno-56-13"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">119854000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80131000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80131000</span>
<a id="__codelineno-56-14" name="__codelineno-56-14" href="#__codelineno-56-14"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">120460000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80132000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80132000</span>
<a id="__codelineno-56-15" name="__codelineno-56-15" href="#__codelineno-56-15"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">121065000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80133000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80133000</span>
<a id="__codelineno-56-16" name="__codelineno-56-16" href="#__codelineno-56-16"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/dfh_walking_seq.svh<span class="o">(</span><span class="m">73</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">121672000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>DFH<span class="w"> </span>offset<span class="w"> </span>Match!<span class="w"> </span><span class="nv">Exp</span><span class="o">=</span><span class="w"> </span><span class="m">80140000</span><span class="w"> </span><span class="nv">Act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80140000</span>
</code></pre></div>
</li>
</ol>
<h5 id="5193-run-uvm-mmio-simulation"><strong>5.1.9.3. Run <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> Simulation</strong><a class="headerlink" href="#5193-run-uvm-mmio-simulation" title="Permanent link">&para;</a></h5>
<p>Perform the following steps to run the <abbr title="Universal Verification Methodology, A modular, reusable, and scalable testbench structure via an API framework.">UVM</abbr> <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> Simulation.</p>
<ol>
<li>
<p>Run the <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> test</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$VERDIR</span>/scripts
<a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>run<span class="w"> </span><span class="nv">TESTNAME</span><span class="o">=</span>mmio_test<span class="w"> </span><span class="nv">DUMP</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
</li>
<li>
<p>Run the following commands to show the result of the scratchpad register and Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> ID register. You can see the "Data match" message indicating that the registers are successfuly verified.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$VERDIR</span>/sim/mmio_test
<a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>cat<span class="w"> </span>runsim.log<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;Data&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">1603</span>
</code></pre></div>
<p>Expected output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/mmio_seq.svh<span class="o">(</span><span class="m">68</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">115466000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>Data<span class="w"> </span>match<span class="w"> </span><span class="m">64</span>!<span class="w"> </span><span class="nv">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80016030</span>,<span class="w"> </span><span class="nv">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>880312f9558c00e1
<a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>UVM_INFO<span class="w"> </span>/home/ofs-n6001/verification/tests/sequences/mmio_seq.svh<span class="o">(</span><span class="m">76</span><span class="o">)</span><span class="w"> </span>@<span class="w"> </span><span class="m">116112000000</span>:<span class="w"> </span>uvm_test_top.tb_env0.v_sequencer@@m_seq<span class="w"> </span><span class="o">[</span>m_seq<span class="o">]</span><span class="w"> </span>Data<span class="w"> </span>match<span class="w"> </span><span class="m">64</span>!<span class="w"> </span><span class="nv">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80016038</span>,<span class="w"> </span><span class="nv">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6626070150000034</span>
</code></pre></div>
</li>
</ol>
<h4 id="5110-compile-the-intel-fpga-smartnic-n6001-pl-design-with-hello-fim"><strong>5.1.10 Compile the Intel® FPGA SmartNIC N6001-PL Design with Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong><a class="headerlink" href="#5110-compile-the-intel-fpga-smartnic-n6001-pl-design-with-hello-fim" title="Permanent link">&para;</a></h4>
<p>Perform the following to compile the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design.</p>
<ol>
<li>
<p>Ensure the pre-requisites described in Section 5.1.5 are satisfied.</p>
</li>
<li>
<p>Ensure that Quartus Prime Pro Version 23.1 is in your $PATH</p>
</li>
<li>
<p>Compile the design</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="nv">$OFS_ROOTDIR</span>/ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>n6001<span class="w"> </span>work_hello_fim
</code></pre></div>
</li>
<li>
<p>Once compilation is complete, the output files can be found in the <code>$OFS_ROOTDIR/work_hello_fim/syn/syn_top/output_files</code> directory.</p>
</li>
</ol>
<h4 id="5111-program-the-intel-fpga-smartnic-n6001-pl-with-the-hello_fim"><strong>5.1.11 Program the Intel® FPGA SmartNIC N6001-PL with the hello_fim</strong><a class="headerlink" href="#5111-program-the-intel-fpga-smartnic-n6001-pl-with-the-hello_fim" title="Permanent link">&para;</a></h4>
<p>Program the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> to Intel® FPGA SmartNIC N6001-PL card.</p>
<p>Run <code>fpgainfo</code> command to confirm current design. The PCIe <code>s:b:d.f</code> and Bitstream Id are 0000:B1:00.0 and 360571655976424377, respectively.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>fpgainfo<span class="w"> </span>fme
<a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>Intel<span class="w"> </span>Acceleration<span class="w"> </span>Development<span class="w"> </span>Platform<span class="w"> </span>n6001
<a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller<span class="w"> </span>NIOS<span class="w"> </span>FW<span class="w"> </span>version:<span class="w"> </span><span class="m">3</span>.11.0
<a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller<span class="w"> </span>Build<span class="w"> </span>version:<span class="w"> </span><span class="m">3</span>.11.0
<a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a>//******<span class="w"> </span>FME<span class="w"> </span>******//
<a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xED00000
<a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:B1:00.0
<a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-61-11" name="__codelineno-61-11" href="#__codelineno-61-11"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x1771
<a id="__codelineno-61-12" name="__codelineno-61-12" href="#__codelineno-61-12"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x00
<a id="__codelineno-61-13" name="__codelineno-61-13" href="#__codelineno-61-13"></a>Ports<span class="w"> </span>Num<span class="w">                        </span>:<span class="w"> </span><span class="m">01</span>
<a id="__codelineno-61-14" name="__codelineno-61-14" href="#__codelineno-61-14"></a>Bitstream<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span><span class="m">360571655976424377</span>
<a id="__codelineno-61-15" name="__codelineno-61-15" href="#__codelineno-61-15"></a>Bitstream<span class="w"> </span>Version<span class="w">                </span>:<span class="w"> </span>
<a id="__codelineno-61-16" name="__codelineno-61-16" href="#__codelineno-61-16"></a>Pr<span class="w"> </span>Interface<span class="w"> </span>Id<span class="w">                  </span>:<span class="w"> </span>4514ee67-ca01-5def-9fa5-a1ef30d0c76c
<a id="__codelineno-61-17" name="__codelineno-61-17" href="#__codelineno-61-17"></a>Boot<span class="w"> </span>Page<span class="w">                        </span>:<span class="w"> </span>user1
<a id="__codelineno-61-18" name="__codelineno-61-18" href="#__codelineno-61-18"></a>Factory<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">               </span>:<span class="w"> </span>
<a id="__codelineno-61-19" name="__codelineno-61-19" href="#__codelineno-61-19"></a>User1<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">                 </span>:<span class="w"> </span>
<a id="__codelineno-61-20" name="__codelineno-61-20" href="#__codelineno-61-20"></a>User2<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">                 </span>:<span class="w"> </span>
</code></pre></div>
<p>Move to <code>$OFS_ROOTDIR/work_hello_fim/syn/syn_top/output_files</code>. You can see <code>ofs_top_page1_unsigned_user1.bin</code> file to run 'ls'.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>$<span class="w"> </span>ls
<a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>hps_bootloader_handoff.bin<span class="w">        </span>ofs_top.fit.rpt<span class="w">                          </span>ofs_top_page2_unsigned_user2.bin<span class="w">  </span>
<a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>mfg_ofs_fim_reversed.bin<span class="w">          </span>ofs_top.fit.summary<span class="w">                      </span>ofs_top_page2_user2.bin<span class="w">           </span>
<a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a>ofs_pr_afu.done<span class="w">                   </span>ofs_top.flow.rpt<span class="w">                         </span>ofs_top.pin<span class="w">                       </span>
<a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a>ofs_pr_afu.drc.partitioned.rpt<span class="w">    </span>ofs_top.green_region.pmsf<span class="w">                </span>ofs_top.sld<span class="w">                       </span>
<a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a>ofs_pr_afu.syn.rpt<span class="w">                </span>ofs_top.green_region.rbf<span class="w">                 </span>ofs_top.sof<span class="w">                       </span>
<a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a>ofs_top.asm.rpt<span class="w">                   </span>ofs_top_hps.bin<span class="w">                          </span>ofs_top.sta.rpt
<a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a>ofs_top.done<span class="w">                      </span>ofs_top_hps.hexout<span class="w">                       </span>ofs_top.sta.summary
<a id="__codelineno-62-9" name="__codelineno-62-9" href="#__codelineno-62-9"></a>ofs_top.drc.partitioned.rpt<span class="w">       </span>ofs_top_hps.pof<span class="w">                          </span>ofs_top.static.msf<span class="w">     </span>
<a id="__codelineno-62-10" name="__codelineno-62-10" href="#__codelineno-62-10"></a>ofs_top.drc.synthesized.rpt<span class="w">       </span>ofs_top_hps_pof.map<span class="w">                      </span>ofs_top.syn.rpt
<a id="__codelineno-62-11" name="__codelineno-62-11" href="#__codelineno-62-11"></a>ofs_top.fit.finalize.rpt<span class="w">          </span>ofs_top_hps.sof<span class="w">                          </span>ofs_top.syn.summary
<a id="__codelineno-62-12" name="__codelineno-62-12" href="#__codelineno-62-12"></a>ofs_top.fit.place.rpt<span class="w">             </span>ofs_top_page0_factory.bin<span class="w">                </span>ofs_top.tq.drc.signoff.rpt
<a id="__codelineno-62-13" name="__codelineno-62-13" href="#__codelineno-62-13"></a>ofs_top.fit.plan.rpt<span class="w">              </span>ofs_top_page0_unsigned_factory.bin<span class="w">       </span>timing_report
<a id="__codelineno-62-14" name="__codelineno-62-14" href="#__codelineno-62-14"></a>ofs_top.fit.retime.rpt<span class="w">            </span>ofs_top_page1_unsigned_user1.bin<span class="w">  </span>
<a id="__codelineno-62-15" name="__codelineno-62-15" href="#__codelineno-62-15"></a>ofs_top.fit.route.rpt<span class="w">             </span>ofs_top_page1_user1.bin<span class="w">           </span>
</code></pre></div>
<p>Run the <code>fpgasupdate</code> command to program the HelloFim to the Intel® FPGA SmartNIC N6001-PL.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>$<span class="w">  </span>sudo<span class="w"> </span>fpgasupdate<span class="w"> </span>ofs_top_page1_unsigned_user1.bin<span class="w"> </span><span class="m">0000</span>:b1:00.0
</code></pre></div>
<p>Run the <code>rsu</code> command to re-configure FPGA on the Intel® FPGA SmartNIC N6001-PL.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>rsu<span class="w"> </span>bmcimg<span class="w"> </span>--page<span class="o">=</span>user1<span class="w"> </span><span class="m">0000</span>:b1:00.0
</code></pre></div>
<p>Run the <code>fpgainfo</code> command again to verify the HelloFIM Bitstream Id.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>fpgainfo<span class="w"> </span>fme
<a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>
<a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a>Open<span class="w"> </span>FPGA<span class="w"> </span>Stack<span class="w"> </span>Platform
<a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller<span class="w"> </span>NIOS<span class="w"> </span>FW<span class="w"> </span>version:<span class="w"> </span><span class="m">3</span>.11.0
<a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller<span class="w"> </span>Build<span class="w"> </span>version:<span class="w"> </span><span class="m">3</span>.11.0
<a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a>PBA:<span class="w"> </span>B#FB2CG1@AGF14-A0P2
<a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a>MMID:<span class="w"> </span><span class="m">217000</span>
<a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a>SN:<span class="w"> </span>Q171211700050
<a id="__codelineno-65-9" name="__codelineno-65-9" href="#__codelineno-65-9"></a>//******<span class="w"> </span>FME<span class="w"> </span>******//
<a id="__codelineno-65-10" name="__codelineno-65-10" href="#__codelineno-65-10"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xED00000
<a id="__codelineno-65-11" name="__codelineno-65-11" href="#__codelineno-65-11"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:b1:00.0
<a id="__codelineno-65-12" name="__codelineno-65-12" href="#__codelineno-65-12"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-65-13" name="__codelineno-65-13" href="#__codelineno-65-13"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-65-14" name="__codelineno-65-14" href="#__codelineno-65-14"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-65-15" name="__codelineno-65-15" href="#__codelineno-65-15"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x0000
<a id="__codelineno-65-16" name="__codelineno-65-16" href="#__codelineno-65-16"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x00
<a id="__codelineno-65-17" name="__codelineno-65-17" href="#__codelineno-65-17"></a>Ports<span class="w"> </span>Num<span class="w">                        </span>:<span class="w"> </span><span class="m">01</span>
<a id="__codelineno-65-18" name="__codelineno-65-18" href="#__codelineno-65-18"></a>Bitstream<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span><span class="m">360571655976424377</span>
<a id="__codelineno-65-19" name="__codelineno-65-19" href="#__codelineno-65-19"></a>Bitstream<span class="w"> </span>Version<span class="w">                </span>:<span class="w"> </span>
<a id="__codelineno-65-20" name="__codelineno-65-20" href="#__codelineno-65-20"></a>Pr<span class="w"> </span>Interface<span class="w"> </span>Id<span class="w">                  </span>:<span class="w"> </span>4514ee67-ca01-5def-9fa5-a1ef30d0c76c
<a id="__codelineno-65-21" name="__codelineno-65-21" href="#__codelineno-65-21"></a>Boot<span class="w"> </span>Page<span class="w">                        </span>:<span class="w"> </span>user1
<a id="__codelineno-65-22" name="__codelineno-65-22" href="#__codelineno-65-22"></a>Factory<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">               </span>:<span class="w"> </span>
<a id="__codelineno-65-23" name="__codelineno-65-23" href="#__codelineno-65-23"></a>User1<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">                 </span>:<span class="w"> </span>
<a id="__codelineno-65-24" name="__codelineno-65-24" href="#__codelineno-65-24"></a>User2<span class="w"> </span>Image<span class="w"> </span>Info<span class="w">                 </span>:<span class="w"> </span>
</code></pre></div>
<h4 id="5112-verify-the-hello-fim-on-the-intel-fpga-smartnic-n6001-pl-using-opaeio-tool"><strong>5.1.12 Verify the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> on the Intel® FPGA SmartNIC N6001-PL Using opae.io Tool</strong><a class="headerlink" href="#5112-verify-the-hello-fim-on-the-intel-fpga-smartnic-n6001-pl-using-opaeio-tool" title="Permanent link">&para;</a></h4>
<p>This section will describe how to access Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> register via opae.io tool.</p>
<p>Run the following command to confirm driver software on 0000:b1:00.0.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>$<span class="w"> </span>opae.io<span class="w"> </span>ls
<a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a><span class="o">[</span><span class="m">0000</span>:b1:00.0<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>n6001<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
<a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a><span class="o">[</span><span class="m">0000</span>:b1:00.1<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>n6001<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
<a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a><span class="o">[</span><span class="m">0000</span>:b1:00.4<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>n6001<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
<a id="__codelineno-66-6" name="__codelineno-66-6" href="#__codelineno-66-6"></a><span class="o">[</span><span class="m">0000</span>:b1:00.2<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>n6001<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
</code></pre></div>
<p>Run the following command to initialize opae.io tool.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>opae.io<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span><span class="nv">$USER</span>
<a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a>Unbinding<span class="w"> </span><span class="o">(</span>0x8086,0xbcce<span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>from<span class="w"> </span>dfl-pci
<a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a>Binding<span class="w"> </span><span class="o">(</span>0x8086,0xbcce<span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>to<span class="w"> </span>vfio-pci
<a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a>iommu<span class="w"> </span>group<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">(</span>0x8086,0xbcce<span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>is<span class="w"> </span><span class="m">186</span>
<a id="__codelineno-67-5" name="__codelineno-67-5" href="#__codelineno-67-5"></a>Assigning<span class="w"> </span>/dev/vfio/186<span class="w"> </span>to<span class="w"> </span><span class="nv">$USER</span>
<a id="__codelineno-67-6" name="__codelineno-67-6" href="#__codelineno-67-6"></a>Changing<span class="w"> </span>permissions<span class="w"> </span><span class="k">for</span><span class="w"> </span>/dev/vfio/186<span class="w"> </span>to<span class="w"> </span>rw-rw----
</code></pre></div>
<p>Run the following command again to confirm driver software on 0000:b1:00.0.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a>$<span class="w"> </span>opae.io<span class="w"> </span>ls
<a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a><span class="o">[</span><span class="m">0000</span>:b1:00.0<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>n6001<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>vfio-pci<span class="o">)</span>
<a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a><span class="o">[</span><span class="m">0000</span>:b1:00.1<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>n6001<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
<a id="__codelineno-68-5" name="__codelineno-68-5" href="#__codelineno-68-5"></a><span class="o">[</span><span class="m">0000</span>:b1:00.4<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>n6001<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
<a id="__codelineno-68-6" name="__codelineno-68-6" href="#__codelineno-68-6"></a><span class="o">[</span><span class="m">0000</span>:b1:00.2<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>n6001<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
</code></pre></div>
<p>Run the following command to walk through DFH register. You can see "offset: 0x16000" message.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a>$<span class="w"> </span>opae.io<span class="w"> </span>walk<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0
<a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a>
<a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a>fset:<span class="w"> </span>0x0000,<span class="w"> </span>value:<span class="w"> </span>0x4000000010000000
<a id="__codelineno-69-4" name="__codelineno-69-4" href="#__codelineno-69-4"></a><span class="w">   </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x4
<a id="__codelineno-69-5" name="__codelineno-69-5" href="#__codelineno-69-5"></a>offset:<span class="w"> </span>0x1000,<span class="w"> </span>value:<span class="w"> </span>0x3000000020000001
<a id="__codelineno-69-6" name="__codelineno-69-6" href="#__codelineno-69-6"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x2000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-69-7" name="__codelineno-69-7" href="#__codelineno-69-7"></a>offset:<span class="w"> </span>0x3000,<span class="w"> </span>value:<span class="w"> </span>0x3000000010000007
<a id="__codelineno-69-8" name="__codelineno-69-8" href="#__codelineno-69-8"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x7,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-69-9" name="__codelineno-69-9" href="#__codelineno-69-9"></a>offset:<span class="w"> </span>0x4000,<span class="w"> </span>value:<span class="w"> </span>0x30000000e0001004
<a id="__codelineno-69-10" name="__codelineno-69-10" href="#__codelineno-69-10"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x4,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0xe000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-69-11" name="__codelineno-69-11" href="#__codelineno-69-11"></a>offset:<span class="w"> </span>0x12000,<span class="w"> </span>value:<span class="w"> </span>0x3000000010000013
<a id="__codelineno-69-12" name="__codelineno-69-12" href="#__codelineno-69-12"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x13,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-69-13" name="__codelineno-69-13" href="#__codelineno-69-13"></a>offset:<span class="w"> </span>0x13000,<span class="w"> </span>value:<span class="w"> </span>0x3000000010000013
<a id="__codelineno-69-14" name="__codelineno-69-14" href="#__codelineno-69-14"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x13,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-69-15" name="__codelineno-69-15" href="#__codelineno-69-15"></a>offset:<span class="w"> </span>0x14000,<span class="w"> </span>value:<span class="w"> </span>0x3000000010002015
<a id="__codelineno-69-16" name="__codelineno-69-16" href="#__codelineno-69-16"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x15,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x2,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-69-17" name="__codelineno-69-17" href="#__codelineno-69-17"></a>offset:<span class="w"> </span>0x15000,<span class="w"> </span>value:<span class="w"> </span>0x3000000010001009
<a id="__codelineno-69-18" name="__codelineno-69-18" href="#__codelineno-69-18"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x9,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-69-19" name="__codelineno-69-19" href="#__codelineno-69-19"></a>offset:<span class="w"> </span>0x16000,<span class="w"> </span>value:<span class="w"> </span>0x30000006a0000100
<a id="__codelineno-69-20" name="__codelineno-69-20" href="#__codelineno-69-20"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x100,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x6a000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-69-21" name="__codelineno-69-21" href="#__codelineno-69-21"></a>offset:<span class="w"> </span>0x80000,<span class="w"> </span>value:<span class="w"> </span>0x3000000800002012
<a id="__codelineno-69-22" name="__codelineno-69-22" href="#__codelineno-69-22"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x12,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x2,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x80000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-69-23" name="__codelineno-69-23" href="#__codelineno-69-23"></a>offset:<span class="w"> </span>0x100000,<span class="w"> </span>value:<span class="w"> </span>0x3000000300000014
<a id="__codelineno-69-24" name="__codelineno-69-24" href="#__codelineno-69-24"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x14,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x30000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-69-25" name="__codelineno-69-25" href="#__codelineno-69-25"></a>offset:<span class="w"> </span>0x130000,<span class="w"> </span>value:<span class="w"> </span>0x3000000010001005
<a id="__codelineno-69-26" name="__codelineno-69-26" href="#__codelineno-69-26"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x5,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-69-27" name="__codelineno-69-27" href="#__codelineno-69-27"></a>offset:<span class="w"> </span>0x131000,<span class="w"> </span>value:<span class="w"> </span>0x4000000010001001
<a id="__codelineno-69-28" name="__codelineno-69-28" href="#__codelineno-69-28"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x4
<a id="__codelineno-69-29" name="__codelineno-69-29" href="#__codelineno-69-29"></a>offset:<span class="w"> </span>0x132000,<span class="w"> </span>value:<span class="w"> </span>0x3000000010001014
<a id="__codelineno-69-30" name="__codelineno-69-30" href="#__codelineno-69-30"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x14,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-69-31" name="__codelineno-69-31" href="#__codelineno-69-31"></a>offset:<span class="w"> </span>0x133000,<span class="w"> </span>value:<span class="w"> </span>0x30000000d0002013
<a id="__codelineno-69-32" name="__codelineno-69-32" href="#__codelineno-69-32"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x13,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x2,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0xd000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-69-33" name="__codelineno-69-33" href="#__codelineno-69-33"></a>offset:<span class="w"> </span>0x140000,<span class="w"> </span>value:<span class="w"> </span>0x3000010000002010
<a id="__codelineno-69-34" name="__codelineno-69-34" href="#__codelineno-69-34"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x10,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x2,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
</code></pre></div>
<p>Run the following commands to read all registers in Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x16000
<a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>0x30000000c0000100
<a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a>
<a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x16030
<a id="__codelineno-70-5" name="__codelineno-70-5" href="#__codelineno-70-5"></a>0x0
<a id="__codelineno-70-6" name="__codelineno-70-6" href="#__codelineno-70-6"></a>
<a id="__codelineno-70-7" name="__codelineno-70-7" href="#__codelineno-70-7"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x16038
<a id="__codelineno-70-8" name="__codelineno-70-8" href="#__codelineno-70-8"></a>0x6626070150000034
</code></pre></div>
<p>Run the following commands to verify the scratchpad register at 0x16030.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x16030<span class="w"> </span>0x123456789abcdef
<a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a>
<a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x16030
<a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a>0x123456789abcdef
<a id="__codelineno-71-5" name="__codelineno-71-5" href="#__codelineno-71-5"></a>
<a id="__codelineno-71-6" name="__codelineno-71-6" href="#__codelineno-71-6"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x16030<span class="w"> </span>0xfedcba9876543210
<a id="__codelineno-71-7" name="__codelineno-71-7" href="#__codelineno-71-7"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x16030
<a id="__codelineno-71-8" name="__codelineno-71-8" href="#__codelineno-71-8"></a>0xfedcba9876543210
<a id="__codelineno-71-9" name="__codelineno-71-9" href="#__codelineno-71-9"></a>
<a id="__codelineno-71-10" name="__codelineno-71-10" href="#__codelineno-71-10"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x16030<span class="w"> </span>0x0123456789abcdef
<a id="__codelineno-71-11" name="__codelineno-71-11" href="#__codelineno-71-11"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x16030
<a id="__codelineno-71-12" name="__codelineno-71-12" href="#__codelineno-71-12"></a>0x123456789abcdef
</code></pre></div>
<p>Run the following commands to release opae.io tool.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>opae.io<span class="w"> </span>release<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0
<a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a>Releasing<span class="w"> </span><span class="o">(</span>0x8086,0xbcce<span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>from<span class="w"> </span>vfio-pci
<a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a>Rebinding<span class="w"> </span><span class="o">(</span>0x8086,0xbcce<span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>to<span class="w"> </span>dfl-pci
</code></pre></div>
<p>Run the following command again to confirm driver software on 0000:b1:00.0.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>$<span class="w"> </span>opae.io<span class="w"> </span>ls
<a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a><span class="o">[</span><span class="m">0000</span>:b1:00.0<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>n6001<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
<a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a><span class="o">[</span><span class="m">0000</span>:b1:00.1<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>n6001<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
<a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a><span class="o">[</span><span class="m">0000</span>:b1:00.4<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>n6001<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
<a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a><span class="o">[</span><span class="m">0000</span>:b1:00.2<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>n6001<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
</code></pre></div>
<h3 id="52-debugging-the-fim-with-signal-tap"><strong>5.2. Debugging the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> with Signal Tap</strong><a class="headerlink" href="#52-debugging-the-fim-with-signal-tap" title="Permanent link">&para;</a></h3>
<p>For debugging issues within the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>, Signal Tap can be used to gain internal visibility into your design. This section describes the process of adding a Signal Tap instance to your Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design example described previously.</p>
<p>For more detailed information on Signal Tap please see:</p>
<ul>
<li>Understanding of Signal Tap fundamentals - please review <a href="https://www.intel.com/content/www/us/en/docs/programmable/683819/22-4/faq.html">Quartus Prime Pro Edition User Guide: Debug Tools</a> (RDC Document ID 683819).</li>
</ul>
<p>Signal Tap uses the Intel FPGA Download Cable II USB device to provide access. Please see [Intel FPGA Download Cable II] for more information and this device is widely available via distributors for purchase.</p>
<h4 id="521-adding-signal-tap-to-the-hello-fim-example"><strong>5.2.1. Adding Signal Tap to the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> example</strong><a class="headerlink" href="#521-adding-signal-tap-to-the-hello-fim-example" title="Permanent link">&para;</a></h4>
<p>The following steps guide you through the process of adding a Signal Tap instance to your design. The added Signal Tap instance provides hardware to capture the desired internal signals and connect the stored trace information via <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr>. Please be aware that the added Signal Tap hardware will consume FPGA resources and may require additional floorplanning steps to accommodate these resources. Some areas of the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> use logic lock regions and these regions may need to be re-sized. These steps assume the use of the n6001.</p>
<p>The steps below use the hello_fim example to add Signal Tap, however the general process can be used for any design.</p>
<ol>
<li>
<p>The design must have been compiled before adding Signal Tap. If using the previously built Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design, copy the work directory and rename it so that we have a work directory dedicated to the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Signal Tap design.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a>cp<span class="w"> </span>-r<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/work_hello_fim<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/work_hello_fim_with_stp
</code></pre></div>
</li>
<li>
<p>Open the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Signal Tap project in the Intel Quartus Prime Pro GUI. The Intel Quartus Prime Pro project is named ofs_top.qpf and is located in the work directory <strong>$OFS_ROOTDIR/work_hello_fim_with_stp/syn/syn_top/ofs_top.qpf</strong>.</p>
</li>
<li>
<p>Once the project is loaded, select <strong>Tools</strong> &gt; <strong>Signal Tap Logic Analyzer</strong> to open the Signal Tap GUI.</p>
<p><a class="glightbox" href="../images/signal_tap_log_analyizer_menu.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/signal_tap_log_analyizer_menu.png" /></a></p>
</li>
<li>
<p>Accept the "Default" selection and click "Create".</p>
<p><a class="glightbox" href="../images/new_stp_file_from_template.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/new_stp_file_from_template.png" /></a></p>
</li>
<li>
<p>This brings up the Signal Tap Logic Analyzer window as shown below</p>
<p><a class="glightbox" href="../images/signal_tap_log_analyizer_dialog.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/signal_tap_log_analyizer_dialog.png" /></a></p>
</li>
<li>
<p>Set up the clock for the STP instance. This example instruments the <strong>hello_fim_top</strong> module previously intetegrated into the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. If unfamiliar with code, it is helpful to use the Quartus Project Navigator to find the block of interest and open the design instance for review. For example, see the image below using Project Navigator to open the <strong>top</strong> module where <strong>hello_fim_top_inst</strong> is instantiated.</p>
<p><a class="glightbox" href="../images/hello_fim_top.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/hello_fim_top.png" /></a></p>
</li>
<li>
<p>Assign the clock for sampling the Signal Tap instrumented signals of interest. Note, that the clock selected should correspond to the signals you want to view for best trace fidelity. Different clocks can be used, however, there maybe issues with trace inaccuracy due to sampling time differences. In the middle right of the Signal Tap window, under <strong>Signal Configuration, Clock:</strong>, select <strong>"…"</strong> as shown below:</p>
<p><a class="glightbox" href="../images/stp_hello_fim_clk_search.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_hello_fim_clk_search.png" /></a></p>
</li>
<li>
<p>In the Node Finder tool that popped up, input <strong>"hello_fim_top_inst|clk"</strong> into the "Named:" textbox and click "Search". Select "clk" in the Matching Nodes list and click the "&gt;" button to select this clock as shown below. Click "OK" to close the Node Finder dialog.</p>
<p><a class="glightbox" href="../images/stp_node_finder_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_node_finder_hello_fim.png" /></a></p>
</li>
<li>
<p>Update the sample depth and other Signal Tap settings as needed for your debugging criteria.</p>
<p><a class="glightbox" href="../images/STP_Configs_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/STP_Configs_hello_fim.png" /></a></p>
</li>
<li>
<p>In the Signal Tap GUI add the nodes to be instrumented by double-clicking on the "Double-click to add nodes" legend.</p>
<p><a class="glightbox" href="../images/STP_Add_Nodes_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/STP_Add_Nodes_hello_fim.png" /></a></p>
</li>
<li>
<p>This brings up the Node Finder to add the signals to be traced. Select the signals that appear from the  search patterns <strong>hello_fim_top_inst|reset</strong> and <strong>hello_fim_top_inst|csr_lite_if*</strong>. Click Insert and close the Node Finder dialog.</p>
<p><a class="glightbox" href="../images/stp_traced_signals_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_traced_signals_hello_fim.png" /></a></p>
</li>
<li>
<p>To provide a unique name for your Signal Tap instance, select "auto signaltap_0", right-click, and select <strong>Rename Instance (F2)</strong>. Provide a descriptive name for your instance, for example, "STP_For_Hello_FIM".</p>
<p><a class="glightbox" href="../images/stp_rename_instance_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_rename_instance_hello_fim.png" /></a></p>
</li>
<li>
<p>Save the newly created Signal Tap file, and give it the same name as the instance.</p>
<p><a class="glightbox" href="../images/save_STP_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/save_STP_hello_fim.png" /></a></p>
</li>
<li>
<p>In the dialog that pops up, click "Yes" to add the newly created Signal Tap file to the project settings files.</p>
<p><a class="glightbox" href="../images/add_STP_Project_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/add_STP_Project_hello_fim.png" /></a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="c"># Answer &#39;Yes&#39; to add the following lines to the end of the project&#39;s **ofs_top.qsf** file.</span>
<a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>ENABLE_SIGNALTAP<span class="w"> </span>ON
<a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>USE_SIGNALTAP_FILE<span class="w"> </span>STP_For_Hello_FIM.stp
<a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>SIGNALTAP_FILE<span class="w"> </span>STP_For_Hello_FIM.stp
</code></pre></div>
</li>
<li>
<p>Close all Quartus GUIs.</p>
</li>
<li>
<p>Compile the project with the Signal Tap file added to the project. Use the <strong>-k</strong> switch to perform the compilation using the files under the working directory you just edited and not the original ones from the cloned repository. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a>ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-k<span class="w"> </span>n6001<span class="w"> </span>work_hello_fim_with_stp
</code></pre></div>
</li>
<li>
<p>[OPTIONAL] Alternatively, you can copy the <strong>ofs_top.qsf</strong> and <strong>STP_For_Hello_FIM.stp</strong> files from the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> with STP work directory to replace the original files in the cloned <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> repository. By doing this, all further <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> compilation projects will include the Signal Tap instance integrated into the design. Execute the following commands for this alternative flow:</p>
<ol>
<li>
<p>Copy the modified file "work_hello_fim_with_stp/syn/syn_top/ofs_top.qsf" over to the source <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> repository, into "syn/syn_top/".</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/work_hello_fim_with_stp/syn/syn_top
<a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a>cp<span class="w"> </span>ofs_top.qsf<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/syn/syn_top
<a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a>cp<span class="w"> </span>STP_For_Hello_FIM.stp<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/syn/syn_top
</code></pre></div>
</li>
<li>
<p>Compile the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> using the files from the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> repository to create a new work directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a>ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>n6001<span class="w"> </span>work_hello_fim_with_stp_from_src_repo
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Make sure the compile completes successfully and meets timing, see below.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a>***********************************
<a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a>***
<a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a>***<span class="w">        </span>OFS_PROJECT:<span class="w"> </span>n6001
<a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a>***<span class="w">        </span>Q_PROJECT:<span class="w">  </span>ofs_top
<a id="__codelineno-79-5" name="__codelineno-79-5" href="#__codelineno-79-5"></a>***<span class="w">        </span>Q_REVISION:<span class="w"> </span>ofs_top
<a id="__codelineno-79-6" name="__codelineno-79-6" href="#__codelineno-79-6"></a>***<span class="w">        </span>SEED:<span class="w"> </span><span class="m">106</span>
<a id="__codelineno-79-7" name="__codelineno-79-7" href="#__codelineno-79-7"></a>***<span class="w">        </span>Build<span class="w"> </span>Complete
<a id="__codelineno-79-8" name="__codelineno-79-8" href="#__codelineno-79-8"></a>***<span class="w">        </span>Timing<span class="w"> </span>Passed!
<a id="__codelineno-79-9" name="__codelineno-79-9" href="#__codelineno-79-9"></a>***
<a id="__codelineno-79-10" name="__codelineno-79-10" href="#__codelineno-79-10"></a>***********************************
</code></pre></div>
</li>
</ol>
<h4 id="522-downloading-ofs_top_hpssof-into-the-fpga-using-jtag"><strong>5.2.2 Downloading ofs_top_hps.sof into the FPGA using <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr></strong><a class="headerlink" href="#522-downloading-ofs_top_hpssof-into-the-fpga-using-jtag" title="Permanent link">&para;</a></h4>
<p>Every successful run of <code>build_top.sh</code> script creates the file <strong>$OFS_ROOTDIR/syn/syn_top/output_files/ofs_top_hps.sof</strong> which can be used with the Intel Download Cable II to load the image into the FPGA using the Intel® FPGA SmartNIC N6001-PL <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> access connector. </p>
<blockquote>
<p><strong>Note:</strong> You are encouraged to initially load the <strong>ofs_fim_hps.sof</strong> file for testing new versions of your <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> because if there is an issue with your new <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that prevents the host from accessing the FPGA via PCIe, then you can load a known good <strong>ofs_fim_hps.sof</strong> file to recover.</p>
</blockquote>
<p>The following steps load the <strong>ofs_fim_hps.sof</strong> created in the previous section into the Intel® Agilex® FPGA using the Intel FPGA Download Cable.  Use these FPGA loading steps for initial testing of newly created FIMs. You will also use the Intel Download II Cable to access the Signal Tap instance via <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr>.</p>
<h5 id="5221-connecting-to-intel-download-cable-ii"><strong>5.2.2.1 Connecting to Intel Download Cable II</strong><a class="headerlink" href="#5221-connecting-to-intel-download-cable-ii" title="Permanent link">&para;</a></h5>
<p>The Intel® FPGA SmartNIC N6001-PL has a 10 pin <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> header on the top side of the board.  This <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> header provides access to either the Intel® Agilex® FPGA or MAX® 10 <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> device.  The steps below instruct you in how to set DIP switches on the back side of the board to dynamically select either the Intel® Agilex® FPGA or MAX® 10 device on the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> chain.</p>
<ol>
<li>
<p>Set SW1.1=ON as shown in the next image. The switches are located at the back of the Intel® FPGA SmartNIC N6001-PL.</p>
<p><a class="glightbox" href="../images/n6000_sw2_position_0_for_agilex_jtag.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/n6000_sw2_position_0_for_agilex_jtag.png" /></a></p>
</li>
<li>
<p>Connect an Intel® FPGA Download II Cable to the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> header of the Intel® FPGA SmartNIC N6001-PL as shown in picture below.   This picture shows the Intel® FPGA SmartNIC N6001-PL card installed in the middle bay, top slot of a SuperMicro® SYS-220HE-FTNR server where the lower slot does not have card installed allowing the Intel® Download II cables to pass through removed the slot access. </p>
<p><a class="glightbox" href="../images/n6000_jtag_connection.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/n6000_jtag_connection.png" /></a></p>
</li>
</ol>
<h5 id="5222-programming-the-fpga-image-using-jtag"><strong>5.2.2.2 Programming the FPGA Image using <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr></strong><a class="headerlink" href="#5222-programming-the-fpga-image-using-jtag" title="Permanent link">&para;</a></h5>
<blockquote>
<p><strong>Important</strong>: Execute the commands as root user.</p>
<p><strong>Note</strong>: The commands below use Intel® FPGA SmartNIC N6001-PL board PCIe B.D.f of b1:00, please use the correct PCIe B.D.f for your target Intel® FPGA SmartNIC N6001-PL card.</p>
</blockquote>
<ol>
<li>
<p>The SOF file is located in the work directory <strong>$OFS_ROOTDIR/work_hello_fim_with_stp/syn/syn_top/output_files/ofs_top_hps.sof</strong>. If the target FPGA is on a different server, then transfer <strong>ofs_top_hps.sof</strong> and <strong>STP_For_Hello_FIM.stp</strong> files to the server with the target FPGA.</p>
</li>
<li>
<p>You can use a Full Quartus Installation or Standalone Quartus Prime Programmer &amp; Tools running on the machine where the Intel® FPGA SmartNIC N6001-PL is installed or on a separte machine sucha as a laptop.</p>
<blockquote>
<p><strong>Note:</strong> You can download the Quartus II Prime Programmer and Tools by clicking on the "Additional Software" tab as shown in the FPGA download page. The Quartus II prime Programmer and Tools come with Quartus programmer as well as System Console which are needed to program the flash devices.</p>
<p><strong>Note:</strong> If using the Intel FGPA download Cable on Linux, add the udev rule as described in <a href="https://www.intel.com/content/www/us/en/support/programmable/support-resources/download/dri-usb-b-lnx.html">Intel® FPGA Download Cable (formerly USB-Blaster) Driver for Linux*</a>.</p>
</blockquote>
</li>
<li>
<p>Set the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> interface to target the Intel® Agilex® FPGA by setting <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> register <code>0x378</code>. The <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> registers are accessed via the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>'s PMCI registers at address 0x2040c and 0x20400.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span><span class="nv">$USER</span>
<a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x2040c<span class="w"> </span>0x100000000
<a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x20400<span class="w"> </span>0x37800000002
<a id="__codelineno-80-4" name="__codelineno-80-4" href="#__codelineno-80-4"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>release<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0
</code></pre></div>
<blockquote>
<p><strong>Note:</strong> To later re-direct the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> back to the MAX 10 device, execute the following commands.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span><span class="nv">$USER</span>
<a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x2040c<span class="w"> </span>0x000000000
<a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x20400<span class="w"> </span>0x37800000002
<a id="__codelineno-81-4" name="__codelineno-81-4" href="#__codelineno-81-4"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>release<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:b1:00.0
</code></pre></div>
<p>Alternatively, rather than dynamically commanding Intel® Agilex® FPGA/MAX10 selection with the <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> register settings, you can fix the selection with the following switch settings shown in the table below:</p>
<table>
<thead>
<tr>
<th>SW1.1</th>
<th>SW2</th>
<th><abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> Target</th>
</tr>
</thead>
<tbody>
<tr>
<td>OFF</td>
<td>OFF</td>
<td>Intel® Agilex® FPGA</td>
</tr>
<tr>
<td>OFF</td>
<td>ON</td>
<td>MAX® 10 FPGA</td>
</tr>
<tr>
<td>ON</td>
<td>X</td>
<td>Intel® Agilex® FPGA if <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> register <code>378=1</code></td>
</tr>
<tr>
<td>ON</td>
<td>X</td>
<td>MAX® 10 FPGA if <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> register <code>0x378=0</code></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Verify the cable is successfully connected with the <strong>jtagconfig</strong> command. You should see the next output, which indicates the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> interface targets the Intel® Agilex® FPGA.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a>jtagconfig
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="m">1</span><span class="o">)</span><span class="w"> </span>USB-BlasterII<span class="w"> </span><span class="o">[</span><span class="m">1</span>-6<span class="o">]</span>
<a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a>4341A0DD<span class="w">   </span>AGFB014R24A
</code></pre></div>
<blockquote>
<p><strong>Note:</strong> The jtagconfig command is located in <strong>$QUARTUS_ROOTDIR/bin</strong>.
If you are running jtagconfig from another directory, you may see "jtagconfig: command not found...". The  workaround is to add the location of the command to the PATH environment variable.      </p>
</blockquote>
<div class="highlight"><pre><span></span><code><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="nv">$QUARTUS_ROOTDIR</span>/bin
</code></pre></div>
</li>
<li>
<p>Temporarily disable the PCIe <abbr title="Advanced Error Reporting, The PCIe AER driver is the extended PCI Express error reporting capability providing more robust error reporting.">AER</abbr> feature. This is required because when you program the FPGA using <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr>, the Intel® FPGA SmartNIC N6001-PL PCIe link goes down for a moment causing a server surprise link down event. To prevent this server event, temporarily disable PCIe <abbr title="Advanced Error Reporting, The PCIe AER driver is the extended PCI Express error reporting capability providing more robust error reporting.">AER</abbr> and remove the root port connected to the Intel® FPGA SmartNIC N6001-PL PCIe slot using the following steps:</p>
<ol>
<li>
<p>Find the root port connected to the Intel® FPGA SmartNIC N6001-PL.  In this example, the Intel® FPGA SmartNIC N6001-PL is assigned PCIe BDF b1:00, so you will use Linux lspci tree command to determine the root port.  </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a>sudo<span class="w"> </span>lspci<span class="w"> </span>-t
</code></pre></div>
<p>Example Output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a>...
<a id="__codelineno-86-2" name="__codelineno-86-2" href="#__codelineno-86-2"></a>+-<span class="o">[</span><span class="m">0000</span>:e2<span class="o">]</span>-+-00.0
<a id="__codelineno-86-3" name="__codelineno-86-3" href="#__codelineno-86-3"></a><span class="p">|</span><span class="w">           </span>+-00.1
<a id="__codelineno-86-4" name="__codelineno-86-4" href="#__codelineno-86-4"></a><span class="p">|</span><span class="w">           </span>+-00.2
<a id="__codelineno-86-5" name="__codelineno-86-5" href="#__codelineno-86-5"></a><span class="p">|</span><span class="w">           </span><span class="se">\-</span><span class="m">00</span>.4
<a id="__codelineno-86-6" name="__codelineno-86-6" href="#__codelineno-86-6"></a>+-<span class="o">[</span><span class="m">0000</span>:c9<span class="o">]</span>-+-00.0
<a id="__codelineno-86-7" name="__codelineno-86-7" href="#__codelineno-86-7"></a><span class="p">|</span><span class="w">           </span>+-00.1
<a id="__codelineno-86-8" name="__codelineno-86-8" href="#__codelineno-86-8"></a><span class="p">|</span><span class="w">           </span>+-00.2
<a id="__codelineno-86-9" name="__codelineno-86-9" href="#__codelineno-86-9"></a><span class="p">|</span><span class="w">           </span><span class="se">\-</span><span class="m">00</span>.4
<a id="__codelineno-86-10" name="__codelineno-86-10" href="#__codelineno-86-10"></a>+-<span class="o">[</span><span class="m">0000</span>:b0<span class="o">]</span>-+-00.0
<a id="__codelineno-86-11" name="__codelineno-86-11" href="#__codelineno-86-11"></a><span class="p">|</span><span class="w">           </span>+-00.1
<a id="__codelineno-86-12" name="__codelineno-86-12" href="#__codelineno-86-12"></a><span class="p">|</span><span class="w">           </span>+-00.2
<a id="__codelineno-86-13" name="__codelineno-86-13" href="#__codelineno-86-13"></a><span class="p">|</span><span class="w">           </span>+-00.4
<a id="__codelineno-86-14" name="__codelineno-86-14" href="#__codelineno-86-14"></a><span class="p">|</span><span class="w">           </span><span class="se">\-</span><span class="m">02</span>.0-<span class="o">[</span>b1<span class="o">]</span>--+-00.0<span class="w">   </span>*****Here<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>desired<span class="w"> </span>Intel®<span class="w"> </span>FPGA<span class="w"> </span>SmartNIC<span class="w"> </span>N6001-PL<span class="w"> </span>on<span class="w"> </span>B1:00*****
<a id="__codelineno-86-15" name="__codelineno-86-15" href="#__codelineno-86-15"></a><span class="p">|</span><span class="w">                        </span>+-00.1
<a id="__codelineno-86-16" name="__codelineno-86-16" href="#__codelineno-86-16"></a><span class="p">|</span><span class="w">                        </span>+-00.2
<a id="__codelineno-86-17" name="__codelineno-86-17" href="#__codelineno-86-17"></a><span class="p">|</span><span class="w">                        </span>+-00.3
<a id="__codelineno-86-18" name="__codelineno-86-18" href="#__codelineno-86-18"></a><span class="p">|</span><span class="w">                        </span><span class="se">\-</span><span class="m">00</span>.4
<a id="__codelineno-86-19" name="__codelineno-86-19" href="#__codelineno-86-19"></a>...
</code></pre></div>
<p>In this example, the root port PCIe BDF is b0:02.0.</p>
</li>
<li>
<p>Disable <abbr title="Advanced Error Reporting, The PCIe AER driver is the extended PCI Express error reporting capability providing more robust error reporting.">AER</abbr> on the Intel® FPGA SmartNIC N6001-PL PCIe root port and remove the root port using the commands entered as root.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a>sudo<span class="w"> </span>su
<a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a><span class="c1"># type in the root password.      </span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a>setpci<span class="w"> </span>-s<span class="w"> </span><span class="m">0000</span>:b0:02.0<span class="w"> </span>ECAP_AER+0x08.L<span class="o">=</span>0xFFFFFFFF
<a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a>setpci<span class="w"> </span>-s<span class="w"> </span><span class="m">0000</span>:b0:02.0<span class="w"> </span>ECAP_AER+0x14.L<span class="o">=</span>0xFFFFFFFF
<a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a><span class="nb">echo</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/bus/pci/devices/0000<span class="se">\:</span>b0<span class="se">\:</span><span class="m">02</span>.0/remove
</code></pre></div>
</li>
</ol>
</li>
<li>
<p>Launch "Quartus Prime Programmer" software with the following command.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a>quartus_pgmw
</code></pre></div>
<p>Click on <strong>Hardware Setup</strong>, select <strong>USB-Blaster II</strong> in the <strong>Current Selected Hardware</strong> list, and ensure the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> <strong>Hardware Frequency</strong> is set to 16Mhz (The default is 24MHz).</p>
<p><a class="glightbox" href="../images/stp_hardware_setup.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_hardware_setup.png" /></a></p>
<blockquote>
<p><strong>Note:</strong> The following command can be used alternatively, <code>jtagconfig –setparam “USB-BlasterII” JtagClock 16M</code>.</p>
</blockquote>
</li>
<li>
<p>Click the <strong>Auto Detect</strong> and make sure the Intel® Agilex® FPGA Device is shown in the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> chain.</p>
<p><a class="glightbox" href="../images/stp_autodetect_agilex.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_autodetect_agilex.png" /></a></p>
</li>
<li>
<p>To program the Intel® Agilex® FPGA .sof image, right-click on the first cell below the <strong>'File'</strong> column and click on <strong>'Change file'</strong></p>
<p><a class="glightbox" href="../images/stp_change_file_hello_fim.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_change_file_hello_fim.png" /></a> </p>
</li>
<li>
<p>Select the generated <strong>ofs_top_hps.sof</strong> file for the Intel® Agilex® FPGA with the Signal Tap instrumented Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> example. Remember that the output files are located under <strong>work_x16_adp_hello_fim_with_stp/syn/syn_top/output_files/</strong>.</p>
<p><a class="glightbox" href="../images/agilex_path_sof.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/agilex_path_sof.png" /></a></p>
</li>
<li>
<p>Check the checkbox below "Program/Configure" column and click on <strong>'Start'</strong> to program this .sof file. After successful programming, you can close the "Quartus Prime Programmer" software. You can answer 'No' if a dialog pops up asking to save the <strong>'Chain.cdf'</strong> file. This completes the Intel® Agilex® FPGA .sof programming.</p>
</li>
<li>
<p>Rescan PCIe Bus as root user. <strong>Important</strong>, enter the command as root:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a>sudo<span class="w"> </span>su
<a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a><span class="nb">echo</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/bus/pci/rescan
<a id="__codelineno-90-3" name="__codelineno-90-3" href="#__codelineno-90-3"></a><span class="nb">exit</span>
</code></pre></div>
</li>
<li>
<p>Verify the Intel® FPGA SmartNIC N6001-PL is present by comparing the <strong>$OFS_ROOTDIR/work_hello_fim_with_stp/syn/syn_top/fme_id.txt</strong> value to the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> Interface Id value read from <code>fpgainfo fme</code> - the two values should be identical:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a>sudo<span class="w"> </span>fpgainfo<span class="w"> </span>fme<span class="w">   </span>
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a>Intel<span class="w"> </span>Acceleration<span class="w"> </span>Development<span class="w"> </span>Platform
<a id="__codelineno-92-2" name="__codelineno-92-2" href="#__codelineno-92-2"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller<span class="w"> </span>NIOS<span class="w"> </span>FW<span class="w"> </span>version:<span class="w"> </span><span class="m">3</span>.11.0<span class="w"> </span>
<a id="__codelineno-92-3" name="__codelineno-92-3" href="#__codelineno-92-3"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller<span class="w"> </span>Build<span class="w"> </span>version:<span class="w"> </span><span class="m">3</span>.11.0<span class="w"> </span>
<a id="__codelineno-92-4" name="__codelineno-92-4" href="#__codelineno-92-4"></a>//******<span class="w"> </span>FME<span class="w"> </span>******//
<a id="__codelineno-92-5" name="__codelineno-92-5" href="#__codelineno-92-5"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xEE00000
<a id="__codelineno-92-6" name="__codelineno-92-6" href="#__codelineno-92-6"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:98:00.0
<a id="__codelineno-92-7" name="__codelineno-92-7" href="#__codelineno-92-7"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-92-8" name="__codelineno-92-8" href="#__codelineno-92-8"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x00
<a id="__codelineno-92-9" name="__codelineno-92-9" href="#__codelineno-92-9"></a>Ports<span class="w"> </span>Num<span class="w">                        </span>:<span class="w"> </span><span class="m">01</span>
<a id="__codelineno-92-10" name="__codelineno-92-10" href="#__codelineno-92-10"></a>Bitstream<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span><span class="m">360571655976424377</span><span class="w"> </span>
<a id="__codelineno-92-11" name="__codelineno-92-11" href="#__codelineno-92-11"></a>Bitstream<span class="w"> </span>Version<span class="w">                </span>:<span class="w"> </span>
<a id="__codelineno-92-12" name="__codelineno-92-12" href="#__codelineno-92-12"></a>Pr<span class="w"> </span>Interface<span class="w"> </span>Id<span class="w">                  </span>:<span class="w"> </span>4514ee67-ca01-5def-9fa5-a1ef30d0c76c<span class="w"> </span>
<a id="__codelineno-92-13" name="__codelineno-92-13" href="#__codelineno-92-13"></a>Boot<span class="w"> </span>Page<span class="w">                        </span>:<span class="w"> </span>user1
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a>cat<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/work_hello_fim_with_stp/syn/syn_top/fme_id.txt
</code></pre></div>
<p>Example output:
<div class="highlight"><pre><span></span><code><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a>4514ee67-ca01-5def-9fa5-a1ef30d0c76c<span class="w"> </span>
</code></pre></div></p>
</li>
</ol>
<h4 id="523-signal-tap-trace-acquisition-of-hello-fim-signals"><strong>5.2.3. Signal Tap trace acquisition of Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> signals</strong><a class="headerlink" href="#523-signal-tap-trace-acquisition-of-hello-fim-signals" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p>Once the instrumented HelloFIM SOF file is downloaded into the Intel® Agilex® FPGA, start the Quartus Signal Tap GUI.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a>quartus_stpw
<a id="__codelineno-95-2" name="__codelineno-95-2" href="#__codelineno-95-2"></a><span class="c1">#The Signal Tap GUI comes up.</span>
</code></pre></div>
</li>
<li>
<p>In the Signal Tap GUI, open your STP file. Your STP file settings will load.</p>
<p><a class="glightbox" href="../images/stp_open_STP_For_Hello_FIM.stp.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_open_STP_For_Hello_FIM.stp.png" /></a></p>
</li>
<li>
<p>In the right pane of the Signal Tap GUI, in Hardware: selection box, select the cable "USB-BlasterII".</p>
<p><a class="glightbox" href="../images/stp_select_usbBlasterII_hardware.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_select_usbBlasterII_hardware.png" /></a></p>
</li>
<li>
<p>Make sure the Intel® Agilex® FPGA Device is displayed in the Device: list as shown below. If not, click the <strong>'Scan Chain'</strong> button to re-scan the <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> device chain.</p>
<p><a class="glightbox" href="../images/stp_agilex_device_is_present.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_agilex_device_is_present.png" /></a></p>
</li>
<li>
<p>If not already set, you can create the trigger conditions, for example.</p>
<p><a class="glightbox" href="../images/stp_set_trigger_conditions.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_set_trigger_conditions.png" /></a></p>
</li>
<li>
<p>Start analysis by selecting the <strong>'STP_For_Hello_FIM'</strong> instance and pressing <strong>'F5'</strong>. You should see a green message indicating the Acquisition is in progress. Then, move to the <strong>'Data</strong> Tab to observe the signals captured.</p>
<p><a class="glightbox" href="../images/stp_start_signal_capture.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_start_signal_capture.png" /></a></p>
</li>
<li>
<p>To generate traffic in the <strong>'csr_lite_if'</strong> signals of the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> module, go back to the terminal and walk the DFH list or peek/poke the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> registers as was done during the creation of the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design example. For instance, the next image shows the activity of the instrumented signals when walking the DFH list with the commands below.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a>sudo opae.io init -d 0000:b1:00.0 $USER
<a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a>sudo opae.io walk -d 0000:b1:00.0
<a id="__codelineno-96-3" name="__codelineno-96-3" href="#__codelineno-96-3"></a>sudo opae.io release -d 0000:b1:00.0
</code></pre></div>
<p><a class="glightbox" href="../images/stp_captured_csr_lite_if_traces.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/stp_captured_csr_lite_if_traces.png" /></a></p>
</li>
<li>
<p>The PCIe <abbr title="Advanced Error Reporting, The PCIe AER driver is the extended PCI Express error reporting capability providing more robust error reporting.">AER</abbr> feature is automatically re-enabled by rebooting the server. </p>
</li>
</ol>
<p>This concludes the example on how to instrument an <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> with the Quartus Prime Signal Tap Logic Analyzer.</p>
<h2 id="6-compiling-the-fim-in-preparation-for-designing-your-afu"><strong>6. Compiling the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> in preparation for designing your <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr></strong><a class="headerlink" href="#6-compiling-the-fim-in-preparation-for-designing-your-afu" title="Permanent link">&para;</a></h2>
<p>The default Host Exercisers in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> can be replaced by a "he_null" block during compile-time. There are a few things to note:</p>
<ul>
<li>"he_null" is a minimal block with registers that responds to PCIe <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> request. <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> responses are required to keep PCIe alive (end points enabled in PCIe-SS needs service downstream requests).</li>
</ul>
<ul>
<li>If an exerciser with other I/O connections such has "he_mem" or "he_hssi" is replaced, then then those I/O ports are simply tied off.</li>
</ul>
<ul>
<li>The options supported are <code>null_he_lb</code>, <code>null_he_hssi</code>, <code>null_he_mem</code> and <code>null_he_mem_tg</code>. Any combination, order or all can be enabled at the same time. </li>
</ul>
<ul>
<li>Finer grain control is provided since the user may just turn off the exercisers in Static region to save area. </li>
</ul>
<p>To compile a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> for where the exercisers are removed and replaced with a he_null module and keeping the PF/VF multiplexor connections, execute the following command.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-97-2" name="__codelineno-97-2" href="#__codelineno-97-2"></a>ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>n6001:null_he_lp<span class="w">          </span>,null_he_hssi,null_he_mem,null_he_mem_tg<span class="w"> </span>work_null_he
</code></pre></div>
<h2 id="7-how-to-resize-the-partial-reconfiguration-region"><strong>7. How to resize the Partial Reconfiguration region</strong><a class="headerlink" href="#7-how-to-resize-the-partial-reconfiguration-region" title="Permanent link">&para;</a></h2>
<p>The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Intel® Agilex® FPGA flow provides the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> code to the user to enable full customization for your application needs.</p>
<p>To take advantage of the available resources in the Intel® Agilex® FPGA for an <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> design, you can adjust the size of the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> partition. An example reason for the changing the size of <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region is if you add more logic to the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> region, then you may need to adjust the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region to fit the additional logic into the static region.  Similarly, if you reduce logic in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> region, then you can adjust the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region to provide more logic resources for the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>.</p>
<p>After the compilation of the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>, the resources usage broken down by partitions as reported in the following two files</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a><span class="nv">$OFS_ROOTDIR</span>/syn/syn_top/output_files/ofs_top.fit.place.rpt
<a id="__codelineno-98-2" name="__codelineno-98-2" href="#__codelineno-98-2"></a><span class="nv">$OFS_ROOTDIR</span>/syn/syn_top/output_files/ofs_top.fit.rpt
</code></pre></div>
<p>The next is a report of the resources usage by partitions defined for the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. </p>
<p><a class="glightbox" href="../images/IOFS_FLOW_Logic_lock_region_usage_summary.PNG" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/IOFS_FLOW_Logic_lock_region_usage_summary.PNG" /></a></p>
<p>In this case, the default size for the afu_top|port_gasket|pr_slot|afu_main <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> partition is large enough to hold the logic of the default <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>, which is mainly occupied by the Host Exercisers. However, larger designs might require additional resources.</p>
<p>To customize the resources allocated to the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> in the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> regions follow the next iterative process.</p>
<ol>
<li>
<p>The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> flow provides the TCL file <code>$OFS_ROOTDIR/syn/setup/pr_assignments.tcl</code> which defines the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> partition where the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> is allocated.</p>
<p><a class="glightbox" href="../images/IOFS_PR_flow_pr_assignments.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/IOFS_PR_flow_pr_assignments.png" /></a></p>
</li>
<li>
<p>Use Quartus Chip Planner to identify the locations of the resources available within the Intel® Agilex® FPGA chip for placement and routing your <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>. You need to identify a pair of coordinates, the origin (X0, Y0) and top right corner (X1, Y1) of the new or existing rectangles to modify as shown in the following image. </p>
<p>The image below shows the coodinates for Region1.<br /></p>
<p><a class="glightbox" href="../images/chip_planner_coordinates.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/chip_planner_coordinates.png" /></a></p>
<p>The coordinates of the top right corner of the lock regions are computed indirectly based on the Width and Height, as follows.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a>X1 = X0 + Width 
<a id="__codelineno-99-2" name="__codelineno-99-2" href="#__codelineno-99-2"></a>Y1 = Y0 + Height
</code></pre></div>
</li>
<li>
<p>Make changes to the pr_assignments.tcl based on your findings in Quartus Chip Planner. You can modify the size and location of existing lock regions or add new ones and assign them to the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> partition.</p>
</li>
<li>
<p>Recompile your <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and create the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> relocatable build tree using the following commands.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span><span class="w">    </span>
<a id="__codelineno-100-2" name="__codelineno-100-2" href="#__codelineno-100-2"></a>ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>n6001<span class="w"> </span>work_&lt;your<span class="w"> </span>directory&gt;
</code></pre></div>
</li>
<li>
<p>Analyze the resource utilization report per partition produced after recompiling the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
</li>
<li>
<p>Perform further modification to the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> regions until the results are satisfactory. Make sure timing constraints are met.</p>
<p>For more information on how to optimize the floor plan of your Partial Reconfiguration design refer to the following online documentation.</p>
<ul>
<li><a href="https://www.intel.com/content/www/us/en/docs/programmable/683641/21-4/analyzing-and-optimizing-the-design-03170.html" title="Analyzing and Optimizing the Design Floorplan">Analyzing and Optimizing the Design Floorplan</a></li>
</ul>
<ul>
<li><a href="https://www.intel.com/content/www/us/en/docs/programmable/683834/21-4/step-3-floorplan-the-design.html">Partial Reconfiguration Design Flow - Step 3: Floorplan the Design</a></li>
</ul>
</li>
</ol>
<h2 id="8-how-to-modify-the-memory-subsystem"><strong>8. How to modify the Memory Subsystem</strong><a class="headerlink" href="#8-how-to-modify-the-memory-subsystem" title="Permanent link">&para;</a></h2>
<p><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> allows performing modifications on the subsystems in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. To customize the Memory Subsystem follow these instructions.</p>
<ol>
<li>
<p>Within the cloned <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> repository, go to the directory containing the Memory Subsystem IP file <code>mem_ss_fm.ip</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ipss/mem/qip/mem_ss
</code></pre></div>
</li>
<li>
<p>Open the Memory Subsystem IP file in Platform Designer to perform the required edits. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a>qsys-edit<span class="w"> </span>mem_ss_fm.ip<span class="w">  </span>
</code></pre></div>
<p>The IP Parameter Editor GUI comes up.</p>
</li>
<li>
<p>Select the "Memory Interfaces" tab and then select the tab "Interface 4"</p>
<p>The figure below shows the GUI of the platform designer with the current configuration of the Memory Subsystem.</p>
<p><a class="glightbox" href="../images/mem_ss_current_settings.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/mem_ss_current_settings.png" /></a></p>
</li>
<li>
<p>As an example, the figure below highlights the drop-down list option to change the width of the data bus (Memory DQ width) to the HPS subsystem, from a 40-bits wide (with ECC) configuration to a 32-bits wide (no ECC) configuration. Similarly, Platform Designer allows performing configuration edits to any of the available memory interfaces.</p>
<p><a class="glightbox" href="../images/mem_ss_from_40b_ecc_to_32b_no_ecc.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/mem_ss_from_40b_ecc_to_32b_no_ecc.png" /></a></p>
</li>
<li>
<p>The next step is to generate the HDL code that reflects the configuration edits performed. For this, click the Generate HDL... button at the bottom right corner of the Platform Designer window. In the dialog that appears next, review and modify the HDL generation options and click the Generate button at the bottom right corner of the dialog.</p>
<p><a class="glightbox" href="../images/mem_ss_generate_hdl.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/mem_ss_generate_hdl.png" /></a></p>
</li>
<li>
<p>Once the generation process is finished, close the Platform designer dialogs. </p>
</li>
<li>
<p>Open the <code>$OFS_ROOTDIR/src/top/top.sv</code> file. Comment out line 37, and declare a non_ecc interface in line 38, as shown in the figure below.</p>
<p><a class="glightbox" href="../images/mem_ss_ofs_ddr_no_ecc_if.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/mem_ss_ofs_ddr_no_ecc_if.png" /></a></p>
</li>
<li>
<p>Similarly, open the <code>$OFS_ROOTDIR/ipss/mem/rtl/mem_ss_top.sv</code> file. Comment out line 35, and declare a non_ecc interface in line 46, as shown in the figure below.</p>
<p><a class="glightbox" href="../images/mem_ss_ofs_ddr_no_ecc_if_mem_ss_top_sv.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/mem_ss_ofs_ddr_no_ecc_if_mem_ss_top_sv.png" /></a></p>
</li>
<li>
<p>Since the ECC feature of the DDR interace to the HPS has been disabled, the physical pin assignments to corresponding byte (DQ/DQS signals) are not required. Thus, comment out the location_assigments below the line "# HPS DQS4 (ECC)" in the file <code>$OFS_ROOTDIR/syn/setup/emif_loc.tcl</code>. Use the figure below as reference.</p>
<p><a class="glightbox" href="../images/mem_ss_ofs_ddr_no_ecc_if_location_assignments.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/mem_ss_ofs_ddr_no_ecc_if_location_assignments.png" /></a></p>
<p>The configuration edits were performed to affect the original set of files of the cloned <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> repository. Therefore, these modifications will be carried over to any new <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> compilation performed hereafter. Recall that the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> compilation process links and copies files over from the cloned and just modified <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> repository to the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> compilation work directory given as input to the compilation scripts.</p>
</li>
<li>
<p>Back in the terminal, execute the <code>build_top.sh</code> command to compile a new <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that incorporates the newly configured Memory Subsystem. The next command example performs the compile of the BASE x16 <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> in a clean work directory named work_x16_adp__MemSS_HPS_32b_NoECC.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a><span class="c1"># Return to the root directory of the OFS repository</span>
<a id="__codelineno-103-2" name="__codelineno-103-2" href="#__codelineno-103-2"></a>
<a id="__codelineno-103-3" name="__codelineno-103-3" href="#__codelineno-103-3"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-103-4" name="__codelineno-103-4" href="#__codelineno-103-4"></a>ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>n6001<span class="w"> </span>work_x16_adp_MemSS_HPS_32b_NoECC
</code></pre></div>
</li>
</ol>
<h2 id="9-how-to-compile-the-fim-with-no-hssi-for-the-intel-fpga-smartnic-n6001-pl"><strong>9. How to compile the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> with no hssi for the Intel® FPGA SmartNIC N6001-PL</strong><a class="headerlink" href="#9-how-to-compile-the-fim-with-no-hssi-for-the-intel-fpga-smartnic-n6001-pl" title="Permanent link">&para;</a></h2>
<p>The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> n6001:no_hssi is derived from the base Intel® FPGA SmartNIC N6001-PL <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>, with the transceiver subsystem removed. To perform the flat compile of the n6001:no_hssi, pass the <code>no_hssi</code> option to the <code>build_top.sh</code> script, as follows. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-104-2" name="__codelineno-104-2" href="#__codelineno-104-2"></a>ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>n6001:no_hssi,flat<span class="w"> </span>work_N6001_base_x16_adp_no_hssi
</code></pre></div>
<h2 id="10-how-to-change-the-pcie-device-id-and-vendor-id"><strong>10. How to change the PCIe device ID and Vendor ID</strong><a class="headerlink" href="#10-how-to-change-the-pcie-device-id-and-vendor-id" title="Permanent link">&para;</a></h2>
<p>The PCIe configuration registers contains the Vendor, Device and Subsystem Vendor ID registers which are used in PCIe add-in cards to uniquely identify the card for assignment to software drivers.  <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> has these registers set with Intel values for out of the box usage.  If you are using <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for a PCIe add in card that your company manufactures, then update the PCIe Subsytem Subsystem ID and Vendor ID registers as described below and change OPAE provided software code to properly operate with your company's register values.</p>
<p>The Vendor ID is assigned to your company by the PCI-SIG (Special Interest Group). The PCI-SIG is the only body officially licensed to give out IDs. You must be a member of PCI-SIG to request your own ID. Information about joining PCI-SIG is available here: <a href="http://www.pcisig.com">PCI-SIG</a>. You select the Subsystem Device ID for your PCIe add in card.</p>
<p>Follow the instructions below to customize the PCIe device ID and Vendor ID of the Intel® FPGA SmartNIC N6001-PL.</p>
<p>You can display the current settings using the command <code>lspci -nvmms &lt;PCIe B.D.f&gt;</code> as shown below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a>$<span class="w"> </span>lspci<span class="w"> </span>-nvmms<span class="w"> </span><span class="m">98</span>:00
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a>Slot:<span class="w">   </span><span class="m">98</span>:00.0
<a id="__codelineno-106-2" name="__codelineno-106-2" href="#__codelineno-106-2"></a>Class:<span class="w">  </span><span class="m">1200</span>
<a id="__codelineno-106-3" name="__codelineno-106-3" href="#__codelineno-106-3"></a>Vendor:<span class="w"> </span><span class="m">8086</span>
<a id="__codelineno-106-4" name="__codelineno-106-4" href="#__codelineno-106-4"></a>Device:<span class="w"> </span>bcce
<a id="__codelineno-106-5" name="__codelineno-106-5" href="#__codelineno-106-5"></a>SVendor:<span class="w">        </span><span class="m">8086</span>
<a id="__codelineno-106-6" name="__codelineno-106-6" href="#__codelineno-106-6"></a>SDevice:<span class="w">        </span><span class="m">1771</span>
<a id="__codelineno-106-7" name="__codelineno-106-7" href="#__codelineno-106-7"></a>PhySlot:<span class="w">        </span><span class="m">1</span>
<a id="__codelineno-106-8" name="__codelineno-106-8" href="#__codelineno-106-8"></a>Rev:<span class="w">    </span><span class="m">01</span>
<a id="__codelineno-106-9" name="__codelineno-106-9" href="#__codelineno-106-9"></a>NUMANode:<span class="w">       </span><span class="m">1</span>
<a id="__codelineno-106-10" name="__codelineno-106-10" href="#__codelineno-106-10"></a>
<a id="__codelineno-106-11" name="__codelineno-106-11" href="#__codelineno-106-11"></a>Slot:<span class="w">   </span><span class="m">98</span>:00.1
<a id="__codelineno-106-12" name="__codelineno-106-12" href="#__codelineno-106-12"></a>Class:<span class="w">  </span><span class="m">1200</span>
<a id="__codelineno-106-13" name="__codelineno-106-13" href="#__codelineno-106-13"></a>Vendor:<span class="w"> </span><span class="m">8086</span>
<a id="__codelineno-106-14" name="__codelineno-106-14" href="#__codelineno-106-14"></a>Device:<span class="w"> </span>bcce
<a id="__codelineno-106-15" name="__codelineno-106-15" href="#__codelineno-106-15"></a>SVendor:<span class="w">        </span><span class="m">8086</span>
<a id="__codelineno-106-16" name="__codelineno-106-16" href="#__codelineno-106-16"></a>SDevice:<span class="w">        </span><span class="m">1771</span>
<a id="__codelineno-106-17" name="__codelineno-106-17" href="#__codelineno-106-17"></a>PhySlot:<span class="w">        </span><span class="m">1</span>
<a id="__codelineno-106-18" name="__codelineno-106-18" href="#__codelineno-106-18"></a>NUMANode:<span class="w">       </span><span class="m">1</span>
<a id="__codelineno-106-19" name="__codelineno-106-19" href="#__codelineno-106-19"></a>
<a id="__codelineno-106-20" name="__codelineno-106-20" href="#__codelineno-106-20"></a>Slot:<span class="w">   </span><span class="m">98</span>:00.2
<a id="__codelineno-106-21" name="__codelineno-106-21" href="#__codelineno-106-21"></a>Class:<span class="w">  </span><span class="m">1200</span>
<a id="__codelineno-106-22" name="__codelineno-106-22" href="#__codelineno-106-22"></a>Vendor:<span class="w"> </span><span class="m">8086</span>
<a id="__codelineno-106-23" name="__codelineno-106-23" href="#__codelineno-106-23"></a>Device:<span class="w"> </span>bcce
<a id="__codelineno-106-24" name="__codelineno-106-24" href="#__codelineno-106-24"></a>SVendor:<span class="w">        </span><span class="m">8086</span>
<a id="__codelineno-106-25" name="__codelineno-106-25" href="#__codelineno-106-25"></a>SDevice:<span class="w">        </span><span class="m">1771</span>
<a id="__codelineno-106-26" name="__codelineno-106-26" href="#__codelineno-106-26"></a>PhySlot:<span class="w">        </span><span class="m">1</span>
<a id="__codelineno-106-27" name="__codelineno-106-27" href="#__codelineno-106-27"></a>NUMANode:<span class="w">       </span><span class="m">1</span>
<a id="__codelineno-106-28" name="__codelineno-106-28" href="#__codelineno-106-28"></a>
<a id="__codelineno-106-29" name="__codelineno-106-29" href="#__codelineno-106-29"></a>Slot:<span class="w">   </span><span class="m">98</span>:00.3
<a id="__codelineno-106-30" name="__codelineno-106-30" href="#__codelineno-106-30"></a>Class:<span class="w">  </span><span class="m">1200</span>
<a id="__codelineno-106-31" name="__codelineno-106-31" href="#__codelineno-106-31"></a>Vendor:<span class="w"> </span>1af4
<a id="__codelineno-106-32" name="__codelineno-106-32" href="#__codelineno-106-32"></a>Device:<span class="w"> </span><span class="m">1000</span>
<a id="__codelineno-106-33" name="__codelineno-106-33" href="#__codelineno-106-33"></a>SVendor:<span class="w">        </span>1af4
<a id="__codelineno-106-34" name="__codelineno-106-34" href="#__codelineno-106-34"></a>SDevice:<span class="w">        </span><span class="m">1771</span>
<a id="__codelineno-106-35" name="__codelineno-106-35" href="#__codelineno-106-35"></a>PhySlot:<span class="w">        </span><span class="m">1</span>
<a id="__codelineno-106-36" name="__codelineno-106-36" href="#__codelineno-106-36"></a>NUMANode:<span class="w">       </span><span class="m">1</span>
<a id="__codelineno-106-37" name="__codelineno-106-37" href="#__codelineno-106-37"></a>
<a id="__codelineno-106-38" name="__codelineno-106-38" href="#__codelineno-106-38"></a>Slot:<span class="w">   </span><span class="m">98</span>:00.4
<a id="__codelineno-106-39" name="__codelineno-106-39" href="#__codelineno-106-39"></a>Class:<span class="w">  </span><span class="m">1200</span>
<a id="__codelineno-106-40" name="__codelineno-106-40" href="#__codelineno-106-40"></a>Vendor:<span class="w"> </span><span class="m">8086</span>
<a id="__codelineno-106-41" name="__codelineno-106-41" href="#__codelineno-106-41"></a>Device:<span class="w"> </span>bcce
<a id="__codelineno-106-42" name="__codelineno-106-42" href="#__codelineno-106-42"></a>SVendor:<span class="w">        </span><span class="m">8086</span>
<a id="__codelineno-106-43" name="__codelineno-106-43" href="#__codelineno-106-43"></a>SDevice:<span class="w">        </span><span class="m">1771</span>
<a id="__codelineno-106-44" name="__codelineno-106-44" href="#__codelineno-106-44"></a>PhySlot:<span class="w">        </span><span class="m">1</span>
<a id="__codelineno-106-45" name="__codelineno-106-45" href="#__codelineno-106-45"></a>NUMANode:<span class="w">       </span><span class="m">1</span>
</code></pre></div>
<h3 id="101-changing-the-pcie-subsystem-device-id-and-vendor-id"><strong>10.1. Changing the PCIe Subsystem Device ID and Vendor ID</strong><a class="headerlink" href="#101-changing-the-pcie-subsystem-device-id-and-vendor-id" title="Permanent link">&para;</a></h3>
<p>You will use IP Parameter Editor to modify the PCIe configuration registers.</p>
<ol>
<li>
<p>Navigate to the PCIe Subsystem IP file and bring up IP Parameter Editor to change values.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ipss/pcie/qip
<a id="__codelineno-107-2" name="__codelineno-107-2" href="#__codelineno-107-2"></a>qsys-edit<span class="w"> </span>pcie_ss.ip
<a id="__codelineno-107-3" name="__codelineno-107-3" href="#__codelineno-107-3"></a>
<a id="__codelineno-107-4" name="__codelineno-107-4" href="#__codelineno-107-4"></a><span class="c1">#The above command starts up the IP Parameter Editor GUI.  Close any tool pop-ups.</span>
</code></pre></div>
<p>The Editor comes up as shown below:</p>
<p><a class="glightbox" href="../images/pcie_ss_editor.PNG" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/pcie_ss_editor.PNG" /></a></p>
</li>
<li>
<p>Scroll down through the PCIe subsystem settings tabs to the PCIe Interfaces 0 Ports Settings tab as shown below:</p>
<p><a class="glightbox" href="../images/pcie_ss_editor2.PNG" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/pcie_ss_editor2.PNG" /></a></p>
</li>
<li>
<p>Select the PCIe0 Device Identification Registers tab. You can edit the values of Vendor ID, Device ID, Subsystem Vendor ID and Subsystem Device ID for each PF/VF in use.</p>
</li>
<li>
<p>Once you have made changes, click Generate HDL and save. </p>
</li>
<li>
<p>Build your new FPGA image with build_top.sh script</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-108-1" name="__codelineno-108-1" href="#__codelineno-108-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-108-2" name="__codelineno-108-2" href="#__codelineno-108-2"></a><span class="c1">#Set required OFS environment variables</span>
<a id="__codelineno-108-3" name="__codelineno-108-3" href="#__codelineno-108-3"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>n6001<span class="w"> </span>work_pcie_vid
</code></pre></div>
</li>
</ol>
<p>Once your image is built and passes timing, be aware that OPAE FPGA management commands require recognition of the FPGA PCIe Device ID for control.  If there is a problem between OPAE management recognition of FPGA PCIe values, then control of the card will be lost.  For this reason, you are strongly encouraged to use the [<abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> FPGA Download method]  to load the test FPGA image.  If there is a problem with the SOF image working with your host software that is updated for the new PCIe settings, then you can load a known good SOF file to recover.  Once you sure that both the software and FPGA work properly, you can load the FPGA into FPGA flash using the OPAE command <code>fpgasupdate</code>.</p>
<p>The changes to software required to work with new PCIe settings are described in [Software Reference Manual: Open FPGA Stack]</p>
<h2 id="11-migrating-intel-fpga-smartnic-n6001-pl-to-a-different-device-part-number"><strong>11. Migrating Intel® FPGA SmartNIC N6001-PL to a different device part number</strong><a class="headerlink" href="#11-migrating-intel-fpga-smartnic-n6001-pl-to-a-different-device-part-number" title="Permanent link">&para;</a></h2>
<p>The following instructions enable a user to change the device part number of the Intel® FPGA SmartNIC N6001-PL. Please beware that this release works with Intel® Agilex® FPGA devices that have P tile for PCIe and E tile for Ethernet.  Other tiles will take further work.</p>
<p>A user my want to change the device part number for the following reasons</p>
<ol>
<li>Migrate to same device package but with a larger density</li>
<li>Migrate to a different package and with a larger or same density</li>
</ol>
<p>The default device for the Intel® FPGA SmartNIC N6001-PL is AGFB014R24A2E2V</p>
<p>The instructions below will describe how to change the device to a different package and with a larger density</p>
<ol>
<li>
<p>Navigate to the root directory</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-109-1" name="__codelineno-109-1" href="#__codelineno-109-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
</code></pre></div>
</li>
<li>
<p>The following command will be used to to alter the device part number throughout $OFS_ROOTDIR directory</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-110-1" name="__codelineno-110-1" href="#__codelineno-110-1"></a>grep<span class="w"> </span>-rli<span class="w"> </span><span class="s1">&#39;&lt;default_OPN&gt;&#39;</span><span class="w"> </span>*<span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>-i@<span class="w"> </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/default_OPN/&lt;new_OPN&gt;/g&#39;</span><span class="w"> </span>@
</code></pre></div>
<p>where there are two fields to change</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-111-1" name="__codelineno-111-1" href="#__codelineno-111-1"></a>default_OPN
<a id="__codelineno-111-2" name="__codelineno-111-2" href="#__codelineno-111-2"></a>new_OPN
</code></pre></div>
<p>So in this case below the user changes the default device part number from AGFB014R24A2E2V to <strong>AGFB022R25A2E2V</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-112-1" name="__codelineno-112-1" href="#__codelineno-112-1"></a>grep<span class="w"> </span>-rli<span class="w"> </span><span class="s1">&#39;AGFB014R24A2E2V&#39;</span><span class="w"> </span>*<span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>-i@<span class="w"> </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/AGFB014R24A2E2V/AGFB022R25A2E2V/g&#39;</span><span class="w"> </span>@
</code></pre></div>
<p>This  changes all occurrences of the default device (AGFB014R24A2E2V) in the $OFS_ROOTDIR directory to the new device number (AGFB022R25A2E2V)</p>
</li>
<li>
<p>Since the new device is targeting a different package the current pin location constraints will not work and the user will have to comment out all pin location constraints in the following files located at $OFS_ROOTDIR/syn/setup</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-113-1" name="__codelineno-113-1" href="#__codelineno-113-1"></a>emif_loc.tcl
<a id="__codelineno-113-2" name="__codelineno-113-2" href="#__codelineno-113-2"></a>hps_loc.tcl
<a id="__codelineno-113-3" name="__codelineno-113-3" href="#__codelineno-113-3"></a>pmci_loc.tcl
<a id="__codelineno-113-4" name="__codelineno-113-4" href="#__codelineno-113-4"></a>top_loc.tcl
</code></pre></div>
<p>e.g </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-114-1" name="__codelineno-114-1" href="#__codelineno-114-1"></a><span class="c1">#set_location_assignment PIN_CU26 -to hssi_rec_clk[0]</span>
</code></pre></div>
</li>
<li>
<p>The user must then run the $OFS_ROOTDIR/ofs-common/scripts/common/syn/build_top.sh script to check if the design fits. More than likely the user will need to place some Transceiver refclk pins (normal Txcvr and PCIe refclk) to guide the fitter. Please adjust the pin constraints based on the messages in the fitter.</p>
</li>
<li>
<p>Quartus compilation will then be successful. To preserve the pin assignments the user must then hard code all of the new pin assignments back into the following files to provide deterministic results.</p>
<ul>
<li>emif_loc.tcl</li>
<li>hps_loc.tcl</li>
<li>pmci_loc.tcl</li>
<li>top_loc.tcl</li>
</ul>
</li>
</ol>
<h2 id="12-how-to-change-e-tile-ethernet-subsystem-from-8-x-25-gbe-to-8-x-10-gbe"><strong>12. How to change E-Tile Ethernet Subsystem from 8 X 25 GbE to 8 X 10 GbE</strong><a class="headerlink" href="#12-how-to-change-e-tile-ethernet-subsystem-from-8-x-25-gbe-to-8-x-10-gbe" title="Permanent link">&para;</a></h2>
<p>This section describes steps to change the E-Tile Ethernet Subsystem from 8 X 25 GbE to 8 X 10 GbE. </p>
<ol>
<li>
<p>Edit E-Tile Ethernet  IP Subsystem <strong>$OFS_ROOTDIR/ipss/hssi/qip/hssi_ss/hssi_ss_8x25g.ip</strong> to be 8 X 10 GbE using IP Platform Editor.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-115-1" name="__codelineno-115-1" href="#__codelineno-115-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ipss/hssi/qip/hssi_ss
<a id="__codelineno-115-2" name="__codelineno-115-2" href="#__codelineno-115-2"></a>qsys-edit<span class="w"> </span>hssi_ss_8x25g.ip
</code></pre></div>
</li>
<li>
<p>The IP Parameter Editor comes up - expect 2-5 minutes for this process to complete.  When pop-up indicates Open System Completed, click 'Close'.  The General Configuration window comes up, scroll down and switch ports 0 to 7 from 25GbE to 10GbE as shown below:</p>
<p><a class="glightbox" href="../images/ip_param_editor_10g_1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/ip_param_editor_10g_1.png" /></a></p>
</li>
<li>
<p>Click the IP Configuration tab and note the default settings of OFF for AN/LT and SYNCE.  You may optionally change these settings based on your application needs. The settings for P0 IP cover ports 0 to 3.  The settings for P4 cover ports 4 to 7.</p>
<p><a class="glightbox" href="../images/ip_param_editor_10g_2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/ip_param_editor_10g_2.png" /></a></p>
</li>
<li>
<p>Click "P0 Configuration" tab and note the default settings for maximum frame size.  You may optionally change these settings based on your application needs.  Set "P4 Configuration" as needed. </p>
<p><a class="glightbox" href="../images/ip_param_editor_10g_3.PNG" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/ip_param_editor_10g_3.PNG" /></a></p>
</li>
<li>
<p>Leave other settings at default values.</p>
</li>
<li>
<p>Click <code>File</code> and <code>Save As</code> hssi_ss_8x10g.  Click <code>Generate HDL</code> in the bottom right hand corner of IP Editor and enable simulation support.</p>
</li>
<li>
<p>Edit $OFS_ROOTDIR/ipss/hssi/eth_design_files.tcl to comment out 8x25g and add in 8x10g.ip</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-116-1" name="__codelineno-116-1" href="#__codelineno-116-1"></a><span class="c">#-----------------</span>
<a id="__codelineno-116-2" name="__codelineno-116-2" href="#__codelineno-116-2"></a><span class="c"># HSSI SS IP</span>
<a id="__codelineno-116-3" name="__codelineno-116-3" href="#__codelineno-116-3"></a><span class="c">#-----------------</span>
<a id="__codelineno-116-4" name="__codelineno-116-4" href="#__codelineno-116-4"></a><span class="c">#set_global_assignment -name IP_FILE               ../ip_lib/ipss/hssi/qip/hssi_ss/hssi_ss_8x25g.ip</span>
<a id="__codelineno-116-5" name="__codelineno-116-5" href="#__codelineno-116-5"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>IP_FILE<span class="w">               </span>..<span class="o">/</span>ip_lib<span class="o">/</span>ipss<span class="o">/</span>hssi<span class="o">/</span>qip<span class="o">/</span>hssi_ss<span class="o">/</span>hssi_ss_8x10g.ip
<a id="__codelineno-116-6" name="__codelineno-116-6" href="#__codelineno-116-6"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>IP_FILE<span class="w">               </span>..<span class="o">/</span>ip_lib<span class="o">/</span>ipss<span class="o">/</span>hssi<span class="o">/</span>qip<span class="o">/</span>ptp_iopll<span class="o">/</span>ptp_sample_clk_pll.ip
</code></pre></div>
</li>
<li>
<p>Edit $OFS_ROOTDIR/syn/syn_top/ofs_top.qsf and $OFS_ROOTDIR/syn/syn_top/ofs_pr_afu.qsf to add new macro definition:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-117-1" name="__codelineno-117-1" href="#__codelineno-117-1"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>VERILOG_MACRO<span class="w"> </span><span class="s2">&quot;ETH_10G&quot;</span><span class="w">                  </span><span class="err">#</span><span class="w"> </span>Change<span class="w"> </span>Ethernet<span class="w"> </span>from<span class="w"> </span><span class="mi">8</span>x25<span class="w"> </span>to<span class="w"> </span><span class="mi">8</span>x10<span class="w"> </span>GbE
</code></pre></div>
</li>
<li>
<p>Build new 8x10G <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-118-1" name="__codelineno-118-1" href="#__codelineno-118-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-118-2" name="__codelineno-118-2" href="#__codelineno-118-2"></a>ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>n6001<span class="w"> </span>work_8x10gbe
</code></pre></div>
</li>
</ol>
<h2 id="13-how-to-change-e-tile-ethernet-subsystem-from-8-x-25-gbe-to-2-x-100-gbe"><strong>13. How to change E-Tile Ethernet Subsystem from 8 X 25 GbE to 2 X 100 GbE</strong><a class="headerlink" href="#13-how-to-change-e-tile-ethernet-subsystem-from-8-x-25-gbe-to-2-x-100-gbe" title="Permanent link">&para;</a></h2>
<p>This section describes steps to change the E-Tile Ethernet Subsystem from 8 X 25 GbE to 2 x 100 GbE. </p>
<ol>
<li>
<p>Edit E-Tile Ethernet  IP Subsystem <strong>$OFS_ROOTDIR/ipss/hssi/qip/hssi_ss/hssi_ss_8x25g.ip</strong> to be 2 X 100 GbE using IP Platform Editor.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-119-1" name="__codelineno-119-1" href="#__codelineno-119-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ipss/hssi/qip/hssi_ss
<a id="__codelineno-119-2" name="__codelineno-119-2" href="#__codelineno-119-2"></a>qsys-edit<span class="w"> </span>hssi_ss_8x25g.ip
</code></pre></div>
</li>
<li>
<p>The IP Parameter Editor comes up - expect 2-5 minutes for this process to complete.  When pop-up indicates Open System Completed, click 'Close'.  The General Configuration window comes up, change ports to 2 and set "PORT0_PROFILE" and "PORT4_PROFILE" to "100GCAUI-4" as shown below:</p>
<p><a class="glightbox" href="../images/ip_param_editor_100g_1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/ip_param_editor_100g_1.png" /></a></p>
</li>
<li>
<p>Click the IP Configuration tab and note the default settings of OFF for AN/LT.  You may optionally change these settings based on your application needs.</p>
<p><a class="glightbox" href="../images/ip_param_editor_100g_2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/ip_param_editor_100g_2.png" /></a></p>
</li>
<li>
<p>Click "P0 Configuration" tab and note the default settings for maximum frame size.  You may optionally change these settings based on your application needs.  Set "P4 Configuration" as needed. </p>
<p><a class="glightbox" href="../images/ip_param_editor_100g_3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/ip_param_editor_100g_3.png" /></a></p>
</li>
<li>
<p>Leave other settings at default values.</p>
</li>
<li>
<p>Click <code>File</code> and <code>Save As</code> hssi_ss_2x100g.  Click <code>Generate HDL</code> in the bottom right hand corner of IP Editor and enable simulation support.</p>
</li>
<li>
<p>Edit $OFS_ROOTDIR/ipss/hssi/eth_design_files.tcl to comment out 8x25g and add in 2x100g.ip</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-120-1" name="__codelineno-120-1" href="#__codelineno-120-1"></a><span class="c">#-----------------</span>
<a id="__codelineno-120-2" name="__codelineno-120-2" href="#__codelineno-120-2"></a><span class="c"># E-Tile Ethernet  SS IP</span>
<a id="__codelineno-120-3" name="__codelineno-120-3" href="#__codelineno-120-3"></a><span class="c">#-----------------</span>
<a id="__codelineno-120-4" name="__codelineno-120-4" href="#__codelineno-120-4"></a><span class="c">#set_global_assignment -name IP_FILE               ../ip_lib/ipss/hssi/qip/hssi_ss/hssi_ss_8x25g.ip</span>
<a id="__codelineno-120-5" name="__codelineno-120-5" href="#__codelineno-120-5"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>IP_FILE<span class="w">               </span>..<span class="o">/</span>ip_lib<span class="o">/</span>ipss<span class="o">/</span>hssi<span class="o">/</span>qip<span class="o">/</span>hssi_ss<span class="o">/</span>hssi_ss_2x100g.ip
<a id="__codelineno-120-6" name="__codelineno-120-6" href="#__codelineno-120-6"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>IP_FILE<span class="w">               </span>..<span class="o">/</span>ip_lib<span class="o">/</span>ipss<span class="o">/</span>hssi<span class="o">/</span>qip<span class="o">/</span>ptp_iopll<span class="o">/</span>ptp_sample_clk_pll.ip
</code></pre></div>
</li>
<li>
<p>Edit $OFS_ROOTDIR/syn/syn_top/ofs_top.qsf and $OFS_ROOTDIR/syn/syn_top/ofs_pr_afu.qsf to add new macro definition:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-121-1" name="__codelineno-121-1" href="#__codelineno-121-1"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>VERILOG_MACRO<span class="w"> </span><span class="s2">&quot;ETH_100G&quot;</span><span class="w">         </span>Change<span class="w"> </span>Ethernet<span class="w"> </span>from<span class="w"> </span><span class="mi">8</span>x25<span class="w"> </span>to<span class="w"> </span><span class="mi">2</span>x100<span class="w"> </span>GbE
</code></pre></div>
</li>
<li>
<p>In Quartus 23.1, you will need to update $OFS_ROOTDIR/syn/setup/eth_top.sdc:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-122-1" name="__codelineno-122-1" href="#__codelineno-122-1"></a><span class="c">#Timing for 100G</span>
<a id="__codelineno-122-2" name="__codelineno-122-2" href="#__codelineno-122-2"></a><span class="nv">set_false_path</span><span class="w"> </span><span class="o">-</span>from<span class="w"> </span><span class="k">[</span><span class="nv">get_clocks</span><span class="w"> </span><span class="k">{</span><span class="nv">sys_pll</span><span class="o">|</span>iopll_0_clk_100m<span class="k">}]</span><span class="w"> </span><span class="o">-</span>to<span class="w"> </span><span class="k">[</span><span class="nv">get_clocks</span><span class="w"> </span><span class="k">{</span><span class="nv">hssi_wrapper</span><span class="o">|</span>hssi_ss<span class="o">|</span>hssi_ss_0<span class="o">|</span>U_hssi_ss_ip_wrapper<span class="o">|</span>U_hssi_ss_ip_top_p<span class="o">*|</span>alt_ehipc3_fm_0<span class="o">|</span>alt_ehipc3_fm_top_p<span class="o">*|</span>alt_ehipc3_fm_hard_inst<span class="o">|</span>E100GX4_FEC.altera_xcvr_native_inst<span class="o">|</span>xcvr_native_s10_etile_0_example_design_4ln_ptp<span class="o">|</span>tx_clkout<span class="o">|</span>ch0<span class="k">}];</span><span class="w"> </span>
<a id="__codelineno-122-3" name="__codelineno-122-3" href="#__codelineno-122-3"></a>
<a id="__codelineno-122-4" name="__codelineno-122-4" href="#__codelineno-122-4"></a><span class="nv">set_false_path</span><span class="w"> </span><span class="o">-</span>from<span class="w"> </span><span class="k">[</span><span class="nv">get_clocks</span><span class="w"> </span><span class="k">{</span><span class="nv">hssi_wrapper</span><span class="o">|</span>hssi_ss<span class="o">|</span>hssi_ss_0<span class="o">|</span>U_hssi_ss_ip_wrapper<span class="o">|</span>U_hssi_ss_ip_top_p<span class="o">*|</span>alt_ehipc3_fm_0<span class="o">|</span>alt_ehipc3_fm_top_p<span class="o">*|</span>alt_ehipc3_fm_hard_inst<span class="o">|</span>E100GX4_FEC.altera_xcvr_native_inst<span class="o">|</span>xcvr_native_s10_etile_0_example_design_4ln_ptp<span class="o">|</span>tx_clkout<span class="o">|</span>ch0<span class="k">}]</span><span class="w"> </span><span class="o">-</span>to<span class="w"> </span><span class="k">[</span><span class="nv">get_clocks</span><span class="w"> </span><span class="k">{</span><span class="nv">sys_pll</span><span class="o">|</span>iopll_0_clk_100m<span class="k">}];</span><span class="w">   </span>
</code></pre></div>
</li>
<li>
<p>Build new 2x100G <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-123-1" name="__codelineno-123-1" href="#__codelineno-123-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-123-2" name="__codelineno-123-2" href="#__codelineno-123-2"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>n6001<span class="w"> </span>work_2x100gbe
</code></pre></div>
</li>
</ol>
<h2 id="14-how-to-add-more-transceiver-channels-to-an-existing-fim-design"><strong>14. How to add more Transceiver channels to an existing <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design</strong><a class="headerlink" href="#14-how-to-add-more-transceiver-channels-to-an-existing-fim-design" title="Permanent link">&para;</a></h2>
<p>The next section will describe how to add 4 extra ethernet channels to the existing Intel® FPGA SmartNIC N6001-PL <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> base_x16 design which uses the 8x25G (2x4x25G) as the default ethernet configuration.</p>
<p>In this exercise we will add 4 extra channels to make a total of 12 channels. This configuration will be called 12x25G.</p>
<ol>
<li>
<p>Navigate to the following directory.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-124-1" name="__codelineno-124-1" href="#__codelineno-124-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ipss/hssi/qip/hssi_ss
</code></pre></div>
</li>
<li>
<p>Copy <code>hssi_ss_8x25g.ip</code> to <code>hssi_ss_12x25g.ip</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-125-1" name="__codelineno-125-1" href="#__codelineno-125-1"></a>cp<span class="w"> </span>hssi_ss_8x25g.ip<span class="w"> </span>hssi_ss_12x25g.ip
</code></pre></div>
</li>
<li>
<p>Then, open the <code>hssi_ss_12x25g.ip</code> file in platform designer and proceed to add 4 more transceiver channels copying the same configuration as the original 8 transceiver channels. Remove any errors in platform designer before generating the IP.</p>
</li>
<li>
<p>The following table describes the files that need to be changed next and the modification that needs to be made to add four extra Ethernet channels.</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Modification</th>
</tr>
</thead>
<tbody>
<tr>
<td>ipss/hssi/eth_design_files.tcl</td>
<td>Add assignment (after line 39) set_global_assignment -name IP_FILE ../ip_lib/ipss/hssi/qip/hssi_ss/hssi_ss_12x25g.ip</td>
</tr>
<tr>
<td>ipss/hssi/rtl/hssi_wrapper.sv</td>
<td>Comment out old Ethernet configuration IP file (line 427) //hssi_ss_8x25g <br /> Add New Ethernet Configuration IP file (after line 427) hssi_ss_12x25g  <br />Add the following code for the 4 extra Ethernet channels (after line 1524)  <code>ifdef INCLUDE_HSSI_PORT_8 assign serial_rx_p[PORT_8] = qsfp_serial[2].rx_p[0]; assign serial_rx_n[PORT_8] = 1'b0; assign qsfp_serial[2].tx_p[0] = serial_tx_p[PORT_8];</code>endif <code>ifdef INCLUDE_HSSI_PORT_9 assign serial_rx_p[PORT_9] = qsfp_serial[2].rx_p[1]; assign serial_rx_n[PORT_9] = 1'b0; assign qsfp_serial[2].tx_p[1] = serial_tx_p[PORT_9];</code>endif <code>ifdef INCLUDE_HSSI_PORT_10 assign serial_rx_p[PORT_10] = qsfp_serial[2].rx_p[2]; assign serial_rx_n[PORT_10] = 1'b0; assign qsfp_serial[2].tx_p[2] = serial_tx_p[PORT_10];</code>endif <code>ifdef INCLUDE_HSSI_PORT_11 assign serial_rx_p[PORT_11] = qsfp_serial[2].rx_p[3]; assign serial_rx_n[PORT_11] = 1'b0; assign qsfp_serial[2].tx_p[3] = serial_tx_p[PORT_11];</code>endif</td>
</tr>
<tr>
<td>ipss/hssi/rtl/inc/ofs_fim_eth_plat_defines.svh</td>
<td>Add the following code (after line 130)  <br /><code>define INCLUDE_HSSI_PORT_8</code>define INCLUDE_HSSI_PORT_9 <code>define INCLUDE_HSSI_PORT_10</code>define INCLUDE_HSSI_PORT_11</td>
</tr>
<tr>
<td>ipss/hssi/rtl/inc/ofs_fim_eth_plat_if_pkg.sv</td>
<td>Change parameters to reflect the addition of 4 Ethernet channels ie from 8 to 12 and the addition of one extra QSFP cage ie from 2 to 3<br />  localparam MAX_NUM_ETH_CHANNELS = 12; // Ethernet Ports (line 32) localparam NUM_QSFP_PORTS = 3; // QSFP cage on board (line 34) localparam NUM_ETH_CHANNELS = 12; // Ethernet Ports (line 63)</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Since the new device is targeting a different package the current pin location constraints will not work and the user will have to comment out all pin location constraints in the following files located at $IOFS_BUILD_ROOT/ofs-n6001/syn/setup</p>
<ul>
<li>emif_loc.tcl</li>
<li>hps_loc.tcl</li>
<li>pmci_loc.tcl</li>
<li>top_loc.tcl</li>
</ul>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-126-1" name="__codelineno-126-1" href="#__codelineno-126-1"></a><span class="c">#set_location_assignment PIN_CU26 -to hssi_rec_clk[0]</span>
</code></pre></div>
</li>
<li>
<p>Run the <code>ofs-common/scripts/common/syn/build_top.sh</code> script to check if the design fits. More than likely the user will need to place some Transceiver refclk pins (normal Txcvr and PCIe refclk) to guide the fitter. Please adjust the pin contraints based on the messages in the fitter.</p>
</li>
<li>
<p>Quartus compilation will then be successful. To preserve the pin assignments the user must then hard code all of the new pin assignments back into the following files to provide deterministic results.</p>
<ul>
<li>emif_loc.tcl</li>
<li>hps_loc.tcl</li>
<li>pmci_loc.tcl</li>
<li>top_loc.tcl</li>
</ul>
</li>
</ol>
<h2 id="15-how-to-modify-the-pfvf-mux-configuration"><strong>15. How to modify the PF/VF MUX configuration</strong><a class="headerlink" href="#15-how-to-modify-the-pfvf-mux-configuration" title="Permanent link">&para;</a></h2>
<p>The <strong>PF/VF Configuration Tool</strong> allows you to easily reconfigure the default number of PFs and VFs on your design. To modify the PF/VF configuration, you must: </p>
<ol>
<li>
<p>Decide which PCIe PF/VFs require modification.  If you are modifying host side PF/VF configuration, you must edit file <code>pcie_host.ofss</code> file found in <code>$OFS_ROOTDIR/tools/pfvf_config_tool</code>.  </p>
<p>The code given below show the default pcie_host.ofss file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-127-1" name="__codelineno-127-1" href="#__codelineno-127-1"></a><span class="o">[</span>ProjectSettings<span class="o">]</span>
<a id="__codelineno-127-2" name="__codelineno-127-2" href="#__codelineno-127-2"></a><span class="nv">platform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>n6001<span class="w"> </span>
<a id="__codelineno-127-3" name="__codelineno-127-3" href="#__codelineno-127-3"></a><span class="nv">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Agilex
<a id="__codelineno-127-4" name="__codelineno-127-4" href="#__codelineno-127-4"></a><span class="nv">fim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>base_x16
<a id="__codelineno-127-5" name="__codelineno-127-5" href="#__codelineno-127-5"></a><span class="nv">Part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>AGFB014R24A2E2V
<a id="__codelineno-127-6" name="__codelineno-127-6" href="#__codelineno-127-6"></a><span class="nv">IpDeployFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss.sh
<a id="__codelineno-127-7" name="__codelineno-127-7" href="#__codelineno-127-7"></a><span class="nv">IpFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss.ip
<a id="__codelineno-127-8" name="__codelineno-127-8" href="#__codelineno-127-8"></a><span class="nv">OutputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss
<a id="__codelineno-127-9" name="__codelineno-127-9" href="#__codelineno-127-9"></a><span class="nv">ComponentName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss
<a id="__codelineno-127-10" name="__codelineno-127-10" href="#__codelineno-127-10"></a><span class="nv">is_host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>True
<a id="__codelineno-127-11" name="__codelineno-127-11" href="#__codelineno-127-11"></a>
<a id="__codelineno-127-12" name="__codelineno-127-12" href="#__codelineno-127-12"></a><span class="o">[</span>pf0<span class="o">]</span>
<a id="__codelineno-127-13" name="__codelineno-127-13" href="#__codelineno-127-13"></a>
<a id="__codelineno-127-14" name="__codelineno-127-14" href="#__codelineno-127-14"></a><span class="o">[</span>pf1<span class="o">]</span>
</code></pre></div>
<p>This default configuration is made up of two physical functions (PF), and neither of them has any virtual functions (VF). </p>
</li>
<li>
<p>Modify the OFSS file with the new PF/VF configuration.</p>
<p>An example modification to the OFSS file is shown below.  In this example we have changed the configuration to: 6 PFs in total, 4 VFs in PF0, 1 VF in PF2, and 2 VFs on PF3.  You can add up to 8 PFs and could conceivably add up to the number of VFs supported by the PCIe IP.  Note more PFs/VFs will use more FPGA resources, which may cause fitter challenges.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-128-1" name="__codelineno-128-1" href="#__codelineno-128-1"></a><span class="o">[</span>ProjectSettings<span class="o">]</span>
<a id="__codelineno-128-2" name="__codelineno-128-2" href="#__codelineno-128-2"></a><span class="nv">platform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>n6001<span class="w"> </span>
<a id="__codelineno-128-3" name="__codelineno-128-3" href="#__codelineno-128-3"></a><span class="nv">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Agilex
<a id="__codelineno-128-4" name="__codelineno-128-4" href="#__codelineno-128-4"></a><span class="nv">fim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>base_x16
<a id="__codelineno-128-5" name="__codelineno-128-5" href="#__codelineno-128-5"></a><span class="nv">Part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>AGFB014R24A2E2V
<a id="__codelineno-128-6" name="__codelineno-128-6" href="#__codelineno-128-6"></a><span class="nv">IpDeployFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss.sh
<a id="__codelineno-128-7" name="__codelineno-128-7" href="#__codelineno-128-7"></a><span class="nv">IpFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss.ip
<a id="__codelineno-128-8" name="__codelineno-128-8" href="#__codelineno-128-8"></a><span class="nv">OutputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss
<a id="__codelineno-128-9" name="__codelineno-128-9" href="#__codelineno-128-9"></a><span class="nv">ComponentName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss
<a id="__codelineno-128-10" name="__codelineno-128-10" href="#__codelineno-128-10"></a><span class="nv">is_host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>True
<a id="__codelineno-128-11" name="__codelineno-128-11" href="#__codelineno-128-11"></a>
<a id="__codelineno-128-12" name="__codelineno-128-12" href="#__codelineno-128-12"></a><span class="o">[</span>pf0<span class="o">]</span>
<a id="__codelineno-128-13" name="__codelineno-128-13" href="#__codelineno-128-13"></a><span class="nv">num_vfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>
<a id="__codelineno-128-14" name="__codelineno-128-14" href="#__codelineno-128-14"></a>
<a id="__codelineno-128-15" name="__codelineno-128-15" href="#__codelineno-128-15"></a><span class="o">[</span>pf1<span class="o">]</span>
<a id="__codelineno-128-16" name="__codelineno-128-16" href="#__codelineno-128-16"></a>
<a id="__codelineno-128-17" name="__codelineno-128-17" href="#__codelineno-128-17"></a><span class="o">[</span>pf2<span class="o">]</span>
<a id="__codelineno-128-18" name="__codelineno-128-18" href="#__codelineno-128-18"></a><span class="nv">num_vfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<a id="__codelineno-128-19" name="__codelineno-128-19" href="#__codelineno-128-19"></a>
<a id="__codelineno-128-20" name="__codelineno-128-20" href="#__codelineno-128-20"></a><span class="o">[</span>pf3<span class="o">]</span>
<a id="__codelineno-128-21" name="__codelineno-128-21" href="#__codelineno-128-21"></a><span class="nv">num_vfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
<a id="__codelineno-128-22" name="__codelineno-128-22" href="#__codelineno-128-22"></a>
<a id="__codelineno-128-23" name="__codelineno-128-23" href="#__codelineno-128-23"></a><span class="o">[</span>pf4<span class="o">]</span>
<a id="__codelineno-128-24" name="__codelineno-128-24" href="#__codelineno-128-24"></a>
<a id="__codelineno-128-25" name="__codelineno-128-25" href="#__codelineno-128-25"></a><span class="o">[</span>pf5<span class="o">]</span>
</code></pre></div>
</li>
<li>
<p>Run the <code>gen_ofs_settings.py</code> script found in <code>$OFS_ROOTDIR/ofs-fim-common/tools/pfvf_config_tool</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-129-1" name="__codelineno-129-1" href="#__codelineno-129-1"></a>./gen_ofs_settings.py<span class="w">  </span>--ini<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/tools/pfvf_config_tool/&lt;PCIE_SOURCE&gt;.ofss<span class="w"> </span>--platform<span class="w"> </span><span class="nv">$ADP_PLATFORM</span>
</code></pre></div>
<p>For example, execute the following command to generate Host settings in an n6001 design:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-130-1" name="__codelineno-130-1" href="#__codelineno-130-1"></a>./gen_ofs_settings.py<span class="w">  </span>--ini<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/tools/pfvf_config_tool/pcie_host.ofss<span class="w"> </span>--platform<span class="w"> </span>n6001
</code></pre></div>
<p>This script reconfigures the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> by:</p>
<ol>
<li>
<p>Updating the PF/VF Mux Package APIs:</p>
<ul>
<li>$OFS_ROOTDIR/src/afu_top/mux/top_cfg_pkg.sv</li>
<li>$OFS_ROOTDIR/src/includes/ofs_fim_cfg_pkg.sv</li>
</ul>
</li>
<li>
<p>Adding/removing <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> endpoints</p>
<ul>
<li>PF0 VFs - afu_main.port_afu_instances</li>
<li>All other functions: afu_top.fim_afu_instances</li>
<li>New AFUs will be instantiated as HE-NULL (he_null.sv) AFUs</li>
</ul>
</li>
<li>
<p>Updating the pcie_ss.sh "ip-deploy" file</p>
</li>
<li>
<p>Generating the new pcie_ss.ip file ($OFS_ROOTDOR/ipss/pcie/ss/pcie_ss.ip)</p>
</li>
<li>
<p>Adding scratch register reads/writes to sim/csr_test for added functions</p>
</li>
<li>
<p>Updating the simulation filelists ($OFS_ROOTDIR/sim/common/pfvf_sim_pkg.sv)</p>
</li>
</ol>
<p>If the port gasket is enabled in the OFSS file, all functions in the <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> region must be a virtual function (VF) on physical function 0 (PF0) and are routed to Port <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Instances (port_afu_instances.sv) in the port gasket.  You can enable the port gasket in the ini (*.ofss file) by adding <code>pg_enable = True</code> under the <code>num_vfs</code> in PF0. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-131-1" name="__codelineno-131-1" href="#__codelineno-131-1"></a><span class="o">[</span>ProjectSettings<span class="o">]</span>
<a id="__codelineno-131-2" name="__codelineno-131-2" href="#__codelineno-131-2"></a><span class="nv">platform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>n6001<span class="w"> </span>
<a id="__codelineno-131-3" name="__codelineno-131-3" href="#__codelineno-131-3"></a><span class="nv">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Agilex
<a id="__codelineno-131-4" name="__codelineno-131-4" href="#__codelineno-131-4"></a><span class="nv">fim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>base_x16
<a id="__codelineno-131-5" name="__codelineno-131-5" href="#__codelineno-131-5"></a><span class="nv">Part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>AGFB014R24A2E2V
<a id="__codelineno-131-6" name="__codelineno-131-6" href="#__codelineno-131-6"></a><span class="nv">IpDeployFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss.sh
<a id="__codelineno-131-7" name="__codelineno-131-7" href="#__codelineno-131-7"></a><span class="nv">IpFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss.ip
<a id="__codelineno-131-8" name="__codelineno-131-8" href="#__codelineno-131-8"></a><span class="nv">OutputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss
<a id="__codelineno-131-9" name="__codelineno-131-9" href="#__codelineno-131-9"></a><span class="nv">ComponentName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss
<a id="__codelineno-131-10" name="__codelineno-131-10" href="#__codelineno-131-10"></a><span class="nv">is_host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>False
<a id="__codelineno-131-11" name="__codelineno-131-11" href="#__codelineno-131-11"></a>
<a id="__codelineno-131-12" name="__codelineno-131-12" href="#__codelineno-131-12"></a><span class="o">[</span>pf0<span class="o">]</span>
<a id="__codelineno-131-13" name="__codelineno-131-13" href="#__codelineno-131-13"></a><span class="nv">pg_enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>True
<a id="__codelineno-131-14" name="__codelineno-131-14" href="#__codelineno-131-14"></a><span class="nv">num_vfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>
</code></pre></div>
<p>If the port gasket is disabled, the virtual functions on PF0 are routed to <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Instances (fim_afu_instances.sv) in the static region.  All physical functions and virtual functions not on PF0 are routed to the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Instances module (fim_afu_instances.sv) in afu_top.</p>
<p>After you run the <code>gen_ofs_settings.py</code> script you should see a final success report:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-132-1" name="__codelineno-132-1" href="#__codelineno-132-1"></a>Info:<span class="w"> </span>Regenerate<span class="w"> </span>these<span class="w"> </span>scripts<span class="w"> </span>whenever<span class="w"> </span>you<span class="w"> </span>make<span class="w"> </span>any<span class="w"> </span>change<span class="w"> </span>to<span class="w"> </span>any<span class="w"> </span>Quartus-generated<span class="w"> </span>IP<span class="w"> </span><span class="k">in</span><span class="w"> </span>your<span class="w"> </span>project.
<a id="__codelineno-132-2" name="__codelineno-132-2" href="#__codelineno-132-2"></a>Info:<span class="w"> </span>Finished:<span class="w"> </span>Create<span class="w"> </span>simulation<span class="w"> </span>script
<a id="__codelineno-132-3" name="__codelineno-132-3" href="#__codelineno-132-3"></a>sh:<span class="w"> </span>/home/applications.fpga.ofs.rtl/env_not_shipped/n6001/update_sim.sh:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory
<a id="__codelineno-132-4" name="__codelineno-132-4" href="#__codelineno-132-4"></a>Success!<span class="w">  </span>Thank<span class="w"> </span>you<span class="w"> </span><span class="k">for</span><span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span>IP-Deploy<span class="w"> </span>Tool
</code></pre></div>
</li>
<li>
<p>Recompile the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> using the <code>build_top.sh</code> script described in Section 4.3.2 of this guide. </p>
</li>
<li>
<p>Verify the correct functionality of new the PF/VF Mux configuration.</p>
<p>New PF/VF are seamlessly connected to their own CSR stub, which can be read at DFH Offset 0x0. You can bind to the function and perform <code>opae.io peek</code> commands to read from the stub CSR. Similarly, perform <code>opae.io poke</code> commands to write into the stub CSRs. Use this mechanism to verify that the new PF/VF Mux configuration allows to write and read back values from the stub CSRs. </p>
<p>The GUID for every new PF/VF CSR stub is the same.   </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-133-1" name="__codelineno-133-1" href="#__codelineno-133-1"></a>NULL_GUID_L           = 64&#39;haa31f54a3e403501
<a id="__codelineno-133-2" name="__codelineno-133-2" href="#__codelineno-133-2"></a>NULL_GUID_H           = 64&#39;h3e7b60a0df2d4850
</code></pre></div>
<blockquote>
<p><strong>Limitations:</strong> Setting 0 virtual functions on PF0 is not supported. This is because the <strong><abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr></strong> region cannot be left unconnected. A loopback may need to be instantiated in this special case. </p>
</blockquote>
<p>Load the newly compiled <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> to the card to test the functionality of the new PF/VF functions. Use the following commands to verify the number of PFs/VFs created:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-134-1" name="__codelineno-134-1" href="#__codelineno-134-1"></a>sudo<span class="w"> </span>lspci<span class="w"> </span>-vvv<span class="w"> </span>-s<span class="w"> </span>b1:00.0<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>VF
</code></pre></div>
<p>Example output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-135-1" name="__codelineno-135-1" href="#__codelineno-135-1"></a>Initial<span class="w"> </span>VFs:<span class="w"> </span><span class="m">4</span>,<span class="w"> </span>Total<span class="w"> </span>VFs:<span class="w"> </span><span class="m">4</span>,<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>VFs:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>Function<span class="w"> </span>Dependency<span class="w"> </span>Link:<span class="w"> </span><span class="m">00</span>
<a id="__codelineno-135-2" name="__codelineno-135-2" href="#__codelineno-135-2"></a>VF<span class="w"> </span>offset:<span class="w"> </span><span class="m">6</span>,<span class="w"> </span>stride:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>Device<span class="w"> </span>ID:<span class="w"> </span>bccf<span class="w">               </span>
</code></pre></div>
<blockquote>
<p><strong>Note:</strong> The PCIe B:D.F associated with your board may be different. Use the <code>fpgainfo fme</code> command to see the PCIe B:D:F for your board.</p>
</blockquote>
</li>
</ol>
<h2 id="16-how-to-create-a-minimal-fim"><strong>16. How to Create a Minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></strong><a class="headerlink" href="#16-how-to-create-a-minimal-fim" title="Permanent link">&para;</a></h2>
<p>In this example, the exercisers and E-Tile Ethernet  subsection are removed and a new <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> area is used to make use of the added area from the removed components.  This minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> is useful for HDL applications.</p>
<p>To create this minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>, perform the following steps:</p>
<ol>
<li>
<p>The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> repo provides a <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> assignments TCL file for this minimal <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.  You will copy the minimal <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> assignments TCL file into pr_assignments.tcl file location for use in the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> build process:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-136-1" name="__codelineno-136-1" href="#__codelineno-136-1"></a><span class="c1">## Save current pr_assignments.tcl file into pr_assignments_base.tcl for later use</span>
<a id="__codelineno-136-2" name="__codelineno-136-2" href="#__codelineno-136-2"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-136-3" name="__codelineno-136-3" href="#__codelineno-136-3"></a>mv<span class="w"> </span>syn/setup/pr_assignments.tcl<span class="w"> </span>syn/setup/pr_assignments_base.tcl
<a id="__codelineno-136-4" name="__codelineno-136-4" href="#__codelineno-136-4"></a><span class="c1">## Move &quot;Slim&quot; PR assignment file into pr_assignments.tcl - this file is used in the build process</span>
<a id="__codelineno-136-5" name="__codelineno-136-5" href="#__codelineno-136-5"></a>cp<span class="w"> </span>syn/setup/pr_assignments_slim.tcl<span class="w"> </span>syn/setup/pr_assignments.tcl
</code></pre></div>
</li>
<li>
<p>Change the PF/VF configuration to support only 1 PF with 1 VF.  You will edit <code>$OFS_ROOTDIR/tools/pfvf_config_tool/pcie_host.ofss</code> to be as shown below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-137-1" name="__codelineno-137-1" href="#__codelineno-137-1"></a>nano<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/tools/pfvf_config_tool/pcie_host.ofss
<a id="__codelineno-137-2" name="__codelineno-137-2" href="#__codelineno-137-2"></a>
<a id="__codelineno-137-3" name="__codelineno-137-3" href="#__codelineno-137-3"></a><span class="o">[</span>ProjectSettings<span class="o">]</span>
<a id="__codelineno-137-4" name="__codelineno-137-4" href="#__codelineno-137-4"></a><span class="nv">platform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>n6001<span class="w"> </span>
<a id="__codelineno-137-5" name="__codelineno-137-5" href="#__codelineno-137-5"></a><span class="nv">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Agilex
<a id="__codelineno-137-6" name="__codelineno-137-6" href="#__codelineno-137-6"></a><span class="nv">fim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>base_x16
<a id="__codelineno-137-7" name="__codelineno-137-7" href="#__codelineno-137-7"></a><span class="nv">Part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>AGFB014R24A2E2V
<a id="__codelineno-137-8" name="__codelineno-137-8" href="#__codelineno-137-8"></a><span class="nv">IpDeployFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss.sh
<a id="__codelineno-137-9" name="__codelineno-137-9" href="#__codelineno-137-9"></a><span class="nv">IpFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss.ip
<a id="__codelineno-137-10" name="__codelineno-137-10" href="#__codelineno-137-10"></a><span class="nv">OutputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss
<a id="__codelineno-137-11" name="__codelineno-137-11" href="#__codelineno-137-11"></a><span class="nv">ComponentName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pcie_ss
<a id="__codelineno-137-12" name="__codelineno-137-12" href="#__codelineno-137-12"></a><span class="nv">is_host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>True
<a id="__codelineno-137-13" name="__codelineno-137-13" href="#__codelineno-137-13"></a>
<a id="__codelineno-137-14" name="__codelineno-137-14" href="#__codelineno-137-14"></a><span class="o">[</span>pf0<span class="o">]</span>
<a id="__codelineno-137-15" name="__codelineno-137-15" href="#__codelineno-137-15"></a><span class="nv">num_vfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<a id="__codelineno-137-16" name="__codelineno-137-16" href="#__codelineno-137-16"></a><span class="nv">pg_enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>True
<a id="__codelineno-137-17" name="__codelineno-137-17" href="#__codelineno-137-17"></a>
<a id="__codelineno-137-18" name="__codelineno-137-18" href="#__codelineno-137-18"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ofs-common/tools/pfvf_config_tool/
</code></pre></div>
</li>
<li>
<p>Save the modified ofs_dev.ofss file and build a new configuration.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-138-1" name="__codelineno-138-1" href="#__codelineno-138-1"></a>python3<span class="w"> </span>gen_ofs_settings.py<span class="w"> </span>--ini<span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/tools/pfvf_config_tool/pcie_host.ofss<span class="w"> </span>--platform<span class="w"> </span>n6001
</code></pre></div>
</li>
<li>
<p>Compile the new <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> with exercisers removed.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-139-1" name="__codelineno-139-1" href="#__codelineno-139-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-139-2" name="__codelineno-139-2" href="#__codelineno-139-2"></a>./ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>-p<span class="w"> </span>n6001:null_he_lp,null_he_hssi,null_he_mem,null_he_mem_tg,no_hssi<span class="w"> </span>work_null_he_no_hssi
</code></pre></div>
</li>
</ol>
<p>The build will complete with reduced resources as compared to the base version.</p>
<h2 id="17-single-event-upset-reporting"><strong>17. Single Event Upset Reporting</strong><a class="headerlink" href="#17-single-event-upset-reporting" title="Permanent link">&para;</a></h2>
<p>A Single Event Upset (SEU) is the change in state of a storage element inside a device or system. They are caused by ionizing radiation strikes that discharge the charge in storage elements, such as configuration memory cells, user memory and registers.</p>
<p>Error Detection CRC (EDCRC) circuitry in the MAX® 10 is used to detect SEU errors. The CRC function is enabled in Quartus to enable CRC status to be reported to the Intel® Agilex® FPGA via the dedicated CRC_ERROR pin.</p>
<p>With the EDCRC there is no method to determine the severity of whether the SEU error is non-critical or catastrophic. Hence once the SEU error is detected, the Host system must initiate the Card <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> reset procedure.</p>
<p>SEU errors can be read from either the MAX® 10 SEU Status Register or the PMCI Subsystem SEU Error Indication Register. The processes to read these registers are described in greater detail in the [<abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> User Guide: Section 15 Single Event Upset Reporting].</p>
<p>Additionally, refer to the <a href="https://www.intel.com/content/www/us/en/docs/programmable/683128/21-3/seu-mitigation-overview.html">Intel Agilex SEU Mitigation User Guide</a> for more information on SEU detection and mitigation.</p>
<h2 id="18-adding-fim-image-info"><strong>18. Adding <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Image Info</strong><a class="headerlink" href="#18-adding-fim-image-info" title="Permanent link">&para;</a></h2>
<p>When using your newly created FPGA images, there are fields in the OPAE fpgainfo fme tool providing information on the FPGA image that is loaded in the FPGA flash.  This information is added with the <code>PACSign</code> tool.  When loading the FPGA binary file with OPAE tool fpgasupdate, the FPGA flash is written with the binary to load the FPGA, additionally, the FPGA flash has areas to store user entered information.  The OPAE tool fpgainfo fme reads this area and presents the information read back.</p>
<p>The <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> tool called PACSign appends the FPGA image information to the FPGA binary file.  By default, the <code>ofs-common/scripts/common/syn/build_top.sh</code> script runs the PACSign tool with the FPGA Information field set to a checksum hex value generated by <code>syn_top/build_flash/gen_image_info_hex.py</code>.   </p>
<p>To change the value loaded in the FPGA info field, you can run the PACSign tool to add either hex or ASCII information.</p>
<p>For example, adding the hex value "DEADBEEF12349876AAAA555512345678", do the following:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-140-1" name="__codelineno-140-1" href="#__codelineno-140-1"></a>PACSign<span class="w"> </span>SR<span class="w"> </span>-y<span class="w"> </span>-s<span class="w"> </span><span class="m">0</span><span class="w"> </span>-b<span class="w"> </span>DEADBEEF12349876AAAA555512345678-t<span class="w"> </span>UPDATE<span class="w"> </span>-H<span class="w"> </span>openssl_manager<span class="w"> </span>-i<span class="w"> </span>ofs_top_page1_unsigned_user1.bin<span class="w"> </span>-o<span class="w"> </span>my_fpgainfo_user1.bin
<a id="__codelineno-140-2" name="__codelineno-140-2" href="#__codelineno-140-2"></a>
<a id="__codelineno-140-3" name="__codelineno-140-3" href="#__codelineno-140-3"></a><span class="c1"># Once completed, you can review the binary file using OPAE SDK tool `bitstreaminfo` to read information fields</span>
<a id="__codelineno-140-4" name="__codelineno-140-4" href="#__codelineno-140-4"></a>
<a id="__codelineno-140-5" name="__codelineno-140-5" href="#__codelineno-140-5"></a>bitstreaminfo<span class="w"> </span>my_fpgainfo_user1.bin
<a id="__codelineno-140-6" name="__codelineno-140-6" href="#__codelineno-140-6"></a><span class="c1">#.....</span>
<a id="__codelineno-140-7" name="__codelineno-140-7" href="#__codelineno-140-7"></a>File<span class="w"> </span>my_fpgainfo_user1.bin:
<a id="__codelineno-140-8" name="__codelineno-140-8" href="#__codelineno-140-8"></a>Block<span class="w"> </span><span class="m">0</span>:
<a id="__codelineno-140-9" name="__codelineno-140-9" href="#__codelineno-140-9"></a><span class="w">        </span>Block<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="nv">magic</span><span class="w"> </span><span class="o">=</span><span class="w">         </span>0xb6eafd19
<a id="__codelineno-140-10" name="__codelineno-140-10" href="#__codelineno-140-10"></a><span class="w">        </span>Content<span class="w"> </span><span class="nv">length</span><span class="w"> </span><span class="o">=</span><span class="w">        </span>0x02467100
<a id="__codelineno-140-11" name="__codelineno-140-11" href="#__codelineno-140-11"></a><span class="w">        </span>Content<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="o">=</span><span class="w">          </span>SR
<a id="__codelineno-140-12" name="__codelineno-140-12" href="#__codelineno-140-12"></a><span class="w">        </span>Cert<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="o">=</span><span class="w">             </span>UPDATE
<a id="__codelineno-140-13" name="__codelineno-140-13" href="#__codelineno-140-13"></a><span class="w">        </span>Slot<span class="w"> </span><span class="nv">number</span><span class="w"> </span><span class="o">=</span><span class="w">           </span><span class="m">0</span>
<a id="__codelineno-140-14" name="__codelineno-140-14" href="#__codelineno-140-14"></a><span class="w">        </span>Protected<span class="w"> </span>content<span class="w"> </span>SHA-256:
<a id="__codelineno-140-15" name="__codelineno-140-15" href="#__codelineno-140-15"></a><span class="w">                        </span>0x509661a69aa42e84d11573e87e75e976a47c9e6bce86253e77422f85eb4f07b1
<a id="__codelineno-140-16" name="__codelineno-140-16" href="#__codelineno-140-16"></a><span class="w">        </span>Calculated<span class="w"> </span>protected<span class="w"> </span>content<span class="w"> </span>SHA-256:
<a id="__codelineno-140-17" name="__codelineno-140-17" href="#__codelineno-140-17"></a><span class="w">                        </span>0x509661a69aa42e84d11573e87e75e976a47c9e6bce86253e77422f85eb4f07b1
<a id="__codelineno-140-18" name="__codelineno-140-18" href="#__codelineno-140-18"></a><span class="w">                </span>Match
<a id="__codelineno-140-19" name="__codelineno-140-19" href="#__codelineno-140-19"></a><span class="w">        </span>Protected<span class="w"> </span>content<span class="w"> </span>SHA-384:
<a id="__codelineno-140-20" name="__codelineno-140-20" href="#__codelineno-140-20"></a><span class="w">                        </span>0xced3a0d7837767e40be8dd9b72b6eefd121d68c42c9aa040345534cca27c45d4910fe8e917163c19a8317e7485a2f5f9
<a id="__codelineno-140-21" name="__codelineno-140-21" href="#__codelineno-140-21"></a><span class="w">        </span>Calculated<span class="w"> </span>protected<span class="w"> </span>content<span class="w"> </span>SHA-384:
<a id="__codelineno-140-22" name="__codelineno-140-22" href="#__codelineno-140-22"></a><span class="w">                        </span>0xced3a0d7837767e40be8dd9b72b6eefd121d68c42c9aa040345534cca27c45d4910fe8e917163c19a8317e7485a2f5f9
<a id="__codelineno-140-23" name="__codelineno-140-23" href="#__codelineno-140-23"></a><span class="w">                </span>Match
<a id="__codelineno-140-24" name="__codelineno-140-24" href="#__codelineno-140-24"></a><span class="w">        </span>Bitstream<span class="w"> </span><span class="nv">Version</span><span class="w"> </span><span class="o">=</span><span class="w">             </span>DEADBEEF12349876AAAA555512345678
<a id="__codelineno-140-25" name="__codelineno-140-25" href="#__codelineno-140-25"></a>Block<span class="w"> </span><span class="m">1</span>:
<a id="__codelineno-140-26" name="__codelineno-140-26" href="#__codelineno-140-26"></a><span class="w">        </span>Block<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="nv">magic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0xf27f28d7
<a id="__codelineno-140-27" name="__codelineno-140-27" href="#__codelineno-140-27"></a><span class="w">                </span>Root<span class="w"> </span>Entry<span class="w"> </span><span class="nv">magic</span><span class="w"> </span><span class="o">=</span><span class="w">              </span>0xa757a046
<a id="__codelineno-140-28" name="__codelineno-140-28" href="#__codelineno-140-28"></a><span class="w">                </span>Root<span class="w"> </span>Entry<span class="w"> </span>curve<span class="w"> </span><span class="nv">magic</span><span class="w"> </span><span class="o">=</span><span class="w">        </span>0xc7b88c74
<a id="__codelineno-140-29" name="__codelineno-140-29" href="#__codelineno-140-29"></a><span class="w">                </span>Root<span class="w"> </span>Entry<span class="w"> </span><span class="nv">permissions</span><span class="w"> </span><span class="o">=</span><span class="w">        </span>0xffffffff
<a id="__codelineno-140-30" name="__codelineno-140-30" href="#__codelineno-140-30"></a><span class="w">                </span>Root<span class="w"> </span>Entry<span class="w"> </span>key<span class="w"> </span><span class="nv">ID</span><span class="w"> </span><span class="o">=</span><span class="w">             </span>0xffffffff
<a id="__codelineno-140-31" name="__codelineno-140-31" href="#__codelineno-140-31"></a><span class="w">                </span>Root<span class="w"> </span>public<span class="w"> </span>key<span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="o">=</span><span class="w">             </span>0x0000000000000000000000000000000000000000000000000000000000000000
<a id="__codelineno-140-32" name="__codelineno-140-32" href="#__codelineno-140-32"></a><span class="w">                </span>Root<span class="w"> </span>public<span class="w"> </span>key<span class="w"> </span><span class="nv">Y</span><span class="w"> </span><span class="o">=</span><span class="w">             </span>0x0000000000000000000000000000000000000000000000000000000000000000
<a id="__codelineno-140-33" name="__codelineno-140-33" href="#__codelineno-140-33"></a>
<a id="__codelineno-140-34" name="__codelineno-140-34" href="#__codelineno-140-34"></a><span class="w">                </span>Expected<span class="w"> </span>root<span class="w"> </span>entry<span class="w"> </span><span class="nb">hash</span><span class="w"> </span><span class="o">=</span><span class="w">      </span>0xf8ff7e0a52a378483c85301df49c7d55ffd26f794121bdb8b102d7e1c3132bb9
<a id="__codelineno-140-35" name="__codelineno-140-35" href="#__codelineno-140-35"></a>
<a id="__codelineno-140-36" name="__codelineno-140-36" href="#__codelineno-140-36"></a><span class="w">                </span>CSK<span class="w"> </span><span class="nv">magic</span><span class="w"> </span><span class="o">=</span><span class="w">                     </span>0x14711c2f
<a id="__codelineno-140-37" name="__codelineno-140-37" href="#__codelineno-140-37"></a><span class="w">                </span>CSK<span class="w"> </span>curve<span class="w"> </span><span class="nv">magic</span><span class="w"> </span><span class="o">=</span><span class="w">               </span>0xc7b88c74
<a id="__codelineno-140-38" name="__codelineno-140-38" href="#__codelineno-140-38"></a><span class="w">                </span>CSK<span class="w"> </span><span class="nv">permissions</span><span class="w"> </span><span class="o">=</span><span class="w">               </span>0xffffffff
<a id="__codelineno-140-39" name="__codelineno-140-39" href="#__codelineno-140-39"></a><span class="w">                </span>CSK<span class="w"> </span>key<span class="w"> </span><span class="nv">ID</span><span class="w"> </span><span class="o">=</span><span class="w">                    </span>0x00000000
<a id="__codelineno-140-40" name="__codelineno-140-40" href="#__codelineno-140-40"></a><span class="w">                </span>Code<span class="w"> </span>signing<span class="w"> </span>key<span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="o">=</span><span class="w">            </span>0x0000000000000000000000000000000000000000000000000000000000000000
<a id="__codelineno-140-41" name="__codelineno-140-41" href="#__codelineno-140-41"></a><span class="w">                </span>Code<span class="w"> </span>signing<span class="w"> </span>key<span class="w"> </span><span class="nv">Y</span><span class="w"> </span><span class="o">=</span><span class="w">            </span>0x0000000000000000000000000000000000000000000000000000000000000000
<a id="__codelineno-140-42" name="__codelineno-140-42" href="#__codelineno-140-42"></a><span class="w">                </span>CSK<span class="w"> </span>signature<span class="w"> </span><span class="nv">magic</span><span class="w"> </span><span class="o">=</span><span class="w">           </span>0xde64437d
<a id="__codelineno-140-43" name="__codelineno-140-43" href="#__codelineno-140-43"></a><span class="w">                </span>Signature<span class="w"> </span><span class="nv">R</span><span class="w"> </span><span class="o">=</span><span class="w">                   </span>0x0000000000000000000000000000000000000000000000000000000000000000
<a id="__codelineno-140-44" name="__codelineno-140-44" href="#__codelineno-140-44"></a><span class="w">                </span>Signature<span class="w"> </span><span class="nv">S</span><span class="w"> </span><span class="o">=</span><span class="w">                   </span>0x0000000000000000000000000000000000000000000000000000000000000000
<a id="__codelineno-140-45" name="__codelineno-140-45" href="#__codelineno-140-45"></a>
<a id="__codelineno-140-46" name="__codelineno-140-46" href="#__codelineno-140-46"></a><span class="w">                </span>Expected<span class="w"> </span>CSK<span class="w"> </span><span class="nb">hash</span><span class="w"> </span><span class="o">=</span><span class="w">             </span>0xbe8a02e7932d98aff66584598978d84412e3c641927efac2cb786a1754cfcd4e
<a id="__codelineno-140-47" name="__codelineno-140-47" href="#__codelineno-140-47"></a>
<a id="__codelineno-140-48" name="__codelineno-140-48" href="#__codelineno-140-48"></a><span class="w">                </span>Block<span class="w"> </span><span class="m">0</span><span class="w"> </span>Entry<span class="w"> </span><span class="nv">magic</span><span class="w"> </span><span class="o">=</span><span class="w">           </span>0x15364367
<a id="__codelineno-140-49" name="__codelineno-140-49" href="#__codelineno-140-49"></a><span class="w">                </span>Block<span class="w"> </span><span class="m">0</span><span class="w"> </span>Entry<span class="w"> </span>signature<span class="w"> </span><span class="nv">magic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0xde64437d
<a id="__codelineno-140-50" name="__codelineno-140-50" href="#__codelineno-140-50"></a><span class="w">                </span>Signature<span class="w"> </span><span class="nv">R</span><span class="w"> </span><span class="o">=</span><span class="w">                   </span>0x0000000000000000000000000000000000000000000000000000000000000000
<a id="__codelineno-140-51" name="__codelineno-140-51" href="#__codelineno-140-51"></a><span class="w">                </span>Signature<span class="w"> </span><span class="nv">S</span><span class="w"> </span><span class="o">=</span><span class="w">                   </span>0x0000000000000000000000000000000000000000000000000000000000000000
<a id="__codelineno-140-52" name="__codelineno-140-52" href="#__codelineno-140-52"></a>Payload:
<a id="__codelineno-140-53" name="__codelineno-140-53" href="#__codelineno-140-53"></a><span class="w">        </span><span class="m">80</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">04</span><span class="w"> </span>a9<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">94</span><span class="w"> </span><span class="m">46</span><span class="w"> </span>0c<span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span>
<a id="__codelineno-140-54" name="__codelineno-140-54" href="#__codelineno-140-54"></a><span class="w">        </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span>
<a id="__codelineno-140-55" name="__codelineno-140-55" href="#__codelineno-140-55"></a><span class="w">        </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span>
<a id="__codelineno-140-56" name="__codelineno-140-56" href="#__codelineno-140-56"></a><span class="w">        </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span>
<a id="__codelineno-140-57" name="__codelineno-140-57" href="#__codelineno-140-57"></a><span class="w">        </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span>
<a id="__codelineno-140-58" name="__codelineno-140-58" href="#__codelineno-140-58"></a><span class="w">        </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span>
<a id="__codelineno-140-59" name="__codelineno-140-59" href="#__codelineno-140-59"></a><span class="w">        </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span>
<a id="__codelineno-140-60" name="__codelineno-140-60" href="#__codelineno-140-60"></a><span class="w">        </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span>
<a id="__codelineno-140-61" name="__codelineno-140-61" href="#__codelineno-140-61"></a>
<a id="__codelineno-140-62" name="__codelineno-140-62" href="#__codelineno-140-62"></a><span class="w">        </span>...
<a id="__codelineno-140-63" name="__codelineno-140-63" href="#__codelineno-140-63"></a><span class="w">        </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span>
</code></pre></div>
<p>You can load this image using <code>fpgasupdate</code> and then read the value using <code>fpgainfo fme</code>.</p>
<p>ASCII upto characters can also be loaded for upto 32 - 8 bit ASCII characters by putting the quotes as shown below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-141-1" name="__codelineno-141-1" href="#__codelineno-141-1"></a>PACSign<span class="w"> </span>SR<span class="w"> </span>-y<span class="w"> </span>-s<span class="w"> </span><span class="m">0</span><span class="w"> </span>-b<span class="w"> </span><span class="s2">&quot;My new FPGA 1234&quot;</span><span class="w"> </span>-t<span class="w"> </span>UPDATE<span class="w"> </span>-H<span class="w"> </span>openssl_manager<span class="w"> </span>-i<span class="w"> </span>ofs_top_page1_unsigned_user1.bin<span class="w"> </span>-o<span class="w"> </span>my_new_fpga_user1.bin
</code></pre></div>
<h2 id="notices-disclaimers">Notices &amp; Disclaimers<a class="headerlink" href="#notices-disclaimers" title="Permanent link">&para;</a></h2>
<p>Intel<sup>&reg;</sup> technologies may require enabled hardware, software or service activation.
No product or component can be absolutely secure. 
Performance varies by use, configuration and other factors.
Your costs and results may vary. 
You may not use or facilitate the use of this document in connection with any infringement or other legal analysis concerning Intel products described herein. You agree to grant Intel a non-exclusive, royalty-free license to any patent claim thereafter drafted which includes subject matter disclosed herein.
No license (express or implied, by estoppel or otherwise) to any intellectual property rights is granted by this document, with the sole exception that you may publish an unmodified copy. You may create software implementations based on this document and in compliance with the foregoing that are intended to execute on the Intel product(s) referenced in this document. No rights are granted to create modifications or derivatives of this document.
The products described may contain design defects or errors known as errata which may cause the product to deviate from published specifications.  Current characterized errata are available on request.
Intel disclaims all express and implied warranties, including without limitation, the implied warranties of merchantability, fitness for a particular purpose, and non-infringement, as well as any warranty arising from course of performance, course of dealing, or usage in trade.
You are responsible for safety of the overall system, including compliance with applicable safety-related requirements or standards. 
<sup>&copy;</sup> Intel Corporation.  Intel, the Intel logo, and other Intel marks are trademarks of Intel Corporation or its subsidiaries.  Other names and brands may be claimed as the property of others. </p>
<p>OpenCL and the OpenCL logo are trademarks of Apple Inc. used by permission of the Khronos Group™. </p>
<!-- include ./docs/hw/n6001/doc_modules/links.md -->





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.indexes", "search.suggest", "search.highlight", "content.code.copy", "navigation.indexes", "toc.follow"], "search": "../../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "ofs-2023.1", "provider": "mike"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.fac441b0.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>