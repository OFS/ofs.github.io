
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../../reference_manuals/ofs_fim/mnl_fim_ofs_d5005/">
      
      
        <link rel="next" href="../../afu_dev/ug_dev_afu_d5005/">
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.9">
    
    
      
        <title>FPGA Interface Manager Developer Guide - OFS</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.85bb2934.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#intel-fpga-interface-manager-developer-guide-open-fpga-stack-for-intel-stratix-10-fpga" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="OFS" class="md-header__button md-logo" aria-label="OFS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OFS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              FPGA Interface Manager Developer Guide
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ofs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ofs
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../user_guides/ug_eval_ofs_d5005/ug_eval_script_ofs_d5005/" class="md-tabs__link md-tabs__link--active">
        Stratix 10 PCIe Attach OFS
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../n6001/user_guides/ug_eval_ofs_n6001/ug_eval_script_ofs_n6001/" class="md-tabs__link">
        Agilex PCIe Attach OFS
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../f2000x/user_guides/ug_eval_ofs/ug_eval_script_ofs_f2000x/" class="md-tabs__link">
        Agilex SoC Attach OFS
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../common/user_guides/oneapi_asp/ug_oneapi_asp/" class="md-tabs__link">
        oneAPI
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../sw/fpga_api/quick_start/readme/" class="md-tabs__link">
        OFS Software
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="OFS" class="md-nav__button md-logo" aria-label="OFS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    OFS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ofs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ofs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Stratix 10 PCIe Attach OFS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Stratix 10 PCIe Attach OFS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_eval_ofs_d5005/ug_eval_script_ofs_d5005/" class="md-nav__link">
        Quick Start Evaluation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_qs_ofs_d5005/ug_qs_ofs_d5005/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/reference_manual/ofs_sw/mnl_sw_ofs/" class="md-nav__link">
        Software Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference_manuals/ofs_fim/mnl_fim_ofs_d5005/" class="md-nav__link">
        FPGA Interface Manager Technical Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          FPGA Interface Manager Developer Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        FPGA Interface Manager Developer Guide
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    1. Introduction
  </a>
  
    <nav class="md-nav" aria-label="1. Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-about-this-document" class="md-nav__link">
    1.1. About This Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-introduction" class="md-nav__link">
    1.2. Introduction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-release-capabilities" class="md-nav__link">
    1.2. Release Capabilities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-prerequisites" class="md-nav__link">
    1.3. Prerequisites
  </a>
  
    <nav class="md-nav" aria-label="1.3. Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131-base-knowledge-and-skills-prerequisites" class="md-nav__link">
    1.3.1. Base Knowledge and Skills Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132-development-environment" class="md-nav__link">
    1.3.2. Development Environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-high-level-description" class="md-nav__link">
    2. High Level Description
  </a>
  
    <nav class="md-nav" aria-label="2. High Level Description">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-fpga-interface-manager-overview" class="md-nav__link">
    2.1. FPGA Interface Manager Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-fim-fpga-resource-usage" class="md-nav__link">
    2.2. FIM FPGA Resource Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-ofs-directory-structure" class="md-nav__link">
    2.3. OFS Directory Structure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-description-of-sub-systems" class="md-nav__link">
    3. Description of Sub-Systems
  </a>
  
    <nav class="md-nav" aria-label="3. Description of Sub-Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-host-control-and-data-flow" class="md-nav__link">
    3.1. Host Control and Data Flow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-fim-development-flow" class="md-nav__link">
    4. FIM Development Flow
  </a>
  
    <nav class="md-nav" aria-label="4. FIM Development Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-installation-of-ofs" class="md-nav__link">
    4.1. Installation of OFS
  </a>
  
    <nav class="md-nav" aria-label="4.1. Installation of OFS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-git-lfs" class="md-nav__link">
    Install git lfs:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-compiling-ofs-fim" class="md-nav__link">
    4.2. Compiling OFS FIM
  </a>
  
    <nav class="md-nav" aria-label="4.2. Compiling OFS FIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#421-setting-up-required-environment-variables" class="md-nav__link">
    4.2.1. Setting Up Required Environment Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#422-compiling" class="md-nav__link">
    4.2.2. Compiling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#423-relocatable-pr-directory-tree" class="md-nav__link">
    4.2.3. Relocatable PR Directory Tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#424-unit-level-simulation" class="md-nav__link">
    4.2.4. Unit Level Simulation
  </a>
  
    <nav class="md-nav" aria-label="4.2.4. Unit Level Simulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4241-dfh-walking-unit-simulation-output" class="md-nav__link">
    4.2.4.1. DFH Walking Unit Simulation Output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-compiling-the-ofs-fim-using-eval-script" class="md-nav__link">
    4.3. Compiling the OFS FIM using Eval Script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-debugging" class="md-nav__link">
    4.4. Debugging
  </a>
  
    <nav class="md-nav" aria-label="4.4. Debugging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#441-signal-tap-prerequisites" class="md-nav__link">
    4.4.1. Signal Tap Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#442-adding-signal-tap" class="md-nav__link">
    4.4.2. Adding Signal Tap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#443-signal-tap-trace-acquisition" class="md-nav__link">
    4.4.3. Signal Tap trace acquisition
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-fim-modification-example" class="md-nav__link">
    5. FIM Modification Example
  </a>
  
    <nav class="md-nav" aria-label="5. FIM Modification Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-hello-fim-example" class="md-nav__link">
    5.1. Hello FIM example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#511-srctopiofs_topsv" class="md-nav__link">
    5.1.1. src/top/iofs_top.sv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#512-ipssmememif_csrsv" class="md-nav__link">
    5.1.2. ipss/mem/emif_csr.sv
  </a>
  
    <nav class="md-nav" aria-label="5.1.2. ipss/mem/emif_csr.sv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#513-srchello_fimhello_fim_topsv" class="md-nav__link">
    5.1.3. src/hello_fim/hello_fim_top.sv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#514-srchello_fimhello_fim_comsv" class="md-nav__link">
    5.1.4. src/hello_fim/hello_fim_com.sv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#515-unit-level-simulations" class="md-nav__link">
    5.1.5. Unit Level Simulations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#516-synsyn_topd5005qsf" class="md-nav__link">
    5.1.6. syn/syn_top/d5005.qsf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#517-synsetuphello_fim_design_filestcl" class="md-nav__link">
    5.1.7. syn/setup/hello_fim_design_files.tcl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#518-build-hello_fim-example" class="md-nav__link">
    5.1.8. Build hello_fim example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#519-test-the-hello_fim-on-a-d5005" class="md-nav__link">
    5.1.9. Test the hello_fim on a D5005
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-memory-subsystem-modification" class="md-nav__link">
    5.2. Memory Subsystem Modification
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-conclusion" class="md-nav__link">
    6. Conclusion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notices-disclaimers" class="md-nav__link">
    Notices &amp; Disclaimers
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../afu_dev/ug_dev_afu_d5005/" class="md-nav__link">
        AFU Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guides/ug_sim_ofs_d5005/ug_sim_ofs_d5005/" class="md-nav__link">
        Simulation User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_docker/ug_docker/" class="md-nav__link">
        Docker User guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_kvm/ug_kvm/" class="md-nav__link">
        KVM User guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../doc_modules/Glossary/" class="md-nav__link">
        Glossary
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Agilex PCIe Attach OFS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Agilex PCIe Attach OFS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../n6001/user_guides/ug_eval_ofs_n6001/ug_eval_script_ofs_n6001/" class="md-nav__link">
        Quick Start Evaluation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../n6001/user_guides/ug_qs_ofs_n6001/ug_qs_ofs_n6001/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/reference_manual/ofs_sw/mnl_sw_ofs/" class="md-nav__link">
        Software Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../n6001/reference_manuals/ofs_fim/mnl_fim_ofs_n6001/" class="md-nav__link">
        FPGA Interface Manager Technical Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../n6001/dev_guides/fim_dev/ug_dev_fim_ofs_n6001/" class="md-nav__link">
        FPGA Interface Manager Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../n6001/dev_guides/afu_dev/ug_dev_afu_ofs_n6001/" class="md-nav__link">
        AFU Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../n6001/dev_guides/hps_dev/hps_developer_ug/" class="md-nav__link">
        HPS Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../n6001/user_guides/ug_sim_ofs_n6001/ug_sim_ofs_n6001/" class="md-nav__link">
        Simulation User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_docker/ug_docker/" class="md-nav__link">
        Docker User guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_kvm/ug_kvm/" class="md-nav__link">
        KVM User guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../n6001/doc_modules/Glossary/" class="md-nav__link">
        Glossary
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Agilex SoC Attach OFS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Agilex SoC Attach OFS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/user_guides/ug_eval_ofs/ug_eval_script_ofs_f2000x/" class="md-nav__link">
        Quick Start Evaluation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/user_guides/ug_qs_ofs_f2000x/ug_qs_ofs_f2000x/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/reference_manual/ofs_sw/mnl_sw_ofs/" class="md-nav__link">
        Software Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/reference_manuals/ofs_fim/mnl_fim_ofs/" class="md-nav__link">
        FPGA Interface Manager Technical Reference Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/dev_guides/fim_dev/ug_dev_fim_ofs_f2000x/" class="md-nav__link">
        FPGA Interface Manager Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/dev_guides/afu_dev/ug_dev_afu_ofs_f2000x/" class="md-nav__link">
        AFU Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/user_guides/ug_sim_ofs/ug_sim_ofs/" class="md-nav__link">
        Simulation User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_docker/ug_docker/" class="md-nav__link">
        Docker User guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/ug_kvm/ug_kvm/" class="md-nav__link">
        KVM User guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../f2000x/doc_modules/Glossary/" class="md-nav__link">
        Glossary
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          oneAPI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          oneAPI
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/user_guides/oneapi_asp/ug_oneapi_asp/" class="md-nav__link">
        oneAPI ASP Getting Started User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/reference_manual/oneapi_asp/oneapi_asp_ref_mnl/" class="md-nav__link">
        oneAPI Accelerator Support Package(ASP) Reference Manual
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          OFS Software
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          OFS Software
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
          OPAE USER GUIDES
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_1">
          <span class="md-nav__icon md-icon"></span>
          OPAE USER GUIDES
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_api/quick_start/readme/" class="md-nav__link">
        Quick Start Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/install_guide/installation_guide/" class="md-nav__link">
        OPAE Installation Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_api/prog_guide/readme/" class="md-nav__link">
        OPAE C API Programming Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/pyopae/python_bindings/" class="md-nav__link">
        OPAE Python Bindings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_api/plug_guide/readme/" class="md-nav__link">
        OPAE Plugin Developers Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
          OPAE LIBRARIES
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          OPAE LIBRARIES
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_api/fpga_api/" class="md-nav__link">
        OPAE C API Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_api/fpga_cxx_api/" class="md-nav__link">
        OPAE C++ Core API Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_api/fpga_python_api/" class="md-nav__link">
        OPAE Python API Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_api/plug_guide/readme/" class="md-nav__link">
        OPAE Plugin Developers Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
          OPAE LINUX KERNEL DRIVERS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          OPAE LINUX KERNEL DRIVERS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/drv_arch/drv_arch/" class="md-nav__link">
        Open Programmable Accelerator Engine (OPAE) Linux Device Driver Architecture
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../../sw/fpga_tools/fpgadiag/">OPAE FPGA TOOLS</a>
          
            <label for="__nav_6_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_4">
          <span class="md-nav__icon md-icon"></span>
          OPAE FPGA TOOLS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/fpgaconf/fpgaconf/" class="md-nav__link">
        fpgaconf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/fpgainfo/fpgainfo/" class="md-nav__link">
        fpgainfo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/fpgasupdate/fpgasupdate/" class="md-nav__link">
        fpgasupdate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/mmlink/mmlink/" class="md-nav__link">
        mmlink
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/packager/packager/" class="md-nav__link">
        packager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/userclk/userclk/" class="md-nav__link">
        userclk
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/hssi/hssi/" class="md-nav__link">
        hssi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/pci_device/pci_device/" class="md-nav__link">
        pci_device
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/opae.io/opae.io/" class="md-nav__link">
        opae.io
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/rsu/rsu/" class="md-nav__link">
        rsu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/host_exerciser/host_exerciser/" class="md-nav__link">
        host_exerciser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/hssi_ethernet/hssistats/" class="md-nav__link">
        HSSI ethernet statistics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/hssi_ethernet/hssimac/" class="md-nav__link">
        HSSI ethernet mac
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/hssi_ethernet/hssiloopback/" class="md-nav__link">
        HSSI ethernet loopback
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/mem_tg/mem_tg/" class="md-nav__link">
        mem_tg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/vabtool/vabtool/" class="md-nav__link">
        vabtool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/opaevfio/opaevfio/" class="md-nav__link">
        opaevfio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/ofs.uio/ofs.uio/" class="md-nav__link">
        ofs.uio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/opaeuio/opaeuio/" class="md-nav__link">
        opaeuio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../sw/fpga_tools/fpgad/fpgad/" class="md-nav__link">
        fpgad
      </a>
    </li>
  

            
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    1. Introduction
  </a>
  
    <nav class="md-nav" aria-label="1. Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-about-this-document" class="md-nav__link">
    1.1. About This Document
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-introduction" class="md-nav__link">
    1.2. Introduction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-release-capabilities" class="md-nav__link">
    1.2. Release Capabilities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-prerequisites" class="md-nav__link">
    1.3. Prerequisites
  </a>
  
    <nav class="md-nav" aria-label="1.3. Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131-base-knowledge-and-skills-prerequisites" class="md-nav__link">
    1.3.1. Base Knowledge and Skills Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132-development-environment" class="md-nav__link">
    1.3.2. Development Environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-high-level-description" class="md-nav__link">
    2. High Level Description
  </a>
  
    <nav class="md-nav" aria-label="2. High Level Description">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-fpga-interface-manager-overview" class="md-nav__link">
    2.1. FPGA Interface Manager Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-fim-fpga-resource-usage" class="md-nav__link">
    2.2. FIM FPGA Resource Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-ofs-directory-structure" class="md-nav__link">
    2.3. OFS Directory Structure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-description-of-sub-systems" class="md-nav__link">
    3. Description of Sub-Systems
  </a>
  
    <nav class="md-nav" aria-label="3. Description of Sub-Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-host-control-and-data-flow" class="md-nav__link">
    3.1. Host Control and Data Flow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-fim-development-flow" class="md-nav__link">
    4. FIM Development Flow
  </a>
  
    <nav class="md-nav" aria-label="4. FIM Development Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-installation-of-ofs" class="md-nav__link">
    4.1. Installation of OFS
  </a>
  
    <nav class="md-nav" aria-label="4.1. Installation of OFS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-git-lfs" class="md-nav__link">
    Install git lfs:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-compiling-ofs-fim" class="md-nav__link">
    4.2. Compiling OFS FIM
  </a>
  
    <nav class="md-nav" aria-label="4.2. Compiling OFS FIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#421-setting-up-required-environment-variables" class="md-nav__link">
    4.2.1. Setting Up Required Environment Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#422-compiling" class="md-nav__link">
    4.2.2. Compiling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#423-relocatable-pr-directory-tree" class="md-nav__link">
    4.2.3. Relocatable PR Directory Tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#424-unit-level-simulation" class="md-nav__link">
    4.2.4. Unit Level Simulation
  </a>
  
    <nav class="md-nav" aria-label="4.2.4. Unit Level Simulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4241-dfh-walking-unit-simulation-output" class="md-nav__link">
    4.2.4.1. DFH Walking Unit Simulation Output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-compiling-the-ofs-fim-using-eval-script" class="md-nav__link">
    4.3. Compiling the OFS FIM using Eval Script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-debugging" class="md-nav__link">
    4.4. Debugging
  </a>
  
    <nav class="md-nav" aria-label="4.4. Debugging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#441-signal-tap-prerequisites" class="md-nav__link">
    4.4.1. Signal Tap Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#442-adding-signal-tap" class="md-nav__link">
    4.4.2. Adding Signal Tap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#443-signal-tap-trace-acquisition" class="md-nav__link">
    4.4.3. Signal Tap trace acquisition
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-fim-modification-example" class="md-nav__link">
    5. FIM Modification Example
  </a>
  
    <nav class="md-nav" aria-label="5. FIM Modification Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-hello-fim-example" class="md-nav__link">
    5.1. Hello FIM example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#511-srctopiofs_topsv" class="md-nav__link">
    5.1.1. src/top/iofs_top.sv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#512-ipssmememif_csrsv" class="md-nav__link">
    5.1.2. ipss/mem/emif_csr.sv
  </a>
  
    <nav class="md-nav" aria-label="5.1.2. ipss/mem/emif_csr.sv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#513-srchello_fimhello_fim_topsv" class="md-nav__link">
    5.1.3. src/hello_fim/hello_fim_top.sv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#514-srchello_fimhello_fim_comsv" class="md-nav__link">
    5.1.4. src/hello_fim/hello_fim_com.sv
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#515-unit-level-simulations" class="md-nav__link">
    5.1.5. Unit Level Simulations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#516-synsyn_topd5005qsf" class="md-nav__link">
    5.1.6. syn/syn_top/d5005.qsf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#517-synsetuphello_fim_design_filestcl" class="md-nav__link">
    5.1.7. syn/setup/hello_fim_design_files.tcl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#518-build-hello_fim-example" class="md-nav__link">
    5.1.8. Build hello_fim example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#519-test-the-hello_fim-on-a-d5005" class="md-nav__link">
    5.1.9. Test the hello_fim on a D5005
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-memory-subsystem-modification" class="md-nav__link">
    5.2. Memory Subsystem Modification
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-conclusion" class="md-nav__link">
    6. Conclusion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notices-disclaimers" class="md-nav__link">
    Notices &amp; Disclaimers
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="intel-fpga-interface-manager-developer-guide-open-fpga-stack-for-intel-stratix-10-fpga">Intel® FPGA Interface Manager Developer Guide: Open FPGA Stack for Intel® Stratix 10® FPGA<a class="headerlink" href="#intel-fpga-interface-manager-developer-guide-open-fpga-stack-for-intel-stratix-10-fpga" title="Permanent link">&para;</a></h1>
<h2 id="1-introduction">1. Introduction<a class="headerlink" href="#1-introduction" title="Permanent link">&para;</a></h2>
<h3 id="11-about-this-document">1.1. About This Document<a class="headerlink" href="#11-about-this-document" title="Permanent link">&para;</a></h3>
<p>This document serves as a design guide for FPGA developers, system architects and hardware developers using <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> as a starting point for the creating the FPGA Interface Manager (<abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>) for a custom FPGA acceleration board or Platform with Intel FPGAs.</p>
<p>This development guide is organized as follows: </p>
<ul>
<li>Introduction</li>
<li>Top Level Block Diagram description<ul>
<li>Control and data flow</li>
</ul>
</li>
<li>Description of Subsystems<ul>
<li>Command/status registers (CSR) and software interface</li>
<li>Clocking, resets and interfaces</li>
<li>High speed interface (HSSI)</li>
<li>External attached memory</li>
</ul>
</li>
<li>High Level development flow description<ul>
<li>Installation of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> RTL and development packages</li>
<li>Compiling <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></li>
<li>Simulation  </li>
</ul>
</li>
<li>Demonstration steps illustrating how to change areas of the design</li>
<li>Debugging using <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr></li>
</ul>
<p>This document uses the Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005 as an example platform to illustrate key points and demonstrate how to extend the capabilities provided in <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> (Open FPGA Stack) to custom platforms. The demonstration steps serves as a tutorial for the development of your <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> knowledge.</p>
<p>This document covers <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> architecture lightly.  For more details on the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> architecture, please see <a href="https://ofs.github.io/hw/d5005/reference_manuals/ofs_fim/mnl_fim_ofs_d5005/">Open FPGA Stack Technical Reference Manual</a>.</p>
<p>You are encouraged to read <a href="https://ofs.github.io/hw/d5005/dev_guides/afu_dev/ug_dev_afu_d5005/"><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Development Guide</a> to fully understand how <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Developers will use your newly developed <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<h3 id="12-introduction">1.2. Introduction<a class="headerlink" href="#12-introduction" title="Permanent link">&para;</a></h3>
<p>Open FPGA Stack (<abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>) addresses the scalability for FPGA acceleration boards and workloads by providing a powerful and systematic methodology for the rapid development of FPGA-based Acceleration systems.  This methodology addresses the key challenges of hardware, software and workload developers by providing a complete FPGA project consisting of RTL and simulation code, build scripts and software. The FPGA project released in <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> can be rapidly customized to meet new market requirements by adding new features, custom IPs and Intel interface subsystems IPs. </p>
<p>A high-level overview of the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Intel® Stratix 10® FPGA hardware architecture on the Intel® Stratix 10® FPGA reference platform, Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005 is shown in the below figure. The provided FPGA architecture is divided into two main components </p>
<p>- The outer area in white, the FPGA Interface manager (or <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>)
   - The inner area in green, the Acceleration Function Unit or <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Region. </p>
<p>The outer area, the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>, provides the core infrastructure and interfaces within the FPGA. The <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> region is where a user’s custom logic would reside for their specific workload. </p>
<p>* FPGA external interfaces and IP cores (e.g. Ethernet, DDR-4, PCIe, etc)
  * PLLs/resets
  * FPGA - Board management infrastructure
  * Interface to Acceleration Function Unit (<abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>)</p>
<p>The <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> region has both static and dynamic partial reconfiguration regions enabling a lot of customization. </p>
<p>* Uses the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> interfaces to perform useful work inside the FPGA
  * Contains logic supporting partial reconfiguration
  * Remote Signal Tap core for remote debugging of workload</p>
<p>Outside of the FPGA is the Board Management Controller which provides board management, root of trust, board monitoring, and remote system updates. </p>
<p>The overall architecture is built to be very composable and modular in blocks that can be modified while leaving the rest of the infrastructure intact so you may only need to modify a few of these blocks. </p>
<p><a class="glightbox" href="../images/s10_arch.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="s10-arch" src="../images/s10_arch.png" /></a></p>
<h3 id="12-release-capabilities">1.2. Release Capabilities<a class="headerlink" href="#12-release-capabilities" title="Permanent link">&para;</a></h3>
<p>This release of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> supports the following key features:</p>
<ul>
<li>1 - Host channel interface via PCIe Gen 3 x 16 SRIOV (1PF, 3 VF, AXI-S TLP packets)</li>
<li>DDR4 SDRAM External memory interface (AXI-M)</li>
<li>1 - 10G Ethernet interfaces (1x10G)</li>
<li>MSI-X Interrupts (PF, VF)</li>
<li>1 - <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr></li>
<li>Exercisers demonstrating PCIe, external memory and Ethernet interfaces</li>
<li>Port, <abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr> CSR</li>
<li>Remote Signal Tap</li>
</ul>
<p><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> is extensible to meet the needs of a broad set of customer applications, however not all use cases are easily served.  The general uses cases listed below are examples where the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> base design can be easily re-used to build a custom <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>:
1. Use <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference design as-is
  - Porting the code to another platform that is identical to the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference platform only changing target FPGA device and pinout
  - Change I/O assignments without changing design
2. Update the configuration of peripheral IP in <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference design, not affecting <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> architecture
  - External memory settings
  - HSSI analog settings
3. Remove/update peripheral feature in <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference design, not affecting <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> architecture
  - External memory speed/width change
  - Change 10G Ethernet to 25 or 100G Ethernet IP
   - Change number of VFs supported
4. Add new features as an extension to <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference design, not affecting <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> architecture
  - Add/remove external memory interface to the design
  - Add/remove user clocks for <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>
  - Add/remove IP to the design with connection to <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr></p>
<p>More advanced use cases requiring changes or additions to the host PCIe channel are not easily supported with this release of the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<p>Reuse of the provided host management FPGA logic and software is the fastest and most simple approach to <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> customization.</p>
<h3 id="13-prerequisites">1.3. Prerequisites<a class="headerlink" href="#13-prerequisites" title="Permanent link">&para;</a></h3>
<h4 id="131-base-knowledge-and-skills-prerequisites">1.3.1. Base Knowledge and Skills Prerequisites<a class="headerlink" href="#131-base-knowledge-and-skills-prerequisites" title="Permanent link">&para;</a></h4>
<p><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> is an advanced application of FPGA technology. This guide assumes you have the following FPGA logic design-related knowledge and skills:</p>
<ul>
<li>FPGA compilation flows using Intel<sup>&reg;</sup> Quartus<sup>&reg;</sup> Prime Pro Edition design flow.</li>
<li>Static Timing closure, including familiarity with the Timing Analyzer tool in Intel<sup>&reg;</sup> Quartus<sup>&reg;</sup> Prime Pro Edition, applying timing constraints, Synopsys* Design Constraints (.sdc) language and Tcl scripting, and design methods to close on timing critical paths.</li>
<li>RTL and coding practices for FPGA implementation.</li>
<li>RTL simulation tools.</li>
<li>Intel<sup>&reg;</sup> Quartus<sup>&reg;</sup> Prime Pro Edition Signal Tap Logic Analyzer tool software.</li>
</ul>
<h4 id="132-development-environment">1.3.2. Development Environment<a class="headerlink" href="#132-development-environment" title="Permanent link">&para;</a></h4>
<p>To run the tutorial steps in this guide requires this development environment:</p>
<table>
<thead>
<tr>
<th>Item</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>Intel Quartus Prime Pro</td>
<td>Intel Quartus Prime Pro 23.1 (with license patch)</td>
</tr>
<tr>
<td>Target D5005 Sever Operating System</td>
<td>RHEL 8.2</td>
</tr>
<tr>
<td><abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr></td>
<td><a href="https://github.com/OFS/opae-sdk/releases/tag/2.5.0-3">2.5.0-3 </a></td>
</tr>
<tr>
<td>Linux <abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr></td>
<td><a href="https://github.com/OFS/linux-dfl/releases/tag/ofs-2023.1-6.1-1">ofs-2023.1-6.1-1</a></td>
</tr>
<tr>
<td>Python</td>
<td>3.7.7</td>
</tr>
<tr>
<td>cmake</td>
<td>3.11.4</td>
</tr>
<tr>
<td>GCC</td>
<td>7.2.0</td>
</tr>
<tr>
<td>perl</td>
<td>5.8.8</td>
</tr>
</tbody>
</table>
<p>The following server and Intel <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> card are required to run the examples in this guide:</p>
<ol>
<li>Qualified Intel Xeon <sup>&reg;</sup> server see <a href="https://www.intel.com/content/www/us/en/products/details/fpga/platforms/pac/d5005/view.html">Qualified Servers</a>.</li>
<li>Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005 with root entry hash erased (Please contact Intel for root entry hash erase instructions).  The standard Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005 card is programmed to only allow the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> binary files signed by Intel to be loaded.  The root entry hash erase process will allow newly created, unsigned <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> binary files to be loaded.</li>
<li>Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005 installed in the qualified server following instructions in <a href="https://ofs.github.io/hw/d5005/user_guides/ug_qs_ofs_d5005/ug_qs_ofs_d5005/"><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Getting Started User Guide</a>.</li>
</ol>
<p>The steps included in this guide have been verified in the Dell R740 and HPE ProLiant DL380 Gen10 servers.</p>
<h2 id="2-high-level-description">2. High Level Description<a class="headerlink" href="#2-high-level-description" title="Permanent link">&para;</a></h2>
<p>The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> targets operation in the Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005 card.  The block diagram of the D5005 is shown below:</p>
<p><a class="glightbox" href="../images/d5005_Top_block_diagram.PNG" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Intel® FPGA PAC D5005" src="../images/d5005_Top_block_diagram.PNG" /></a></p>
<p>The key D5005 FPGA interfaces are:</p>
<ul>
<li>Host interface 
    - PCIe Gen3 x 16</li>
<li>Network interface<ul>
<li>2 - QSFP28 cages</li>
<li>Current <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> supports 1 x 10 GbE, other interfaces can be created  </li>
</ul>
</li>
<li>External Memory<ul>
<li>2 or 4 channels of DDR4-2400 to RDIMM modules</li>
<li>RDIMM modules =  8GB organized as 1 Gb X 72</li>
</ul>
</li>
<li>Board Management<ul>
<li>SPI interface</li>
<li>FPGA configuration</li>
</ul>
</li>
</ul>
<h3 id="21-fpga-interface-manager-overview">2.1. FPGA Interface Manager Overview<a class="headerlink" href="#21-fpga-interface-manager-overview" title="Permanent link">&para;</a></h3>
<p>The FPGA Interface Manager architecture is shown in the below diagram:</p>
<p><a class="glightbox" href="../images/Top_Rel1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="OFS FIM Top Level Block Diagram" src="../images/Top_Rel1.png" /></a></p>
<p>The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> consists of the following components
   - PCIe Subsystem
   - Memory Subsystem
   - HSSI Subsystem
   - Platform Management Component Intercommunications (PMCI) 
   - Board Peripheral Fabric (BPF) 
   - <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Peripheral Fabric (APF)
   - Port Gasket
   - AXI-S PF/VF Demux/Mux
   - Host Exerciser Modules - HE-MEM, HE-LB, HE-HSSI
   - FPGA Management Engine (<abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr>)</p>
<h3 id="22-fim-fpga-resource-usage">2.2. <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> FPGA Resource Usage<a class="headerlink" href="#22-fim-fpga-resource-usage" title="Permanent link">&para;</a></h3>
<p>The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> uses a small portion of the available FPGA resources.  The table below shows resource usage for a base <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> built with 2 channels of external memory, a small <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> instantiated that has host CSR read/write, external memory test and Ethernet test functionality.</p>
<p><br></p>
<table>
<thead>
<tr>
<th>Entity</th>
<th>ALMs Used</th>
<th>% ALMS Used</th>
<th>M20Ks</th>
<th>% M20Ks used</th>
<th>DSP Blocks</th>
<th>Pins</th>
<th>IOPLLs</th>
</tr>
</thead>
<tbody>
<tr>
<td>OFS_top</td>
<td>125009.4</td>
<td>13.0%</td>
<td>661</td>
<td>5.4%</td>
<td>0</td>
<td>630</td>
<td>15</td>
</tr>
<tr>
<td>afu_top</td>
<td>70522.7</td>
<td>7.0%</td>
<td>228</td>
<td>2.4%</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>auto_fab_0</td>
<td>1305.7</td>
<td>0.0%</td>
<td>9</td>
<td>0.1%</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>bpf_rsv_5_slv</td>
<td>0.6</td>
<td>0.0%</td>
<td>0</td>
<td>0.0%</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>bpf_rsv_6_slv</td>
<td>0.6</td>
<td>0.0%</td>
<td>0</td>
<td>0.0%</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>bpf_rsv_7_slv</td>
<td>0.4</td>
<td>0.0%</td>
<td>0</td>
<td>0.0%</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>bpf</td>
<td>241.9</td>
<td>0.0%</td>
<td>0</td>
<td>0.0%</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>emif_top_inst</td>
<td>10508.6</td>
<td>1.0%</td>
<td>0</td>
<td>0.0%</td>
<td>0</td>
<td>0</td>
<td>12</td>
</tr>
<tr>
<td>eth_ac_wrapper</td>
<td>6024.8</td>
<td>0.5%</td>
<td>9</td>
<td>0.1%</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>fme_top</td>
<td>615.5</td>
<td>0.2%</td>
<td>7</td>
<td>0.1%</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>pcie_wrapper</td>
<td>35424.7</td>
<td>3.5%</td>
<td>348</td>
<td>2.9%</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>pmci_top</td>
<td>318.5</td>
<td>0.1%</td>
<td>0</td>
<td>0.0%</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>rst_ctrl</td>
<td>40.2</td>
<td>0.0%</td>
<td>0</td>
<td>0.0%</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>sys_pll</td>
<td>0.5</td>
<td>0.0%</td>
<td>0</td>
<td>0.0%</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Total ALMS</td>
<td>933,120</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Total M20Ks</td>
<td>11,721</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Summary</th>
<th>FPGA Resource Utilization</th>
</tr>
</thead>
<tbody>
<tr>
<td>Logic utilization (in ALMs)</td>
<td>124,092 / 933,120 ( 13 % )</td>
</tr>
<tr>
<td>Total dedicated logic registers</td>
<td>282822</td>
</tr>
<tr>
<td>Total pins</td>
<td>630 / 912 ( 69 % )</td>
</tr>
<tr>
<td>Total block memory bits</td>
<td>3,425,120 / 240,046,080 ( 1 % )</td>
</tr>
<tr>
<td>Total RAM Blocks</td>
<td>661 / 11,721 ( 6 % )</td>
</tr>
<tr>
<td>Total DSP Blocks</td>
<td>0 / 5,760 ( 0 % )</td>
</tr>
<tr>
<td>Total eSRAMs</td>
<td>0 / 75 ( 0 % )</td>
</tr>
<tr>
<td>Total HSSI P-Tiles</td>
<td>17 / 48 ( 35 % )</td>
</tr>
<tr>
<td>Total HSSI E-Tile Channels</td>
<td>17 / 48 ( 35 % )</td>
</tr>
<tr>
<td>Total HSSI HPS</td>
<td>0 / 1 ( 0 % )</td>
</tr>
<tr>
<td>Total HSSI EHIPs</td>
<td>0 / 2 ( 0 % )</td>
</tr>
<tr>
<td>Total PLLs</td>
<td>36 / 104 ( 35 % )</td>
</tr>
</tbody>
</table>
<h3 id="23-ofs-directory-structure">2.3. <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Directory Structure<a class="headerlink" href="#23-ofs-directory-structure" title="Permanent link">&para;</a></h3>
<p>The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Git <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> repository ofs-d5005 directory structure is shown below:</p>
<p><br></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>├──<span class="w"> </span>eval_script
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="p">|</span><span class="w">   </span>├──<span class="w"> </span>ofs_d5005_eval.sh
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">|</span><span class="w">   </span>└──<span class="w"> </span>README_ofs_d5005_eval.txt
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>├──<span class="w"> </span>ipss
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>│<span class="w">   </span>├──<span class="w"> </span>hssi
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">|</span><span class="w">   </span>├──<span class="w"> </span>mem
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">|</span><span class="w">   </span>├──<span class="w"> </span>pcie
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">|</span><span class="w">   </span>├──<span class="w"> </span>pmci
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">|</span><span class="w">   </span>├──<span class="w"> </span>spi
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="p">|</span><span class="w">   </span>└──<span class="w"> </span>README.md
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>├──<span class="w"> </span>license
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>│<span class="w">   </span>└──<span class="w"> </span>quartus-0.0-0.01iofs-linux.run
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>├──<span class="w"> </span>ofs-common
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="p">|</span><span class="w">   </span>├──<span class="w"> </span>scripts
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="p">|</span><span class="w">   </span>├──<span class="w"> </span>src
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="p">|</span><span class="w">   </span>├──<span class="w"> </span>verification
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="p">|</span><span class="w">   </span>├──<span class="w"> </span>LICENSE.txt
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="p">|</span><span class="w">   </span>└──<span class="w"> </span>README.md
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>├──<span class="w"> </span>sim
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="p">|</span><span class="w">   </span>├──<span class="w"> </span>bfm
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="p">|</span><span class="w">   </span>├──<span class="w"> </span>rp_bfm
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>│<span class="w">   </span>├──<span class="w"> </span>scripts
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="p">|</span><span class="w">   </span>├──<span class="w"> </span>unit_test<span class="w"> </span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>│<span class="w">   </span>└──<span class="w"> </span>readme.txt
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>├──<span class="w"> </span>src
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>│<span class="w">   </span>├──<span class="w"> </span>afu_top
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>│<span class="w">   </span>├──<span class="w"> </span>includes
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>│<span class="w">   </span>├──<span class="w"> </span>pd_qsys
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>│<span class="w">   </span>├──<span class="w"> </span>README.md
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>│<span class="w">   </span>└──<span class="w"> </span>top
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>├──<span class="w"> </span>syn
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>│<span class="w">   </span>├──<span class="w"> </span>scripts
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>│<span class="w">   </span>├──<span class="w"> </span>setup
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>│<span class="w">   </span>├──<span class="w"> </span>syn_top
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>│<span class="w">   </span>├──<span class="w"> </span>readme.txt
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>│<span class="w">   </span>└──<span class="w"> </span>README
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>├──<span class="w"> </span>LICENSE.txt
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>└──<span class="w"> </span>README.md
</code></pre></div>
<p>The contents of each directory are described below:</p>
<p><strong>Eval Script</strong> - Contains scripts for evaluation of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for D5005 including compiling <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>/<abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> from source, unit level test. Also includes resources to report and setup D5005 development environment</p>
<p><strong>ipss</strong> - Contains the code and supporting files that define or set up the IP subsystems (HSSI, PCIe, memory, PMCI, SPI, etc...) contained in the D5005 FPGA Interface Manager (<abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>).   </p>
<p><strong>license</strong> - License file for the Low Latency 10Gbps Ethernet MAC (6AF7 0119) IP core.</p>
<p><strong>ofs-common</strong> - This directory contains resources that may be used across the board-specific repositories. This directory is referenced via a link within each of the FPGA-specific repositories.</p>
<p><strong>sim</strong> - Contains the testbenches and supporting code for all the unit test simulations. 
   - Bus Functional Model code is contained here.
   - Scripts are included for automating a myriad of tasks.
   - All of the individual unit tests and their supporting code is also located here.</p>
<p><strong>src</strong> - SystemVerilog source and script files<br />
   - Contains all of the structural and behavioral code for the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.
   - Scripts for generating the AXI buses for module interconnect.
   - Top-level RTL for synthesis is located in this directory.
   - Accelerated Functional Unit (<abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>) infrastructure code is contained in this directory.</p>
<p><strong>syn</strong> - This directory contains all of the scripts, settings, and setup files for running synthesis on the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<h2 id="3-description-of-sub-systems">3. Description of Sub-Systems<a class="headerlink" href="#3-description-of-sub-systems" title="Permanent link">&para;</a></h2>
<h3 id="31-host-control-and-data-flow">3.1. Host Control and Data Flow<a class="headerlink" href="#31-host-control-and-data-flow" title="Permanent link">&para;</a></h3>
<p>The host control and data flow are shown in the diagram below:</p>
<p><a class="glightbox" href="../images/FIM_data_flow.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="OFS FIM Top Level Block Diagram" src="../images/FIM_data_flow.png" /></a></p>
<p>The control and data flow is composed of the following:</p>
<ul>
<li>Host Interface Adapter (PCIe)</li>
<li>Low Performance Peripherals<ul>
<li>Slow speed peripherals (I2C, Smbus, etc)</li>
<li>Management peripherals (<abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr>)</li>
</ul>
</li>
</ul>
<ul>
<li>High Performance Peripherals<ul>
<li>Memory peripherals</li>
<li>Acceleration Function peripherals</li>
<li>HPS Peripheral</li>
</ul>
</li>
</ul>
<ul>
<li>Fabrics<ul>
<li>Peripheral Fabric (multi drop)</li>
<li><abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Streaming fabric (point to point)</li>
</ul>
</li>
</ul>
<p>Peripherals are connected to one another using AXI:</p>
<ul>
<li>Via the peripheral fabric (AXI4-Lite, multi drop)</li>
<li>Via the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> streaming fabric (AXI-S, point to point)</li>
</ul>
<p>Peripherals are presented to software as:</p>
<ul>
<li><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> managed peripherals that implement DFH CSR structure.  </li>
<li>Native driver managed peripherals (i.e. Exposed via an independent PF, VF)</li>
</ul>
<p>The peripherals connected to the peripheral fabric are primarily Intel OPAE managed resources, whereas the peripherals connected to the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> are “primarily” managed by native OS drivers. The word “primarily” is used since the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> is not mandated to expose all its peripherals to Intel OPAE. It can be connected to the peripheral fabric, but can choose to expose only a subset of its capability to Intel OPAE.</p>
<p><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> uses a defined set of CSRs to expose the functionality of the FPGA to the host software.  These registers are described in <a href="https://ofs.github.io/hw/d5005/reference_manuals/ofs_fim/mnl_fim_ofs_d5005/#7-mmio-regions">Open FPGA Stack Reference Manual - <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> Regions section</a>.</p>
<p>If you make changes to the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that affect the software operation, then <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> provides a mechanism to communicate that information to the proper software driver.  The <a href="https://ofs.github.io/hw/d5005/reference_manuals/ofs_fim/mnl_fim_ofs_d5005/#721-device-feature-header-dfh-structure">Device Feature Header (DFH) structure</a> provides a mechanism to maintain compatibility with OPAE software.  Please see <a href="https://github.com/ofs/linux-dfl/blob/fpga-ofs-dev/Documentation/fpga/dfl.rst#fpga-device-feature-list-dfl-framework-overview">FPGA Device Feature List (<abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr>) Framework Overview</a> for an excellent description of <abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr> operation from the driver perspective.</p>
<p>When you are planning your address space for your <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> updates, please be aware that the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> targeting Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005, 256KB of <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> region is allocated for external <abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr> features and 128kB of <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> region is allocated for external port features. Each external feature must implement a feature DFH, and the DFH needs to be placed at 4KB boundary. The last feature in the external feature list must have the EOL bit in its DFH set to 1 to mark the end of external feature list.  Since the FPGA address space is limited, consider using an indirect addressing scheme to conserve address space.</p>
<h2 id="4-fim-development-flow">4. <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Development Flow<a class="headerlink" href="#4-fim-development-flow" title="Permanent link">&para;</a></h2>
<p><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> provides a framework of FPGA synthesizable code, simulation environment, and synthesis/simulation scripts.  <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> designers can take the provided code and scripts and modify existing code or add new code to meet their specific product requirements.</p>
<p><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> development for a new acceleration card consists of the following steps:</p>
<ol>
<li>Installation of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> and familiarization with scripts and source code</li>
<li>Development of high-level block diagram with your specific functionality<ol>
<li>Determination of requirements and key performance metrics</li>
<li>Selection of IP cores</li>
<li>Selection of FPGA device</li>
<li>Software memory map</li>
</ol>
</li>
<li>Selection and implementation of <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Physical interfaces including:<ol>
<li>External clock sources and creation of internal PLL clocks</li>
<li>General I/O</li>
<li>Transceivers</li>
<li>External memories</li>
<li>FPGA programming methodology</li>
</ol>
</li>
<li>Device physical implementation<ol>
<li>FPGA device pin assignment</li>
<li>Inclusion of logic lock regions</li>
<li>Creation of timing constraints</li>
<li>Create Quartus <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> test project and validate:<ol>
<li>Placement</li>
<li>Timing constraints</li>
<li>Build script process</li>
<li>Review test <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> FPGA resource usage</li>
</ol>
</li>
</ol>
</li>
<li>Select <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> to <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> interfaces and development of <abbr title="Platform Interface Manager, An interface manager that comprises two components: a configurable platform specific interface for board developers and a collection of shims that AFU developers can use to handle clock crossing, response sorting, buffering and different protocols.">PIM</abbr></li>
<li><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design implementation<ol>
<li>RTL coding</li>
<li>IP instantiation</li>
<li>Development of test <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> to validate <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></li>
<li>Unit and device level simulation</li>
<li>Timing constraints and build scripts</li>
<li>Timing closure and build validation</li>
</ol>
</li>
<li>Creation of <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> documentation to support <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> development and synthesis</li>
<li>Software Device Feature discovery</li>
<li>Hardware/software integration, validation and debugging</li>
<li>High volume production preparation</li>
</ol>
<p>The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> developer works closely with the hardware design of the target board, software development and system validation.</p>
<p>Understanding how the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> developer utilizes the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> is important for <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> development success.  Please read <a href="https://ofs.github.io/hw/d5005/dev_guides/afu_dev/ug_dev_afu_d5005/"><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> Development Guide</a> for a detailed description of <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> development.</p>
<h3 id="41-installation-of-ofs">4.1. Installation of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr><a class="headerlink" href="#41-installation-of-ofs" title="Permanent link">&para;</a></h3>
<p>In this section you set up a development machine for compiling the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. These steps are separate from the setup for a deployment machine where the FPGA acceleration card is installed.  Typically, FPGA development and deployment work is performed on separate machines, however, both development and deployment can be performed on the same server if desired.  Please see <a href="https://ofs.github.io/hw/d5005/user_guides/ug_qs_ofs_d5005/ug_qs_ofs_d5005/"><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Getting Started User Guide</a> for instructions on installing software for deployment of your FPGA <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>, <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> and software application on a server.  </p>
<p>Building the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> requires the development machine to have at least 64 GB of RAM.</p>
<p>The following is a summary of the steps to set up for <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> development:</p>
<ol>
<li>Install Quartus Prime Pro 23.1 Linux and setup environment</li>
<li>Clone the github <code>ofs-d5005</code> repository</li>
<li>Test installation by building the provided <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></li>
</ol>
<p>Intel Quartus Prime Pro version 23.1 is the currently verified version of Quartus used for building the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> images for this release.  Porting to newer versions of Quartus may be performed by developers.  Download Quartus Prime Pro Linux version 23.1 from <a href="https://www.intel.com/content/www/us/en/software-kit/746666/intel-quartus-prime-pro-edition-design-software-version-22-3-for-linux.html">Intel® Quartus® Prime Pro Edition Linux</a>.</p>
<p>After running the Quartus Prime Pro installer, set the PATH environment variable to make utilities <code>quartus</code>, <code>jtagconfig</code>, and <code>quartus_pgm</code> discoverable. Edit your bashrc file <code>~/.bashrc</code> to add the following line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:&lt;Quartus<span class="w"> </span>install<span class="w"> </span>directory&gt;/quartus/bin
</code></pre></div>
<p>For example, if the Quartus install directory is /home/intelFPGA_pro/23.1 then the new line is:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/home/intelFPGA_pro/23.1/quartus/bin
</code></pre></div>
<p>Verify, Quartus is discoverable by opening a new shell:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>which<span class="w"> </span>quartus
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c1">## Output</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>/home/intelFPGA_pro/23.1/quartus/bin/quartus
</code></pre></div>
Note, for some Linux distributions such as RHEL 8.2, Quartus requires installation of the following libraries:
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>libnsl
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>ncurses-compat-libs
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>sudo<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/usr/bin/python3<span class="w"> </span>/usr/bin/python
</code></pre></div></p>
<p>You will need to obtain a license for Intel Quartus Prime Pro version 23.1 to compile the design.  This license is obtained from Intel.  Additionally, <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> for Intel® Stratix 10® FPGA requires a license for the Low Latency 10Gbps Ethernet MAC (6AF7 0119) IP core.  This license is required to generate a programming file using the provided <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> source code.  The Low Latency 10Gbps Ethernet MAC (6AF7 0119) IP core license patch installer is provided in the ofs-d5005 git repository in the /license directory.  After cloning the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> release in step 4 below, you can install this IP license.  </p>
<ol>
<li>Install git and install git lfs to extract large files within the repository that are compressed with git lfs.  Please note, for proper operation of files retrieved from <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> repository, you will require git lfs. </li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>git
</code></pre></div>
<h4 id="install-git-lfs">Install git lfs:<a class="headerlink" href="#install-git-lfs" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>https://packagecloud.io/install/repositories/github/git-lfs/script.rpm.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>git-lfs
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>git<span class="w"> </span>lfs<span class="w"> </span>install
</code></pre></div>
<ol>
<li>Retrieve <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> repositories:</li>
</ol>
<p>The <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> source code is included in the GitHub repository. Create a new directory to use as a clean starting point to store the retrieved files.  </p>
<ol>
<li>Navigate to location for storage of <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> source, create the top-level source directory and clone <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> repositories.</li>
</ol>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>mkdir<span class="w"> </span>OFS_fim_build_root
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nb">cd</span><span class="w"> </span>OFS_fim_build_root
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OFS_BUILD_ROOT</span><span class="o">=</span><span class="nv">$PWD</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>git<span class="w"> </span>clone<span class="w"> </span>--recurse-submodules<span class="w">  </span>https://github.com/OFS/ofs-d5005.git
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="nb">cd</span><span class="w"> </span>ofs-d5005
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>git<span class="w"> </span>checkout<span class="w"> </span>tags/ofs-2023.1-1
</code></pre></div>
Verify proper tag is selected:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>git<span class="w"> </span>describe<span class="w"> </span>--tags
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>ofs-2023.1-1
</code></pre></div>
2. Install the Low Latency 10Gbps Ethernet MAC (6AF7 0119) IP license by running provided license installer.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nb">cd</span><span class="w"> </span>license
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>chmod<span class="w"> </span>+x<span class="w"> </span>quartus-0.0-0.01iofs-linux.run
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>sudo<span class="w"> </span>./quartus-0.0-0.01iofs-linux.run
</code></pre></div>
<ol>
<li>Verify patch installed
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>quartus_sh<span class="w"> </span>--version
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="c1">##Output</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>Quartus<span class="w"> </span>Prime<span class="w"> </span>Shell
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>Version<span class="w"> </span><span class="m">23</span>.1<span class="w"> </span>Pro<span class="w"> </span>Edition
</code></pre></div></li>
</ol>
<h3 id="42-compiling-ofs-fim">4.2. Compiling <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr><a class="headerlink" href="#42-compiling-ofs-fim" title="Permanent link">&para;</a></h3>
<p><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> provides a build script with the following FPGA image creation options:</p>
<ul>
<li>Flat compile which combines the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> into one FPGA image that is loaded into the entire FPGA device</li>
</ul>
<ul>
<li>A <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> compile which creates a FPGA image consisting of the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that is loaded into the static region of the FPGA and a default <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> that is loaded into dynamic region. Additional AFUs maybe loaded into the dynamic region using partial reconfiguration.</li>
</ul>
<p>The build scripts included with <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> are verified to run in a bash shell. Other shells have not been tested. Each build script step will take several hours to completes, Please note, building directly in Quartus GUI is not supported - you must build with the provided scripts.</p>
<p>The following sections describe how to set up the environment and build the provided <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr>. Follow these steps as a tutorial to learn the build flow. You will use this environment and build scripts for the creation of your specialized <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<h4 id="421-setting-up-required-environment-variables">4.2.1. Setting Up Required Environment Variables<a class="headerlink" href="#421-setting-up-required-environment-variables" title="Permanent link">&para;</a></h4>
<p>Set required environment variables as shown below. These environment variables must be set prior to simulation or compilation tasks so creating a simple script to set these variables saves time.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_BUILD_ROOT</span>/ofs-d5005
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OFS_ROOTDIR</span><span class="o">=</span><span class="nv">$PWD</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_HOME</span><span class="o">=</span>&lt;user_path&gt;/intelFPGA_pro/23.1/quartus
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_ROOTDIR</span><span class="o">=</span><span class="nv">$QUARTUS_HOME</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="c1">##   *Note, OFS_ROOTDIR is the directory where you cloned the repo, e.g. /home/MyProject/ofs-d5005 *</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">WORKDIR</span><span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="nb">export</span><span class="w"> </span><span class="nv">VERDIR</span><span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>/verification
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_HOME</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="c1">##   *Note, QUARTUS_ROOTDIR is your Quartus installation directory, e.g. $QUARTUS_ROOTDIR/bin contains Quartus executuable*</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_INSTALL_DIR</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="nb">export</span><span class="w"> </span><span class="nv">IMPORT_IP_ROOTDIR</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/../ip
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="nb">export</span><span class="w"> </span><span class="nv">IP_ROOTDIR</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/../ip
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OPAE_SDK_REPO_BRANCH</span><span class="o">=</span>release/2.5.0
</code></pre></div>
<h4 id="422-compiling">4.2.2. Compiling<a class="headerlink" href="#422-compiling" title="Permanent link">&para;</a></h4>
<p>The usage of the compile build script is shown below:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span><span class="o">[</span>-p<span class="o">]</span><span class="w"> </span>target_configuration<span class="w"> </span>work_dir<span class="w"> </span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>Usage:<span class="w"> </span>ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span><span class="o">[</span>-k<span class="o">]</span><span class="w"> </span><span class="o">[</span>-p<span class="o">]</span><span class="w"> </span>&lt;build<span class="w"> </span>target&gt;<span class="w"> </span><span class="o">[</span>&lt;work<span class="w"> </span>dir<span class="w"> </span>name&gt;<span class="o">]</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">  </span>Build<span class="w"> </span>a<span class="w"> </span>FIM<span class="w"> </span>instance<span class="w"> </span>specified<span class="w"> </span>by<span class="w"> </span>&lt;build<span class="w"> </span>target&gt;.<span class="w"> </span>The<span class="w"> </span>target<span class="w"> </span>names<span class="w"> </span>an<span class="w"> </span>FPGA<span class="w"> </span>architecture,<span class="w"> </span>board<span class="w"> </span>and<span class="w"> </span>configuration.
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">  </span>The<span class="w"> </span>FIM<span class="w"> </span>is<span class="w"> </span>built<span class="w"> </span><span class="k">in</span><span class="w"> </span>&lt;work<span class="w"> </span>dir<span class="w"> </span>name&gt;.<span class="w"> </span>If<span class="w"> </span>not<span class="w"> </span>specified,<span class="w"> </span>the<span class="w"> </span>target<span class="w"> </span>is<span class="w"> </span><span class="si">${</span><span class="nv">OFS_ROOTDIR</span><span class="si">}</span>/work.
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">  </span>The<span class="w"> </span>-k<span class="w"> </span>option<span class="w"> </span>preserves<span class="w"> </span>and<span class="w"> </span>rebuilds<span class="w"> </span>within<span class="w"> </span>an<span class="w"> </span>existing<span class="w"> </span>work<span class="w"> </span>tree<span class="w"> </span>instead<span class="w"> </span>of<span class="w"> </span>overwriting<span class="w"> </span>it.
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">  </span>When<span class="w"> </span>-p<span class="w"> </span>is<span class="w"> </span>set,<span class="w"> </span><span class="k">if</span><span class="w"> </span>the<span class="w"> </span>FIM<span class="w"> </span>is<span class="w"> </span>able<span class="w"> </span><span class="k">then</span><span class="w"> </span>a<span class="w"> </span>partial<span class="w"> </span>reconfiguration<span class="w"> </span>template<span class="w"> </span>tree<span class="w"> </span>is<span class="w"> </span>generated<span class="w"> </span>at<span class="w"> </span>the<span class="w"> </span>end<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>FIM<span class="w"> </span>build.<span class="w"> </span>The<span class="w"> </span>PR<span class="w"> </span>template<span class="w"> </span>tree<span class="w"> </span>is<span class="w"> </span>located<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>top<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>work<span class="w"> </span>directory<span class="w"> </span>but<span class="w"> </span>is<span class="w"> </span>relocatable
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="w">  </span>and<span class="w"> </span>uses<span class="w"> </span>only<span class="w"> </span>relative<span class="w"> </span>paths.<span class="w"> </span>See<span class="w"> </span>ofs-common/scripts/common/syn/generate_pr_release.sh<span class="w"> </span><span class="k">for</span><span class="w"> </span>details.
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="w">  </span>The<span class="w"> </span>-e<span class="w"> </span>option<span class="w"> </span>runs<span class="w"> </span>only<span class="w"> </span>Quartus<span class="w"> </span>analysis<span class="w"> </span>and<span class="w"> </span>elaboration.
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="w">      </span>*<span class="w"> </span>target_configuration<span class="w"> </span>-<span class="w"> </span>Specifies<span class="w"> </span>the<span class="w"> </span>project<span class="w">  </span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="w">         </span>For<span class="w"> </span>example:<span class="w"> </span>d5005
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="w">      </span>*<span class="w"> </span>work_dir<span class="w"> </span>-<span class="w"> </span>Work<span class="w"> </span>Directory<span class="w"> </span><span class="k">for</span><span class="w"> </span>this<span class="w"> </span>build<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>form<span class="w"> </span>a<span class="w"> </span>directory<span class="w"> </span>name.<span class="w"> </span>It<span class="w"> </span>is<span class="w"> </span>created<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>&lt;<span class="nb">local</span><span class="w"> </span>repo<span class="w"> </span>directory&gt;/ofs-d5005/&lt;work_dir&gt;<span class="w"> </span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="w">          </span>-<span class="w"> </span>NOTE:<span class="w"> </span>The<span class="w"> </span>directory<span class="w"> </span>name<span class="w"> </span>must<span class="w"> </span>start<span class="w"> </span>with<span class="w"> </span><span class="s2">&quot;work&quot;</span>.<span class="w">  </span>If<span class="w"> </span>the<span class="w"> </span>work<span class="w"> </span>directory<span class="w"> </span>exists,<span class="w"> </span><span class="k">then</span><span class="w"> </span>the<span class="w"> </span>script<span class="w"> </span>stops<span class="w"> </span>and<span class="w"> </span>asks<span class="w"> </span><span class="k">if</span><span class="w"> </span>you<span class="w"> </span>want<span class="w"> </span>to<span class="w"> </span>overwrite<span class="w"> </span>the<span class="w"> </span>directory.
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="w">            </span>-<span class="w"> </span>e.g.
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="w">                </span>-<span class="w"> </span>ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>d5005<span class="w"> </span>work_d5005
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="w">                </span>work<span class="w"> </span>directory<span class="w"> </span>as<span class="w"> </span>a<span class="w"> </span>name<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>created<span class="w"> </span><span class="k">in</span><span class="w"> </span>&lt;<span class="nb">local</span><span class="w"> </span>repo<span class="w"> </span>directory&gt;/ofs-d5005/work_d5005
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a>
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a>
<a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a><span class="w">                </span>The<span class="w"> </span>obmission<span class="w"> </span>of<span class="w"> </span>&lt;work_dir&gt;<span class="w"> </span>results<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span>default<span class="w"> </span>work<span class="w"> </span>directory<span class="w"> </span><span class="o">(</span>&lt;<span class="nb">local</span><span class="w"> </span>repo<span class="w">  </span>directory&gt;/ofs-d5005/work<span class="o">)</span>
<a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a>
<a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a><span class="w">        </span>-<span class="w"> </span>compile<span class="w"> </span>reports<span class="w"> </span>and<span class="w"> </span>artifacts<span class="w"> </span><span class="o">(</span>.rpt,<span class="w"> </span>.sof,<span class="w"> </span>etc<span class="o">)</span><span class="w"> </span>are<span class="w"> </span>stored<span class="w"> </span><span class="k">in</span><span class="w"> </span>&lt;work_dir&gt;/syn/syn_top/output_files
<a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a>
<a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a><span class="w">        </span>-<span class="w"> </span>There<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>log<span class="w"> </span>file<span class="w"> </span>created<span class="w"> </span><span class="k">in</span><span class="w"> </span>ofs-d5005<span class="w"> </span>directory.<span class="w">  </span>
<a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a><span class="w">        </span>-<span class="w"> </span><span class="o">[</span>-p<span class="o">]</span><span class="w">  </span>Optional<span class="w"> </span>switch<span class="w"> </span><span class="k">for</span><span class="w"> </span>creation<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>relocatable<span class="w"> </span>PR<span class="w"> </span>build<span class="w"> </span>tree<span class="w"> </span>supporting<span class="w"> </span>the<span class="w"> </span>creation<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>PR-able<span class="w"> </span>AFU<span class="w"> </span>workload.<span class="w">   </span>
<a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a><span class="w">        </span>The<span class="w"> </span><span class="s2">&quot;-p&quot;</span><span class="w"> </span>switch<span class="w"> </span>invokes<span class="w"> </span>generate_pr_release.sh<span class="w"> </span>at<span class="w"> </span>the<span class="w"> </span>end<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>FIM<span class="w"> </span>build<span class="w"> </span>and<span class="w"> </span>writes<span class="w"> </span>the<span class="w"> </span>PR<span class="w"> </span>build<span class="w"> </span>tree<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>top<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>work<span class="w"> </span>directory.<span class="w">  </span>More<span class="w"> </span>information<span class="w"> </span>on<span class="w"> </span>this<span class="w"> </span>option<span class="w"> </span>is<span class="w"> </span>provided<span class="w"> </span>below.<span class="w"> </span>
</code></pre></div>
In the next example, you will build the provided example design using a flat, non-<abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> build flow.</p>
<p>Build the provided base example design:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_BUILD_ROOT</span>/ofs-d5005
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>d5005<span class="w"> </span>work_d5005
</code></pre></div>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="w">    </span>...<span class="w"> </span>build<span class="w"> </span>takes<span class="w"> </span>~5<span class="w"> </span>hours<span class="w"> </span>to<span class="w"> </span><span class="nb">complete</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>Compile<span class="w"> </span>work<span class="w"> </span>directory:<span class="w">     </span>&lt;<span class="nv">$OFS_BUILD_ROOT</span>&gt;/work_d5005/syn/syn_top
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>Compile<span class="w"> </span>artifact<span class="w"> </span>directory:<span class="w"> </span>&lt;<span class="nv">$OFS_BUILD_ROOT</span>&gt;/work_d5005/syn/syn_top/output_files
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>***********************************
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>***
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>***<span class="w">        </span>OFS_PROJECT:<span class="w"> </span>d5005
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>***<span class="w">        </span>Q_PROJECT:<span class="w">  </span>d5005
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>***<span class="w">        </span>Q_REVISION:<span class="w"> </span>d5005
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>***<span class="w">        </span>SEED:<span class="w"> </span><span class="m">03</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>***<span class="w">        </span>Build<span class="w"> </span>Complete
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>***<span class="w">        </span>Timing<span class="w"> </span>Passed!
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>***
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>***********************************
</code></pre></div>
The build script copies the ipss, sim, src and syn directories to the specified work directory and then these copied files are used in the Quartus compilation process.  Do not edit the files in the work directory, these files are copies of source files.</p>
<p>Some of the key files are described below:</p>
<p><work_dir>/syn/syn_top == 
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>├──<span class="w"> </span>syn_top<span class="w">                    </span>//<span class="w"> </span>D5005<span class="w"> </span>Quartus<span class="w"> </span>build<span class="w"> </span>area<span class="w"> </span>with<span class="w"> </span>Quartus<span class="w"> </span>files<span class="w"> </span>used<span class="w"> </span>this<span class="w"> </span>build
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>│<span class="w">  </span>├──<span class="w"> </span>d5005.ipregen.rpt<span class="w">       </span>//<span class="w"> </span>IP<span class="w"> </span>regeneration<span class="w"> </span>report<span class="w"> </span>states<span class="w"> </span>the<span class="w"> </span>output<span class="w"> </span>of<span class="w"> </span>IP<span class="w"> </span>upgrade
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>│<span class="w">  </span>├──<span class="w"> </span>d5005.qpf<span class="w">               </span>//<span class="w"> </span>Quartus<span class="w"> </span>Project<span class="w"> </span>File<span class="w"> </span><span class="o">(</span>qpf<span class="o">)</span><span class="w"> </span>mentions<span class="w"> </span>about<span class="w"> </span>Quartus<span class="w"> </span>version<span class="w"> </span>and<span class="w"> </span>project<span class="w"> </span>revision
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>│<span class="w">  </span>├──<span class="w"> </span>d5005.qsf<span class="w">               </span>//<span class="w"> </span>Quartus<span class="w"> </span>Settings<span class="w"> </span>File<span class="w"> </span><span class="o">(</span>qsf<span class="o">)</span><span class="w"> </span>lists<span class="w"> </span>current<span class="w"> </span>project<span class="w"> </span>settings<span class="w"> </span>and<span class="w"> </span>entity<span class="w"> </span>level<span class="w"> </span>assignments
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>│<span class="w">  </span>├──<span class="w"> </span>d5005.stp<span class="w">               </span>//<span class="w"> </span>Signal<span class="w"> </span>Tap<span class="w"> </span>file<span class="w"> </span>included<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>d5005.qsf.<span class="w"> </span>This<span class="w"> </span>file<span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>modified<span class="w"> </span>as<span class="w"> </span>required<span class="w"> </span><span class="k">if</span><span class="w"> </span>you<span class="w"> </span>need<span class="w"> </span>to<span class="w"> </span>add<span class="w"> </span>an<span class="w"> </span>Signal<span class="w"> </span>Tap<span class="w"> </span>instance
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>│<span class="w">  </span>├──<span class="w"> </span>fme_id.mif<span class="w">              </span>//<span class="w"> </span>the<span class="w"> </span>fme<span class="w"> </span>id<span class="w"> </span>hex<span class="w"> </span>value<span class="w"> </span>is<span class="w"> </span>stored<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span>mif<span class="w"> </span>file<span class="w"> </span>format
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>│<span class="w">  </span>├──<span class="w"> </span>Intel<span class="w"> </span>OFS_pr_afu.json<span class="w">        </span>//<span class="w"> </span>PR<span class="w"> </span>JSON<span class="w"> </span>file
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>│<span class="w">  </span>├──<span class="w"> </span>Intel<span class="w"> </span>OFS_pr_afu.qsf<span class="w">                </span>//<span class="w"> </span>PR<span class="w"> </span>AFU<span class="w"> </span>qsf<span class="w"> </span>file
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>│<span class="w">  </span>├──<span class="w"> </span>Intel<span class="w"> </span>OFS_pr_afu_sources.tcl<span class="w">        </span>//<span class="w"> </span>AFU<span class="w"> </span><span class="nb">source</span><span class="w"> </span>file<span class="w"> </span>list
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>│<span class="w">  </span>├──<span class="w"> </span>ip_upgrade_port_diff_reports<span class="w">   </span>//<span class="w"> </span>IP<span class="w"> </span>upgrade<span class="w"> </span>report<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>reference
</code></pre></div>
<work_dir>/syn/syn_top/output_files == Directory with build reports and FPGA programming files. </p>
<p>The programming files consist of the Quartus generated d5005.sof and d5005.pof.  The D5005 board hardware provides a 2 Gb flash device to store the FPGA programming files and a MAX10 <abbr title="Board Management Controller, Acts as the Root of Trust (RoT) on the Intel FPGA PAC platform. Supports features such as power sequence management and board monitoring through on-board sensors.">BMC</abbr> that reads this flash and programs the D5005 Intel® Stratix 10® FPGA FPGA. The syn/build_top.sh script runs script file syn/syn_top/build_flash/build_flash.s which takes the Quartus generated d5005.sof and creates binary files in the proper format to be loaded into the 2 Gb flash device.  You can also run build_flash.sh by yourself if needed.  The build_flash  script runs PACSign (if installed) to create an unsigned FPGA programming file that can be stored in the D5005 FPGA flash. Please note, if the D5005 has the root entry hash key loaded, then PACsign must be run with d5005_page1.bin as the input with the proper key to create an authenticated FPGA binary file.  Please see <a href="https://github.com/otcshare/intel-ofs-docs/blob/main/d5005/user_guides/%20ug_security_ofs_d5005/ug-pac-security-d5005.md">Security User Guide: Intel® Open FPGA Stack for Intel® Stratix 10® FPGA</a> for details on the security aspects of Intel® Open FPGA Stack.</p>
<p>The following table provides further detail on the generated bin files.</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>d5005.sof</td>
<td>This is the Quartus generated programming file created by Quartus synthesis and place and route.  This file can be used to programming the FPGA using a <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> programmer.  This file is used as the source file for the binary files used to program the FPGA flash.</td>
</tr>
<tr>
<td>d5005.bin</td>
<td>This is an intermediate raw binary image of the FPGA</td>
</tr>
<tr>
<td>d5005_page1.bin</td>
<td>This is the binary file created from input file, d5005.sof.  This file is used as the input file to the PACSign utility to generate <strong>d5005_page1_unsigned.bin</strong> binary image file.</td>
</tr>
<tr>
<td>d5005_page1_unsigned.bin</td>
<td>This is the unsigned PACSign output which can be programmed into the FPGA flash of an unsigned D5005 usign the <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> utility <strong>fpgasupdate</strong></td>
</tr>
<tr>
<td>mfg_d5005_reversed.bin</td>
<td>A special programming file for a third party programming device used in board manufacturing.  This file is typically not used.</td>
</tr>
</tbody>
</table>
<p>build/output_files/timing_report == Directory containing clocks report, failing paths and passing margin reports</p>
<h4 id="423-relocatable-pr-directory-tree">4.2.3. Relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> Directory Tree<a class="headerlink" href="#423-relocatable-pr-directory-tree" title="Permanent link">&para;</a></h4>
<p>If you are developing a <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> to be used by another team developing the <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> workload, scripts are provided that create a relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> directory tree. ODM and board developers will make use of this capability to enable a broad set of AFUs to be loaded on a board using <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr>.  The relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> directory contains the Quartus *.qdb file that goes the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.</p>
<p>The creation of the relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> directory tree requires a clone of the Intel Basic Building Blocks (<abbr title="Basic Building Block, Features within an AFU or part of an FPGA interface that can be reused across designs. These building blocks do not have stringent interface requirements like the FIM's AFU and host interface requires. All BBBs must have a (globally unique identifier) GUID.">BBB</abbr>) repository. The OFS_PLATFORM_AFU_BBB environment variable must point to the repository, for example.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_BUILD_ROOT</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OPAE/ofs-platform-afu-bbb
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="nb">cd</span><span class="w"> </span>ofs-platform-afu-bbb
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OFS_PLATFORM_AFU_BBB</span><span class="o">=</span><span class="nv">$PWD</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
</code></pre></div>
<p>You can create this relocatable <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> directory tree by either:</p>
<ul>
<li>Build <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> using /syn/build_top.sh followed by running./ofs-common/scripts/common/syn/generate_pr_release.sh</li>
<li>Build <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> and <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> using /syn/build_top.sh with optional -p switch included</li>
</ul>
<p>The generate_pr_release.sh has the following command structure:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>./ofs-common/scripts/common/syn/generate_pr_release.sh<span class="w"> </span>-t<span class="w"> </span>&lt;path<span class="w"> </span>to<span class="w"> </span>generated<span class="w"> </span>release<span class="w"> </span>tree&gt;<span class="w"> </span>*Board<span class="w"> </span>Build<span class="w"> </span>Target*<span class="w"> </span>&lt;work<span class="w"> </span>dir<span class="w"> </span>from<span class="w"> </span>build_top.sh&gt;
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>Where:
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>-t<span class="w"> </span>&lt;path<span class="w"> </span>to<span class="w"> </span>generated<span class="w"> </span>release<span class="w"> </span>tree&gt;<span class="w"> </span><span class="o">=</span><span class="w"> </span>location<span class="w"> </span><span class="k">for</span><span class="w"> </span>your<span class="w"> </span>relocatable<span class="w"> </span>PR<span class="w"> </span>directory<span class="w"> </span>tree
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>*Board<span class="w"> </span>Build<span class="w"> </span>Target*<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>name<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>board<span class="w"> </span>target/FIM<span class="w"> </span>e.g.<span class="w"> </span>d5005
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>&lt;work<span class="w"> </span>dir<span class="w"> </span>from<span class="w"> </span>build_top.sh&gt;<span class="w"> </span>
</code></pre></div>
Here is an example of running the generate_pr_release.sh script:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>ofs-common/scripts/common/syn/generate_pr_release.sh<span class="w"> </span>-t<span class="w"> </span>work_d5005/build_tree<span class="w"> </span>d5005<span class="w">  </span>work_d5005
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>**********************************
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>*********<span class="w"> </span>ENV<span class="w"> </span>SETUP<span class="w"> </span>**************
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>FIM<span class="w"> </span>Project:
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">  </span><span class="nv">OFS_PROJECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>d5005
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">  </span><span class="nv">OFS_FIM</span><span class="w">     </span><span class="o">=</span><span class="w"> </span>.
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">  </span><span class="nv">OFS_BOARD</span><span class="w">   </span><span class="o">=</span><span class="w"> </span>.
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">  </span><span class="nv">Q_PROJECT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span>d5005
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">  </span><span class="nv">Q_REVISION</span><span class="w">  </span><span class="o">=</span><span class="w"> </span>d5005
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="w">  </span>Fitter<span class="w"> </span><span class="nv">SEED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">03</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>FME<span class="w"> </span>id
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="w">  </span><span class="nv">BITSTREAM_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>04010002c7cab852
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="w">  </span><span class="nv">BITSTREAM_MD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0000000002204283</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>...
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>...
</code></pre></div>
The resulting relocatable build tree has the following structure:
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>.
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>├──<span class="w"> </span>bin
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>│<span class="w">   </span>├──<span class="w"> </span>afu_synth
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>│<span class="w">   </span>├──<span class="w"> </span>build_env_config
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>│<span class="w">   </span>├──<span class="w"> </span>run.sh<span class="w"> </span>-&gt;<span class="w"> </span>afu_synth
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>│<span class="w">   </span>└──<span class="w"> </span>update_pim
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>├──<span class="w"> </span>hw
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>│<span class="w">   </span>├──<span class="w"> </span>blue_bits
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>d5005_page1_unsigned.bin
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>d5005.sof<span class="w"> </span>-&gt;<span class="w"> </span>../lib/build/syn/syn_top/output_files/d5005.sof
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>│<span class="w">   </span>└──<span class="w"> </span>lib
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>│<span class="w">       </span>├──<span class="w"> </span>build
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>│<span class="w">       </span>├──<span class="w"> </span>fme-ifc-id.txt
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>│<span class="w">       </span>├──<span class="w"> </span>fme-platform-class.txt
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>│<span class="w">       </span>└──<span class="w"> </span>platform
</code></pre></div></p>
<p>This build tree can be moved to a different location and used for <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> development of a <abbr title="Partial Reconfiguration, The ability to dynamically reconfigure a portion of an FPGA while the remaining FPGA design continues to function. In the context of Intel FPGA PAC, a PR bitstream refers to an Intel FPGA PAC AFU. Refer to Partial Reconfiguration support page.">PR</abbr> capable <abbr title="Accelerator Functional Unit, Hardware Accelerator implemented in FPGA logic which offloads a computational operation for an application from the CPU to improve performance. Note: An AFU region is the part of the design where an AFU may reside. This AFU may or may not be a partial reconfiguration region">AFU</abbr> to be used with this board.</p>
<h4 id="424-unit-level-simulation">4.2.4. Unit Level Simulation<a class="headerlink" href="#424-unit-level-simulation" title="Permanent link">&para;</a></h4>
<p>Unit level simulation of key components is provided. These simulations provide verification of the following areas:</p>
<ul>
<li>HSSI</li>
<li>PCIe</li>
<li>External Memory</li>
<li><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> management</li>
</ul>
<p>These simulations use the Synopsys VCS simulator. Each simulation contains a readme file explaining how to run the simulation. Refer to <a href="https://github.com/OFS/otcshare/blob/main/hw/docs/d5005/user_guides/ug_sim_ofs_d5005/ug_sim_ofs_d5005.md">Simulation User Guide: Open FPGA Stack for Intel Intel® Stratix 10® FPGA</a>  for details of simulation examples. Your simulation shell requires Python, Quartus, and VCS to run.  To run a simulation of the dfh_walker that simulates host access to the internal DFH registers, perform the following steps:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>Before<span class="w"> </span>running<span class="w"> </span>unit<span class="w"> </span>simulation,<span class="w"> </span>you<span class="w"> </span>must<span class="w"> </span><span class="nb">set</span><span class="w"> </span>environment<span class="w"> </span>variables<span class="w"> </span>as<span class="w"> </span>described<span class="w"> </span>below:
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_BUILD_ROOT</span>/ofs-d5005
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OFS_ROOTDIR</span><span class="o">=</span><span class="nv">$PWD</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="c1">##   *Note, OFS_ROOTDIR is the directory where you cloned the repo, e.g. /home/MyProject/ofs-d5005 *</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">WORKDIR</span><span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">VERDIR</span><span class="o">=</span><span class="nv">$OFS_ROOTDIR</span>/verification
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_HOME</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="c1">##   *Note, QUARTUS_ROOTDIR is your Quartus installation directory, e.g. $QUARTUS_ROOTDIR/bin contains Quartus executuable*</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_INSTALL_DIR</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="nb">export</span><span class="w"> </span><span class="nv">IMPORT_IP_ROOTDIR</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/../ip
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="nb">export</span><span class="w"> </span><span class="nv">IP_ROOTDIR</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/../ip
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="nb">export</span><span class="w"> </span><span class="nv">OPAE_SDK_REPO_BRANCH</span><span class="o">=</span>release/2.5.0
</code></pre></div>
<p>To compile all IPs:</p>
<p>To Generate Simulation Files &amp; compile all IPs, run the following command:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/ofs-common/scripts/common/sim
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>sh<span class="w"> </span>gen_sim_files.sh<span class="w"> </span>d5005
</code></pre></div>
The RTL file list for unit_test is located here: $OFS_ROOTDIR/sim/scripts/rtl_comb.f</p>
<p>The IPs are generated here: </p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="nv">$OFS_ROOTDIR</span>/sim/scripts/qip_gen
</code></pre></div>
The IP simulation filelist is generated here: </p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="nv">$OFS_ROOTDIR</span>/sim/scripts/ip_flist.f
</code></pre></div>
Once the IPs are generated, they can be used for any unit test.</p>
<p>To run the simulation, run the following command:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/sim/unit_test/&lt;Unit<span class="w"> </span>Test<span class="w"> </span>Name&gt;/scripts
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>sh<span class="w"> </span>run_sim.sh<span class="w"> </span><span class="nv">VCS</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
Simulation files are located in the sim/unit_test/<test_name>/sim directory.</p>
<p>To view simulation waveform:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>/sim/unit_test/&lt;test_name&gt;/script/sim/unit_test/&lt;test_name&gt;/scripts/sim_vcs
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>dve<span class="w"> </span>-full64<span class="w"> </span>-vpd<span class="w"> </span>vcdplus.vpd<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<h5 id="4241-dfh-walking-unit-simulation-output">4.2.4.1. DFH Walking Unit Simulation Output<a class="headerlink" href="#4241-dfh-walking-unit-simulation-output" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>********************************************
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w"> </span>Running<span class="w"> </span>TEST<span class="o">(</span><span class="m">0</span><span class="o">)</span><span class="w"> </span>:<span class="w"> </span>test_fme_dfh_walking
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>********************************************
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00000000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x4000000010000000
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>FME_DFH
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x0<span class="o">)</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x4000000010000000<span class="o">)</span>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00001000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000020000001
<a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a>
<a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a>THERM_MNGM_DFH
<a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x1000<span class="o">)</span>
<a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000020000001<span class="o">)</span>
<a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00003000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a>
<a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000010000007
<a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a>
<a id="__codelineno-27-22" name="__codelineno-27-22" href="#__codelineno-27-22"></a>GLBL_PERF_DFH
<a id="__codelineno-27-23" name="__codelineno-27-23" href="#__codelineno-27-23"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x3000<span class="o">)</span>
<a id="__codelineno-27-24" name="__codelineno-27-24" href="#__codelineno-27-24"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000010000007<span class="o">)</span>
<a id="__codelineno-27-25" name="__codelineno-27-25" href="#__codelineno-27-25"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00004000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-27-26" name="__codelineno-27-26" href="#__codelineno-27-26"></a>
<a id="__codelineno-27-27" name="__codelineno-27-27" href="#__codelineno-27-27"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x30000000c0001004
<a id="__codelineno-27-28" name="__codelineno-27-28" href="#__codelineno-27-28"></a>
<a id="__codelineno-27-29" name="__codelineno-27-29" href="#__codelineno-27-29"></a>GLBL_ERROR_DFH
<a id="__codelineno-27-30" name="__codelineno-27-30" href="#__codelineno-27-30"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x4000<span class="o">)</span>
<a id="__codelineno-27-31" name="__codelineno-27-31" href="#__codelineno-27-31"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x30000000c0001004<span class="o">)</span>
<a id="__codelineno-27-32" name="__codelineno-27-32" href="#__codelineno-27-32"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00010000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-27-33" name="__codelineno-27-33" href="#__codelineno-27-33"></a>
<a id="__codelineno-27-34" name="__codelineno-27-34" href="#__codelineno-27-34"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x300000010000000e
<a id="__codelineno-27-35" name="__codelineno-27-35" href="#__codelineno-27-35"></a>
<a id="__codelineno-27-36" name="__codelineno-27-36" href="#__codelineno-27-36"></a>SPI_DFH
<a id="__codelineno-27-37" name="__codelineno-27-37" href="#__codelineno-27-37"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x10000<span class="o">)</span>
<a id="__codelineno-27-38" name="__codelineno-27-38" href="#__codelineno-27-38"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x300000010000000e<span class="o">)</span>
<a id="__codelineno-27-39" name="__codelineno-27-39" href="#__codelineno-27-39"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00020000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-27-40" name="__codelineno-27-40" href="#__codelineno-27-40"></a>
<a id="__codelineno-27-41" name="__codelineno-27-41" href="#__codelineno-27-41"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000100000020
<a id="__codelineno-27-42" name="__codelineno-27-42" href="#__codelineno-27-42"></a>
<a id="__codelineno-27-43" name="__codelineno-27-43" href="#__codelineno-27-43"></a>PCIE_DFH
<a id="__codelineno-27-44" name="__codelineno-27-44" href="#__codelineno-27-44"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x20000<span class="o">)</span>
<a id="__codelineno-27-45" name="__codelineno-27-45" href="#__codelineno-27-45"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000100000020<span class="o">)</span>
<a id="__codelineno-27-46" name="__codelineno-27-46" href="#__codelineno-27-46"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00030000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-27-47" name="__codelineno-27-47" href="#__codelineno-27-47"></a>
<a id="__codelineno-27-48" name="__codelineno-27-48" href="#__codelineno-27-48"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x300000010000100f
<a id="__codelineno-27-49" name="__codelineno-27-49" href="#__codelineno-27-49"></a>
<a id="__codelineno-27-50" name="__codelineno-27-50" href="#__codelineno-27-50"></a>HSSI_DFH
<a id="__codelineno-27-51" name="__codelineno-27-51" href="#__codelineno-27-51"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x30000<span class="o">)</span>
<a id="__codelineno-27-52" name="__codelineno-27-52" href="#__codelineno-27-52"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x300000010000100f<span class="o">)</span>
<a id="__codelineno-27-53" name="__codelineno-27-53" href="#__codelineno-27-53"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00040000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-27-54" name="__codelineno-27-54" href="#__codelineno-27-54"></a>
<a id="__codelineno-27-55" name="__codelineno-27-55" href="#__codelineno-27-55"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000500000009
<a id="__codelineno-27-56" name="__codelineno-27-56" href="#__codelineno-27-56"></a>
<a id="__codelineno-27-57" name="__codelineno-27-57" href="#__codelineno-27-57"></a>EMIF_DFH
<a id="__codelineno-27-58" name="__codelineno-27-58" href="#__codelineno-27-58"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x40000<span class="o">)</span>
<a id="__codelineno-27-59" name="__codelineno-27-59" href="#__codelineno-27-59"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000500000009<span class="o">)</span>
<a id="__codelineno-27-60" name="__codelineno-27-60" href="#__codelineno-27-60"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00090000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-27-61" name="__codelineno-27-61" href="#__codelineno-27-61"></a>
<a id="__codelineno-27-62" name="__codelineno-27-62" href="#__codelineno-27-62"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000010001005
<a id="__codelineno-27-63" name="__codelineno-27-63" href="#__codelineno-27-63"></a>
<a id="__codelineno-27-64" name="__codelineno-27-64" href="#__codelineno-27-64"></a>FME_PR_DFH
<a id="__codelineno-27-65" name="__codelineno-27-65" href="#__codelineno-27-65"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x90000<span class="o">)</span>
<a id="__codelineno-27-66" name="__codelineno-27-66" href="#__codelineno-27-66"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000010001005<span class="o">)</span>
<a id="__codelineno-27-67" name="__codelineno-27-67" href="#__codelineno-27-67"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00091000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-27-68" name="__codelineno-27-68" href="#__codelineno-27-68"></a>
<a id="__codelineno-27-69" name="__codelineno-27-69" href="#__codelineno-27-69"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x4000000010001001
<a id="__codelineno-27-70" name="__codelineno-27-70" href="#__codelineno-27-70"></a>
<a id="__codelineno-27-71" name="__codelineno-27-71" href="#__codelineno-27-71"></a>PORT_DFH
<a id="__codelineno-27-72" name="__codelineno-27-72" href="#__codelineno-27-72"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x91000<span class="o">)</span>
<a id="__codelineno-27-73" name="__codelineno-27-73" href="#__codelineno-27-73"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x4000000010001001<span class="o">)</span>
<a id="__codelineno-27-74" name="__codelineno-27-74" href="#__codelineno-27-74"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00092000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-27-75" name="__codelineno-27-75" href="#__codelineno-27-75"></a>
<a id="__codelineno-27-76" name="__codelineno-27-76" href="#__codelineno-27-76"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000010000014
<a id="__codelineno-27-77" name="__codelineno-27-77" href="#__codelineno-27-77"></a>
<a id="__codelineno-27-78" name="__codelineno-27-78" href="#__codelineno-27-78"></a>USER_CLOCK_DFH
<a id="__codelineno-27-79" name="__codelineno-27-79" href="#__codelineno-27-79"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x92000<span class="o">)</span>
<a id="__codelineno-27-80" name="__codelineno-27-80" href="#__codelineno-27-80"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000010000014<span class="o">)</span>
<a id="__codelineno-27-81" name="__codelineno-27-81" href="#__codelineno-27-81"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00093000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-27-82" name="__codelineno-27-82" href="#__codelineno-27-82"></a>
<a id="__codelineno-27-83" name="__codelineno-27-83" href="#__codelineno-27-83"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x30000000d0002013
<a id="__codelineno-27-84" name="__codelineno-27-84" href="#__codelineno-27-84"></a>
<a id="__codelineno-27-85" name="__codelineno-27-85" href="#__codelineno-27-85"></a>PORT_STP_DFH
<a id="__codelineno-27-86" name="__codelineno-27-86" href="#__codelineno-27-86"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x93000<span class="o">)</span>
<a id="__codelineno-27-87" name="__codelineno-27-87" href="#__codelineno-27-87"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x30000000d0002013<span class="o">)</span>
<a id="__codelineno-27-88" name="__codelineno-27-88" href="#__codelineno-27-88"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x000a0000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-27-89" name="__codelineno-27-89" href="#__codelineno-27-89"></a>
<a id="__codelineno-27-90" name="__codelineno-27-90" href="#__codelineno-27-90"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000010000002010
<a id="__codelineno-27-91" name="__codelineno-27-91" href="#__codelineno-27-91"></a>
<a id="__codelineno-27-92" name="__codelineno-27-92" href="#__codelineno-27-92"></a>AFU_INTF_DFH
<a id="__codelineno-27-93" name="__codelineno-27-93" href="#__codelineno-27-93"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0xa0000<span class="o">)</span>
<a id="__codelineno-27-94" name="__codelineno-27-94" href="#__codelineno-27-94"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000010000002010<span class="o">)</span>
<a id="__codelineno-27-95" name="__codelineno-27-95" href="#__codelineno-27-95"></a>MMIO<span class="w"> </span>error<span class="w"> </span>count<span class="w"> </span>matches:<span class="w"> </span>x
<a id="__codelineno-27-96" name="__codelineno-27-96" href="#__codelineno-27-96"></a>
<a id="__codelineno-27-97" name="__codelineno-27-97" href="#__codelineno-27-97"></a>Test<span class="w"> </span>status:<span class="w"> </span>OK
<a id="__codelineno-27-98" name="__codelineno-27-98" href="#__codelineno-27-98"></a>
<a id="__codelineno-27-99" name="__codelineno-27-99" href="#__codelineno-27-99"></a>********************
<a id="__codelineno-27-100" name="__codelineno-27-100" href="#__codelineno-27-100"></a><span class="w">  </span>Test<span class="w"> </span>summary
<a id="__codelineno-27-101" name="__codelineno-27-101" href="#__codelineno-27-101"></a>********************
<a id="__codelineno-27-102" name="__codelineno-27-102" href="#__codelineno-27-102"></a><span class="w">   </span>test_fme_dfh_walking<span class="w"> </span><span class="o">(</span><span class="nv">id</span><span class="o">=</span><span class="m">0</span><span class="o">)</span><span class="w"> </span>-<span class="w"> </span>pass
<a id="__codelineno-27-103" name="__codelineno-27-103" href="#__codelineno-27-103"></a>Test<span class="w"> </span>passed!
<a id="__codelineno-27-104" name="__codelineno-27-104" href="#__codelineno-27-104"></a>Assertion<span class="w"> </span>count:<span class="w"> </span><span class="m">0</span>
</code></pre></div>
<p>The simulation transcript is displayed while the simulation runs.  The transcript is saved to the file transcript.out for review after the simulation completes.  The simulation waveform database is saved as vcdplus.vpd for post simulation review. You are encouraged to run the additional simulation examples to learn about each key area of the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> shell.</p>
<h3 id="43-compiling-the-ofs-fim-using-eval-script">4.3. Compiling the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> using Eval Script<a class="headerlink" href="#43-compiling-the-ofs-fim-using-eval-script" title="Permanent link">&para;</a></h3>
<p>The Evaluation Script provides resources to setup and report D5005 development environment. You can use the evaluation script to compile and simulate the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. Refer to <a href="https://github.com/OFS/ofs-d5005/blob/release/1.0.x/eval_scripts/README_ofs_d5005_eval.txt">README_ofs_d5005_eval.txt</a>) for details of using the evaluation script.</p>
<h3 id="44-debugging">4.4. Debugging<a class="headerlink" href="#44-debugging" title="Permanent link">&para;</a></h3>
<p>For debugging issues within the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>, Signal Tap can be used to gain internal visibility into your design.  This section describes the process of adding a Signal Tap instance to your <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> design</p>
<h4 id="441-signal-tap-prerequisites">4.4.1. Signal Tap Prerequisites<a class="headerlink" href="#441-signal-tap-prerequisites" title="Permanent link">&para;</a></h4>
<p>To use Signal Tap with <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr>, you will need the following:</p>
<ul>
<li>Understanding of Signal Tap fundamentals - please review <a href="https://www.intel.com/content/www/us/en/programmable/documentation/nfc1513989909783.html"><em>Quartus Prime Pro Edition User Guide: Debug Tools</em></a>.<br />
section 2. Design Debugging with the Signal Tap Logic Analyzer.</li>
</ul>
<ul>
<li>The Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005 has a built in Intel FPGA Download Cable II allowing <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> access to the S10 FPGA. You can access the D5005 built in Intel FPGA Download Cable II by connecting your server to the Micro USB connector as shown below:</li>
</ul>
<p><a class="glightbox" href="../images/D5005_MicroUSB.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Microbus" src="../images/D5005_MicroUSB.png" /></a></p>
<ul>
<li>If you are using a custom board without a built-in Intel FPGA Download Cable then an external Intel FPGA Download Cable II (see <a href="https://www.intel.com/content/www/us/en/programmable/products/boards_and_kits/download-cables.html">Download Cables</a> for more information) can be used for Signal Tap access.  The custom board must have <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> access to the target FPGA for the Intel FPGA Download Cable II.</li>
</ul>
<h4 id="442-adding-signal-tap">4.4.2. Adding Signal Tap<a class="headerlink" href="#442-adding-signal-tap" title="Permanent link">&para;</a></h4>
<p>The following steps guide you through the process of adding a Signal Tap instance to your design.  The added Signal Tap instance provides hardware to capture the desired internal signals and connect the stored trace information via <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr>.  Please be aware, the added Signal Tap hardware will consume FPGA resources and may require additional floorplanning steps to accommodate these resources.  Some areas of the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> use logic lock regions and these regions may need to be re-sized. These steps assume the use of the Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005.</p>
<ol>
<li>Perform a full compile using the script build_top.sh.</li>
<li>Once the compile completes open the Quartus GUI using the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> project.  The Quartus project is named d5005 and is located in the work directory syn/syn_top/d5005.qpf.  Once the project is loaded, go to Tools &gt; Signal Tap Logic Analyzer to bring up the Signal Tap GUI.</li>
</ol>
<p><a class="glightbox" href="../images/QuartusSignalTap.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Quartus Signal Tap" src="../images/QuartusSignalTap.png" /></a></p>
<ol>
<li>Accept the "Default" selection and click "Create".</li>
</ol>
<p><a class="glightbox" href="../images/Default_SignalTap.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Default Signal Tap" src="../images/Default_SignalTap.png" /></a></p>
<ol>
<li>This brings up Signal Tap Logic Analyzer window as shown below:</li>
</ol>
<p><a class="glightbox" href="../images/STP_GUI.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Signal Tap GUI" src="../images/STP_GUI.png" /></a></p>
<ol>
<li>Set up clock for STP instance.  In this example, the EMIF CSR module is being instrumented.  If unfamiliar with code, it is helpful to use the Quartus Project Navigator to find the specific block of interest and open the design instance for review.  For example, see snip below using Project Navigator to open emif_csr block:</li>
</ol>
<p><a class="glightbox" href="../images/STP_ProjNav.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Project Navigator" src="../images/STP_ProjNav.png" /></a>    </p>
<ol>
<li>After reviewing code, assign clock for sampling Signal Tap instrumented signals of interest.  Note, the clock selected and the signals you want to view should be the same for best trace fidelity.  Different clocks can be used however there maybe issues with trace inaccuracy due sampling time differences.  In the middle right of the Signal Tap window under Signal Configuration, Clock:  select "…" as shown below: </li>
</ol>
<p><a class="glightbox" href="../images/STP_Clock.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="STP Clock" src="../images/STP_Clock.png" /></a></p>
<ol>
<li>After reviewing code, assign clock for sampling Signal Tap instrumented signals of interest.  In the middle right of the Signal Tap window under Signal Configuration, Clock:  select "…" as shown below:   This brings up the Node Finder tool.  Input "<em>emif_csr</em>" into Named and select "Search".  This brings up all nodes from the pre-synthesis view.  Expand, "mem" and "emif_csr" and scroll through this list to become familiar with nodes, and then select csr_if.clk and click "&gt;"  to select this clock as shown below and click "OK": </li>
</ol>
<p><a class="glightbox" href="../images/STP_nodefinder.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Node Finder" src="../images/STP_nodefinder.png" /></a></p>
<ol>
<li>Update the sample depth and other Signal Tap settings as needed for your debugging criteria.</li>
</ol>
<p><a class="glightbox" href="../images/STP_settings.PNG" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="STP Settings" src="../images/STP_settings.PNG" /></a></p>
<ol>
<li>In the Signal Tap GUI add nodes to be instrumented by double clicking on "Double-click to add nodes".</li>
</ol>
<p><a class="glightbox" href="../images/STP_addNodes.PNG" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="STP Settings" src="../images/STP_addNodes.PNG" /></a></p>
<ol>
<li>This brings up the Node Finder.  Add signals to be traced by the Signal Tap instance.  Click "Insert" to add the signals.</li>
<li>To provide a unique name for your Signal Tap instance, select "auto signaltap_0", right click and select rename instance and provide a descriptive name for your instance.</li>
<li>Save the newly created Signal Tap file and click "Yes" to add the new Signal Tap file to the project.</li>
<li>Compile the project with the Signal Tap file added to the project.</li>
<li>Once the compile successfully completes with proper timing, you can load the generated d5005.sof using the Intel FPGA Downloader cable.</li>
</ol>
<h4 id="443-signal-tap-trace-acquisition">4.4.3. Signal Tap trace acquisition<a class="headerlink" href="#443-signal-tap-trace-acquisition" title="Permanent link">&para;</a></h4>
<p>To acquire signals using SignalTap, first load the Signal Tap instrumented SOF file into your target board, open the STP file in the Signal Tap GUI and start the signal acquisition. </p>
<p>Avoid system hang during programming the sof file, mask <abbr title="Advanced Error Reporting, The PCIe AER driver is the extended PCI Express error reporting capability providing more robust error reporting.">AER</abbr> regsiter using below steps </p>
<p>Find Root complex - End Point mapping using the below command</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>lspci<span class="w"> </span>-vt
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>+-<span class="o">[</span><span class="m">0000</span>:3a<span class="o">]</span>-+-00.0-<span class="o">[</span>3b-3c<span class="o">]</span>----00.0<span class="w">  </span>Intel<span class="w"> </span>Corporation<span class="w"> </span>Device<span class="w"> </span>bcce
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w"> </span><span class="p">|</span><span class="w">           </span>+-05.0<span class="w">  </span>Intel<span class="w"> </span>Corporation<span class="w"> </span>Sky<span class="w"> </span>Lake-E<span class="w"> </span>VT-d
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="w"> </span><span class="p">|</span><span class="w">           </span>+-05.2<span class="w">  </span>Intel<span class="w"> </span>Corporation<span class="w"> </span>Sky<span class="w"> </span>Lake-E<span class="w"> </span>RAS<span class="w"> </span>Configuration<span class="w"> </span>Registers
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="w"> </span><span class="p">|</span><span class="w">           </span>+-05.4<span class="w">  </span>Intel<span class="w"> </span>Corporation<span class="w"> </span>Sky<span class="w"> </span>Lake-E<span class="w"> </span>IOxAPIC<span class="w"> </span>Configuration<span class="w"> </span>Registers
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="w"> </span><span class="p">|</span><span class="w">           </span>+-08.0<span class="w">  </span>Intel<span class="w"> </span>Corporation<span class="w"> </span>Sky<span class="w"> </span>Lake-E<span class="w"> </span>Integrated<span class="w"> </span>Memory<span class="w"> </span>Controller
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="w"> </span><span class="p">|</span><span class="w">           </span>+-09.0<span class="w">  </span>Intel<span class="w"> </span>Corporation<span class="w"> </span>Sky<span class="w"> </span>Lake-E<span class="w"> </span>Integrated<span class="w"> </span>Memory<span class="w"> </span>Controller
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="w"> </span><span class="p">|</span><span class="w">           </span>+-0a.0<span class="w">  </span>Intel<span class="w"> </span>Corporation<span class="w"> </span>Sky<span class="w"> </span>Lake-E<span class="w"> </span>Integrated<span class="w"> </span>Memory<span class="w"> </span>Controller
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="w"> </span><span class="p">|</span><span class="w">           </span>+-0a.1<span class="w">  </span>Intel<span class="w"> </span>Corporation<span class="w"> </span>Sky<span class="w"> </span>Lake-E<span class="w"> </span>Integrated<span class="w"> </span>Memory<span class="w"> </span>Controller
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="w"> </span><span class="p">|</span><span class="w">           </span>+-0a.2<span class="w">  </span>Intel<span class="w"> </span>Corporation<span class="w"> </span>Sky<span class="w"> </span>Lake-E<span class="w"> </span>Integrated<span class="w"> </span>Memory<span class="w"> </span>Controller
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="w"> </span><span class="p">|</span><span class="w">           </span>+-0a.3<span class="w">  </span>Intel<span class="w"> </span>Corporation<span class="w"> </span>Sky<span class="w"> </span>Lake-E<span class="w"> </span>Integrated<span class="w"> </span>Memory<span class="w"> </span>Controller
<a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="w"> </span><span class="p">|</span><span class="w">           </span>+-0a.4<span class="w">  </span>Intel<span class="w"> </span>Corporation<span class="w"> </span>Sky<span class="w"> </span>Lake-E<span class="w"> </span>Integrated<span class="w"> </span>Memory<span class="w"> </span>Controller
<a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a><span class="w"> </span><span class="p">|</span><span class="w">           </span>+-0a.5<span class="w">  </span>Intel<span class="w"> </span>Corporation<span class="w"> </span>Sky<span class="w"> </span>Lake-E<span class="w"> </span>LM<span class="w"> </span>Channel<span class="w"> </span><span class="m">1</span>
</code></pre></div>
<p>Use the bus information from the lspci logs to mask the <abbr title="Advanced Error Reporting, The PCIe AER driver is the extended PCI Express error reporting capability providing more robust error reporting.">AER</abbr> (Advanced Error Reporting) register</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>sudo<span class="w"> </span>su
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>setpci<span class="w"> </span>-s<span class="w"> </span><span class="m">0000</span>:3b:00.0<span class="w"> </span>ECAP_AER+0x08.L<span class="o">=</span>0xFFFFFFFF<span class="w"> </span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>setpci<span class="w"> </span>-s<span class="w"> </span><span class="m">0000</span>:3b:00.0<span class="w"> </span>ECAP_AER+0x14.L<span class="o">=</span>0xFFFFFFFF
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>setpci<span class="w"> </span>-s<span class="w"> </span><span class="m">0000</span>:3a:00.0<span class="w"> </span>ECAP_AER+0x08.L<span class="o">=</span>0xFFFFFFFF
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>setpci<span class="w"> </span>-s<span class="w"> </span><span class="m">0000</span>:3a:00.0<span class="w"> </span>ECAP_AER+0x14.L<span class="o">=</span>0xFFFFFFFF
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/bus/pci/devices/0000:3b:00.0/remove
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="nb">exit</span>
</code></pre></div>
<ol>
<li>The SOF file is located in the work directory work_d5005/syn/syn_top/output_files/d5005.sof.  If the target FPGA is on a different server, then transfer d5005.sof and STP files to the server with the target FPGA. Load the SOF using the Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005 built-in Intel FPGA Download Cable II. </li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>sudo<span class="w"> </span>su
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/bus/pci/rescan
</code></pre></div>
<ol>
<li>Make sure D5005 is present by checking expected bitstream ID using command:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>sudo<span class="w"> </span>fpgainfo<span class="w"> </span>fme
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>Intel<span class="w"> </span>FPGA<span class="w"> </span>Programmable<span class="w"> </span>Acceleration<span class="w"> </span>Card<span class="w"> </span>D5005
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller,<span class="w"> </span>MAX10<span class="w"> </span>NIOS<span class="w"> </span>FW<span class="w"> </span>version:<span class="w"> </span><span class="m">2</span>.0.13<span class="w"> </span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller,<span class="w"> </span>MAX10<span class="w"> </span>Build<span class="w"> </span>version:<span class="w"> </span><span class="m">2</span>.0.8<span class="w"> </span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>//******<span class="w"> </span>FME<span class="w"> </span>******//
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xF000000
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:3B:00.0
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x138D
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x00
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>Ports<span class="w"> </span>Num<span class="w">                        </span>:<span class="w"> </span><span class="m">01</span>
<a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>Bitstream<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x40100022C164DB1
<a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a>Bitstream<span class="w"> </span>Version<span class="w">                </span>:<span class="w"> </span><span class="m">4</span>.0.1
<a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a>Pr<span class="w"> </span>Interface<span class="w"> </span>Id<span class="w">                  </span>:<span class="w"> </span>210a4631-18bb-57d1-879f-2c3d59b26e37
<a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a>Boot<span class="w"> </span>Page<span class="w">                        </span>:<span class="w"> </span>user
</code></pre></div>
<ol>
<li>Once the SOF file is loaded, start the Quartus Signal Tap GUI.</li>
</ol>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>quartus_stpw
</code></pre></div>
The Signal Tap GUI comes up.</p>
<ol>
<li>In the Signal Tap GUI, <code>Hardware:</code> selection box select the cable "Stratix10 Darby Creek [ <abbr title="Joint Test Action Group, Refers to the IEEE 1149.1 JTAG standard; Another FPGA configuration methodology.">JTAG</abbr> cable number ]" as shown below:</li>
</ol>
<p><a class="glightbox" href="../images/STP_HW.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="STP HW" src="../images/STP_HW.png" /></a></p>
<ol>
<li>In <code>File</code> open your STP file.  Your STP file settings will load.  If not already set, you can create the trigger conditions, then start analysis with <code>F5</code>.</li>
</ol>
<p><a class="glightbox" href="../images/stp_capture.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="STP-cap" src="../images/stp_capture.png" /></a></p>
<h2 id="5-fim-modification-example">5. <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> Modification Example<a class="headerlink" href="#5-fim-modification-example" title="Permanent link">&para;</a></h2>
<p>An example of <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> modification is provided in this section.  This example can be used in your specific application as a starting point.  This example shows the basic flow and listing of files that are to be changed.</p>
<h3 id="51-hello-fim-example">5.1. Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> example<a class="headerlink" href="#51-hello-fim-example" title="Permanent link">&para;</a></h3>
<p>If you intend to add a new module to the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> area, then you will need to inform the host software of the new module.  The <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> exposes its functionalities to host software through a set of CSR registers that are mapped to an <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> region (Memory Mapped IO).  This set of CSR registers and their operation is described in <a href="https://ofs.github.io/hw/d5005/reference_manuals/ofs_fim/mnl_fim_ofs_d5005/#mmio_regions"><abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> Regions</a>.</p>
<p>See <a href="https://github.com/ofs/linux-dfl/blob/fpga-ofs-dev/Documentation/fpga/dfl.rst#fpga-device-feature-list-dfl-framework-overview">FPGA Device Feature List (<abbr title="Device Feature List, A concept inherited from OFS. The DFL drivers provide support for FPGA devices that are designed to support the Device Feature List. The DFL, which is implemented in RTL, consists of a self-describing data structure in PCI BAR space that allows the DFL driver to automatically load the drivers required for a given FPGA configuration.">DFL</abbr>) Framework Overview</a> for a description of the software process to read and process the linked list of Device Feature Header (DFH) CSRs within a FPGA.</p>
<p>This example adds a simple DFH register set to the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. You can use this example as the basis for adding a new feature to your <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>.  </p>
<p>The steps to add this simple DFH register are described below.</p>
<ol>
<li>Review current design documentation: <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> Tech Ref <abbr title="Memory Mapped Input/Output, Users may map and access both control registers and system memory buffers with accelerators.">MMIO</abbr> Regions</li>
<li>Understand <abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr> and Port regions, DFH walking, DFH register structure </li>
<li>Run unit level simulations and review output:
            i.  sim/unit_test/dfh_walker</li>
<li>Note DFH link list order, see <a href="#dfh-walking-unit-simulation-output">DFH Walker Unit Level Simulation Output</a></li>
<li>Make code changes to top level <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> file to instantiate new DFH register</li>
<li>The DFH registers follow a link list.  This example inserts the hello_fim DFH register after the EMIF DFH register, so the emif_csr.sv parameters are updated to insert the hello_fim DFH register as next register in the link list.</li>
<li>Create the new hello_fim SystemVerilog files.</li>
<li>Update and run the dfh_walker unit simulation files</li>
<li>Update synthesis files to include the new hello_fim source files</li>
<li>Build and test the new <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr></li>
</ol>
<p>The following sections describe changes to add the hello_fim DFH example to the Intel provided FPGA design.</p>
<h3 id="511-srctopiofs_topsv">5.1.1. src/top/iofs_top.sv<a class="headerlink" href="#511-srctopiofs_topsv" title="Permanent link">&para;</a></h3>
<ol>
<li>Edit top level design module: src/top/iofs_top.sv<ol>
<li>Instantiate new hello_fim module in OFS_top.sv at line 294</li>
</ol>
</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c1">//*******************************</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="c1">// FME</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="c1">//*******************************</span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="w">  </span><span class="n">fme_top</span><span class="w"> </span>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="w">  </span><span class="n">fme_top</span><span class="p">(</span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="w">          </span><span class="p">.</span><span class="n">clk</span><span class="w">               </span><span class="p">(</span><span class="n">clk_1x</span><span class="w">                    </span><span class="p">),</span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="w">          </span><span class="p">.</span><span class="n">rst_n</span><span class="w">             </span><span class="p">(</span><span class="n">rst_n_d_1x</span><span class="w">       </span><span class="p">),</span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="w">          </span><span class="p">.</span><span class="n">pwr_good_n</span><span class="w">        </span><span class="p">(</span><span class="n">ninit_done</span><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="w">          </span><span class="p">.</span><span class="n">i_pcie_error</span><span class="w">      </span><span class="p">(</span><span class="m">&#39;0</span><span class="w">                        </span><span class="p">),</span>
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="w">          </span><span class="p">.</span><span class="n">axi_lite_m_if</span><span class="w">     </span><span class="p">(</span><span class="n">bpf_fme_mst_if</span><span class="w">            </span><span class="p">),</span>
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="w">          </span><span class="p">.</span><span class="n">axi_lite_s_if</span><span class="w">     </span><span class="p">(</span><span class="n">bpf_fme_slv_if</span><span class="w">            </span><span class="p">)</span>
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a><span class="w">         </span><span class="p">);</span>
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a>
<a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a>
<a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="no">`ifdef</span><span class="w"> </span><span class="n">INCLUDE_HELLO_FIM</span>
<a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a>
<a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a><span class="w">        </span><span class="n">hello_fim_top</span><span class="w"> </span>
<a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a><span class="w">           </span><span class="n">hello_fim_top</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a><span class="w">        </span><span class="p">.</span><span class="n">clk</span><span class="w">   </span><span class="p">(</span><span class="n">clk_1x</span><span class="p">),</span>
<a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a>
<a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a><span class="w">       </span><span class="p">.</span><span class="n">rst_n</span><span class="w">                      </span><span class="p">(</span><span class="n">rst_n_d_1x</span><span class="p">),</span>
<a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a><span class="w">       </span><span class="p">.</span><span class="n">csr_lite_if</span><span class="w">             </span><span class="p">(</span><span class="n">bpf_rsv_5_slv_if</span><span class="p">)</span>
<a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a>
<a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a>
<a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a><span class="w">        </span><span class="p">);</span>
<a id="__codelineno-34-28" name="__codelineno-34-28" href="#__codelineno-34-28"></a><span class="no">`endif</span>
<a id="__codelineno-34-29" name="__codelineno-34-29" href="#__codelineno-34-29"></a>
<a id="__codelineno-34-30" name="__codelineno-34-30" href="#__codelineno-34-30"></a><span class="c1">//*******************************</span>
<a id="__codelineno-34-31" name="__codelineno-34-31" href="#__codelineno-34-31"></a><span class="c1">// AFU</span>
<a id="__codelineno-34-32" name="__codelineno-34-32" href="#__codelineno-34-32"></a><span class="c1">//*******************************</span>
</code></pre></div>
<p>You will connect the Hello_FIM DFH register to the existing BPF reserved link 5.  The provided <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference design includes 3 reserved BPF interfaces available for custom usage such as new OPAE controlled modules.  The address map of BPF is shown below:</p>
<table>
<thead>
<tr>
<th><strong>Address</strong></th>
<th><strong>Size (Byte)</strong></th>
<th><strong>Feature</strong></th>
<th><strong>Master</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00000 – 0x0FFFF</td>
<td>64K</td>
<td><abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr> (<abbr title="FPGA Management Engine, Provides a way to manage the platform and enable acceleration functions on the platform.">FME</abbr>, Error, etc)</td>
<td>Yes</td>
</tr>
<tr>
<td>0x10000 – 0x1FFFF</td>
<td>64K</td>
<td>PMCI Proxy (SPI Controller)</td>
<td>Yes</td>
</tr>
<tr>
<td>0x20000 – 0x2FFFF</td>
<td>64K</td>
<td>PCIe CSR</td>
<td></td>
</tr>
<tr>
<td>0x30000 – 0x3FFFF</td>
<td>64K</td>
<td>HSSI CSR</td>
<td></td>
</tr>
<tr>
<td>0x40000 – 0x4FFFF</td>
<td>64K</td>
<td>EMIF CSR</td>
<td></td>
</tr>
<tr>
<td>0x50000 – 0x5FFFF</td>
<td>64K</td>
<td>Reserved</td>
<td></td>
</tr>
<tr>
<td>0x60000 – 0x6FFFF</td>
<td>64K</td>
<td>Reserved</td>
<td></td>
</tr>
<tr>
<td>0x70000 – 0x7FFFF</td>
<td>64K</td>
<td>Reserved</td>
<td></td>
</tr>
</tbody>
</table>
<p>The BPF reserved link 5 is connected to a dummy connection to prevent this link from being optimized out the design during synthesis.  You will add a compiler `define that will cause this dummy connection to be removed when the variable INCLUDE_HELLO_FIM is defined by editing line 575 if iofs_top.sv as shown below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="w">    </span><span class="c1">// Reserved address response</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="w">   </span><span class="no">`ifndef</span><span class="w"> </span><span class="n">INCLUDE_HELLO_FIM</span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w">    </span><span class="n">bpf_dummy_slv</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="w">    </span><span class="n">bpf_rsv_5_slv</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="w">        </span><span class="p">.</span><span class="n">clk</span><span class="w">            </span><span class="p">(</span><span class="n">clk_1x</span><span class="p">),</span>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="w">        </span><span class="p">.</span><span class="n">dummy_slv_if</span><span class="w">   </span><span class="p">(</span><span class="n">bpf_rsv_5_slv_if</span><span class="p">)</span>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="w">    </span><span class="no">`endif</span>
</code></pre></div>
<h3 id="512-ipssmememif_csrsv">5.1.2. ipss/mem/emif_csr.sv<a class="headerlink" href="#512-ipssmememif_csrsv" title="Permanent link">&para;</a></h3>
<p>The Hello_FIM DFH is inserted in the DFH link list after the EMIF CSR DFH and before the FME_PR DFH.  The file ipss/d5005/emif/emif_csr.sv contains a parameter defining the next address for the next DFH in in the link list chain.  You will change the next address offset to be 0x10000 so the reveserved BPF AXI lite link connected to the Hello_FIM DFH register is next in the DFH link list.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="k">module</span><span class="w"> </span><span class="n">emif_csr</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">NUM_LOCAL_MEM_BANKS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">,</span>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">END_OF_LIST</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="w">  </span><span class="no">`ifndef</span><span class="w"> </span><span class="n">INCLUDE_HELLO_FIM</span>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">NEXT_DFH_OFFSET</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">24&#39;h05</span><span class="n">_0000</span>
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="w">  </span><span class="no">`else</span>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="n">NEXT_DFH_OFFSET</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">24&#39;h01</span><span class="n">_0000</span><span class="c1">//New for Hello_FIM, next offset now at 0x50000</span>
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="w">  </span><span class="no">`endif</span>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="p">)</span>
</code></pre></div>
<h4 id="513-srchello_fimhello_fim_topsv">5.1.3. src/hello_fim/hello_fim_top.sv<a class="headerlink" href="#513-srchello_fimhello_fim_topsv" title="Permanent link">&para;</a></h4>
<p>Create hello_fim_top.sv, and store it in src/hello_fim directory. The main purpose of this RTL is to convert AXI4-Lite interface to a simple interface to interface with the registers in hello_fim_com.sv.  This register sets the DFH feature ID to 0xfff which is undefined.  Since this for test purposes, using an undefined feature ID will result in no driver being used.  Normally, a defined feature ID will be used to associate a specific driver with the FPGA module.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="c1">// ***************************************************************************</span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="c1">//                               INTEL CONFIDENTIAL</span>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="c1">//</span>
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="c1">//        Copyright (C) 2021 Intel Corporation All Rights Reserved.</span>
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="c1">//</span>
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="c1">// The source code contained or described herein and all  documents related to</span>
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a><span class="c1">// the  source  code  (&quot;Material&quot;)  are  owned  by  Intel  Corporation  or its</span>
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a><span class="c1">// suppliers  or  licensors.    Title  to  the  Material  remains  with  Intel</span>
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a><span class="c1">// Corporation or  its suppliers  and licensors.  The Material  contains trade</span>
<a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a><span class="c1">// secrets  and  proprietary  and  confidential  information  of  Intel or its</span>
<a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a><span class="c1">// suppliers and licensors.  The Material is protected  by worldwide copyright</span>
<a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a><span class="c1">// and trade secret laws and treaty provisions. No part of the Material may be</span>
<a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a><span class="c1">// used,   copied,   reproduced,   modified,   published,   uploaded,  posted,</span>
<a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a><span class="c1">// transmitted,  distributed,  or  disclosed  in any way without Intel&#39;s prior</span>
<a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a><span class="c1">// express written permission.</span>
<a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a><span class="c1">//</span>
<a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a><span class="c1">// No license under any patent,  copyright, trade secret or other intellectual</span>
<a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a><span class="c1">// property  right  is  granted  to  or  conferred  upon  you by disclosure or</span>
<a id="__codelineno-37-19" name="__codelineno-37-19" href="#__codelineno-37-19"></a><span class="c1">// delivery  of  the  Materials, either expressly, by implication, inducement,</span>
<a id="__codelineno-37-20" name="__codelineno-37-20" href="#__codelineno-37-20"></a><span class="c1">// estoppel or otherwise.  Any license under such intellectual property rights</span>
<a id="__codelineno-37-21" name="__codelineno-37-21" href="#__codelineno-37-21"></a><span class="c1">// must be express and approved by Intel in writing.</span>
<a id="__codelineno-37-22" name="__codelineno-37-22" href="#__codelineno-37-22"></a><span class="c1">//</span>
<a id="__codelineno-37-23" name="__codelineno-37-23" href="#__codelineno-37-23"></a><span class="c1">// You will not, and will not allow any third party to modify, adapt, enhance, </span>
<a id="__codelineno-37-24" name="__codelineno-37-24" href="#__codelineno-37-24"></a><span class="c1">// disassemble, decompile, reverse engineer, change or create derivative works </span>
<a id="__codelineno-37-25" name="__codelineno-37-25" href="#__codelineno-37-25"></a><span class="c1">// from the Software except and only to the extent as specifically required by </span>
<a id="__codelineno-37-26" name="__codelineno-37-26" href="#__codelineno-37-26"></a><span class="c1">// mandatory applicable laws or any applicable third party license terms </span>
<a id="__codelineno-37-27" name="__codelineno-37-27" href="#__codelineno-37-27"></a><span class="c1">// accompanying the Software.</span>
<a id="__codelineno-37-28" name="__codelineno-37-28" href="#__codelineno-37-28"></a><span class="c1">//</span>
<a id="__codelineno-37-29" name="__codelineno-37-29" href="#__codelineno-37-29"></a><span class="c1">// -----------------------------------------------------------------------------</span>
<a id="__codelineno-37-30" name="__codelineno-37-30" href="#__codelineno-37-30"></a><span class="c1">// Engineer     : </span>
<a id="__codelineno-37-31" name="__codelineno-37-31" href="#__codelineno-37-31"></a><span class="c1">// Create Date  : Nov 2021</span>
<a id="__codelineno-37-32" name="__codelineno-37-32" href="#__codelineno-37-32"></a><span class="c1">// Module Name  : hello_fim_top.sv</span>
<a id="__codelineno-37-33" name="__codelineno-37-33" href="#__codelineno-37-33"></a><span class="c1">// Project      : OFS</span>
<a id="__codelineno-37-34" name="__codelineno-37-34" href="#__codelineno-37-34"></a><span class="c1">// -----------------------------------------------------------------------------</span>
<a id="__codelineno-37-35" name="__codelineno-37-35" href="#__codelineno-37-35"></a><span class="c1">//</span>
<a id="__codelineno-37-36" name="__codelineno-37-36" href="#__codelineno-37-36"></a><span class="c1">// Description: </span>
<a id="__codelineno-37-37" name="__codelineno-37-37" href="#__codelineno-37-37"></a><span class="c1">// This is a simple module that implements DFH registers and </span>
<a id="__codelineno-37-38" name="__codelineno-37-38" href="#__codelineno-37-38"></a><span class="c1">// AVMM address decoding logic.</span>
<a id="__codelineno-37-39" name="__codelineno-37-39" href="#__codelineno-37-39"></a>
<a id="__codelineno-37-40" name="__codelineno-37-40" href="#__codelineno-37-40"></a>
<a id="__codelineno-37-41" name="__codelineno-37-41" href="#__codelineno-37-41"></a><span class="k">module</span><span class="w"> </span><span class="n">hello_fim_top</span><span class="w">  </span><span class="p">#(</span>
<a id="__codelineno-37-42" name="__codelineno-37-42" href="#__codelineno-37-42"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="n">ADDR_WIDTH</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">12</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-37-43" name="__codelineno-37-43" href="#__codelineno-37-43"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="n">DATA_WIDTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-37-44" name="__codelineno-37-44" href="#__codelineno-37-44"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">11</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">FEAT_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">12&#39;hfff</span><span class="p">,</span>
<a id="__codelineno-37-45" name="__codelineno-37-45" href="#__codelineno-37-45"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">FEAT_VER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">4&#39;h0</span><span class="p">,</span>
<a id="__codelineno-37-46" name="__codelineno-37-46" href="#__codelineno-37-46"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">23</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">NEXT_DFH_OFFSET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">24&#39;h04</span><span class="n">_0000</span><span class="p">,</span>
<a id="__codelineno-37-47" name="__codelineno-37-47" href="#__codelineno-37-47"></a><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="n">END_OF_LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span>
<a id="__codelineno-37-48" name="__codelineno-37-48" href="#__codelineno-37-48"></a><span class="p">)(</span>
<a id="__codelineno-37-49" name="__codelineno-37-49" href="#__codelineno-37-49"></a><span class="w">   </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w">    </span><span class="n">clk</span><span class="p">,</span>
<a id="__codelineno-37-50" name="__codelineno-37-50" href="#__codelineno-37-50"></a><span class="w">   </span><span class="k">input</span><span class="w">  </span><span class="kt">logic</span><span class="w">    </span><span class="n">rst_n</span><span class="p">,</span>
<a id="__codelineno-37-51" name="__codelineno-37-51" href="#__codelineno-37-51"></a><span class="c1">// -----------------------------------------------------------</span>
<a id="__codelineno-37-52" name="__codelineno-37-52" href="#__codelineno-37-52"></a><span class="c1">//  AXI4LITE Interface</span>
<a id="__codelineno-37-53" name="__codelineno-37-53" href="#__codelineno-37-53"></a><span class="c1">// -----------------------------------------------------------</span>
<a id="__codelineno-37-54" name="__codelineno-37-54" href="#__codelineno-37-54"></a><span class="w">   </span><span class="n">ofs_fim_axi_lite_if</span><span class="p">.</span><span class="n">slave</span><span class="w">   </span><span class="n">csr_lite_if</span>
<a id="__codelineno-37-55" name="__codelineno-37-55" href="#__codelineno-37-55"></a><span class="p">);</span>
<a id="__codelineno-37-56" name="__codelineno-37-56" href="#__codelineno-37-56"></a>
<a id="__codelineno-37-57" name="__codelineno-37-57" href="#__codelineno-37-57"></a><span class="kn">import</span> <span class="nn">ofs_fim_cfg_pkg::*</span><span class="p">;</span>
<a id="__codelineno-37-58" name="__codelineno-37-58" href="#__codelineno-37-58"></a><span class="kn">import</span> <span class="nn">ofs_csr_pkg::*</span><span class="p">;</span>
<a id="__codelineno-37-59" name="__codelineno-37-59" href="#__codelineno-37-59"></a>
<a id="__codelineno-37-60" name="__codelineno-37-60" href="#__codelineno-37-60"></a><span class="c1">//-------------------------------------</span>
<a id="__codelineno-37-61" name="__codelineno-37-61" href="#__codelineno-37-61"></a><span class="c1">// Signals</span>
<a id="__codelineno-37-62" name="__codelineno-37-62" href="#__codelineno-37-62"></a><span class="c1">//-------------------------------------</span>
<a id="__codelineno-37-63" name="__codelineno-37-63" href="#__codelineno-37-63"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">ADDR_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_waddr</span><span class="p">;</span>
<a id="__codelineno-37-64" name="__codelineno-37-64" href="#__codelineno-37-64"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">DATA_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_wdata</span><span class="p">;</span>
<a id="__codelineno-37-65" name="__codelineno-37-65" href="#__codelineno-37-65"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">DATA_WIDTH</span><span class="o">/</span><span class="mh">8</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">            </span><span class="n">csr_wstrb</span><span class="p">;</span>
<a id="__codelineno-37-66" name="__codelineno-37-66" href="#__codelineno-37-66"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_write</span><span class="p">;</span>
<a id="__codelineno-37-67" name="__codelineno-37-67" href="#__codelineno-37-67"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_slv_wready</span><span class="p">;</span>
<a id="__codelineno-37-68" name="__codelineno-37-68" href="#__codelineno-37-68"></a><span class="w">   </span><span class="n">csr_access_type_t</span><span class="w">                   </span><span class="n">csr_write_type</span><span class="p">;</span>
<a id="__codelineno-37-69" name="__codelineno-37-69" href="#__codelineno-37-69"></a>
<a id="__codelineno-37-70" name="__codelineno-37-70" href="#__codelineno-37-70"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">ADDR_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_raddr</span><span class="p">;</span>
<a id="__codelineno-37-71" name="__codelineno-37-71" href="#__codelineno-37-71"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_read</span><span class="p">;</span>
<a id="__codelineno-37-72" name="__codelineno-37-72" href="#__codelineno-37-72"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_read_32b</span><span class="p">;</span>
<a id="__codelineno-37-73" name="__codelineno-37-73" href="#__codelineno-37-73"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">DATA_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_readdata</span><span class="p">;</span>
<a id="__codelineno-37-74" name="__codelineno-37-74" href="#__codelineno-37-74"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">csr_readdata_valid</span><span class="p">;</span>
<a id="__codelineno-37-75" name="__codelineno-37-75" href="#__codelineno-37-75"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">ADDR_WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">              </span><span class="n">csr_addr</span><span class="p">;</span>
<a id="__codelineno-37-76" name="__codelineno-37-76" href="#__codelineno-37-76"></a>
<a id="__codelineno-37-77" name="__codelineno-37-77" href="#__codelineno-37-77"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">                        </span><span class="n">com_csr_writedata</span><span class="p">;</span>
<a id="__codelineno-37-78" name="__codelineno-37-78" href="#__codelineno-37-78"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">com_csr_read</span><span class="p">;</span>
<a id="__codelineno-37-79" name="__codelineno-37-79" href="#__codelineno-37-79"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">com_csr_write</span><span class="p">;</span>
<a id="__codelineno-37-80" name="__codelineno-37-80" href="#__codelineno-37-80"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">                        </span><span class="n">com_csr_readdata</span><span class="p">;</span>
<a id="__codelineno-37-81" name="__codelineno-37-81" href="#__codelineno-37-81"></a><span class="w">   </span><span class="kt">logic</span><span class="w">                               </span><span class="n">com_csr_readdatavalid</span><span class="p">;</span>
<a id="__codelineno-37-82" name="__codelineno-37-82" href="#__codelineno-37-82"></a><span class="w">   </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">                         </span><span class="n">com_csr_address</span><span class="p">;</span>
<a id="__codelineno-37-83" name="__codelineno-37-83" href="#__codelineno-37-83"></a>
<a id="__codelineno-37-84" name="__codelineno-37-84" href="#__codelineno-37-84"></a><span class="c1">// AXI-M CSR interfaces</span>
<a id="__codelineno-37-85" name="__codelineno-37-85" href="#__codelineno-37-85"></a><span class="n">ofs_fim_axi_mmio_if</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-37-86" name="__codelineno-37-86" href="#__codelineno-37-86"></a><span class="w">   </span><span class="p">.</span><span class="n">AWID_WIDTH</span><span class="w">   </span><span class="p">(</span><span class="n">ofs_fim_cfg_pkg</span><span class="o">::</span><span class="n">MMIO_TID_WIDTH</span><span class="p">),</span>
<a id="__codelineno-37-87" name="__codelineno-37-87" href="#__codelineno-37-87"></a><span class="w">   </span><span class="p">.</span><span class="n">AWADDR_WIDTH</span><span class="w"> </span><span class="p">(</span><span class="n">ADDR_WIDTH</span><span class="p">),</span>
<a id="__codelineno-37-88" name="__codelineno-37-88" href="#__codelineno-37-88"></a><span class="w">   </span><span class="p">.</span><span class="n">WDATA_WIDTH</span><span class="w">  </span><span class="p">(</span><span class="n">ofs_fim_cfg_pkg</span><span class="o">::</span><span class="n">MMIO_DATA_WIDTH</span><span class="p">),</span>
<a id="__codelineno-37-89" name="__codelineno-37-89" href="#__codelineno-37-89"></a><span class="w">   </span><span class="p">.</span><span class="n">ARID_WIDTH</span><span class="w">   </span><span class="p">(</span><span class="n">ofs_fim_cfg_pkg</span><span class="o">::</span><span class="n">MMIO_TID_WIDTH</span><span class="p">),</span>
<a id="__codelineno-37-90" name="__codelineno-37-90" href="#__codelineno-37-90"></a><span class="w">   </span><span class="p">.</span><span class="n">ARADDR_WIDTH</span><span class="w"> </span><span class="p">(</span><span class="n">ADDR_WIDTH</span><span class="p">),</span>
<a id="__codelineno-37-91" name="__codelineno-37-91" href="#__codelineno-37-91"></a><span class="w">   </span><span class="p">.</span><span class="n">RDATA_WIDTH</span><span class="w">  </span><span class="p">(</span><span class="n">ofs_fim_cfg_pkg</span><span class="o">::</span><span class="n">MMIO_DATA_WIDTH</span><span class="p">)</span>
<a id="__codelineno-37-92" name="__codelineno-37-92" href="#__codelineno-37-92"></a><span class="p">)</span><span class="w"> </span><span class="n">csr_if</span><span class="p">();</span>
<a id="__codelineno-37-93" name="__codelineno-37-93" href="#__codelineno-37-93"></a>
<a id="__codelineno-37-94" name="__codelineno-37-94" href="#__codelineno-37-94"></a><span class="c1">// AXI4-lite to AXI-M adapter</span>
<a id="__codelineno-37-95" name="__codelineno-37-95" href="#__codelineno-37-95"></a><span class="n">axi_lite2mmio</span><span class="w"> </span><span class="n">axi_lite2mmio</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-37-96" name="__codelineno-37-96" href="#__codelineno-37-96"></a><span class="w">   </span><span class="p">.</span><span class="n">clk</span><span class="w">       </span><span class="p">(</span><span class="n">clk</span><span class="p">),</span>
<a id="__codelineno-37-97" name="__codelineno-37-97" href="#__codelineno-37-97"></a><span class="w">   </span><span class="p">.</span><span class="n">rst_n</span><span class="w">     </span><span class="p">(</span><span class="n">rst_n</span><span class="p">),</span>
<a id="__codelineno-37-98" name="__codelineno-37-98" href="#__codelineno-37-98"></a><span class="w">   </span><span class="p">.</span><span class="n">lite_if</span><span class="w">   </span><span class="p">(</span><span class="n">csr_lite_if</span><span class="p">),</span>
<a id="__codelineno-37-99" name="__codelineno-37-99" href="#__codelineno-37-99"></a><span class="w">   </span><span class="p">.</span><span class="n">mmio_if</span><span class="w">   </span><span class="p">(</span><span class="n">csr_if</span><span class="p">)</span>
<a id="__codelineno-37-100" name="__codelineno-37-100" href="#__codelineno-37-100"></a><span class="p">);</span>
<a id="__codelineno-37-101" name="__codelineno-37-101" href="#__codelineno-37-101"></a>
<a id="__codelineno-37-102" name="__codelineno-37-102" href="#__codelineno-37-102"></a><span class="c1">//---------------------------------</span>
<a id="__codelineno-37-103" name="__codelineno-37-103" href="#__codelineno-37-103"></a><span class="c1">// Map AXI write/read request to CSR write/read,</span>
<a id="__codelineno-37-104" name="__codelineno-37-104" href="#__codelineno-37-104"></a><span class="c1">// and send the write/read response back</span>
<a id="__codelineno-37-105" name="__codelineno-37-105" href="#__codelineno-37-105"></a><span class="c1">//---------------------------------</span>
<a id="__codelineno-37-106" name="__codelineno-37-106" href="#__codelineno-37-106"></a><span class="n">ofs_fim_axi_csr_slave</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-37-107" name="__codelineno-37-107" href="#__codelineno-37-107"></a><span class="w">   </span><span class="p">.</span><span class="n">ADDR_WIDTH</span><span class="w"> </span><span class="p">(</span><span class="n">ADDR_WIDTH</span><span class="p">),</span>
<a id="__codelineno-37-108" name="__codelineno-37-108" href="#__codelineno-37-108"></a><span class="w">   </span><span class="p">.</span><span class="n">USE_SLV_READY</span><span class="w"> </span><span class="p">(</span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">)</span>
<a id="__codelineno-37-109" name="__codelineno-37-109" href="#__codelineno-37-109"></a>
<a id="__codelineno-37-110" name="__codelineno-37-110" href="#__codelineno-37-110"></a><span class="w">   </span><span class="p">)</span><span class="w"> </span><span class="n">csr_slave</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-37-111" name="__codelineno-37-111" href="#__codelineno-37-111"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_if</span><span class="w">             </span><span class="p">(</span><span class="n">csr_if</span><span class="p">),</span>
<a id="__codelineno-37-112" name="__codelineno-37-112" href="#__codelineno-37-112"></a>
<a id="__codelineno-37-113" name="__codelineno-37-113" href="#__codelineno-37-113"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_write</span><span class="w">          </span><span class="p">(</span><span class="n">csr_write</span><span class="p">),</span>
<a id="__codelineno-37-114" name="__codelineno-37-114" href="#__codelineno-37-114"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_waddr</span><span class="w">          </span><span class="p">(</span><span class="n">csr_waddr</span><span class="p">),</span>
<a id="__codelineno-37-115" name="__codelineno-37-115" href="#__codelineno-37-115"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_write_type</span><span class="w">     </span><span class="p">(</span><span class="n">csr_write_type</span><span class="p">),</span>
<a id="__codelineno-37-116" name="__codelineno-37-116" href="#__codelineno-37-116"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_wdata</span><span class="w">          </span><span class="p">(</span><span class="n">csr_wdata</span><span class="p">),</span>
<a id="__codelineno-37-117" name="__codelineno-37-117" href="#__codelineno-37-117"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_wstrb</span><span class="w">          </span><span class="p">(</span><span class="n">csr_wstrb</span><span class="p">),</span>
<a id="__codelineno-37-118" name="__codelineno-37-118" href="#__codelineno-37-118"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_slv_wready</span><span class="w">     </span><span class="p">(</span><span class="n">csr_slv_wready</span><span class="p">),</span>
<a id="__codelineno-37-119" name="__codelineno-37-119" href="#__codelineno-37-119"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_read</span><span class="w">           </span><span class="p">(</span><span class="n">csr_read</span><span class="p">),</span>
<a id="__codelineno-37-120" name="__codelineno-37-120" href="#__codelineno-37-120"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_raddr</span><span class="w">          </span><span class="p">(</span><span class="n">csr_raddr</span><span class="p">),</span>
<a id="__codelineno-37-121" name="__codelineno-37-121" href="#__codelineno-37-121"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_read_32b</span><span class="w">       </span><span class="p">(</span><span class="n">csr_read_32b</span><span class="p">),</span>
<a id="__codelineno-37-122" name="__codelineno-37-122" href="#__codelineno-37-122"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_readdata</span><span class="w">       </span><span class="p">(</span><span class="n">csr_readdata</span><span class="p">),</span>
<a id="__codelineno-37-123" name="__codelineno-37-123" href="#__codelineno-37-123"></a><span class="w">   </span><span class="p">.</span><span class="n">csr_readdata_valid</span><span class="w"> </span><span class="p">(</span><span class="n">csr_readdata_valid</span><span class="p">)</span>
<a id="__codelineno-37-124" name="__codelineno-37-124" href="#__codelineno-37-124"></a><span class="p">);</span>
<a id="__codelineno-37-125" name="__codelineno-37-125" href="#__codelineno-37-125"></a>
<a id="__codelineno-37-126" name="__codelineno-37-126" href="#__codelineno-37-126"></a><span class="c1">// Address mapping</span>
<a id="__codelineno-37-127" name="__codelineno-37-127" href="#__codelineno-37-127"></a><span class="k">assign</span><span class="w"> </span><span class="n">csr_addr</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="n">csr_write</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">csr_waddr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">csr_raddr</span><span class="p">;</span>
<a id="__codelineno-37-128" name="__codelineno-37-128" href="#__codelineno-37-128"></a><span class="k">assign</span><span class="w"> </span><span class="n">com_csr_address</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">csr_addr</span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span><span class="w">  </span><span class="c1">// byte address</span>
<a id="__codelineno-37-129" name="__codelineno-37-129" href="#__codelineno-37-129"></a><span class="k">assign</span><span class="w"> </span><span class="n">csr_slv_wready</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="w"> </span><span class="p">;</span>
<a id="__codelineno-37-130" name="__codelineno-37-130" href="#__codelineno-37-130"></a><span class="c1">// Write data mapping</span>
<a id="__codelineno-37-131" name="__codelineno-37-131" href="#__codelineno-37-131"></a><span class="k">assign</span><span class="w"> </span><span class="n">com_csr_writedata</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">csr_wdata</span><span class="p">;</span>
<a id="__codelineno-37-132" name="__codelineno-37-132" href="#__codelineno-37-132"></a>
<a id="__codelineno-37-133" name="__codelineno-37-133" href="#__codelineno-37-133"></a><span class="c1">// Read-Write mapping</span>
<a id="__codelineno-37-134" name="__codelineno-37-134" href="#__codelineno-37-134"></a><span class="k">always_comb</span>
<a id="__codelineno-37-135" name="__codelineno-37-135" href="#__codelineno-37-135"></a><span class="k">begin</span>
<a id="__codelineno-37-136" name="__codelineno-37-136" href="#__codelineno-37-136"></a><span class="w">   </span><span class="n">com_csr_read</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-37-137" name="__codelineno-37-137" href="#__codelineno-37-137"></a><span class="w">   </span><span class="n">com_csr_write</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-37-138" name="__codelineno-37-138" href="#__codelineno-37-138"></a><span class="w">   </span><span class="k">casez</span><span class="w"> </span><span class="p">(</span><span class="n">csr_addr</span><span class="p">[</span><span class="mh">11</span><span class="o">:</span><span class="mh">6</span><span class="p">])</span>
<a id="__codelineno-37-139" name="__codelineno-37-139" href="#__codelineno-37-139"></a><span class="w">      </span><span class="mh">6&#39;h00</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span><span class="c1">// Common CSR</span>
<a id="__codelineno-37-140" name="__codelineno-37-140" href="#__codelineno-37-140"></a><span class="w">         </span><span class="n">com_csr_read</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">csr_read</span><span class="p">;</span>
<a id="__codelineno-37-141" name="__codelineno-37-141" href="#__codelineno-37-141"></a><span class="w">         </span><span class="n">com_csr_write</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">csr_write</span><span class="p">;</span>
<a id="__codelineno-37-142" name="__codelineno-37-142" href="#__codelineno-37-142"></a><span class="w">      </span><span class="k">end</span><span class="w">   </span>
<a id="__codelineno-37-143" name="__codelineno-37-143" href="#__codelineno-37-143"></a><span class="w">      </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-37-144" name="__codelineno-37-144" href="#__codelineno-37-144"></a><span class="w">         </span><span class="n">com_csr_read</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-37-145" name="__codelineno-37-145" href="#__codelineno-37-145"></a><span class="w">         </span><span class="n">com_csr_write</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-37-146" name="__codelineno-37-146" href="#__codelineno-37-146"></a><span class="w">      </span><span class="k">end</span>
<a id="__codelineno-37-147" name="__codelineno-37-147" href="#__codelineno-37-147"></a><span class="w">   </span><span class="k">endcase</span>
<a id="__codelineno-37-148" name="__codelineno-37-148" href="#__codelineno-37-148"></a><span class="k">end</span>
<a id="__codelineno-37-149" name="__codelineno-37-149" href="#__codelineno-37-149"></a>
<a id="__codelineno-37-150" name="__codelineno-37-150" href="#__codelineno-37-150"></a><span class="c1">// Read data mapping</span>
<a id="__codelineno-37-151" name="__codelineno-37-151" href="#__codelineno-37-151"></a><span class="w">   </span><span class="k">always_comb</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-37-152" name="__codelineno-37-152" href="#__codelineno-37-152"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">com_csr_readdatavalid</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-37-153" name="__codelineno-37-153" href="#__codelineno-37-153"></a><span class="w">         </span><span class="n">csr_readdata</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">com_csr_readdata</span><span class="p">;</span>
<a id="__codelineno-37-154" name="__codelineno-37-154" href="#__codelineno-37-154"></a><span class="w">         </span><span class="n">csr_readdata_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
<a id="__codelineno-37-155" name="__codelineno-37-155" href="#__codelineno-37-155"></a><span class="w">      </span><span class="k">end</span>
<a id="__codelineno-37-156" name="__codelineno-37-156" href="#__codelineno-37-156"></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-37-157" name="__codelineno-37-157" href="#__codelineno-37-157"></a><span class="w">         </span><span class="n">csr_readdata</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="m">&#39;0</span><span class="p">;</span>
<a id="__codelineno-37-158" name="__codelineno-37-158" href="#__codelineno-37-158"></a><span class="w">         </span><span class="n">csr_readdata_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-37-159" name="__codelineno-37-159" href="#__codelineno-37-159"></a><span class="w">      </span><span class="k">end</span>
<a id="__codelineno-37-160" name="__codelineno-37-160" href="#__codelineno-37-160"></a><span class="w">   </span><span class="k">end</span>
<a id="__codelineno-37-161" name="__codelineno-37-161" href="#__codelineno-37-161"></a>
<a id="__codelineno-37-162" name="__codelineno-37-162" href="#__codelineno-37-162"></a><span class="w">   </span><span class="n">hello_fim_com</span><span class="w">  </span><span class="p">#(</span>
<a id="__codelineno-37-163" name="__codelineno-37-163" href="#__codelineno-37-163"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_ID</span><span class="w">          </span><span class="p">(</span><span class="n">FEAT_ID</span><span class="p">),</span>
<a id="__codelineno-37-164" name="__codelineno-37-164" href="#__codelineno-37-164"></a><span class="w">   </span><span class="p">.</span><span class="n">FEAT_VER</span><span class="w">         </span><span class="p">(</span><span class="n">FEAT_VER</span><span class="p">),</span>
<a id="__codelineno-37-165" name="__codelineno-37-165" href="#__codelineno-37-165"></a><span class="w">   </span><span class="p">.</span><span class="n">NEXT_DFH_OFFSET</span><span class="w">  </span><span class="p">(</span><span class="n">NEXT_DFH_OFFSET</span><span class="p">),</span>
<a id="__codelineno-37-166" name="__codelineno-37-166" href="#__codelineno-37-166"></a><span class="w">   </span><span class="p">.</span><span class="n">END_OF_LIST</span><span class="w">      </span><span class="p">(</span><span class="n">END_OF_LIST</span><span class="p">)</span>
<a id="__codelineno-37-167" name="__codelineno-37-167" href="#__codelineno-37-167"></a><span class="p">)</span><span class="w"> </span><span class="n">hello_fim_com_inst</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-37-168" name="__codelineno-37-168" href="#__codelineno-37-168"></a><span class="w">   </span><span class="p">.</span><span class="n">clk</span><span class="w">                   </span><span class="p">(</span><span class="n">clk</span><span class="w">                     </span><span class="p">),</span>
<a id="__codelineno-37-169" name="__codelineno-37-169" href="#__codelineno-37-169"></a><span class="w">   </span><span class="p">.</span><span class="n">rst_n</span><span class="w">                 </span><span class="p">(</span><span class="n">rst_n</span><span class="w">                  </span><span class="p">),</span>
<a id="__codelineno-37-170" name="__codelineno-37-170" href="#__codelineno-37-170"></a><span class="w">   </span><span class="p">.</span><span class="n">writedata</span><span class="w">             </span><span class="p">(</span><span class="n">com_csr_writedata</span><span class="w">       </span><span class="p">),</span>
<a id="__codelineno-37-171" name="__codelineno-37-171" href="#__codelineno-37-171"></a><span class="w">   </span><span class="p">.</span><span class="n">read</span><span class="w">                  </span><span class="p">(</span><span class="n">com_csr_read</span><span class="w">            </span><span class="p">),</span>
<a id="__codelineno-37-172" name="__codelineno-37-172" href="#__codelineno-37-172"></a><span class="w">   </span><span class="p">.</span><span class="n">write</span><span class="w">                 </span><span class="p">(</span><span class="n">com_csr_write</span><span class="w">           </span><span class="p">),</span>
<a id="__codelineno-37-173" name="__codelineno-37-173" href="#__codelineno-37-173"></a><span class="w">   </span><span class="p">.</span><span class="n">byteenable</span><span class="w">            </span><span class="p">(</span><span class="mh">4&#39;hF</span><span class="w">                    </span><span class="p">),</span>
<a id="__codelineno-37-174" name="__codelineno-37-174" href="#__codelineno-37-174"></a><span class="w">   </span><span class="p">.</span><span class="n">readdata</span><span class="w">              </span><span class="p">(</span><span class="n">com_csr_readdata</span><span class="w">        </span><span class="p">),</span>
<a id="__codelineno-37-175" name="__codelineno-37-175" href="#__codelineno-37-175"></a><span class="w">   </span><span class="p">.</span><span class="n">readdatavalid</span><span class="w">         </span><span class="p">(</span><span class="n">com_csr_readdatavalid</span><span class="w">   </span><span class="p">),</span>
<a id="__codelineno-37-176" name="__codelineno-37-176" href="#__codelineno-37-176"></a><span class="w">   </span><span class="p">.</span><span class="n">address</span><span class="w">               </span><span class="p">(</span><span class="n">com_csr_address</span><span class="w">         </span><span class="p">)</span>
<a id="__codelineno-37-177" name="__codelineno-37-177" href="#__codelineno-37-177"></a><span class="w">   </span><span class="p">);</span>
<a id="__codelineno-37-178" name="__codelineno-37-178" href="#__codelineno-37-178"></a>
<a id="__codelineno-37-179" name="__codelineno-37-179" href="#__codelineno-37-179"></a>
<a id="__codelineno-37-180" name="__codelineno-37-180" href="#__codelineno-37-180"></a><span class="k">endmodule</span>
</code></pre></div>
<h4 id="514-srchello_fimhello_fim_comsv">5.1.4. src/hello_fim/hello_fim_com.sv<a class="headerlink" href="#514-srchello_fimhello_fim_comsv" title="Permanent link">&para;</a></h4>
<p>Create hello_fim_com.sv, and store it in src/hello_fim directory. This is the simple RTL to implement the Hello <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> registers. You may use this set of registers as the basis for your custom implementation.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="c1">// ***************************************************************************</span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="c1">//                               INTEL CONFIDENTIAL</span>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="c1">//</span>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="c1">//        Copyright (C) 2021 Intel Corporation All Rights Reserved.</span>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="c1">//</span>
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="c1">// The source code contained or described herein and all  documents related to</span>
<a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="c1">// the  source  code  (&quot;Material&quot;)  are  owned  by  Intel  Corporation  or its</span>
<a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="c1">// suppliers  or  licensors.    Title  to  the  Material  remains  with  Intel</span>
<a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="c1">// Corporation or  its suppliers  and licensors.  The Material  contains trade</span>
<a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a><span class="c1">// secrets  and  proprietary  and  confidential  information  of  Intel or its</span>
<a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a><span class="c1">// suppliers and licensors.  The Material is protected  by worldwide copyright</span>
<a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a><span class="c1">// and trade secret laws and treaty provisions. No part of the Material may be</span>
<a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a><span class="c1">// used,   copied,   reproduced,   modified,   published,   uploaded,  posted,</span>
<a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a><span class="c1">// transmitted,  distributed,  or  disclosed  in any way without Intel&#39;s prior</span>
<a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a><span class="c1">// express written permission.</span>
<a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a><span class="c1">//</span>
<a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a><span class="c1">// No license under any patent,  copyright, trade secret or other intellectual</span>
<a id="__codelineno-38-18" name="__codelineno-38-18" href="#__codelineno-38-18"></a><span class="c1">// property  right  is  granted  to  or  conferred  upon  you by disclosure or</span>
<a id="__codelineno-38-19" name="__codelineno-38-19" href="#__codelineno-38-19"></a><span class="c1">// delivery  of  the  Materials, either expressly, by implication, inducement,</span>
<a id="__codelineno-38-20" name="__codelineno-38-20" href="#__codelineno-38-20"></a><span class="c1">// estoppel or otherwise.  Any license under such intellectual property rights</span>
<a id="__codelineno-38-21" name="__codelineno-38-21" href="#__codelineno-38-21"></a><span class="c1">// must be express and approved by Intel in writing.</span>
<a id="__codelineno-38-22" name="__codelineno-38-22" href="#__codelineno-38-22"></a><span class="c1">//</span>
<a id="__codelineno-38-23" name="__codelineno-38-23" href="#__codelineno-38-23"></a><span class="c1">// You will not, and will not allow any third party to modify, adapt, enhance, </span>
<a id="__codelineno-38-24" name="__codelineno-38-24" href="#__codelineno-38-24"></a><span class="c1">// disassemble, decompile, reverse engineer, change or create derivative works </span>
<a id="__codelineno-38-25" name="__codelineno-38-25" href="#__codelineno-38-25"></a><span class="c1">// from the Software except and only to the extent as specifically required by </span>
<a id="__codelineno-38-26" name="__codelineno-38-26" href="#__codelineno-38-26"></a><span class="c1">// mandatory applicable laws or any applicable third party license terms </span>
<a id="__codelineno-38-27" name="__codelineno-38-27" href="#__codelineno-38-27"></a><span class="c1">// accompanying the Software.</span>
<a id="__codelineno-38-28" name="__codelineno-38-28" href="#__codelineno-38-28"></a><span class="c1">//</span>
<a id="__codelineno-38-29" name="__codelineno-38-29" href="#__codelineno-38-29"></a><span class="c1">// -----------------------------------------------------------------------------</span>
<a id="__codelineno-38-30" name="__codelineno-38-30" href="#__codelineno-38-30"></a><span class="c1">// Engineer     : </span>
<a id="__codelineno-38-31" name="__codelineno-38-31" href="#__codelineno-38-31"></a><span class="c1">// Create Date  : Nov 2021</span>
<a id="__codelineno-38-32" name="__codelineno-38-32" href="#__codelineno-38-32"></a><span class="c1">// Module Name  : hello_fim_com.sv</span>
<a id="__codelineno-38-33" name="__codelineno-38-33" href="#__codelineno-38-33"></a><span class="c1">// Project      : IOFS</span>
<a id="__codelineno-38-34" name="__codelineno-38-34" href="#__codelineno-38-34"></a><span class="c1">// -----------------------------------------------------------------------------</span>
<a id="__codelineno-38-35" name="__codelineno-38-35" href="#__codelineno-38-35"></a><span class="c1">//</span>
<a id="__codelineno-38-36" name="__codelineno-38-36" href="#__codelineno-38-36"></a><span class="c1">// Description: </span>
<a id="__codelineno-38-37" name="__codelineno-38-37" href="#__codelineno-38-37"></a><span class="c1">// This is a simple module that implements DFH registers and </span>
<a id="__codelineno-38-38" name="__codelineno-38-38" href="#__codelineno-38-38"></a><span class="c1">// AVMM address decoding logic.</span>
<a id="__codelineno-38-39" name="__codelineno-38-39" href="#__codelineno-38-39"></a>
<a id="__codelineno-38-40" name="__codelineno-38-40" href="#__codelineno-38-40"></a>
<a id="__codelineno-38-41" name="__codelineno-38-41" href="#__codelineno-38-41"></a><span class="k">module</span><span class="w"> </span><span class="n">hello_fim_com</span><span class="w"> </span><span class="p">#(</span>
<a id="__codelineno-38-42" name="__codelineno-38-42" href="#__codelineno-38-42"></a><span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">11</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">FEAT_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">12&#39;h001</span><span class="p">,</span>
<a id="__codelineno-38-43" name="__codelineno-38-43" href="#__codelineno-38-43"></a><span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="n">FEAT_VER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">4&#39;h1</span><span class="p">,</span>
<a id="__codelineno-38-44" name="__codelineno-38-44" href="#__codelineno-38-44"></a><span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="p">[</span><span class="mh">23</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">NEXT_DFH_OFFSET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">24&#39;h1000</span><span class="p">,</span>
<a id="__codelineno-38-45" name="__codelineno-38-45" href="#__codelineno-38-45"></a><span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="kt">bit</span><span class="w"> </span><span class="n">END_OF_LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span>
<a id="__codelineno-38-46" name="__codelineno-38-46" href="#__codelineno-38-46"></a><span class="w"> </span><span class="p">)(</span>
<a id="__codelineno-38-47" name="__codelineno-38-47" href="#__codelineno-38-47"></a><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="n">clk</span><span class="p">,</span>
<a id="__codelineno-38-48" name="__codelineno-38-48" href="#__codelineno-38-48"></a><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="n">rst_n</span><span class="p">,</span>
<a id="__codelineno-38-49" name="__codelineno-38-49" href="#__codelineno-38-49"></a><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">writedata</span><span class="p">,</span>
<a id="__codelineno-38-50" name="__codelineno-38-50" href="#__codelineno-38-50"></a><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="n">read</span><span class="p">,</span>
<a id="__codelineno-38-51" name="__codelineno-38-51" href="#__codelineno-38-51"></a><span class="k">input</span><span class="w"> </span><span class="n">write</span><span class="p">,</span>
<a id="__codelineno-38-52" name="__codelineno-38-52" href="#__codelineno-38-52"></a><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">byteenable</span><span class="p">,</span>
<a id="__codelineno-38-53" name="__codelineno-38-53" href="#__codelineno-38-53"></a><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">readdata</span><span class="p">,</span>
<a id="__codelineno-38-54" name="__codelineno-38-54" href="#__codelineno-38-54"></a><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="n">readdatavalid</span><span class="p">,</span>
<a id="__codelineno-38-55" name="__codelineno-38-55" href="#__codelineno-38-55"></a><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">address</span>
<a id="__codelineno-38-56" name="__codelineno-38-56" href="#__codelineno-38-56"></a><span class="p">);</span>
<a id="__codelineno-38-57" name="__codelineno-38-57" href="#__codelineno-38-57"></a>
<a id="__codelineno-38-58" name="__codelineno-38-58" href="#__codelineno-38-58"></a>
<a id="__codelineno-38-59" name="__codelineno-38-59" href="#__codelineno-38-59"></a><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">rdata_comb</span><span class="p">;</span>
<a id="__codelineno-38-60" name="__codelineno-38-60" href="#__codelineno-38-60"></a><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">scratch_reg</span><span class="p">;</span>
<a id="__codelineno-38-61" name="__codelineno-38-61" href="#__codelineno-38-61"></a>
<a id="__codelineno-38-62" name="__codelineno-38-62" href="#__codelineno-38-62"></a><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span><span class="w">  </span>
<a id="__codelineno-38-63" name="__codelineno-38-63" href="#__codelineno-38-63"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">rst_n</span><span class="p">)</span><span class="w"> </span><span class="n">readdata</span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">readdata</span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">rdata_comb</span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
<a id="__codelineno-38-64" name="__codelineno-38-64" href="#__codelineno-38-64"></a>
<a id="__codelineno-38-65" name="__codelineno-38-65" href="#__codelineno-38-65"></a><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span>
<a id="__codelineno-38-66" name="__codelineno-38-66" href="#__codelineno-38-66"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">rst_n</span><span class="p">)</span><span class="w"> </span><span class="n">readdatavalid</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">readdatavalid</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">read</span><span class="p">;</span>
<a id="__codelineno-38-67" name="__codelineno-38-67" href="#__codelineno-38-67"></a>
<a id="__codelineno-38-68" name="__codelineno-38-68" href="#__codelineno-38-68"></a><span class="kt">wire</span><span class="w"> </span><span class="n">wr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">write</span><span class="p">;</span>
<a id="__codelineno-38-69" name="__codelineno-38-69" href="#__codelineno-38-69"></a><span class="kt">wire</span><span class="w"> </span><span class="n">re</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read</span><span class="p">;</span>
<a id="__codelineno-38-70" name="__codelineno-38-70" href="#__codelineno-38-70"></a><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
<a id="__codelineno-38-71" name="__codelineno-38-71" href="#__codelineno-38-71"></a><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">din</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">writedata</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
<a id="__codelineno-38-72" name="__codelineno-38-72" href="#__codelineno-38-72"></a><span class="kt">wire</span><span class="w"> </span><span class="n">wr_scratch_reg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wr</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">addr</span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="o">==</span><span class="w"> </span><span class="mh">6&#39;h30</span><span class="p">)</span><span class="o">?</span><span class="w"> </span><span class="n">byteenable</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="o">:</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<a id="__codelineno-38-73" name="__codelineno-38-73" href="#__codelineno-38-73"></a>
<a id="__codelineno-38-74" name="__codelineno-38-74" href="#__codelineno-38-74"></a><span class="c1">// 64 bit scratch register</span>
<a id="__codelineno-38-75" name="__codelineno-38-75" href="#__codelineno-38-75"></a><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="w"> </span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span>
<a id="__codelineno-38-76" name="__codelineno-38-76" href="#__codelineno-38-76"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">rst_n</span><span class="p">)</span><span class="w">  </span><span class="k">begin</span>
<a id="__codelineno-38-77" name="__codelineno-38-77" href="#__codelineno-38-77"></a><span class="w">      </span><span class="n">scratch_reg</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">64&#39;h0</span><span class="p">;</span>
<a id="__codelineno-38-78" name="__codelineno-38-78" href="#__codelineno-38-78"></a><span class="w">   </span><span class="k">end</span>
<a id="__codelineno-38-79" name="__codelineno-38-79" href="#__codelineno-38-79"></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-38-80" name="__codelineno-38-80" href="#__codelineno-38-80"></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wr_scratch_reg</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span>
<a id="__codelineno-38-81" name="__codelineno-38-81" href="#__codelineno-38-81"></a><span class="w">      </span><span class="n">scratch_reg</span><span class="w"> </span><span class="o">&lt;=</span><span class="w">  </span><span class="n">din</span><span class="p">;</span><span class="w">  </span>
<a id="__codelineno-38-82" name="__codelineno-38-82" href="#__codelineno-38-82"></a><span class="w">   </span><span class="k">end</span>
<a id="__codelineno-38-83" name="__codelineno-38-83" href="#__codelineno-38-83"></a><span class="k">end</span>
<a id="__codelineno-38-84" name="__codelineno-38-84" href="#__codelineno-38-84"></a>
<a id="__codelineno-38-85" name="__codelineno-38-85" href="#__codelineno-38-85"></a><span class="k">always</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a id="__codelineno-38-86" name="__codelineno-38-86" href="#__codelineno-38-86"></a><span class="k">begin</span>
<a id="__codelineno-38-87" name="__codelineno-38-87" href="#__codelineno-38-87"></a><span class="n">rdata_comb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h0000000000000000</span><span class="p">;</span>
<a id="__codelineno-38-88" name="__codelineno-38-88" href="#__codelineno-38-88"></a><span class="w">   </span><span class="k">if</span><span class="p">(</span><span class="n">re</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-38-89" name="__codelineno-38-89" href="#__codelineno-38-89"></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="w">  </span>
<a id="__codelineno-38-90" name="__codelineno-38-90" href="#__codelineno-38-90"></a><span class="w">    </span><span class="mh">6&#39;h00</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-38-91" name="__codelineno-38-91" href="#__codelineno-38-91"></a><span class="w">        </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">11</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">FEAT_ID</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_feature_id  is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-38-92" name="__codelineno-38-92" href="#__codelineno-38-92"></a><span class="w">        </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">12</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">FEAT_VER</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_feature_rev    is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-38-93" name="__codelineno-38-93" href="#__codelineno-38-93"></a><span class="w">        </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">39</span><span class="o">:</span><span class="mh">16</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">NEXT_DFH_OFFSET</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_dfh_ofst is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-38-94" name="__codelineno-38-94" href="#__codelineno-38-94"></a><span class="w">        </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">40</span><span class="p">]</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">END_OF_LIST</span><span class="w"> </span><span class="p">;</span><span class="w">        </span><span class="c1">//dfh_end_of_list</span>
<a id="__codelineno-38-95" name="__codelineno-38-95" href="#__codelineno-38-95"></a><span class="w">        </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">59</span><span class="o">:</span><span class="mh">40</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">20&#39;h00000</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_rsvd1     is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-38-96" name="__codelineno-38-96" href="#__codelineno-38-96"></a><span class="w">        </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">60</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">4&#39;h3</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="c1">// dfh_feat_type  is reserved or a constant value, a read access gives the reset value</span>
<a id="__codelineno-38-97" name="__codelineno-38-97" href="#__codelineno-38-97"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-38-98" name="__codelineno-38-98" href="#__codelineno-38-98"></a><span class="w">    </span><span class="mh">6&#39;h30</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-38-99" name="__codelineno-38-99" href="#__codelineno-38-99"></a><span class="w">        </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">scratch_reg</span><span class="p">;</span><span class="w"> </span>
<a id="__codelineno-38-100" name="__codelineno-38-100" href="#__codelineno-38-100"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-38-101" name="__codelineno-38-101" href="#__codelineno-38-101"></a><span class="w">        </span><span class="mh">6&#39;h38</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-38-102" name="__codelineno-38-102" href="#__codelineno-38-102"></a><span class="w">                </span><span class="n">rdata_comb</span><span class="w"> </span><span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h6626</span><span class="n">_0701_5000_0034</span><span class="p">;</span>
<a id="__codelineno-38-103" name="__codelineno-38-103" href="#__codelineno-38-103"></a><span class="w">        </span><span class="k">end</span>
<a id="__codelineno-38-104" name="__codelineno-38-104" href="#__codelineno-38-104"></a><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">begin</span>
<a id="__codelineno-38-105" name="__codelineno-38-105" href="#__codelineno-38-105"></a><span class="w">        </span><span class="n">rdata_comb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h0000000000000000</span><span class="p">;</span>
<a id="__codelineno-38-106" name="__codelineno-38-106" href="#__codelineno-38-106"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-38-107" name="__codelineno-38-107" href="#__codelineno-38-107"></a><span class="w">      </span><span class="k">endcase</span>
<a id="__codelineno-38-108" name="__codelineno-38-108" href="#__codelineno-38-108"></a><span class="w">   </span><span class="k">end</span>
<a id="__codelineno-38-109" name="__codelineno-38-109" href="#__codelineno-38-109"></a><span class="k">end</span>
<a id="__codelineno-38-110" name="__codelineno-38-110" href="#__codelineno-38-110"></a>
<a id="__codelineno-38-111" name="__codelineno-38-111" href="#__codelineno-38-111"></a><span class="k">endmodule</span>
</code></pre></div>
<h4 id="515-unit-level-simulations">5.1.5. Unit Level Simulations<a class="headerlink" href="#515-unit-level-simulations" title="Permanent link">&para;</a></h4>
<p>To run a unit level simulation test for the updated RTL files, make modifications to your cloned /my_ofs_project/ofs-d5005/sim/d5005/unit_test/dfh_walker files.  The following simulation files are updated to test the new hello_fim.</p>
<ol>
<li>
<p>Edit sim/unit_test/dfh_walker/testbench/test_csr_defs.sv</p>
<ol>
<li>Update enum line 38</li>
</ol>
</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="w">       </span><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="w">      </span><span class="n">FME_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="w">      </span><span class="n">THERM_MNGM_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="w">      </span><span class="n">GLBL_PERF_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="w">      </span><span class="n">GLBL_ERROR_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="w">      </span><span class="n">SPI_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="w">      </span><span class="n">PCIE_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="w">      </span><span class="n">HSSI_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a><span class="w">      </span><span class="n">EMIF_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a><span class="w">      </span><span class="n">HELLO_FIM_DFH_IDX</span><span class="p">,</span><span class="c1">//New for HELLO_FIM</span>
<a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a><span class="w">      </span><span class="n">FME_PR_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a><span class="w">      </span><span class="n">PORT_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a><span class="w">      </span><span class="n">USER_CLOCK_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a><span class="w">      </span><span class="n">PORT_STP_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a><span class="w">      </span><span class="n">AFU_INTF_DFH_IDX</span><span class="p">,</span>
<a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a><span class="w">      </span><span class="n">MAX_FME_DFH_IDX</span>
<a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a><span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="n">t_fme_dfh_idx</span><span class="p">;</span>
</code></pre></div>
<p>1. Edit function dfh_name line 78</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="k">function</span><span class="w"> </span><span class="k">automatic</span><span class="w"> </span><span class="n">dfh_name</span><span class="p">[</span><span class="n">MAX_FME_DFH_IDX</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">get_fme_dfh_names</span><span class="p">();</span>
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="w">      </span><span class="n">dfh_name</span><span class="p">[</span><span class="n">MAX_FME_DFH_IDX</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">fme_dfh_names</span><span class="p">;</span>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="w">      </span><span class="n">fme_dfh_names</span><span class="p">[</span><span class="n">FME_DFH_IDX</span><span class="p">]</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;FME_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="w">      </span><span class="n">fme_dfh_names</span><span class="p">[</span><span class="n">THERM_MNGM_DFH_IDX</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;THERM_MNGM_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="w">      </span><span class="n">fme_dfh_names</span><span class="p">[</span><span class="n">GLBL_PERF_DFH_IDX</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;GLBL_PERF_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="w">      </span><span class="n">fme_dfh_names</span><span class="p">[</span><span class="n">GLBL_ERROR_DFH_IDX</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;GLBL_ERROR_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="w">      </span><span class="n">fme_dfh_names</span><span class="p">[</span><span class="n">SPI_DFH_IDX</span><span class="p">]</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SPI_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a><span class="w">      </span><span class="n">fme_dfh_names</span><span class="p">[</span><span class="n">PCIE_DFH_IDX</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;PCIE_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a><span class="w">      </span><span class="n">fme_dfh_names</span><span class="p">[</span><span class="n">HSSI_DFH_IDX</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;HSSI_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a><span class="w">      </span><span class="n">fme_dfh_names</span><span class="p">[</span><span class="n">EMIF_DFH_IDX</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;EMIF_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a><span class="w">      </span><span class="n">fme_dfh_names</span><span class="p">[</span><span class="n">HELLO_FIM_DFH_IDX</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;HELLO_FIM_DFH&quot;</span><span class="p">;</span><span class="c1">//New for HELLO_FIM</span>
<a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a><span class="w">      </span><span class="n">fme_dfh_names</span><span class="p">[</span><span class="n">FME_PR_DFH_IDX</span><span class="p">]</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;FME_PR_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a><span class="w">      </span><span class="n">fme_dfh_names</span><span class="p">[</span><span class="n">PORT_DFH_IDX</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;PORT_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a><span class="w">      </span><span class="n">fme_dfh_names</span><span class="p">[</span><span class="n">USER_CLOCK_DFH_IDX</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;USER_CLOCK_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a><span class="w">      </span><span class="n">fme_dfh_names</span><span class="p">[</span><span class="n">PORT_STP_DFH_IDX</span><span class="p">]</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;PORT_STP_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a><span class="w">      </span><span class="n">fme_dfh_names</span><span class="p">[</span><span class="n">AFU_INTF_DFH_IDX</span><span class="p">]</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AFU_INTF_DFH&quot;</span><span class="p">;</span>
<a id="__codelineno-40-18" name="__codelineno-40-18" href="#__codelineno-40-18"></a>
<a id="__codelineno-40-19" name="__codelineno-40-19" href="#__codelineno-40-19"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">fme_dfh_names</span><span class="p">;</span>
<a id="__codelineno-40-20" name="__codelineno-40-20" href="#__codelineno-40-20"></a><span class="w">   </span><span class="k">endfunction</span>
</code></pre></div>
<p>1. Update get_fme_dfh_values</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="w">  </span><span class="k">function</span><span class="w"> </span><span class="k">automatic</span><span class="w"> </span><span class="p">[</span><span class="n">MAX_FME_DFH_IDX</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">][</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">get_fme_dfh_values</span><span class="p">();</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="w">      </span><span class="kt">logic</span><span class="p">[</span><span class="n">MAX_FME_DFH_IDX</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">][</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">fme_dfh_values</span><span class="p">;</span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">      </span><span class="n">fme_dfh_values</span><span class="p">[</span><span class="n">FME_DFH_IDX</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h4000</span><span class="n">_0000_1000_0000</span><span class="p">;</span>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="w">      </span><span class="n">fme_dfh_values</span><span class="p">[</span><span class="n">THERM_MNGM_DFH_IDX</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_002000_0001</span><span class="p">;</span>
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="w">      </span><span class="n">fme_dfh_values</span><span class="p">[</span><span class="n">GLBL_PERF_DFH_IDX</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_001000_0007</span><span class="p">;</span>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="w">      </span><span class="n">fme_dfh_values</span><span class="p">[</span><span class="n">GLBL_ERROR_DFH_IDX</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_00C000_1004</span><span class="p">;</span><span class="w">  </span>
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a><span class="w">      </span><span class="n">fme_dfh_values</span><span class="p">[</span><span class="n">SPI_DFH_IDX</span><span class="p">]</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_010000_000e</span><span class="p">;</span><span class="w">  </span>
<a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a><span class="w">      </span><span class="n">fme_dfh_values</span><span class="p">[</span><span class="n">PCIE_DFH_IDX</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_010000_0020</span><span class="p">;</span><span class="w">  </span>
<a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a><span class="w">      </span><span class="n">fme_dfh_values</span><span class="p">[</span><span class="n">HSSI_DFH_IDX</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_010000_100f</span><span class="p">;</span><span class="w">  </span>
<a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a><span class="w">      </span><span class="n">fme_dfh_values</span><span class="p">[</span><span class="n">EMIF_DFH_IDX</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_010000_0009</span><span class="p">;</span><span class="w"> </span><span class="c1">//Update to link to Hello_FIM </span>
<a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a><span class="w">      </span><span class="n">fme_dfh_values</span><span class="p">[</span><span class="n">HELLO_FIM_DFH_IDX</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_040000_0FFF</span><span class="p">;</span><span class="w">  </span><span class="c1">//New for Hello_FIM</span>
<a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a><span class="w">      </span><span class="n">fme_dfh_values</span><span class="p">[</span><span class="n">FME_PR_DFH_IDX</span><span class="p">]</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_001000_1005</span><span class="p">;</span><span class="w">  </span>
<a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a><span class="w">      </span><span class="n">fme_dfh_values</span><span class="p">[</span><span class="n">PORT_DFH_IDX</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h4000</span><span class="n">_0000_1000_1001</span><span class="p">;</span>
<a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a><span class="w">      </span><span class="n">fme_dfh_values</span><span class="p">[</span><span class="n">USER_CLOCK_DFH_IDX</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_001000_0014</span><span class="p">;</span>
<a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a><span class="w">      </span><span class="n">fme_dfh_values</span><span class="p">[</span><span class="n">PORT_STP_DFH_IDX</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00000_00D000_2013</span><span class="p">;</span>
<a id="__codelineno-41-17" name="__codelineno-41-17" href="#__codelineno-41-17"></a><span class="w">      </span><span class="n">fme_dfh_values</span><span class="p">[</span><span class="n">AFU_INTF_DFH_IDX</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mh">64&#39;h3</span><span class="n">_00001_000000_2010</span><span class="p">;</span><span class="w"> </span>
<a id="__codelineno-41-18" name="__codelineno-41-18" href="#__codelineno-41-18"></a>
<a id="__codelineno-41-19" name="__codelineno-41-19" href="#__codelineno-41-19"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">fme_dfh_values</span><span class="p">;</span>
<a id="__codelineno-41-20" name="__codelineno-41-20" href="#__codelineno-41-20"></a><span class="w">   </span><span class="k">endfunction</span>
</code></pre></div>
<ol>
<li>Update verification/scripts/Makefile_VCS.mk to set macro for INCLUDE_HELLO_FIM starting at line 56 to add +define+INCLUDE_HELLO_FIM
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="nv">VLOG_OPT</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span>+define+SIM_MODE<span class="w"> </span>+define+VCS_S10<span class="w"> </span>+define+RP_MAX_TAGS<span class="o">=</span><span class="m">64</span><span class="w"> </span>+define+INCLUDE_DDR4<span class="w"> </span>+define+INCLUDE_SPI_BRIDGE<span class="w"> </span>+define+INCLUDE_USER_CLOCK<span class="w"> </span>+define+INCLUDE_HSSI<span class="w"> </span>+define+SIM_USE_PCIE_DUMMY_CSR<span class="w"> </span>+define+INCLUDE_HELLO_FIM
</code></pre></div></li>
<li>Update sim/scripts/rtl_comb.f to add the path to your new hello_fim_top and hello_top_com SystemVerilog files.  The update is shown below as the new line - 329 below:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="nv">$WORKDIR</span>/src/hello_fim/hello_fim_com.sv
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="nv">$WORKDIR</span>/src/hello_fim/hello_fim_top.sv
</code></pre></div>
<p>After making these changes, run the unit level simulation using sim/unit_test/dfh_walker test.  Before running, ensure your shell has the environment variables set properly as defined in <a href="#setting-up-required-environment-variables">Setting Up Required Environment Variables</a>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="nb">cd</span><span class="w"> </span>verification/scripts
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>cmplib
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>gmake<span class="w"> </span>-f<span class="w"> </span>Makefile_VCS.mk<span class="w"> </span>build<span class="w"> </span>run<span class="w"> </span><span class="o">[</span><span class="nv">DUMP</span><span class="o">=</span><span class="m">1</span><span class="o">]</span>
</code></pre></div>
<p>Expected output:
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="w"> </span>********************************************
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="w"> </span>Running<span class="w"> </span>TEST<span class="o">(</span><span class="m">0</span><span class="o">)</span><span class="w"> </span>:<span class="w"> </span>test_fme_dfh_walking
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>********************************************
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00000000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a>
<a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x4000000010000000
<a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a>
<a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a>FME_DFH
<a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x0<span class="o">)</span>
<a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x4000000010000000<span class="o">)</span>
<a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00001000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a>
<a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000020000001
<a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a>
<a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a>THERM_MNGM_DFH
<a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x1000<span class="o">)</span>
<a id="__codelineno-45-17" name="__codelineno-45-17" href="#__codelineno-45-17"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000020000001<span class="o">)</span>
<a id="__codelineno-45-18" name="__codelineno-45-18" href="#__codelineno-45-18"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00003000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-45-19" name="__codelineno-45-19" href="#__codelineno-45-19"></a>
<a id="__codelineno-45-20" name="__codelineno-45-20" href="#__codelineno-45-20"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000010000007
<a id="__codelineno-45-21" name="__codelineno-45-21" href="#__codelineno-45-21"></a>
<a id="__codelineno-45-22" name="__codelineno-45-22" href="#__codelineno-45-22"></a>GLBL_PERF_DFH
<a id="__codelineno-45-23" name="__codelineno-45-23" href="#__codelineno-45-23"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x3000<span class="o">)</span>
<a id="__codelineno-45-24" name="__codelineno-45-24" href="#__codelineno-45-24"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000010000007<span class="o">)</span>
<a id="__codelineno-45-25" name="__codelineno-45-25" href="#__codelineno-45-25"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00004000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-45-26" name="__codelineno-45-26" href="#__codelineno-45-26"></a>
<a id="__codelineno-45-27" name="__codelineno-45-27" href="#__codelineno-45-27"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x30000000c0001004
<a id="__codelineno-45-28" name="__codelineno-45-28" href="#__codelineno-45-28"></a>
<a id="__codelineno-45-29" name="__codelineno-45-29" href="#__codelineno-45-29"></a>GLBL_ERROR_DFH
<a id="__codelineno-45-30" name="__codelineno-45-30" href="#__codelineno-45-30"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x4000<span class="o">)</span>
<a id="__codelineno-45-31" name="__codelineno-45-31" href="#__codelineno-45-31"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x30000000c0001004<span class="o">)</span>
<a id="__codelineno-45-32" name="__codelineno-45-32" href="#__codelineno-45-32"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00010000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-45-33" name="__codelineno-45-33" href="#__codelineno-45-33"></a>
<a id="__codelineno-45-34" name="__codelineno-45-34" href="#__codelineno-45-34"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x300000010000000e
<a id="__codelineno-45-35" name="__codelineno-45-35" href="#__codelineno-45-35"></a>
<a id="__codelineno-45-36" name="__codelineno-45-36" href="#__codelineno-45-36"></a>SPI_DFH
<a id="__codelineno-45-37" name="__codelineno-45-37" href="#__codelineno-45-37"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x10000<span class="o">)</span>
<a id="__codelineno-45-38" name="__codelineno-45-38" href="#__codelineno-45-38"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x300000010000000e<span class="o">)</span>
<a id="__codelineno-45-39" name="__codelineno-45-39" href="#__codelineno-45-39"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00020000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-45-40" name="__codelineno-45-40" href="#__codelineno-45-40"></a>
<a id="__codelineno-45-41" name="__codelineno-45-41" href="#__codelineno-45-41"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000100000020
<a id="__codelineno-45-42" name="__codelineno-45-42" href="#__codelineno-45-42"></a>
<a id="__codelineno-45-43" name="__codelineno-45-43" href="#__codelineno-45-43"></a>PCIE_DFH
<a id="__codelineno-45-44" name="__codelineno-45-44" href="#__codelineno-45-44"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x20000<span class="o">)</span>
<a id="__codelineno-45-45" name="__codelineno-45-45" href="#__codelineno-45-45"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000100000020<span class="o">)</span>
<a id="__codelineno-45-46" name="__codelineno-45-46" href="#__codelineno-45-46"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00030000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-45-47" name="__codelineno-45-47" href="#__codelineno-45-47"></a>
<a id="__codelineno-45-48" name="__codelineno-45-48" href="#__codelineno-45-48"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x300000010000100f
<a id="__codelineno-45-49" name="__codelineno-45-49" href="#__codelineno-45-49"></a>
<a id="__codelineno-45-50" name="__codelineno-45-50" href="#__codelineno-45-50"></a>HSSI_DFH
<a id="__codelineno-45-51" name="__codelineno-45-51" href="#__codelineno-45-51"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x30000<span class="o">)</span>
<a id="__codelineno-45-52" name="__codelineno-45-52" href="#__codelineno-45-52"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x300000010000100f<span class="o">)</span>
<a id="__codelineno-45-53" name="__codelineno-45-53" href="#__codelineno-45-53"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00040000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-45-54" name="__codelineno-45-54" href="#__codelineno-45-54"></a>
<a id="__codelineno-45-55" name="__codelineno-45-55" href="#__codelineno-45-55"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000100000009
<a id="__codelineno-45-56" name="__codelineno-45-56" href="#__codelineno-45-56"></a>
<a id="__codelineno-45-57" name="__codelineno-45-57" href="#__codelineno-45-57"></a>EMIF_DFH
<a id="__codelineno-45-58" name="__codelineno-45-58" href="#__codelineno-45-58"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x40000<span class="o">)</span>
<a id="__codelineno-45-59" name="__codelineno-45-59" href="#__codelineno-45-59"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000100000009<span class="o">)</span>
<a id="__codelineno-45-60" name="__codelineno-45-60" href="#__codelineno-45-60"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00050000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-45-61" name="__codelineno-45-61" href="#__codelineno-45-61"></a>
<a id="__codelineno-45-62" name="__codelineno-45-62" href="#__codelineno-45-62"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000400000fff
<a id="__codelineno-45-63" name="__codelineno-45-63" href="#__codelineno-45-63"></a>
<a id="__codelineno-45-64" name="__codelineno-45-64" href="#__codelineno-45-64"></a>HELLO_FIM_DFH
<a id="__codelineno-45-65" name="__codelineno-45-65" href="#__codelineno-45-65"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x50000<span class="o">)</span>
<a id="__codelineno-45-66" name="__codelineno-45-66" href="#__codelineno-45-66"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000400000fff<span class="o">)</span>
<a id="__codelineno-45-67" name="__codelineno-45-67" href="#__codelineno-45-67"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00090000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-45-68" name="__codelineno-45-68" href="#__codelineno-45-68"></a>
<a id="__codelineno-45-69" name="__codelineno-45-69" href="#__codelineno-45-69"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000010001005
<a id="__codelineno-45-70" name="__codelineno-45-70" href="#__codelineno-45-70"></a>
<a id="__codelineno-45-71" name="__codelineno-45-71" href="#__codelineno-45-71"></a>FME_PR_DFH
<a id="__codelineno-45-72" name="__codelineno-45-72" href="#__codelineno-45-72"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x90000<span class="o">)</span>
<a id="__codelineno-45-73" name="__codelineno-45-73" href="#__codelineno-45-73"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000010001005<span class="o">)</span>
<a id="__codelineno-45-74" name="__codelineno-45-74" href="#__codelineno-45-74"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00091000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-45-75" name="__codelineno-45-75" href="#__codelineno-45-75"></a>
<a id="__codelineno-45-76" name="__codelineno-45-76" href="#__codelineno-45-76"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x4000000010001001
<a id="__codelineno-45-77" name="__codelineno-45-77" href="#__codelineno-45-77"></a>
<a id="__codelineno-45-78" name="__codelineno-45-78" href="#__codelineno-45-78"></a>PORT_DFH
<a id="__codelineno-45-79" name="__codelineno-45-79" href="#__codelineno-45-79"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x91000<span class="o">)</span>
<a id="__codelineno-45-80" name="__codelineno-45-80" href="#__codelineno-45-80"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x4000000010001001<span class="o">)</span>
<a id="__codelineno-45-81" name="__codelineno-45-81" href="#__codelineno-45-81"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00092000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-45-82" name="__codelineno-45-82" href="#__codelineno-45-82"></a>
<a id="__codelineno-45-83" name="__codelineno-45-83" href="#__codelineno-45-83"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000000010000014
<a id="__codelineno-45-84" name="__codelineno-45-84" href="#__codelineno-45-84"></a>
<a id="__codelineno-45-85" name="__codelineno-45-85" href="#__codelineno-45-85"></a>USER_CLOCK_DFH
<a id="__codelineno-45-86" name="__codelineno-45-86" href="#__codelineno-45-86"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x92000<span class="o">)</span>
<a id="__codelineno-45-87" name="__codelineno-45-87" href="#__codelineno-45-87"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000000010000014<span class="o">)</span>
<a id="__codelineno-45-88" name="__codelineno-45-88" href="#__codelineno-45-88"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x00093000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-45-89" name="__codelineno-45-89" href="#__codelineno-45-89"></a>
<a id="__codelineno-45-90" name="__codelineno-45-90" href="#__codelineno-45-90"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x30000000d0002013
<a id="__codelineno-45-91" name="__codelineno-45-91" href="#__codelineno-45-91"></a>
<a id="__codelineno-45-92" name="__codelineno-45-92" href="#__codelineno-45-92"></a>PORT_STP_DFH
<a id="__codelineno-45-93" name="__codelineno-45-93" href="#__codelineno-45-93"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0x93000<span class="o">)</span>
<a id="__codelineno-45-94" name="__codelineno-45-94" href="#__codelineno-45-94"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x30000000d0002013<span class="o">)</span>
<a id="__codelineno-45-95" name="__codelineno-45-95" href="#__codelineno-45-95"></a>READ64:<span class="w"> </span><span class="nv">address</span><span class="o">=</span>0x000a0000<span class="w"> </span><span class="nv">bar</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vf_active</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">pfn</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vfn</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-45-96" name="__codelineno-45-96" href="#__codelineno-45-96"></a>
<a id="__codelineno-45-97" name="__codelineno-45-97" href="#__codelineno-45-97"></a><span class="w">   </span>READDATA:<span class="w"> </span>0x3000010000002010
<a id="__codelineno-45-98" name="__codelineno-45-98" href="#__codelineno-45-98"></a>
<a id="__codelineno-45-99" name="__codelineno-45-99" href="#__codelineno-45-99"></a>AFU_INTF_DFH
<a id="__codelineno-45-100" name="__codelineno-45-100" href="#__codelineno-45-100"></a><span class="w">   </span>Address<span class="w">   </span><span class="o">(</span>0xa0000<span class="o">)</span>
<a id="__codelineno-45-101" name="__codelineno-45-101" href="#__codelineno-45-101"></a><span class="w">   </span>DFH<span class="w"> </span>value<span class="w"> </span><span class="o">(</span>0x3000010000002010<span class="o">)</span>
<a id="__codelineno-45-102" name="__codelineno-45-102" href="#__codelineno-45-102"></a>MMIO<span class="w"> </span>error<span class="w"> </span>count<span class="w"> </span>matches:<span class="w"> </span>x
<a id="__codelineno-45-103" name="__codelineno-45-103" href="#__codelineno-45-103"></a>
<a id="__codelineno-45-104" name="__codelineno-45-104" href="#__codelineno-45-104"></a>Test<span class="w"> </span>status:<span class="w"> </span>OK
<a id="__codelineno-45-105" name="__codelineno-45-105" href="#__codelineno-45-105"></a>
<a id="__codelineno-45-106" name="__codelineno-45-106" href="#__codelineno-45-106"></a>********************
<a id="__codelineno-45-107" name="__codelineno-45-107" href="#__codelineno-45-107"></a><span class="w">  </span>Test<span class="w"> </span>summary
<a id="__codelineno-45-108" name="__codelineno-45-108" href="#__codelineno-45-108"></a>********************
<a id="__codelineno-45-109" name="__codelineno-45-109" href="#__codelineno-45-109"></a><span class="w">   </span>test_fme_dfh_walking<span class="w"> </span><span class="o">(</span><span class="nv">id</span><span class="o">=</span><span class="m">0</span><span class="o">)</span><span class="w"> </span>-<span class="w"> </span>pass
<a id="__codelineno-45-110" name="__codelineno-45-110" href="#__codelineno-45-110"></a>Test<span class="w"> </span>passed!
<a id="__codelineno-45-111" name="__codelineno-45-111" href="#__codelineno-45-111"></a>Assertion<span class="w"> </span>count:<span class="w"> </span><span class="m">0</span>
</code></pre></div></p>
<h4 id="516-synsyn_topd5005qsf">5.1.6. syn/syn_top/d5005.qsf<a class="headerlink" href="#516-synsyn_topd5005qsf" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p>Edit syn/syn_top/d5005.qsf      </p>
<ol>
<li>
<p>Add new macro "INCLUDE_HELLO_FIM" line 107
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="w">        </span>set_global_assignment<span class="w"> </span>-name<span class="w"> </span>VERILOG_MACRO<span class="w"> </span><span class="s2">&quot;INCLUDE_HELLO_FIM&quot;</span>
</code></pre></div></p>
</li>
<li>
<p>Add new line 211 to source TCL script with new hello_fim files
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="w">        </span>set_global_assignment<span class="w"> </span>-name<span class="w"> </span>SOURCE_TCL_SCRIPT_FILE<span class="w"> </span>../../../syn/setup/hello_fim_design_files.tcl
</code></pre></div></p>
</li>
</ol>
<h4 id="517-synsetuphello_fim_design_filestcl">5.1.7. syn/setup/hello_fim_design_files.tcl<a class="headerlink" href="#517-synsetuphello_fim_design_filestcl" title="Permanent link">&para;</a></h4>
</li>
</ol>
<p>Create "hello_fim_design_files.tcl" file and store in the syn/setup directory. This tcl file is called from d5005.qsf.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="c"># Copyright 2021 Intel Corporation.</span>
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="c">#</span>
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="c"># THIS SOFTWARE MAY CONTAIN PREPRODUCTION CODE AND IS PROVIDED BY THE</span>
<a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a><span class="c"># COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED</span>
<a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a><span class="c"># WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF</span>
<a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a><span class="c"># MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a><span class="c"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE</span>
<a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a><span class="c"># LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
<a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a><span class="c"># CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
<a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a><span class="c"># SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR</span>
<a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a><span class="c"># BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,</span>
<a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a><span class="c"># WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE</span>
<a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a><span class="c"># OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,</span>
<a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a><span class="c"># EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a id="__codelineno-48-15" name="__codelineno-48-15" href="#__codelineno-48-15"></a><span class="c">#</span>
<a id="__codelineno-48-16" name="__codelineno-48-16" href="#__codelineno-48-16"></a><span class="c"># Hello FIM Files</span>
<a id="__codelineno-48-17" name="__codelineno-48-17" href="#__codelineno-48-17"></a><span class="c">#--------------------</span>
<a id="__codelineno-48-18" name="__codelineno-48-18" href="#__codelineno-48-18"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>SYSTEMVERILOG_FILE<span class="w"> </span>src<span class="o">/</span>hello_fim<span class="o">/</span>hello_fim_com.sv
<a id="__codelineno-48-19" name="__codelineno-48-19" href="#__codelineno-48-19"></a><span class="nv">set_global_assignment</span><span class="w"> </span><span class="o">-</span>name<span class="w"> </span>SYSTEMVERILOG_FILE<span class="w"> </span>src<span class="o">/</span>hello_fim<span class="o">/</span>hello_fim_top.sv
</code></pre></div>
<h4 id="518-build-hello_fim-example">5.1.8. Build hello_fim example<a class="headerlink" href="#518-build-hello_fim-example" title="Permanent link">&para;</a></h4>
<p>With the preceding changes complete, build the new hello_fim example using the following steps:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_ROOTDIR</span>
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>d5005<span class="w"> </span>work_d5005_hello_fim
</code></pre></div>
<p>Verify the design successfully compiled and timing closure is achieved by checking work_d5005_hello_fim/syn/syn_top/output_files/timing_report/clocks.sta.fail.summary - this file should be empty.  If there are timing failures, then this file will list the failing clock domain(s).</p>
<h4 id="519-test-the-hello_fim-on-a-d5005">5.1.9. Test the hello_fim on a D5005<a class="headerlink" href="#519-test-the-hello_fim-on-a-d5005" title="Permanent link">&para;</a></h4>
<p>Load the built FPGA binary file using an unsigned image.  The FPGA image will be in work_d5005_hello_fim/syn/syn_top/output_files/d5005_page1_unsigned.bin</p>
<p>Provide the file d5005_page1_unsigned.bin on the server with the Intel® FPGA <abbr title="Programmable Acceleration Card: FPGA based Accelerator card">PAC</abbr> D5005.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>sudo<span class="w"> </span>fpgasupdate<span class="w"> </span>d5005_page1_unsigned.bin<span class="w"> </span>&lt;D5005<span class="w"> </span>PCIe<span class="w"> </span>B:D.F&gt;
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>sudo<span class="w"> </span>rsu<span class="w"> </span>bmcimg<span class="w"> </span>&lt;D5005<span class="w"> </span>PCIe<span class="w"> </span>B:D.F&gt;
</code></pre></div>
Verify FPGA image is loaded.
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>sudo<span class="w"> </span>fpgainfo<span class="w"> </span>fme
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="c1">## Output</span>
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>Intel<span class="w"> </span>FPGA<span class="w"> </span>Programmable<span class="w"> </span>Acceleration<span class="w"> </span>Card<span class="w"> </span>D5005
<a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller,<span class="w"> </span>MAX10<span class="w"> </span>NIOS<span class="w"> </span>FW<span class="w"> </span>version:<span class="w"> </span><span class="m">2</span>.0.13<span class="w"> </span>
<a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller,<span class="w"> </span>MAX10<span class="w"> </span>Build<span class="w"> </span>version:<span class="w"> </span><span class="m">2</span>.0.8<span class="w"> </span>
<a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a>//******<span class="w"> </span>FME<span class="w"> </span>******//
<a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xF000000
<a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:3B:00.0
<a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x138D
<a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x00
<a id="__codelineno-51-14" name="__codelineno-51-14" href="#__codelineno-51-14"></a>Ports<span class="w"> </span>Num<span class="w">                        </span>:<span class="w"> </span><span class="m">01</span>
<a id="__codelineno-51-15" name="__codelineno-51-15" href="#__codelineno-51-15"></a>Bitstream<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x40100022C164DB1
<a id="__codelineno-51-16" name="__codelineno-51-16" href="#__codelineno-51-16"></a>Bitstream<span class="w"> </span>Version<span class="w">                </span>:<span class="w"> </span><span class="m">4</span>.0.1
<a id="__codelineno-51-17" name="__codelineno-51-17" href="#__codelineno-51-17"></a>Pr<span class="w"> </span>Interface<span class="w"> </span>Id<span class="w">                  </span>:<span class="w"> </span>7d91e0d0-4dcd-58c3-a93d-b9295e6e29b0
<a id="__codelineno-51-18" name="__codelineno-51-18" href="#__codelineno-51-18"></a>Boot<span class="w"> </span>Page<span class="w">                        </span>:<span class="w"> </span>user
</code></pre></div></p>
<p>Use the <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> tool opae.io to check default driver binding using your card under test PCIe B:D.F.  The steps below will use 0000:12:00.0 as the card under test PCIe B:D.F.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="w"> </span>sudo<span class="w"> </span>opae.io<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span><span class="nv">$USER</span>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="w"> </span><span class="c1">##Output</span>
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a><span class="w"> </span><span class="o">[</span><span class="m">0000</span>:12:00.0<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>D5005<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
</code></pre></div>
The dfl-pci driver is used by <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> fpgainfo commands.  The next steps will bind the card under test to the vfio driver to enable access to the registers.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="w"> </span>sudo<span class="w"> </span>opae.io<span class="w"> </span>init<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span><span class="nv">$USER</span>
<a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="w"> </span><span class="c1">##Output</span>
<a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="w"> </span>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a>Unbinding<span class="w"> </span><span class="o">(</span>0x8086,0xbcce<span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>from<span class="w"> </span>dfl-pci
<a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a>Binding<span class="w"> </span><span class="o">(</span>0x8086,0xbcce<span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>to<span class="w"> </span>vfio-pci
<a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a>iommu<span class="w"> </span>group<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">(</span>0x8086,0xbcce<span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>is<span class="w"> </span><span class="m">35</span>
<a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a>Assigning<span class="w"> </span>/dev/vfio/35<span class="w"> </span>to<span class="w"> </span><span class="nv">$USER</span>
</code></pre></div>
Confirm the vfio driver is bound to the card under test.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>opae.io<span class="w"> </span>ls
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="c1">## Output</span>
<a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a><span class="o">[</span><span class="m">0000</span>:12:00.0<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>D5005<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>vfio-pci<span class="o">)</span>
</code></pre></div>
Run the following command to walk DFH link list.  The new hello_fim register is located at offset 0x50000.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>opae.io<span class="w"> </span>walk<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="c1">## Output</span>
<a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>offset:<span class="w"> </span>0x0000,<span class="w"> </span>value:<span class="w"> </span>0x4000000010000000
<a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x4
<a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a>offset:<span class="w"> </span>0x1000,<span class="w"> </span>value:<span class="w"> </span>0x3000000020000001
<a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x2000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a>offset:<span class="w"> </span>0x3000,<span class="w"> </span>value:<span class="w"> </span>0x3000000010000007
<a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x7,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a>offset:<span class="w"> </span>0x4000,<span class="w"> </span>value:<span class="w"> </span>0x30000000c0001004
<a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x4,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0xc000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-55-12" name="__codelineno-55-12" href="#__codelineno-55-12"></a>offset:<span class="w"> </span>0x10000,<span class="w"> </span>value:<span class="w"> </span>0x300000010000000e
<a id="__codelineno-55-13" name="__codelineno-55-13" href="#__codelineno-55-13"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0xe,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x10000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-55-14" name="__codelineno-55-14" href="#__codelineno-55-14"></a>offset:<span class="w"> </span>0x20000,<span class="w"> </span>value:<span class="w"> </span>0x3000000100000020
<a id="__codelineno-55-15" name="__codelineno-55-15" href="#__codelineno-55-15"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x20,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x10000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-55-16" name="__codelineno-55-16" href="#__codelineno-55-16"></a>offset:<span class="w"> </span>0x30000,<span class="w"> </span>value:<span class="w"> </span>0x300000010000100f
<a id="__codelineno-55-17" name="__codelineno-55-17" href="#__codelineno-55-17"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0xf,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x10000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-55-18" name="__codelineno-55-18" href="#__codelineno-55-18"></a>offset:<span class="w"> </span>0x40000,<span class="w"> </span>value:<span class="w"> </span>0x3000000100000009
<a id="__codelineno-55-19" name="__codelineno-55-19" href="#__codelineno-55-19"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x9,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x10000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-55-20" name="__codelineno-55-20" href="#__codelineno-55-20"></a>offset:<span class="w"> </span>0x50000,<span class="w"> </span>value:<span class="w"> </span>0x3000000400000fff
<a id="__codelineno-55-21" name="__codelineno-55-21" href="#__codelineno-55-21"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0xfff,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x40000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-55-22" name="__codelineno-55-22" href="#__codelineno-55-22"></a>offset:<span class="w"> </span>0x90000,<span class="w"> </span>value:<span class="w"> </span>0x3000000010001005
<a id="__codelineno-55-23" name="__codelineno-55-23" href="#__codelineno-55-23"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x5,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-55-24" name="__codelineno-55-24" href="#__codelineno-55-24"></a>offset:<span class="w"> </span>0x91000,<span class="w"> </span>value:<span class="w"> </span>0x4000000010001001
<a id="__codelineno-55-25" name="__codelineno-55-25" href="#__codelineno-55-25"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x4
<a id="__codelineno-55-26" name="__codelineno-55-26" href="#__codelineno-55-26"></a>offset:<span class="w"> </span>0x92000,<span class="w"> </span>value:<span class="w"> </span>0x3000000010000014
<a id="__codelineno-55-27" name="__codelineno-55-27" href="#__codelineno-55-27"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x14,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-55-28" name="__codelineno-55-28" href="#__codelineno-55-28"></a>offset:<span class="w"> </span>0x93000,<span class="w"> </span>value:<span class="w"> </span>0x30000000d0002013
<a id="__codelineno-55-29" name="__codelineno-55-29" href="#__codelineno-55-29"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x13,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x2,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0xd000,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
<a id="__codelineno-55-30" name="__codelineno-55-30" href="#__codelineno-55-30"></a>offset:<span class="w"> </span>0xa0000,<span class="w"> </span>value:<span class="w"> </span>0x3000010000002010
<a id="__codelineno-55-31" name="__codelineno-55-31" href="#__codelineno-55-31"></a><span class="w">    </span>dfh:<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x10,<span class="w"> </span><span class="nv">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x2,<span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">eol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x1,<span class="w"> </span><span class="nv">reserved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x0,<span class="w"> </span><span class="nv">feature_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x3
</code></pre></div>
Read the default values from the hello_fim registers:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x50000
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a>0x3000000400000fff
<a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x50030
<a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a>0x0
<a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x50038
<a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a>0x6626070150000034
</code></pre></div>
Write the scratchpad register at 0x50030</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x50038<span class="w"> </span>0x123456789abcdef
<a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x50038
<a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a>0x6626070150000034
<a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x50030<span class="w"> </span>0x123456789abcdef
<a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x50030
<a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a>0x123456789abcdef
<a id="__codelineno-57-11" name="__codelineno-57-11" href="#__codelineno-57-11"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x50030<span class="w"> </span>0xfedcba9876543210
<a id="__codelineno-57-12" name="__codelineno-57-12" href="#__codelineno-57-12"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-57-13" name="__codelineno-57-13" href="#__codelineno-57-13"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x50030
<a id="__codelineno-57-14" name="__codelineno-57-14" href="#__codelineno-57-14"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-57-15" name="__codelineno-57-15" href="#__codelineno-57-15"></a>0xfedcba9876543210
<a id="__codelineno-57-16" name="__codelineno-57-16" href="#__codelineno-57-16"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>poke<span class="w"> </span>0x50030<span class="w"> </span>0x55550000aaaaffff
<a id="__codelineno-57-17" name="__codelineno-57-17" href="#__codelineno-57-17"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-57-18" name="__codelineno-57-18" href="#__codelineno-57-18"></a>$<span class="w"> </span>opae.io<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>-r<span class="w"> </span><span class="m">0</span><span class="w"> </span>peek<span class="w"> </span>0x50030
<a id="__codelineno-57-19" name="__codelineno-57-19" href="#__codelineno-57-19"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-57-20" name="__codelineno-57-20" href="#__codelineno-57-20"></a>0x55550000aaaaffff
</code></pre></div>
<p>Release the card under test from the vfio driver to re-bind to the dfl-pci driver:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>sudo<span class="w"> </span>opae.io<span class="w"> </span>release<span class="w"> </span>-d<span class="w"> </span><span class="m">0000</span>:12:00.0
<a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="c1">## Output</span>
<a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>Releasing<span class="w"> </span><span class="o">(</span>0x8086,0xbcce<span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>from<span class="w"> </span>vfio-pci
<a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a>Rebinding<span class="w"> </span><span class="o">(</span>0x8086,0xbcce<span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">0000</span>:12:00.0<span class="w"> </span>to<span class="w"> </span>dfl-pci
<a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a>$<span class="w"> </span>sudo<span class="w"> </span>opae.io<span class="w"> </span>ls
<a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a>opae.io<span class="w"> </span><span class="m">0</span>.2.3
<a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a><span class="o">[</span><span class="m">0000</span>:12:00.0<span class="o">]</span><span class="w"> </span><span class="o">(</span>0x8086,<span class="w"> </span>0xbcce<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span>D5005<span class="w"> </span>ADP<span class="w"> </span><span class="o">(</span>Driver:<span class="w"> </span>dfl-pci<span class="o">)</span>
</code></pre></div>
<h3 id="52-memory-subsystem-modification">5.2. Memory Subsystem Modification<a class="headerlink" href="#52-memory-subsystem-modification" title="Permanent link">&para;</a></h3>
<p><abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> enables modifications on the different subsystems that encompass the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr>. To customize the Memory Subsystem follow these instructions.</p>
<ol>
<li>
<p>Set up the environment variables as described in section <a href="#421-setting-up-required-environment-variables">4.2.1. Setting Up Required Environment Variables</a></p>
</li>
<li>
<p>Modify the NUM_MEM_CH parameter in src/afu_top/mux/top_cfg_pkg.sv
Change NUM_MEM_CH from 4 to 2 as shown in below code </p>
</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="c1">//=========================================================================================================================</span>
<a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="c1">//                         OFS Configuration Parameters                                                                 </span>
<a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a><span class="c1">//=========================================================================================================================</span>
<a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a><span class="w">     </span><span class="k">parameter</span><span class="w"> </span><span class="n">NUM_MEM_CH</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">2</span><span class="w">                                                 </span><span class="p">,</span><span class="c1">// Number of Memory/DDR Channel         </span>
<a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a><span class="w">               </span><span class="n">NUM_HOST</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="w">                                                 </span><span class="p">,</span><span class="c1">// Number of Host/Upstream Ports        </span>
<a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a><span class="w">               </span><span class="n">NUM_PORT</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mh">4</span><span class="w">                                                 </span><span class="p">,</span><span class="c1">// Number of Functions/Downstream Ports </span>
<a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a><span class="w">               </span><span class="n">DATA_WIDTH</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mh">512</span><span class="w">                                               </span><span class="p">,</span><span class="c1">// Data Width of Interface              </span>
<a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a><span class="w">               </span><span class="n">TOTAL_BAR_SIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">20</span><span class="w">                                                </span><span class="p">,</span><span class="c1">// Total Space for APF/BPF BARs (2^N) </span>
<a id="__codelineno-59-9" name="__codelineno-59-9" href="#__codelineno-59-9"></a><span class="w">           </span><span class="c1">//------------+-------------+-------------+-----------------+           //--------------------------------------</span>
<a id="__codelineno-59-10" name="__codelineno-59-10" href="#__codelineno-59-10"></a><span class="w">           </span><span class="c1">// VF Active  |     PF #    |     VF #    |  Mux Port Map   |           //  PF/VF Mapping Parameters            </span>
<a id="__codelineno-59-11" name="__codelineno-59-11" href="#__codelineno-59-11"></a><span class="w">           </span><span class="c1">//------------+-------------+-------------+-----------------+           //--------------------------------------</span>
<a id="__codelineno-59-12" name="__codelineno-59-12" href="#__codelineno-59-12"></a><span class="w">             </span><span class="n">CFG_VA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">CFG_PF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">CFG_VF</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="mh">0</span><span class="w"> </span><span class="p">,</span><span class="w">  </span><span class="n">CFG_PID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">3</span><span class="w">    </span><span class="p">,</span><span class="w">           </span><span class="c1">//  Configuration Register Block        </span>
<a id="__codelineno-59-13" name="__codelineno-59-13" href="#__codelineno-59-13"></a><span class="w">             </span><span class="n">HLB_VA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">HLB_PF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">HLB_VF</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="mh">0</span><span class="w"> </span><span class="p">,</span><span class="w">  </span><span class="n">HLB_PID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="w">    </span><span class="p">,</span><span class="w">           </span><span class="c1">//  HE Loopback Engine                  </span>
<a id="__codelineno-59-14" name="__codelineno-59-14" href="#__codelineno-59-14"></a><span class="w">             </span><span class="n">PRG_VA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">PRG_PF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">PRG_VF</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="mh">1</span><span class="w"> </span><span class="p">,</span><span class="w">  </span><span class="n">PRG_PID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="w">    </span><span class="p">,</span><span class="w">           </span><span class="c1">//  Partial Reconfiguration Gasket      </span>
<a id="__codelineno-59-15" name="__codelineno-59-15" href="#__codelineno-59-15"></a><span class="w">             </span><span class="n">HSI_VA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">HSI_PF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">HSI_VF</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="mh">2</span><span class="w"> </span><span class="p">,</span><span class="w">  </span><span class="n">HSI_PID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">2</span><span class="w">    </span><span class="p">;</span><span class="w">           </span><span class="c1">//  HSSI interface </span>
</code></pre></div>
<p>Compile a new <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> that incorporates the newly configured Memory Subsystem. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$OFS_BUILD_ROOT</span>/ofs-d5005
<a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>ofs-common/scripts/common/syn/build_top.sh<span class="w"> </span>d5005<span class="w"> </span>work_d5005_mem_2channel
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>***********************************
<a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>***
<a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a>***        OFS_PROJECT: d5005
<a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a>***        Q_PROJECT:  d5005
<a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a>***        Q_REVISION: d5005
<a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a>***        SEED: 03
<a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a>***        Build Complete
<a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a>***        Timing Passed!
<a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a>***
<a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a>***********************************
</code></pre></div>
<p>Program d5005_page1_unsigned.bin file using below command</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>sudo<span class="w"> </span>fpgasupdate<span class="w"> </span>d5005_page1_unsigned.bin<span class="w"> </span>3b:00.0
</code></pre></div>
<p>Run rsu command
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>sudo<span class="w"> </span>rsu<span class="w"> </span>bmcimg<span class="w"> </span>3b:00.0
</code></pre></div></p>
<p>Check if binary was loaded correctly
<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>fpgainfo<span class="w"> </span>fme
<a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="c1">## Output</span>
<a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a>Intel<span class="w"> </span>FPGA<span class="w"> </span>Programmable<span class="w"> </span>Acceleration<span class="w"> </span>Card<span class="w"> </span>D5005
<a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller,<span class="w"> </span>MAX10<span class="w"> </span>NIOS<span class="w"> </span>FW<span class="w"> </span>version:<span class="w"> </span><span class="m">2</span>.0.13
<a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a>Board<span class="w"> </span>Management<span class="w"> </span>Controller,<span class="w"> </span>MAX10<span class="w"> </span>Build<span class="w"> </span>version:<span class="w"> </span><span class="m">2</span>.0.8
<a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a>//******<span class="w"> </span>FME<span class="w"> </span>******//
<a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a>Object<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xF000000
<a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a>PCIe<span class="w"> </span>s:b:d.f<span class="w">                     </span>:<span class="w"> </span><span class="m">0000</span>:3B:00.0
<a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a>Vendor<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x8086
<a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a>Device<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0xBCCE
<a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a>SubVendor<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x8086
<a id="__codelineno-64-12" name="__codelineno-64-12" href="#__codelineno-64-12"></a>SubDevice<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span>0x138D
<a id="__codelineno-64-13" name="__codelineno-64-13" href="#__codelineno-64-13"></a>Socket<span class="w"> </span>Id<span class="w">                        </span>:<span class="w"> </span>0x00
<a id="__codelineno-64-14" name="__codelineno-64-14" href="#__codelineno-64-14"></a>Ports<span class="w"> </span>Num<span class="w">                        </span>:<span class="w"> </span><span class="m">01</span>
<a id="__codelineno-64-15" name="__codelineno-64-15" href="#__codelineno-64-15"></a>Bitstream<span class="w"> </span>Id<span class="w">                     </span>:<span class="w"> </span><span class="m">288511862659474365</span>
<a id="__codelineno-64-16" name="__codelineno-64-16" href="#__codelineno-64-16"></a>Bitstream<span class="w"> </span>Version<span class="w">                </span>:<span class="w"> </span><span class="m">4</span>.0.1
<a id="__codelineno-64-17" name="__codelineno-64-17" href="#__codelineno-64-17"></a>Pr<span class="w"> </span>Interface<span class="w"> </span>Id<span class="w">                  </span>:<span class="w"> </span>2b5c1c35-9ec4-54ec-8835-94ce6b6c3461
<a id="__codelineno-64-18" name="__codelineno-64-18" href="#__codelineno-64-18"></a>Boot<span class="w"> </span>Page<span class="w">                        </span>:<span class="w"> </span>user
</code></pre></div></p>
<p>Run Host Excersiser to check Memory Subsystem performance</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>sudo<span class="w"> </span>host_exerciser<span class="w"> </span>mem
<a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a><span class="c1">## Output</span>
<a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a><span class="w">    </span>starting<span class="w"> </span><span class="nb">test</span><span class="w"> </span>run,<span class="w"> </span>count<span class="w"> </span>of<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a>API<span class="w"> </span>version:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a>AFU<span class="w"> </span>clock:<span class="w"> </span><span class="m">250</span><span class="w"> </span>MHz
<a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a>Allocate<span class="w"> </span>SRC<span class="w"> </span>Buffer
<a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a>Allocate<span class="w"> </span>DST<span class="w"> </span>Buffer
<a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a>Allocate<span class="w"> </span>DSM<span class="w"> </span>Buffer
<a id="__codelineno-65-9" name="__codelineno-65-9" href="#__codelineno-65-9"></a><span class="w">    </span>Host<span class="w"> </span>Exerciser<span class="w"> </span>Performance<span class="w"> </span>Counter:
<a id="__codelineno-65-10" name="__codelineno-65-10" href="#__codelineno-65-10"></a><span class="w">    </span>Host<span class="w"> </span>Exerciser<span class="w"> </span>numReads:<span class="w"> </span><span class="m">1024</span>
<a id="__codelineno-65-11" name="__codelineno-65-11" href="#__codelineno-65-11"></a><span class="w">    </span>Host<span class="w"> </span>Exerciser<span class="w"> </span>numWrites:<span class="w"> </span><span class="m">1025</span>
<a id="__codelineno-65-12" name="__codelineno-65-12" href="#__codelineno-65-12"></a><span class="w">    </span>Host<span class="w"> </span>Exerciser<span class="w"> </span>numPendReads:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-65-13" name="__codelineno-65-13" href="#__codelineno-65-13"></a><span class="w">    </span>Host<span class="w"> </span>Exerciser<span class="w"> </span>numPendWrites:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-65-14" name="__codelineno-65-14" href="#__codelineno-65-14"></a><span class="w">    </span>Host<span class="w"> </span>Exerciser<span class="w"> </span>numPendEmifReads:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-65-15" name="__codelineno-65-15" href="#__codelineno-65-15"></a><span class="w">    </span>Host<span class="w"> </span>Exerciser<span class="w"> </span>numPendEmifWrites:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-65-16" name="__codelineno-65-16" href="#__codelineno-65-16"></a><span class="w">    </span>Number<span class="w"> </span>of<span class="w"> </span>clocks:<span class="w"> </span><span class="m">5365</span>
<a id="__codelineno-65-17" name="__codelineno-65-17" href="#__codelineno-65-17"></a><span class="w">    </span>Total<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>Reads<span class="w"> </span>sent:<span class="w"> </span><span class="m">1024</span>
<a id="__codelineno-65-18" name="__codelineno-65-18" href="#__codelineno-65-18"></a><span class="w">    </span>Total<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>Writes<span class="w"> </span>sent:<span class="w"> </span><span class="m">1024</span>
<a id="__codelineno-65-19" name="__codelineno-65-19" href="#__codelineno-65-19"></a><span class="w">    </span>Bandwidth:<span class="w"> </span><span class="m">3</span>.054<span class="w"> </span>GB/s
<a id="__codelineno-65-20" name="__codelineno-65-20" href="#__codelineno-65-20"></a><span class="w">    </span>Test<span class="w"> </span>mem<span class="o">(</span><span class="m">1</span><span class="o">)</span>:<span class="w"> </span>PASS
</code></pre></div>
<p>Verify Memory controller placement in syn/syn_top/output_files/d5005.fit.place.rpt file. Open fitter place stage report in any text editor of your choice, find keyword <em>emif</em> in the file. You should see emif[0] &amp; emif[1] for Memory channel 0 &amp; 1 respectively.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="o">|</span><span class="n">emif</span><span class="p">[</span><span class="mh">0</span><span class="p">].</span><span class="n">ddr4_pr_freeze_sync</span><span class="o">|</span><span class="w">                </span><span class="p">;</span><span class="w"> </span><span class="mf">0.4</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">            </span><span class="p">;</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">                        </span><span class="p">;</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">                            </span><span class="p">;</span>
<a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a><span class="o">|</span><span class="n">resync_chains</span><span class="p">[</span><span class="mh">0</span><span class="p">].</span><span class="n">synchronizer_nocut</span><span class="o">|</span><span class="w">        </span><span class="p">;</span><span class="w"> </span><span class="mf">0.4</span><span class="w"> </span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span><span class="w">            </span><span class="p">;</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="w">                        </span><span class="p">;</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span><span class="w">                            </span><span class="p">;</span>
<a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a><span class="o">|</span><span class="n">emif</span><span class="p">[</span><span class="mh">0</span><span class="p">].</span><span class="n">ddr4_softreset_sync</span><span class="o">|</span><span class="w">                </span><span class="p">;</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">            </span><span class="p">;</span><span class="w"> </span><span class="mf">0.7</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">                        </span><span class="p">;</span><span class="w"> </span><span class="mf">0.2</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">                            </span><span class="p">;</span>
<a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a><span class="o">|</span><span class="n">resync_chains</span><span class="p">[</span><span class="mh">0</span><span class="p">].</span><span class="n">synchronizer_nocut</span><span class="o">|</span><span class="w">        </span><span class="p">;</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="w">            </span><span class="p">;</span><span class="w"> </span><span class="mf">0.7</span><span class="w"> </span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span><span class="w">                        </span><span class="p">;</span><span class="w"> </span><span class="mf">0.2</span><span class="w"> </span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span><span class="w">                            </span><span class="p">;</span>
<a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a><span class="o">|</span><span class="n">emif</span><span class="p">[</span><span class="mh">0</span><span class="p">].</span><span class="n">pr_frz_afu_avmm_if</span><span class="o">|</span><span class="w">                 </span><span class="p">;</span><span class="w"> </span><span class="mf">647.5</span><span class="w"> </span><span class="p">(</span><span class="mf">647.5</span><span class="p">)</span><span class="w">        </span><span class="p">;</span><span class="w"> </span><span class="mf">917.3</span><span class="w"> </span><span class="p">(</span><span class="mf">917.3</span><span class="p">)</span><span class="w">                    </span><span class="p">;</span><span class="w"> </span><span class="mf">272.8</span><span class="w"> </span><span class="p">(</span><span class="mf">272.8</span><span class="p">)</span><span class="w">                        </span><span class="p">;</span>
<a id="__codelineno-66-6" name="__codelineno-66-6" href="#__codelineno-66-6"></a><span class="o">|</span><span class="n">emif</span><span class="p">[</span><span class="mh">1</span><span class="p">].</span><span class="n">ddr4_pr_freeze_sync</span><span class="o">|</span><span class="w">                </span><span class="p">;</span><span class="w"> </span><span class="mf">0.4</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">            </span><span class="p">;</span><span class="w"> </span><span class="mf">0.8</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">                        </span><span class="p">;</span><span class="w"> </span><span class="mf">0.4</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">                            </span><span class="p">;</span>
<a id="__codelineno-66-7" name="__codelineno-66-7" href="#__codelineno-66-7"></a><span class="o">|</span><span class="n">resync_chains</span><span class="p">[</span><span class="mh">0</span><span class="p">].</span><span class="n">synchronizer_nocut</span><span class="o">|</span><span class="w">        </span><span class="p">;</span><span class="w"> </span><span class="mf">0.4</span><span class="w"> </span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span><span class="w">            </span><span class="p">;</span><span class="w"> </span><span class="mf">0.8</span><span class="w"> </span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span><span class="w">                        </span><span class="p">;</span><span class="w"> </span><span class="mf">0.4</span><span class="w"> </span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span><span class="w">                            </span><span class="p">;</span>
<a id="__codelineno-66-8" name="__codelineno-66-8" href="#__codelineno-66-8"></a><span class="o">|</span><span class="n">emif</span><span class="p">[</span><span class="mh">1</span><span class="p">].</span><span class="n">ddr4_softreset_sync</span><span class="o">|</span><span class="w">                </span><span class="p">;</span><span class="w"> </span><span class="mf">0.4</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">            </span><span class="p">;</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">                        </span><span class="p">;</span><span class="w"> </span><span class="mf">0.6</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">                            </span><span class="p">;</span>
<a id="__codelineno-66-9" name="__codelineno-66-9" href="#__codelineno-66-9"></a><span class="o">|</span><span class="n">resync_chains</span><span class="p">[</span><span class="mh">0</span><span class="p">].</span><span class="n">synchronizer_nocut</span><span class="o">|</span><span class="w">        </span><span class="p">;</span><span class="w"> </span><span class="mf">0.4</span><span class="w"> </span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span><span class="w">            </span><span class="p">;</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="w">                        </span><span class="p">;</span><span class="w"> </span><span class="mf">0.6</span><span class="w"> </span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span><span class="w">                            </span><span class="p">;</span>
<a id="__codelineno-66-10" name="__codelineno-66-10" href="#__codelineno-66-10"></a><span class="o">|</span><span class="n">emif</span><span class="p">[</span><span class="mh">1</span><span class="p">].</span><span class="n">pr_frz_afu_avmm_if</span><span class="o">|</span><span class="w">                 </span><span class="p">;</span><span class="w"> </span><span class="mf">641.1</span><span class="w"> </span><span class="p">(</span><span class="mf">641.1</span><span class="p">)</span><span class="w">        </span><span class="p">;</span><span class="w"> </span><span class="mf">914.0</span><span class="w"> </span><span class="p">(</span><span class="mf">914.0</span><span class="p">)</span><span class="w">                    </span><span class="p">;</span><span class="w"> </span><span class="mf">272.9</span><span class="w"> </span><span class="p">(</span><span class="mf">272.9</span><span class="p">)</span><span class="w">                        </span><span class="p">;</span>
<a id="__codelineno-66-11" name="__codelineno-66-11" href="#__codelineno-66-11"></a><span class="o">|</span><span class="n">p</span><span class="p">[</span><span class="mh">0</span><span class="p">].</span><span class="n">pr_frz_fn2mx_a_port</span><span class="o">|</span><span class="w">                   </span><span class="p">;</span><span class="w"> </span><span class="mf">435.4</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">          </span><span class="p">;</span><span class="w"> </span><span class="mf">476.2</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">                      </span><span class="p">;</span><span class="w"> </span><span class="mf">40.8</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">                           </span><span class="p">;</span>
<a id="__codelineno-66-12" name="__codelineno-66-12" href="#__codelineno-66-12"></a><span class="o">|</span><span class="n">r</span><span class="p">.</span><span class="n">axis_pl_stage</span><span class="p">[</span><span class="mh">0</span><span class="p">].</span><span class="n">axis_reg_inst</span><span class="o">|</span><span class="w">           </span><span class="p">;</span><span class="w"> </span><span class="mf">435.4</span><span class="w"> </span><span class="p">(</span><span class="mf">435.4</span><span class="p">)</span><span class="w">        </span><span class="p">;</span><span class="w"> </span><span class="mf">476.2</span><span class="w"> </span><span class="p">(</span><span class="mf">476.2</span><span class="p">)</span><span class="w">                    </span><span class="p">;</span><span class="w"> </span><span class="mf">40.8</span><span class="w"> </span><span class="p">(</span><span class="mf">40.8</span><span class="p">)</span><span class="w">                          </span><span class="p">;</span>
<a id="__codelineno-66-13" name="__codelineno-66-13" href="#__codelineno-66-13"></a><span class="o">|</span><span class="n">p</span><span class="p">[</span><span class="mh">0</span><span class="p">].</span><span class="n">pr_frz_fn2mx_b_port</span><span class="o">|</span><span class="w">                   </span><span class="p">;</span><span class="w"> </span><span class="mf">434.6</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">          </span><span class="p">;</span><span class="w"> </span><span class="mf">494.3</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">                      </span><span class="p">;</span><span class="w"> </span><span class="mf">59.6</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="w">                           </span><span class="p">;</span>
</code></pre></div>
<h2 id="6-conclusion">6. Conclusion<a class="headerlink" href="#6-conclusion" title="Permanent link">&para;</a></h2>
<p>Using the <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> reference design and <abbr title="Open Programmable Acceleration Engine Software Development Kit, A collection of libraries and tools to facilitate the development of software applications and accelerators using OPAE.">OPAE SDK</abbr> enables the rapid creation of market leading FPGA based Acceleration systems. <abbr title="Open FPGA Stack, A modular collection of hardware platform components, open source software, and broad ecosystem support that provides a standard and scalable model for AFU and software developers to optimize and reuse their designs.">OFS</abbr> facilitates customization of the <abbr title="FPGA Interface Manager, Provides platform management, functionality, clocks, resets and standard interfaces to host and AFUs. The FIM resides in the static region of the FPGA and contains the FPGA Management Engine (FME) and I/O ring.">FIM</abbr> area for your custom board or platforms. </p>
<h2 id="notices-disclaimers">Notices &amp; Disclaimers<a class="headerlink" href="#notices-disclaimers" title="Permanent link">&para;</a></h2>
<p>Intel<sup>&reg;</sup> technologies may require enabled hardware, software or service activation.
No product or component can be absolutely secure. 
Performance varies by use, configuration and other factors.
Your costs and results may vary. 
You may not use or facilitate the use of this document in connection with any infringement or other legal analysis concerning Intel products described herein. You agree to grant Intel a non-exclusive, royalty-free license to any patent claim thereafter drafted which includes subject matter disclosed herein.
No license (express or implied, by estoppel or otherwise) to any intellectual property rights is granted by this document, with the sole exception that you may publish an unmodified copy. You may create software implementations based on this document and in compliance with the foregoing that are intended to execute on the Intel product(s) referenced in this document. No rights are granted to create modifications or derivatives of this document.
The products described may contain design defects or errors known as errata which may cause the product to deviate from published specifications.  Current characterized errata are available on request.
Intel disclaims all express and implied warranties, including without limitation, the implied warranties of merchantability, fitness for a particular purpose, and non-infringement, as well as any warranty arising from course of performance, course of dealing, or usage in trade.
You are responsible for safety of the overall system, including compliance with applicable safety-related requirements or standards. 
<sup>&copy;</sup> Intel Corporation.  Intel, the Intel logo, and other Intel marks are trademarks of Intel Corporation or its subsidiaries.  Other names and brands may be claimed as the property of others. </p>
<p>OpenCL and the OpenCL logo are trademarks of Apple Inc. used by permission of the Khronos Group™.   </p>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.indexes", "search.suggest", "search.highlight", "content.code.copy", "navigation.indexes", "toc.follow"], "search": "../../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.fac441b0.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>